(this["webpackJsonp@tableplus/diagram"]=this["webpackJsonp@tableplus/diagram"]||[]).push([[0],{120:function(e,t,n){e.exports={container:"marker_container__1M8sa"}},121:function(e,t,n){e.exports={container:"body_container__3oC6s",header:"body_header__jV-GI"}},122:function(e,t,n){e.exports={container:"row_container__2yTZp",over:"row_over__2gC30"}},123:function(e,t,n){e.exports={container:"name_container__1o8SY",view:"name_view__15GrF"}},124:function(e,t,n){e.exports={container:"canvas_container__3Y18v",grid:"canvas_grid__nkChd"}},127:function(e,t,n){e.exports={container:"progress_container__1kfqj",body:"progress_body__2EtDz"}},128:function(e,t,n){e.exports={container:"footer_container__3MvUg",logo:"footer_logo__3qLuS"}},196:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://diagramplus.com/diagram-schema.json","title":"TablePlus Diagram","description":"JSON schema for Diagram by TablePlus (https://diagramplus.com/)","type":"object","definitions":{"column":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"type":{"type":"string"}},"additionalProperties":true,"required":["id","type","name"]},"row":{"type":"object","properties":{"id":{"type":"string"}},"additionalProperties":{"type":"string"},"required":["id"]},"ref-side":{"type":"object","properties":{"name":{"type":"string"},"schema":{"type":"string"},"rows":{"type":"array","items":{"type":"string"}}},"additionalProperties":true,"required":["name","rows"]},"ref":{"type":"object","properties":{"from":{"$ref":"#/definitions/ref-side"},"to":{"$ref":"#/definitions/ref-side"}},"additionalProperties":true,"required":["from","to"]},"item":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"schema":{"type":"string"},"rows":{"type":"array","items":{"$ref":"#/definitions/row"}}},"additionalProperties":true,"required":["id","name","rows"]}},"properties":{"columns":{"type":"array","items":{"$ref":"#/definitions/column"}},"schema":{"type":"string"},"items":{"type":"array","items":{"$ref":"#/definitions/item"}},"refs":{"type":"array","items":{"$ref":"#/definitions/ref"}},"$schema":{"type":"string"}},"additionalProperties":true,"required":["schema","columns","items","refs"]}')},197:function(e,t,n){e.exports={container:"canvas_container__KH5yw"}},199:function(e,t,n){e.exports={container:"active_container__3joLV","react-draggable-dragging":"active_react-draggable-dragging__1JdPr"}},200:function(e,t,n){e.exports={container:"add_container__2lSlZ","slide-in":"add_slide-in__2Hk9K"}},201:function(e,t,n){e.exports={container:"boolean_container__1bqLB"}},202:function(e,t,n){e.exports={right:"field_right__3YAJ4"}},203:function(e,t,n){e.exports={container:"remove_container__Ts2Bx","slide-in":"remove_slide-in__3caLT"}},204:function(e,t,n){e.exports={container:"remove_container__2HEZR","win-background":"remove_win-background__WJQ6a"}},205:function(e,t,n){e.exports={container:"blank_container__3L-Iq"}},207:function(e,t,n){e.exports={container:"mac_container__YDixB"}},208:function(e,t,n){e.exports={container:"win_container__Ote90"}},209:function(e,t){e.exports="data:image/png;base64,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"},210:function(e,t,n){e.exports={container:"privacy_container__1BD1S"}},215:function(e,t,n){e.exports=n(442)},29:function(e,t,n){e.exports={container:"edge_container__1EyW3",from:"edge_from__1Ovs9",to:"edge_to__3E3uJ",path:"edge_path__x4S4v",dot:"edge_dot__2KuhC",selected:"edge_selected__1Gpep",hitarea:"edge_hitarea__3Airq"}},30:function(e,t,n){e.exports={container:"report_container__2lwO5",backdrop:"report_backdrop__3x5uS",main:"report_main__9yJhe",body:"report_body__1p5xp",footer:"report_footer__1K0r-",title:"report_title__3w0zK"}},41:function(e,t,n){e.exports={container:"links_container__1D7C_",nobreak:"links_nobreak__2Iiva"}},438:function(e,t,n){},440:function(e,t,n){},442:function(e,t,n){"use strict";n.r(t);var a,r=n(1),i=n(4),o=n(0),c=n.n(o),l=n(446),s=n(5),u=n(51),d=n.n(u),f=function(e){if(!e.isDragging())return null;if("row"!==e.getItemType())return null;var t=e.getClientOffset(),n=e.getItem();return null===n||null===t?null:{item:n,top:t.y,left:t.x}},m=c.a.memo((function(e){var t=e.top,n=e.left;return c.a.createElement("div",{style:{color:"var(--accent-2)"}},c.a.createElement("div",{className:d.a.icon,style:{top:t-8,left:n-8}},c.a.createElement(r.j,{path:s.a.locate,size:16})))})),p=c.a.memo((function(e){var t=Object(l.a)(f),n=c.a.useRef(null),a=null===t||void 0===t?void 0:t.item.elementRef,r=e.viewportRef;c.a.useEffect((function(){n.current=void 0===a?null:function(e,t){var n=e.current;if(null===n)throw Error("Viewport is not defined");var a=t.current;if(null===a)throw Error("Source drag is not defined");var r=a.getBoundingClientRect(),i=[r.top+r.height/2,r.left+r.width/2];return{top:i[0],left:i[1],scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}}(r,a)}),[r,a]);var i=n.current;if(null===t||null===i)return null;var o=e.viewportRef.current;if(null===o)throw Error("viewport is not defined");var s=o.scrollLeft-i.scrollLeft,u=o.scrollTop-i.scrollTop;return c.a.createElement("div",{className:d.a.container},c.a.createElement("svg",{className:d.a.svg},c.a.createElement("line",{className:d.a.line,x1:i.left-s,y1:i.top-u,x2:t.left,y2:t.top})),c.a.createElement(m,{top:t.top,left:t.left}))})),v=function(e,t){var n=e.get(t.table);if(!n)throw Error('Table Ids "'.concat(t.table,'" not found'));var a=t.rows.map((function(e){var t=n.rows.get(e);if(!t)throw Error('Row id "'.concat(e,'" not found'));return t})),r=n.table;return{name:r.name,schema:r.schema,rows:a}},h=function(e){var t=e.columns.map((function(e){return e.value})),n=e.tables.map((function(e){var t=e.value.rows.map((function(e){return e.value})),n=e.value;return{id:n.id,name:n.name,schema:n.schema,rows:t}})),a=function(e){var t=new Map;return e.forEach((function(e){var n=new Map;e.value.rows.forEach((function(e){n.set(e.id,e.value.id)}));var a={name:e.value.name,schema:e.value.schema};t.set(e.id,{table:a,rows:n})})),t}(e.tables);return{columns:t,items:n,refs:e.refs.map((function(e){return{from:v(a,e.from),to:v(a,e.to)}})),schema:e.schema}},g=n(7),b={},E=[["Initialized",{}]],w=function(e,t){b[e]=t},y=function(e){var t=null,n=[];b[e]=function(){for(var e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];if(null!==t)return E.push(["Execute",a]),t.apply(void 0,a);E.push(["Pending",a]),n.push(a)};return function(e){for(t=e;n.length>0;){var a=n.shift();E.push(["Execute pending item",a]),t.apply(void 0,Object(g.a)(a))}}},x=y("importDiagram"),j=y("importDiagramJSON"),D=y("importDiagramObject"),_=y("importDiagramBase64"),I=n(2),O=function(e){return"table . ".concat(e)},z=function(e){var t=document.getElementById(O(e));if(t instanceof HTMLDivElement)return t;throw Error("Element is not HTMLDivElement")},S=function(e){return{width:224,height:24*(e.isRowsExpand?e.value.rows.length:Math.min(e.value.rows.length,51))+64}},A=n(118),k=n.n(A),T=function(e){return 8*Math.round(e/8)},M=function(e){var t,n,a,r=new k.a.graphlib.Graph({multigraph:!0});return r.setGraph({rankdir:"LR",nodesep:96,ranksep:96,marginx:48,marginy:48}),r.setDefaultEdgeLabel((function(){return{}})),e.tables.forEach((function(e){var t=function(e){try{var t=z(e.id);if(t.dataset.name!==e.value.name)throw Error("Outdated table from previous diagram");return{width:t.clientWidth,height:t.clientHeight}}catch(n){return S(e)}}(e),n=t.width,a=t.height;r.setNode(e.id.toString(),{label:"",width:n,height:a})})),e.refs.forEach((function(e){r.setEdge(e.from.table.toString(),e.to.table.toString())})),k.a.layout(r),{tables:e.tables.map((function(e){var t=r.node(e.id.toString()),n={top:0,left:0};return n.top=T(t.y-t.height/2),n.left=T(t.x-t.width/2),Object(I.a)(Object(I.a)({},e),{},{position:n})})),refs:e.refs,size:{width:(a=null!==(t=r.graph().width)&&void 0!==t?t:-1,320*Math.ceil(a/320)),height:T(null!==(n=r.graph().height)&&void 0!==n?n:-1)}}},C=function(e){return e.height*e.width},L=function(e){var t=e.map((function(e){return{id:e.tables[0].id,width:e.size.width,height:e.size.height}})),n=function(e){var t=e.reduce((function(e,t){return e>t.width?e:t.width}),-1/0),n=e.reduce((function(e,t){return e+C(t)}),0),a=2*Math.sqrt(n/2),r=Math.max(a,t);return Math.ceil(r/320)}(t),a=Array(n).fill(0),r=new Map,i=function(e){return a.map((function(t,n){return{leftIndex:n,top:function(e,t){if(e+t>a.length)return 1/0;for(var n=-1/0,r=0;r<t;r++){var i=a[e+r];n=Math.max(i,n)}return n}(n,e)}})).reduce((function(e,t){return t.top<e.top?t:e}))};return t.sort((function(e,t){return C(t)-C(e)})).forEach((function(e){for(var t=e.width/320,n=i(t),o=n.top+e.height,c=0;c<t;c++)a[n.leftIndex+c]=o;r.set(e.id,{left:320*n.leftIndex,top:n.top})})),r},P=function(e){var t=e.diagrams,n=e.masonry,a=0,r=0;t.forEach((function(e){var t=n.get(e.tables[0].id);if(void 0===t)throw Error("position is undefined");var i=t.left+e.size.width;a=Math.max(a,i);var o=t.top+e.size.height;r=Math.max(r,o)}));var i=[a+96,r+96];return a=i[0],r=i[1],a=Math.max(window.screen.availWidth-20,a),r=Math.max(window.screen.availHeight,r),{width:a,height:r}},N=function(e){var t=[];if(e.diagrams.forEach((function(n){var a=e.masonry.get(n.tables[0].id);if(void 0===a)throw Error("translate is undefined");n.tables.forEach((function(e){var n={top:a.top+e.position.top+48,left:a.left+e.position.left+48};t.push(Object(I.a)(Object(I.a)({},e),{},{position:n}))}))})),t.length===e.originalDiagram.tables.length)return t;throw Error("new tables and old tables have different length")},B=function(e){var t=[],n=new Map,a=new Map;e.tables.forEach((function(e){a.set(e.id,e)}));var r=new Map;return e.refs.forEach((function(e){var t,n,a=[e.from.table,e.to.table],i=a[0],o=a[1];r.set(i,(null!==(t=r.get(i))&&void 0!==t?t:[]).concat(e)),r.set(o,(null!==(n=r.get(o))&&void 0!==n?n:[]).concat(e))})),e.tables.forEach((function(e){if(!0!==n.get(e.id)){var i={tables:[],refs:[],size:{width:0,height:0}};!function e(t,n){var a,r,i=t.diagram,o=t.done,c=t.refMap,l=t.tableMap;!0!==o.get(n.id)&&(i.tables.push(n),null===(a=c.get(n.id))||void 0===a||a.forEach((function(e){i.refs.includes(e)||i.refs.push(e)})),o.set(n.id,!0),(null!==(r=c.get(n.id))&&void 0!==r?r:[]).forEach((function(n){var a=l.get(n.from.table),r=l.get(n.to.table);if(void 0===a||void 0===r)throw Error('"fromTable" or "toTable" is undefined');e(t,a),e(t,r)})))}({diagram:i,done:n,tableMap:a,refMap:r},e),t.push(i)}})),t.forEach((function(e){M(e)})),t},R=function(e){var t=B(e);t=t.map(M);var n,a=L(t);return{columns:(n={originalDiagram:e,masonry:a,diagrams:t}).originalDiagram.columns,tables:N(n),refs:n.originalDiagram.refs,size:P(n),schema:n.originalDiagram.schema}},H=function(e,t,n){var a,r=null!==(a=n.schema)&&void 0!==a?a:e,i=t.get("".concat(r," . ").concat(n.name));if(void 0===i)throw Error('Table Ids "'.concat(n.name,'" not found'));var o=n.rows.map((function(e){var t=i.rows.get(e);if(void 0===t)throw Error('Row id "'.concat(e,'" not found'));return t}));return{table:i.table,rows:o}},F=function(e,t){return{value:{rows:e.rows.map((function(e,t){return{id:t,value:e}})),name:e.name,id:e.id,schema:e.schema},position:{top:0,left:0},id:t,isRowsExpand:!1}},Q=function(e,t){return{id:t,value:e}},V=function(e){var t=e.schema,n=e.columns.map(Q),a=e.items.map(F),r=function(e,t){var n=new Map;return t.forEach((function(t){var a,r=new Map;t.value.rows.forEach((function(e){r.set(e.value.id,e.id)}));var i=null!==(a=t.value.schema)&&void 0!==a?a:e,o="".concat(i," . ").concat(t.value.name);n.set(o,{table:t.id,rows:r})})),n}(t,a),i=e.refs.map(function(e,t){return function(n,a){return{id:a,from:H(e,t,n.from),to:H(e,t,n.to)}}}(t,r));return R({tables:a,refs:i,columns:n,size:{width:0,height:0},schema:t})},W=n(195),U=n.n(W),X=n(196),K=new U.a({strictDefaults:!0,strictKeywords:!0}),q=K.compile(X),G=n(79),Y=n(80),Z=n(84),J=n(214),$=function(e){Object(Y.a)(n,e);var t=Object(Z.a)(n);function n(e){var a;return Object(G.a)(this,n),(a=t.call(this,e)).name="DiagramRefError",a}return n}(Object(J.a)(Error)),ee=function(e,t){return new $("".concat(e," has an invalid reference to ").concat(t))},te=function(e,t,n){var a=e.items.find((function(n){return n.name===t.name&&function(e,t,n){var a,r;return(null!==(a=t.schema)&&void 0!==a?a:e.schema)===(null!==(r=n.schema)&&void 0!==r?r:e.schema)}(e,t,n)}));if(!a)throw ee("Ref #".concat(n),'table "'.concat(t.name,'"'));t.rows.forEach((function(e){if(!a.rows.some((function(t){return t.id===e})))throw ee("Ref #".concat(n,".rows"),'row "'.concat(e,'"'))}))},ne=function(e){!function(e){var t=e.items.map((function(e){return e.id}));if(new Set(t).size!==t.length)throw Error("items.ids are not unique")}(e),e.items.forEach((function(e){!function(e){var t=e.rows.map((function(e){return e.id}));if(new Set(t).size!==t.length)throw Error("tables.".concat(e.id,".rows.ids are not unique"))}(e)})),e.refs=e.refs.filter((function(t,n){try{te(e,t.from,n),te(e,t.to,n)}catch(a){if(a instanceof $)return console.warn(a),!1;throw a}return!0}))},ae=function(e,t){for(var n=new Set(e),a=1,r=t(a);n.has(r);)r=t(a+=1);return r},re=function(e,t){return ae(e,(function(e){return 1===e?t:"".concat(t,"_").concat(e)}))},ie=function(e){return ae(e,(function(e){return e}))},oe=function(e){var t=e.map((function(e){return e.value.id}));return{id:ie(e.map((function(e){return e.id}))),value:{id:re(t,"column")}}},ce=function(e,t){var n=function(e,t){return function(t){if(t.id!==e.tableId)return t;var n=oe(t.value.rows),a=t.value.rows.concat(n);return Object(I.a)(Object(I.a)({},t),{},{value:Object(I.a)(Object(I.a)({},t.value),{},{rows:a})})}}(t,e.columns);return Object(I.a)(Object(I.a)({},e),{},{tables:e.tables.map(n)})},le=function(e,t){return Math.max(t.position.left,e)},se=function(e){return{top:96,left:e.reduce(le,0)+320}},ue=function(e,t){var n=Math.max(e.width,t.left+320);return n===e.width?e:Object(I.a)(Object(I.a)({},e),{},{width:n})},de=function(e,t){var n=t.raw;!function(e){if(q(e))return!0;var t=q.errors;throw SyntaxError(K.errorsText(t,{dataVar:"diagram"}))}(n),ne(n);var a=V(n);return t.isAppend?function(e,t){if(e.columns.length!==t.columns.length)throw Error("Cannot merge diagrams with different columns");var n=e.tables.map((function(e){return e.id})),a=se(e.tables);a.top=a.top-96,a.left=a.left-96;var r=Object(g.a)(e.tables);t.tables.forEach((function(e){var t=ie(n);n.push(t);var i={top:e.position.top+a.top,left:e.position.left+a.left};r.push(Object(I.a)(Object(I.a)({},e),{},{id:t,position:i}))}));var i=a.left+t.size.width,o=Object(I.a)(Object(I.a)({},e.size),{},{width:i});return Object(I.a)(Object(I.a)({},e),{},{tables:r,size:o})}(e,a):a},fe=function(e,t){var n=JSON.parse(t.text);return de(e,Object(I.a)(Object(I.a)({},t),{},{raw:n}))},me=function(e,t){switch(t.type){case"import-raw":return de(e,t.payload);case"import-json":return fe(e,t.payload);case"import-base64":return function(e,t){var n=new TextDecoder,a=Uint8Array.from(atob(t.text),(function(e){return e.charCodeAt(0)})),r=n.decode(a);return fe(e,Object(I.a)(Object(I.a)({},t),{},{text:r}))}(e,t.payload);default:return e}},pe=function(e,t){var n=e.refs.filter((function(e){return e.id!==t.id}));return Object(I.a)(Object(I.a)({},e),{},{refs:n})},ve=function(e,t){switch(t.type){case"add-ref":return function(e,t){var n=e.refs.filter((function(e){return!function(e,t){return e.from.table===t.from.table&&e.from.rows.some((function(e){return t.from.rows.includes(e)}))}(e,t)})),a=e.refs.map((function(e){return e.id})),r=Object(I.a)(Object(I.a)({},t),{},{id:ie(a)});return n.push(r),Object(I.a)(Object(I.a)({},e),{},{refs:n})}(e,t.payload);case"remove-ref":return pe(e,t.payload);case"remove-multiple-refs":return function(e,t){var n=e;return t.ids.forEach((function(e){n=pe(n,{id:e})})),n}(e,t.payload);default:return e}},he=function(e,t){return t.table===e.tableId&&t.rows.includes(e.rowId)},ge=function(e,t){var n=e.tables.map(function(e){return function(t){if(t.id!==e.tableId)return t;var n=t.value.rows.filter((function(t){return t.id!==e.rowId}));return Object(I.a)(Object(I.a)({},t),{},{value:Object(I.a)(Object(I.a)({},t.value),{},{rows:n})})}}(t)),a=e.refs.filter((function(e){return!function(e,t){return he(e,t.from)||he(e,t.to)}(t,e)}));return a.length===e.refs.length&&(a=e.refs),Object(I.a)(Object(I.a)({},e),{},{tables:n,refs:a})},be=function(e){return function(t){if(t.id!==e.tableId)return t;var n=t.value.rows.map(function(e){return function(t){if(t.id!==e.rowId)return t;var n=Object(I.a)({},t.value);return n[e.property]=e.value,Object(I.a)(Object(I.a)({},t),{},{value:n})}}(e));return Object(I.a)(Object(I.a)({},t),{},{value:Object(I.a)(Object(I.a)({},t.value),{},{rows:n})})}},Ee=function(e,t){if(function(e,t){var n,a=t.tableId,r=t.rowId,i=t.property,o=t.value,c=null===(n=e.tables.find((function(e){return e.id===a})))||void 0===n?void 0:n.value.rows.find((function(e){return e.id===r}));if(!c)throw Error('Row "'.concat(a,".").concat(r,'" not found'));return c.value[i]===o}(e,t))return e;var n=e.tables.map(be(t));return Object(I.a)(Object(I.a)({},e),{},{tables:n})},we=function(e,t){var n=e.tables.filter((function(e){return e.id!==t.id})),a=e.refs.filter((function(e){return!function(e,t){return t.from.table===e.id||t.to.table===e.id}(t,e)}));return Object(I.a)(Object(I.a)({},e),{},{tables:n,refs:a})},ye=function(e,t){var n=e.tables.map(function(e){return function(t){return t.id!==e.id?t:Object(I.a)(Object(I.a)({},t),{},{value:Object(I.a)(Object(I.a)({},t.value),{},{name:e.name})})}}(t));return Object(I.a)(Object(I.a)({},e),{},{tables:n})},xe=function(e,t){switch(t.type){case"add-table":return function(e,t){var n,a=e.tables.map((function(e){return e.value.id})),r=re(a,"table"),i=oe([]),o={id:null!==(n=t.id)&&void 0!==n?n:ie(e.tables.map((function(e){return e.id}))),value:{name:r,id:r,schema:"new",rows:[i]},position:se(e.tables),isRowsExpand:!1};return Object(I.a)(Object(I.a)({},e),{},{tables:e.tables.concat(o),size:ue(e.size,o.position)})}(e,t.payload);case"remove-table":return we(e,t.payload);case"remove-multiple-tables":return function(e,t){var n=e;return t.ids.forEach((function(e){n=we(n,{id:e})})),n}(e,t.payload);case"update-table-name":return ye(e,t.payload);case"set-table-position":return function(e,t){return Object(I.a)(Object(I.a)({},e),{},{tables:e.tables.map((function(e){return e.id!==t.id?e:Object(I.a)(Object(I.a)({},e),{},{position:t.position})}))})}(e,t.payload);case"set-table-rows-expand":return function(e,t){var n=e.tables.map((function(e){return e.id!==t.id?e:Object(I.a)(Object(I.a)({},e),{},{isRowsExpand:t.isExpand})}));return Object(I.a)(Object(I.a)({},e),{},{tables:n})}(e,t.payload);case"set-all-tables-rows-expand":return function(e,t){var n=e.tables.map((function(e){return Object(I.a)(Object(I.a)({},e),{},{isRowsExpand:t})}));return Object(I.a)(Object(I.a)({},e),{},{tables:n})}(e,t.payload);default:return e}},je=["localhost","diagramplus.com"],De=function(){if(je.includes(window.location.hostname))return"web";if(window.location.hostname.startsWith("192.168.1"))return"web";var e=navigator.platform.toLowerCase();return e.includes("mac")?"mac":e.includes("win")?"win":"web"}(),_e=c.a.createContext(De),Ie=function(){return c.a.useContext(_e)},Oe=y("setPlatform"),ze=V({columns:[{id:"0",name:"name",type:"string"},{id:"1",name:"type",type:"string"},{id:"2",name:"nullable",type:"boolean"}],schema:"main",items:[],refs:[]}),Se=V({columns:[{id:"0",name:"name",type:"string"},{id:"1",name:"type",type:"string"},{id:"2",name:"nullable",type:"boolean"}],schema:"primary",items:[{id:"employees",name:"employees",rows:[{id:"emp_no",name:"emp_no",type:"int(11)",nullable:"FALSE"},{id:"birth_date",name:"birth_date",type:"date",nullable:"TRUE"},{id:"first_name",name:"first_name",type:"varchar(14)",nullable:"TRUE"},{id:"last_name",name:"last_name",type:"varchar(16)",nullable:"TRUE"}]},{id:"departments",name:"departments",schema:"secondary",rows:[{id:"dept_no",name:"dept_no",type:"char(4)",nullable:"FALSE"},{id:"dept_name",name:"dept_name",type:"varchar(40)",nullable:"FALSE"}]},{id:"dept_emp",name:"dept_emp",rows:[{id:"dept_no",name:"dept_no",type:"char(4)",nullable:"FALSE"},{id:"emp_no",name:"emp_no",type:"int(11)",nullable:"FALSE"},{id:"from_date",name:"from_date",type:"date",nullable:"TRUE"},{id:"to_date",name:"to_date",type:"date",nullable:"TRUE"}]}],refs:[{from:{name:"dept_emp",schema:"primary",rows:["dept_no"]},to:{name:"departments",schema:"secondary",rows:["dept_no"]}},{from:{name:"dept_emp",rows:["emp_no"]},to:{name:"employees",rows:["emp_no"]}}]}),Ae=["There was an error while parsing the locally saved diagram. The app will ","now fallback to a sample diagram.\n\n","Your previous diagram is still available in your localStorage under the ",'key "'.concat("diagram",'-invalid". Please contact us if you need help '),"retrieving it."].join(""),ke=function(e){window.localStorage.setItem("diagram",JSON.stringify(e))},Te=function(){var e=Ie();return o.useMemo((function(){return"web"===e?{get:function(){return function(){var e=window.localStorage.getItem("diagram");if(null===e)return Se;try{return JSON.parse(e)}catch(t){return window.localStorage.setItem("".concat("diagram","-invalid"),e),window.alert(Ae),Se}}()},set:function(e){return ke(e)}}:{get:function(){return ze},set:function(e){return ke(e)}}}),[e])},Me=function(e){var t=e.past,n=e.future,a=e.dispatch;o.useEffect((function(){var e=function(e){return function(t){if((t.ctrlKey||t.metaKey)&&!(t.target instanceof HTMLInputElement)&&!(t.target instanceof HTMLTextAreaElement))switch(t.key){case"z":if(0===e.past.length)return;return e.dispatch({type:"undo"});case"Z":case"y":if(0===e.future.length)return;return e.dispatch({type:"redo"})}}}({past:t,future:n,dispatch:a});return document.addEventListener("keyup",e),function(){return document.removeEventListener("keyup",e)}}),[t,n,a])},Ce=n(119),Le=(a=function(e,t){var n=e;return n=function(e,t){switch(t.type){case"add-row":return ce(e,t.payload);case"remove-row":return ge(e,t.payload);case"update-row":return Ee(e,t.payload);default:return e}}(n=xe(n,t),t),n=ve(n,t),n=function(e,t){switch(t.type){case"set-layout":switch(t.payload.type){case"auto":return R(e);default:return e}default:return e}}(n=me(n,t),t)},function(e,t){switch(t.type){case"undo":var n=Object(Ce.a)(e.past),r=n[0];return{past:n.slice(1),present:r,future:[e.present].concat(Object(g.a)(e.future))};case"redo":var i=Object(Ce.a)(e.future),o=i[0],c=i.slice(1);return{past:[e.present].concat(Object(g.a)(e.past)),present:o,future:c};default:var l=a(e.present,t),s=[e.present].concat(Object(g.a)(e.past));return{past:s=s.length<20?s:s.slice(0,20),present:l,future:[]}}}),Pe=function(){var e,t,n=Te(),a=c.a.useReducer(Le,void 0,(function(){return{past:[],present:n.get(),future:[]}})),r=Object(i.a)(a,2),o=r[0],l=r[1],s=o.past,u=o.present,d=o.future;e=u,t=l,c.a.useEffect((function(){x((function(e){t({type:"import-json",payload:{text:e,isAppend:!1}})})),j((function(e){t({type:"import-json",payload:{text:e,isAppend:!1}})})),D((function(e){t({type:"import-raw",payload:{raw:e,isAppend:!1}})})),_((function(e){t({type:"import-base64",payload:{text:e,isAppend:!1}})}))}),[t]),c.a.useEffect((function(){w("exportDiagram",(function(){return JSON.stringify(h(e))}))}),[e]),Me({past:s,future:d,dispatch:l});var f=n.set;return c.a.useEffect((function(){f(u)}),[u,f]),{history:o,dispatch:l}},Ne=function(e){return function(){e.setSelectIds([{type:"ref",value:e.refId}])}},Be=n(29),Re=n.n(Be),He=function(e,t){return"row . ".concat(e," . ").concat(t)},Fe=function(e,t){var n=t.top,a=t.left,r=z(e.table);return e.rows.map((function(t){var i=function(e,t){var n=document.getElementById(He(e,t));return n instanceof HTMLDivElement?n:null}(e.table,t);if(null!==i){var o=function(e,t){var n=0,a=0,r=e;do{var i=[n+r.offsetTop,a+r.offsetLeft];n=i[0],a=i[1];var o=r.offsetParent;if(!(o instanceof HTMLElement))break;r=o}while(r!==t);return{top:n,left:a}}(i,r),c=o.top,l=o.left,s=c+n+i.clientHeight/2,u=l+a;return{top:s,left:u,right:u+i.clientWidth}}return{top:n+r.clientHeight/2,left:a,right:a+r.clientWidth}}))},Qe={attributes:!0,attributeFilter:["data-is-visible"]},Ve=function(e,t,n){var a=[e[n],t[n]],r=a[0],i=a[1],o=Math.min(8,Math.abs(r-i)/2);return r===i?r:i+o*(r>i?1:-1)},We=function(e,t){return{x:Ve(e,t,"x"),y:Ve(e,t,"y")}},Ue=function(e,t){return t.x!==e.x&&t.y!==e.y},Xe=function(e,t,n){var a=[e[n-1],e[n],e[n+1]],r=a[0],i=a[1],o=a[2];if(Ue(r,i)||Ue(i,o))t.push("L ".concat(i.x," ").concat(i.y));else{var c=[We(r,i),We(o,i)],l=c[0],s=c[1];t.push("L ".concat(l.x," ").concat(l.y)),t.push("Q ".concat(i.x," ").concat(i.y," ").concat(s.x," ").concat(s.y)),e[n]=s}},Ke=function(e){var t,n=e.from,a=e.mid,r=e.to;return{paths:n.inners.map((function(t,n){return function(e){if(0===e.length)return"";if(1===e.length)throw Error("points.length must be 0 or 2+");for(var t=Object(g.a)(e),n=["M ".concat(t[0].x," ").concat(t[0].y)],a=t.length-1,r=1;r<a;r++)Xe(t,n,r);return n.push("L ".concat(t[a].x," ").concat(t[a].y)),n.join(" ")}(function(e,t){var n=e.from,a=e.mid,r=e.to,i=[n.inners[t],r.inners[t]],o=i[0],c=i[1],l=[n.outer,r.outer],s=l[0],u=l[1];return o.x===s.x&&u.x===c.x?[o].concat(Object(g.a)(a),[c]):[o,s].concat(Object(g.a)(a),[u,c])}(e,n))})),length:(t=[n.inners[0]].concat(Object(g.a)(a),[r.inners[0]])).reduce((function(e,n,a){if(0===a)return 0;var r=n.x,i=n.y,o=t[a-1],c=o.x,l=o.y;return e+Math.sqrt(Math.pow(r-c,2)+Math.pow(i-l,2))}),0)}},qe=function(e){return function(t){return{x:"left"===e?t.left:t.right,y:t.top}}},Ge=function(e,t){return{x:e[0].x+16*("right"===t?1:-1),y:e.reduce((function(e,t){return e+t.y}),0)/e.length}},Ye=function(e){var t=e.edgesMids,n=e.edge,a=function(e){var t=[e.from[0],e.to[0]],n=t[0],a=t[1],r="right",i="right";n.right<=a.left-32?(r="right",i="left"):n.left>=a.right+32&&(r="left",i="right");var o=e.from.map(qe(r)),c=Ge(o,r),l=e.to.map(qe(i));return{from:{inners:o,side:r,outer:c},to:{inners:l,side:i,outer:Ge(l,i)}}}(e.boxes),r=a.from,i=a.to,o=function(e){var t=e.from,n=e.to;if(t.side!==n.side){var a=(t.outer.x+n.outer.x)/2;return[{x:a,y:t.outer.y},{x:a,y:n.outer.y}]}if(t.side===n.side){var r=Math.max(t.outer.x,n.outer.x);return[{x:r,y:t.outer.y},{x:r,y:n.outer.y}]}throw Error("never")}({from:r,to:i});return void 0!==t&&(o=function(e){var t,n=e.edgesMids,a=n.edgesMap,r=n.usedMids,i=e.midPoints[0].x,o=null===(t=a.get(e.edge.id))||void 0===t?void 0:t.mid;if(o===i)return e.midPoints;var c=r;if(void 0!==o&&c.delete(o),c.has(i)){var l=function(e,t){for(var n=t,a=1;e.has(n);)n=t+16*a/2,a=a>0?-a:1-a;return n}(c,i);return a.set(e.edge.id,{detail:e.edge,mid:l}),c.add(l),e.midPoints.map((function(e){return Object(I.a)(Object(I.a)({},e),{},{x:l})}))}return a.set(e.edge.id,{detail:e.edge,mid:i}),c.add(i),e.midPoints}({edgesMids:t,edge:n,midPoints:o})),{from:r,mid:o,to:i}},Ze=function(e){var t,n=function(e){return{from:Fe(e.edge.from,e.fromTable.position),to:Fe(e.edge.to,e.toTable.position)}}(e),a=null===(t=e.edgesMids)||void 0===t?void 0:t.current,r=e.edge,i=Ye({edgesMids:a,edge:r,boxes:n});return Ke(i)},Je=function(e){var t=e.edge,n=e.fromTable,a=e.toTable,r=e.edgesMids,c=function(e){var t=o.useState({}),n=Object(i.a)(t,2),a=n[0],r=n[1];return o.useLayoutEffect((function(){var t=z(e.from.table),n=z(e.to.table),a=function(){return r({})},i=new window.ResizeObserver(function(e){return function(){e()}}(a));i.observe(t),i.observe(n);var o=new MutationObserver(function(e){return function(t){t.forEach((function(t){"attributes"===t.type&&"data-is-visible"===t.attributeName&&e()}))}}(a));return o.observe(t,Qe),o.observe(n,Qe),function(){o.disconnect(),i.disconnect()}}),[e]),a}(t),l=o.useState(null),s=Object(i.a)(l,2),u=s[0],d=s[1],f=o.useRef(0);return o.useLayoutEffect((function(){return window.clearTimeout(f.current),f.current=window.setTimeout((function(){var e=Ze({edge:t,fromTable:n,toTable:a,edgesMids:r});d(e)}),0),function(){return window.clearTimeout(f.current)}}),[t,n,a,r,c]),u},$e=function(e){return"edge . ".concat(e)},et=function(e,t,n){return"edge . ".concat(e," . ").concat(t," . ").concat(null!==n&&void 0!==n?n:0)},tt=function(e,t,n){var a=et(e,t,n),r=document.getElementById(a);if(r instanceof SVGElement)return r;throw Error("Element is not SVGElement")},nt=function(e){return o.createElement("circle",{className:Re.a.dot,r:"4"},o.createElement("animateMotion",{dur:"".concat(e.path.length/150,"s"),repeatCount:"indefinite",id:et(e.edge.id,"highlight"),path:e.path.paths[0]}))},at=function(e){var t=[Re.a.container];return e.isSelected&&t.push(Re.a.selected),t.join(" ")},rt=c.a.memo((function(e){e.edge.from.rows,e.edge.to.rows;var t=e.edge,n=e.fromTable,a=e.toTable,r=e.edgesMids,i=Je({edge:t,fromTable:n,toTable:a,edgesMids:r});return null===i?null:c.a.createElement("g",{id:$e(e.edge.id),className:at(e)},i.paths.map((function(e,n){return c.a.createElement("path",{key:n,id:et(t.id,"path-main",n),className:Re.a.path,d:e})})),e.isSelected&&c.a.createElement(nt,{edge:e.edge,path:i}),c.a.createElement("path",{className:Re.a.hitarea,d:i.paths[0],onClick:Ne({refId:e.edge.id,setSelectIds:e.setSelectIds})}))})),it=n(197),ot=n.n(it),ct=n(120),lt=n.n(ct),st=function(){return o.createElement("marker",{id:"edge-from",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"10",markerHeight:"10",markerUnits:"userSpaceOnUse"},o.createElement("circle",{className:lt.a.container,cx:"5",cy:"5",r:"4"}))},ut=function(){return o.createElement("marker",{id:"edge-to",viewBox:"0 0 10 10",refX:"10",refY:"5",markerWidth:"10",markerHeight:"10",markerUnits:"userSpaceOnUse",orient:"auto-start-reverse"},o.createElement("polygon",{className:lt.a.container,points:"1,1 9,5 1,9"}))},dt=function(){return o.createElement("defs",null,o.createElement(st,null),o.createElement(ut,null))},ft=function(e){var t=function(t){var n=e.tablesMap.get(t.table);if(void 0!==n)return n;throw Error("Table is undefined")},n=function(e){var t=o.useRef({edgesMap:new Map,usedMids:new Set});return o.useEffect((function(){var n=new Set(e.edges.map((function(e){return e.id})));t.current.edgesMap.forEach((function(e,a){n.has(a)||(t.current.usedMids.delete(e.mid),t.current.edgesMap.delete(a))}))}),[e.edges]),t}({edges:e.diagram.refs});return o.createElement("svg",{className:ot.a.container,width:e.diagram.size.width,height:e.diagram.size.height},o.createElement(dt,null),e.diagram.refs.map((function(a){return o.createElement(rt,{key:a.id,edge:a,isSelected:e.selectedRefs.has(a.id),setSelectIds:e.setSelectIds,fromTable:t(a.from),toTable:t(a.to),edgesMids:n,diagramDispatch:e.diagramDispatch})})))},mt=n(198),pt=n.n(mt),vt=n(199),ht=n.n(vt),gt=function(e){return function(t,n){var a={left:e.table.position.left+n.x,top:e.table.position.top+n.y},r=Object(I.a)(Object(I.a)({},e.table),{},{position:a});e.relatedEdges.forEach(function(e){return function(t){var n=t.edge,a=t.table,r=n.to.table===e.id?[a,e]:[e,a],o=Object(i.a)(r,2),c=o[0],l=o[1];Ze({edge:n,fromTable:c,toTable:l}).paths.forEach((function(e,t){tt(n.id,"path-main",t).setAttribute("d",e)}));try{tt(n.id,"highlight").setAttribute("path","")}catch(s){}}}(r))}},bt=function(e){return 16*Math.round(e/16)},Et=function(e){return function(t,n){if(0!==n.x||0!==n.y){var a={left:bt(e.table.position.left+n.x),top:bt(e.table.position.top+n.y)};e.diagramDispatch({type:"set-table-position",payload:{id:e.table.id,position:a}})}}},wt=function(e,t){return e.filter((function(e){return e.type===t})).map((function(e){return e.value}))},yt=function(e){return{tables:new Set(wt(e,"table")),refs:new Set(wt(e,"ref"))}},xt=n(200),jt=n.n(xt),Dt=function(e){return function(){var t={tableId:e.tableId};e.diagramDispatch({type:"add-row",payload:t})}},_t=function(e){return c.a.createElement("div",{className:jt.a.container},c.a.createElement(r.c,{onClick:Dt(e),icon:s.a.add,size:r.c.size.small,style:r.c.style.flat,isFullWidth:!0},"Add"))},It=n(121),Ot=n.n(It),zt=function(e,t){return t?e.previousElementSibling:e.nextElementSibling},St=function(e,t){var n=e.closest(".table-row");if(null===n)throw Error(".table-row is null");for(var a=zt(n,t);null!==a;){if(a.classList.contains("table-row"))return a;a=zt(a,t)}return null},At=function(e,t){if("first"===t){var n=e.querySelector(".row-control");if(null!==n)return n}else{var a=e.querySelectorAll(".row-control"),r=a["last"===t?a.length-1:t];if(void 0!==r)return r}throw Error(".table-row doesn't have .row-control")},kt=function(e,t){switch(t){case"ArrowRight":case"ArrowLeft":var n="ArrowLeft"===t,a=zt(e,n);if(null!==a&&a.classList.contains("row-control"))return a;var r=St(e,n);return null===r?null:At(r,n?"last":"first");case"ArrowUp":case"ArrowDown":var i=St(e,"ArrowUp"===t);if(null===i)return null;var o=function(e){var t=e.closest(".table-row");if(null===t)throw Error(".table-row is null");var n=t.querySelectorAll(".row-control"),a=Object(g.a)(n).indexOf(e);if(-1!==a)return a;throw Error("curr is not a child of parent")}(e);return At(i,o)}return null},Tt=function(e){var t=e.target;if(t instanceof HTMLElement&&!(t instanceof HTMLInputElement)){var n=t.closest(".row-control");if(null!==n){e.preventDefault();var a=kt(n,e.key);null!==a&&function(e){var t=e.querySelector("select,input,button,[tabindex]");if(t instanceof HTMLElement)return t.focus();throw Error("No focusable element under row-control")}(a)}}},Mt=function(e){switch(e.key){case"ArrowUp":case"ArrowRight":case"ArrowDown":case"ArrowLeft":return Tt(e)}},Ct=n(86),Lt=n.n(Ct),Pt=[r.s.secondary,r.t.weak,Lt.a.container,r.w.muted].join(" "),Nt=function(e,t){var n=[Lt.a.field,1===t?Lt.a.rightField:""].join(" ");return c.a.createElement("div",{key:e.id,className:n,children:e.value.name})},Bt=function(e){return c.a.createElement("div",{className:Pt},c.a.createElement(r.i,{size:8}),c.a.createElement("div",{className:r.c.size.small.main},c.a.createElement(r.j,{path:s.a.blank,size:r.c.size.small.iconSize})),e.columns.slice(0,e.isExpand?void 0:2).map(Nt),c.a.createElement(r.c,{onClick:function(){return e.setIsExpand((function(e){return!e}))},style:r.c.style.flat,size:r.c.size.small,icon:(t=e.isExpand,t?s.a.doubleChevronLeft:s.a.doubleChevronRight)}),c.a.createElement(r.i,{size:8}));var t},Rt=n(448),Ht=n(449),Ft=n(193),Qt=n(87),Vt=n.n(Qt),Wt=function(e){var t=c.a.useRef(null),n=e.rowId,a=e.tableId,o=Object(Ht.a)({item:{type:"row",rowId:n,tableId:a,elementRef:t},begin:function(){return function(e){if(null!==e.edge){var t={id:e.edge.id};e.diagramDispatch({type:"remove-ref",payload:t})}}(e)},end:function(t,n){return function(e,t){var n=t.getDropResult();if(null!==n){var a={from:{table:e.tableId,rows:[e.rowId]},to:{table:n.tableId,rows:[n.rowId]}};e.diagramDispatch({type:"add-ref",payload:a})}}(e,n)},collect:function(t){return function(e,t){if(!1===t.isDragging())return!1;if("row"!==t.getItemType())return!1;var n=t.getItem(),a=n.tableId,r=n.rowId;return e.tableId===a&&e.rowId===r}(e,t)}}),l=Object(i.a)(o,3),u=l[0],d=l[1],f=l[2];c.a.useEffect((function(){f(Object(Ft.a)())}),[f]),c.a.useEffect((function(){d(t)}),[d]);var m=c.a.useState(!1),p=Object(i.a)(m,2),v=p[0],h=p[1],g=u||v||null!==e.edge,b=c.a.createElement(r.j,{path:g?s.a.selection:s.a.circle,size:r.c.size.small.iconSize});return c.a.createElement("div",{ref:t,className:Vt.a.container,onMouseEnter:function(){return h(!0)},onMouseLeave:function(){return h(!1)}},c.a.createElement("div",{className:[Vt.a.button,u?Vt.a.dragging:"",r.c.style.flat.main,r.c.size.small.main,"react-draggable-cancel"].join(" "),children:b}))},Ut=n(201),Xt=n.n(Ut),Kt=["T","t","1","Y","y"],qt=function(e){return o.createElement("div",{className:[Xt.a.container].join(" ")},o.createElement(r.o,{value:(t=e.value,!!Kt.includes(t.charAt(0))),setValue:function(t){e.setValue(t?"TRUE":"FALSE")},options:[{value:!0,label:"TRUE"},{value:!1,label:"FALSE"}],style:r.o.style.flat,size:r.o.size.small}));var t},Gt=n(202),Yt=n.n(Gt),Zt={current:!1,timeout:0},Jt=n(52),$t=n.n(Jt),en=function(e){return o.createElement("div",{className:$t.a.edit},o.createElement(r.k,{key:e.value,defaultValue:e.value,style:r.k.style.flat,size:r.k.size.small,autoFocus:!0,onBlur:function(t){e.setValue(t.currentTarget.value),e.setIsEdit(!1)},onKeyDown:function(e){"Tab"===e.key&&(window.clearTimeout(Zt.timeout),Zt.current=!0,Zt.timeout=window.setTimeout((function(){Zt.current=!1}),500))},onKeyUp:function(t){"Enter"===t.key&&(e.setValue(t.currentTarget.value),e.setIsEdit(!1),function(e){window.setTimeout((function(){var t=e.viewRef.current;if(null===t)throw Error("View is null");t.focus()}),0)}(e))}}))},tn=[$t.a.view,r.u.always,r.k.size.small.main,"react-draggable-cancel","row-input-string-view"].join(" "),nn=function(e){var t=e.value;return 0!==t.length?o.createElement("span",null,t):o.createElement("span",{className:$t.a.empty},"<empty>")},an=function(e){return o.createElement("div",{tabIndex:0,children:o.createElement(nn,{value:e.value}),className:tn,onDoubleClick:function(){e.setIsEdit(!0)},onFocus:function(){Zt.current&&e.setIsEdit(!0)},onKeyUp:function(t){"Enter"===t.key&&e.setIsEdit(!0)},ref:e.viewRef})},rn=function(e){var t=o.useState(!1),n=Object(i.a)(t,2),a=n[0],r=n[1],c=o.useRef(null),l=Object(I.a)(Object(I.a)({},e),{},{isEdit:a,setIsEdit:r,viewRef:c});return o.createElement("div",{className:[$t.a.container].join(" ")},a?o.createElement(en,l):o.createElement(an,l))},on=function(e){return function(t){var n=e.tableId,a=e.row,r=[e.column.value.name,a.id],i=r[0],o=r[1];if(t!==a.value[i]){var c={tableId:n,rowId:o,property:i,value:t};e.diagramDispatch({type:"update-row",payload:c})}}},cn=function(e){var t;return c.a.createElement("div",{className:e.isRight?"".concat(Yt.a.right," ").concat(r.w.muted):""},function(e){var t=e.column.value.type;switch(t){case"boolean":return qt;case"string":return rn;default:throw Error('Unknown column type "'.concat(t,'"'))}}(e)({value:null!==(t=e.row.value[e.column.value.name])&&void 0!==t?t:"",setValue:on(e)}))},ln=function(e){var t={tableId:e.tableId,rowId:e.rowId};e.diagramDispatch({type:"remove-row",payload:t})},sn=n(203),un=n.n(sn),dn=function(e){return function(){var t={tableId:e.tableId,rowId:e.row.id};e.diagramDispatch({type:"remove-row",payload:t})}},fn=function(e){return c.a.createElement("div",{className:[un.a.container].join(" ")},c.a.createElement(r.c,{onClick:dn(e),style:r.c.style.flat,size:r.c.size.small,icon:s.a.remove}))},mn=n(122),pn=n.n(mn),vn=c.a.memo((function(e){e.tableId,e.row.id,e.row.value.id;var t,n=(t={tableId:e.tableId,rowId:e.row.id},Object(Rt.a)({accept:"row",drop:function(){return{tableId:t.tableId,rowId:t.rowId}},collect:function(e){return e.isOver()}})),a=Object(i.a)(n,2),o=a[0],l=a[1];return c.a.createElement("div",Object.assign({},function(e){var t=c.a.useRef(!1);return{onKeyDown:function(e){["Delete","Backspace"].includes(e.key)&&e.target instanceof HTMLInputElement&&(t.current=""===e.target.value)},onKeyUp:function(n){["Delete","Backspace"].includes(n.key)&&(n.target instanceof HTMLInputElement?t.current&&ln(e):ln(e))}}}({diagramDispatch:e.diagramDispatch,tableId:e.tableId,rowId:e.row.id}),{className:"".concat(pn.a.container," ").concat(o?pn.a.over:""),ref:l}),c.a.createElement(r.i,{size:8}),e.isTableEdit&&c.a.createElement("div",{className:"row-control"},c.a.createElement(fn,{tableId:e.tableId,row:e.row,diagramDispatch:e.diagramDispatch})),e.columns.slice(0,e.isTableColumnsExpand?void 0:2).map((function(t,n){return c.a.createElement("div",{className:"row-control",key:t.id},c.a.createElement(cn,{tableId:e.tableId,row:e.row,column:t,diagramDispatch:e.diagramDispatch,isRight:1===n}))})),e.isTableEdit&&c.a.createElement(Wt,{tableId:e.tableId,rowId:e.row.id,diagramDispatch:e.diagramDispatch,edge:e.edge}),c.a.createElement(r.i,{size:8}))})),hn=function(e){return Array.isArray(e.item)?e.table.isRowsExpand?o.createElement(o.Fragment,null,e.item.map(e.getRow.bind(null,e.edgeMap))):e.getHiddenRows(e.item):e.getRow(e.edgeMap,e.item)},gn=function(e){var t=e.table.value.rows,n=function(e,t){var n=new Map;return t.forEach((function(t){t.edge.from.table===e&&t.edge.from.rows.forEach((function(e){n.set(e,t.edge)}))})),n}(e.table.id,e.relatedEdges),a=function(e,t){var n=50-t.size,a=[],r=[];return e.forEach((function(e){n>0||t.has(e.id)?(0!==r.length&&a.push(r),r=[],a.push(e),n-=1):r.push(e)})),0!==r.length&&a.push(r),a}(t,n);return o.createElement(o.Fragment,null,a.map((function(t){var a=Array.isArray(t)?t[0].id:t.id;return o.createElement(hn,Object.assign({},e,{key:a,edgeMap:n,item:t}))})),e.table.isRowsExpand&&a.length!==t.length&&e.getHideRowsButton())},bn=function(e){return o.createElement(r.a,{color:"secondary"},o.createElement(r.b,{color:"weak"}),o.createElement("div",{style:{marginTop:-1}}),o.createElement(r.c,{style:r.c.style.flat,size:r.c.size.small,isFullWidth:!0,onClick:function(){e.diagramDispatch({type:"set-table-rows-expand",payload:{id:e.tableId,isExpand:!0}})},children:"".concat(e.count," columns hidden")}),o.createElement("div",{style:{marginTop:-1}}),o.createElement(r.b,{color:"weak"}))},En=function(e){return o.createElement(r.c,{style:r.c.style.flat,size:r.c.size.small,isFullWidth:!0,onClick:function(){e.diagramDispatch({type:"set-table-rows-expand",payload:{id:e.tableId,isExpand:!1}})},children:"Hide columns"})},wn=function(e){var t;return o.createElement("div",{className:"table-row",id:He(e.table.id,e.row.id)},o.createElement(vn,{row:e.row,edge:null!==(t=e.edgeMap.get(e.row.id))&&void 0!==t?t:null,tableId:e.table.id,isTableEdit:e.isEdit,isTableColumnsExpand:e.isColumnsExpand,columns:e.columns,diagramDispatch:e.diagramDispatch}))},yn=function(e){return o.createElement(gn,{table:e.table,relatedEdges:e.relatedEdges,getHideRowsButton:function(){return o.createElement(En,{tableId:e.table.id,diagramDispatch:e.diagramDispatch})},getHiddenRows:function(t){return o.createElement(bn,{count:t.length,tableId:e.table.id,diagramDispatch:e.diagramDispatch})},getRow:function(t,n){return o.createElement(wn,Object.assign({},e,{row:n,edgeMap:t}))}})},xn=function(e){return function(t){var n=t.relatedTarget;t.currentTarget.contains(n)||t.target instanceof HTMLButtonElement||e.setIsEdit(!0)}},jn=function(e){var t=c.a.useState(!1),n=Object(i.a)(t,2),a=n[0],o=n[1];return c.a.useEffect((function(){e.isEdit||o(!1)}),[e.isEdit]),c.a.createElement("div",{className:Ot.a.container,onFocus:xn(e)},c.a.createElement(r.i,{size:8}),e.isEdit&&c.a.createElement("div",{className:Ot.a.header},c.a.createElement(Bt,{columns:e.columns,isExpand:a,setIsExpand:o})),c.a.createElement("div",{onKeyDown:Mt},c.a.createElement(yn,{table:e.table,isEdit:e.isEdit,isColumnsExpand:a,columns:e.columns,relatedEdges:e.relatedEdges,diagramDispatch:e.diagramDispatch})),(e.isEdit||0===e.table.value.rows.length)&&c.a.createElement(_t,{tableId:e.table.id,diagramDispatch:e.diagramDispatch}),c.a.createElement(r.i,{size:8}))},Dn=n(53),_n=n.n(Dn),In=n(123),On=n.n(In),zn=function(e){var t=c.a.useRef({x:0,y:0}),n=c.a.useState(!1),a=Object(i.a)(n,2),o=a[0],l=a[1];return c.a.createElement("div",{className:On.a.container,style:{width:208}},o?c.a.createElement(r.k,{key:e.table.value.name,defaultValue:e.table.value.name,onBlur:function(t){!function(e,t){var n=t.currentTarget.value;if(n!==e.table.value.name){var a={id:e.table.id,name:n};e.diagramDispatch({type:"update-table-name",payload:a})}}(e,t),l(!1)},onFocus:function(){e.setIsEdit(!1)},style:r.k.style.flat,size:r.k.size.small,autoFocus:!0}):c.a.createElement("div",{className:[On.a.view,r.k.size.small.main].join(" "),onMouseDown:function(e){t.current.x=e.clientX,t.current.y=e.clientY},onClick:function(e){var n=t.current,a=n.x,r=n.y,i=e.clientX,o=e.clientY;a===i&&r===o&&l(!0)}},e.table.value.name))},Sn=n(204),An=n.n(Sn),kn=function(e){return c.a.createElement("div",{className:[An.a.container,r.s.primary].join(" ")},c.a.createElement(r.c,{style:r.c.style.flat,onClick:function(){var t={id:e.tableId};e.diagramDispatch({type:"remove-table",payload:t})},icon:s.a.cross,size:r.c.size.small}))},Tn=function(e){return c.a.createElement("div",{className:"".concat(_n.a.container," ").concat(e.isEdit?_n.a.edit:"")},c.a.createElement("div",{className:_n.a.main},c.a.createElement(zn,{table:e.table,setIsEdit:e.setIsEdit,diagramDispatch:e.diagramDispatch}),c.a.createElement("div",{className:_n.a.remove},c.a.createElement(kn,{tableId:e.table.id,diagramDispatch:e.diagramDispatch}))))},Mn=function(e,t){if(!e)return function(e){var n=e.relatedTarget;e.currentTarget.contains(n)||t(!1)}},Cn=n(88),Ln=n.n(Cn),Pn=function(e,t){var n=[Ln.a.container,r.s.primary,r.t.strong];return e.isSelected&&n.push(Ln.a.selected),t&&n.push(Ln.a.edit),n.join(" ")},Nn=function(e){return{type:"ref",value:e.edge.id}},Bn=function(e){return function(){e.setSelectIds((function(t){var n=e.relatedEdges.map(Nn);return n.push({type:"table",value:e.table.id}),function(e,t){if(e.length!==t.length)return!1;var n=yt(e),a=n.tables,r=n.refs;return t.every((function(e){return!("table"!==e.type||!a.has(e.value))||!("ref"!==e.type||!r.has(e.value))}))}(t,n)?t:n}))}},Rn=c.a.memo((function(e){e.table.id,e.table.value.id;var t=c.a.useState(!1),n=Object(i.a)(t,2),a=n[0],o=n[1],s=Object(l.a)(function(e){return function(t){var n=t.getItem();return null!==n&&("row"===n.type&&n.tableId===e.table.id)}}(e));return c.a.createElement("div",{className:Pn(e,a),onBlur:Mn(s,o),tabIndex:0,onFocus:Bn(e)},c.a.createElement(Tn,{table:e.table,isEdit:a,setIsEdit:o,diagramDispatch:e.diagramDispatch}),c.a.createElement(r.b,{color:"weak"}),c.a.createElement("div",{style:{marginTop:-1}}),c.a.createElement(jn,{table:e.table,isEdit:a,setIsEdit:o,relatedEdges:e.relatedEdges,diagramDispatch:e.diagramDispatch,columns:e.columns}))})),Hn=function(e){var t=c.a.useRef(null);return c.a.createElement(pt.a,{position:{x:0,y:0},onDrag:gt(e),onStop:Et(e),nodeRef:t,scale:e.zoom,cancel:"input, button, select, .react-draggable-cancel"},c.a.createElement("div",{ref:t,className:ht.a.container},c.a.createElement(Rn,{table:e.table,isSelected:e.isSelected,setSelectIds:e.setSelectId,columns:e.columns,relatedEdges:e.relatedEdges,diagramDispatch:e.diagramDispatch})))},Fn=n(205),Qn=[n.n(Fn).a.container,r.s.primary,r.t.strong].join(" "),Vn=function(e){return o.createElement("div",{className:Qn,style:S(e.table)})},Wn=function(e){var t;return o.createElement("div",{style:{flex:"1 1 0px",overflow:"hidden",textAlign:1===e.index?"right":void 0}},null!==(t=e.row.value[e.columns[e.index].value.name])&&void 0!==t?t:"<empty>")},Un={display:"flex",padding:"0 16px"},Xn=function(e){return o.createElement("div",{style:Un,id:He(e.table.id,e.row.id)},o.createElement(Wn,Object.assign({},e,{index:0})),o.createElement(Wn,Object.assign({},e,{index:1})))},Kn={className:[r.s.primary,r.t.strong].join(" "),style:{lineHeight:"24px",borderStyle:"solid",borderWidth:1,width:224}},qn={padding:8,fontWeight:600,textAlign:"center"},Gn=function(e){return o.createElement("div",{style:{textAlign:"center"}},e.count," columns hidden")},Yn=function(e){return o.createElement("div",Kn,o.createElement("div",{style:qn},e.table.value.name),o.createElement(r.b,{color:"weak"}),o.createElement("div",{style:{padding:"8px 0"}},o.createElement(gn,{table:e.table,relatedEdges:e.relatedEdges,getRow:function(t,n){return o.createElement(Xn,Object.assign({},e,{row:n}))},getHiddenRows:function(e){return o.createElement(Gn,{count:e.length})},getHideRowsButton:function(){return null}})))},Zn=c.a.memo((function(e){var t=c.a.useRef(null),n=c.a.useState(!1),a=Object(i.a)(n,2),r=a[0],o=a[1];return c.a.useEffect((function(){var n,a=(n=o,function(e){e.forEach((function(e){n(e.isIntersecting)}))}),r=new IntersectionObserver(a,{threshold:0,root:e.viewportRef.current});if(null===t.current)throw Error("ref is null");return r.observe(t.current),function(){return r.disconnect()}}),[e.viewportRef]),c.a.createElement("div",{id:O(e.table.id),style:{position:"absolute",top:e.table.position.top,left:e.table.position.left,zIndex:e.isSelected?1:0},ref:t,"data-name":e.table.value.name,"data-is-visible":r},function(e,t){return e.isCapture?c.a.createElement(Yn,{table:e.table,columns:e.columns,relatedEdges:e.relatedEdges}):t?c.a.createElement(Hn,{table:e.table,columns:e.columns,diagramDispatch:e.diagramDispatch,relatedEdges:e.relatedEdges,isSelected:e.isSelected,setSelectId:e.setSelectId,zoom:e.zoom}):c.a.createElement(Vn,{table:e.table})}(e,r))})),Jn=function(e,t){var n=e.current;if(null===n)throw Error("start is null");var a={left:t.nativeEvent.offsetX,top:t.nativeEvent.offsetY},r=Math.min(n.top,a.top),i=Math.max(n.left,a.left),o=Math.max(n.top,a.top),c=Math.min(n.left,a.left);return{top:r,left:c,width:i-c,height:o-r}},$n=function(e,t){e.style.opacity=t},ea={top:0,left:0,width:0,height:0},ta=function(e,t){e.style.width="".concat(t.width,"px"),e.style.height="".concat(t.height,"px"),e.style.transform="translate(".concat(t.left,"px, ").concat(t.top,"px)")},na=function(e,t){var n=e.current;if(null===n)throw Error("boxRef is null");"start"===t?(ta(n,ea),$n(n,"1")):"stop"===t?$n(n,"0"):ta(n,t)},aa=n(89),ra=n.n(aa),ia=function(e){if("true"!==e.element.dataset.isVisible)return!1;var t,n,a=e.element,r=a.clientWidth,i=a.clientHeight,o=e.position,c={width:r,height:i,top:o.top,left:o.left};return t=e.target,n=c,!(t.left>n.left+n.width)&&!(n.left>t.left+t.width)&&!(t.top>n.top+n.height)&&!(n.top>t.top+t.height)},oa=function(e,t){return e.map((function(e){return{type:t,value:e}}))},ca=function(e,t){var n=function(e,t){return e.diagram.tables.filter((function(e){return ia({target:t,position:e.position,element:z(e.id)})})).map((function(e){return e.id}))}(e,t),a=function(e,t){var n=new Set(t);return e.diagram.refs.filter((function(e){return n.has(e.from.table)||n.has(e.to.table)})).map((function(e){return e.id}))}(e,n);return[].concat(Object(g.a)(oa(n,"table")),Object(g.a)(oa(a,"ref")))},la=function(e,t){t?e.classList.add("temp-selected"):e.classList.remove("temp-selected")},sa=function(e,t){var n=new Set;t.tables.forEach((function(t){var a=z(t.id),r=t.position,i=ia({target:e,element:a,position:r});i&&n.add(t.id),la(a,i)})),t.refs.forEach((function(e){var t=n.has(e.from.table)||n.has(e.to.table),a=function(e){var t=document.getElementById($e(e));if(t instanceof SVGGElement)return t;throw Error("Element is not SVGGElement")}(e.id);la(a,t)}))},ua=function(e,t){var n=e.current;if(null===n)throw Error("containerRef is null");n.style.zIndex=t?"2":"0"},da=[],fa=c.a.memo((function(e){var t=c.a.useRef(null),n=c.a.useRef(!1),a=c.a.useRef(null),r=c.a.useRef(null),i=c.a.useRef(!1);return c.a.createElement("div",{className:ra.a.container,tabIndex:0,onKeyDown:function(e){" "===e.key&&(i.current=!0)},onKeyUp:function(e){" "===e.key&&(i.current=!1)},onMouseDown:function(o){if(!0!==i.current){var c=o.nativeEvent,l=c.offsetX,s=c.offsetY;t.current={left:l,top:s},n.current=!0,ua(r,!0),na(a,"start"),e.setSelectIds(da)}},onMouseMove:function(r){if(!1!==n.current){var i=Jn(t,r);na(a,i),sa(i,e.diagram)}},onMouseUp:function(i){if(!1!==n.current){n.current=!1,document.querySelectorAll(".".concat("temp-selected")).forEach((function(e){e.classList.remove("temp-selected")})),ua(r,!1),na(a,"stop");var o=Jn(t,i),c=ca({diagram:e.diagram},o);e.setSelectIds(c),t.current=null}},ref:r},c.a.createElement("div",{ref:a,className:ra.a.box},c.a.createElement("div",{className:ra.a.boxBg})))})),ma=n(124),pa=n.n(ma),va=function(e,t){var n=[e,e.diagram.size],a=n[0].zoom,r=n[1],i=r.width,o=r.height,c=(a-1)/2,l="".concat(o*c,"px ").concat(i*c,"px");return{width:i,height:o,transform:1!==a?"scale(".concat(a,")"):"",margin:l,fontSize:"mac"===t?12:void 0}},ha=function(e,t){return e.set(t.id,t),e},ga=[],ba=function(e){var t=e.diagram,n=t.refs,a=t.tables,i=c.a.useMemo((function(){return a.reduce(ha,new Map)}),[a]),o=c.a.useMemo((function(){return n.reduce(function(e){return function(t,n){var a,r,i=e.get(n.to.table),o=e.get(n.from.table),c=n.from.table,l=null!==(a=t.get(c))&&void 0!==a?a:[];t.set(c,l.concat({edge:n,table:i}));var s=n.to.table,u=null!==(r=t.get(s))&&void 0!==r?r:[];return t.set(s,u.concat({edge:n,table:o})),t}}(i),new Map)}),[n,i]),l=Ie();return c.a.createElement("div",{id:"canvas",className:[pa.a.container,r.s.secondary].join(" "),style:va(e,l)},c.a.createElement("div",{className:pa.a.grid}),c.a.createElement(fa,{diagram:e.diagram,setSelectIds:e.setSelectIds}),c.a.createElement(ft,{diagram:e.diagram,diagramDispatch:e.diagramDispatch,setSelectIds:e.setSelectIds,selectedRefs:e.selectedRefs,tablesMap:i}),e.diagram.tables.map((function(t){var n;return c.a.createElement(Zn,{key:t.id,table:t,isSelected:e.selectedTables.has(t.id),setSelectId:e.setSelectIds,columns:e.diagram.columns,relatedEdges:null!==(n=o.get(t.id))&&void 0!==n?n:ga,diagramDispatch:e.diagramDispatch,viewportRef:e.viewportRef,zoom:e.zoom,isCapture:e.isCapture})})))},Ea=n(125),wa=n.n(Ea),ya=(n(438),function(e){return function(t){t.target instanceof HTMLInputElement||" "===t.key&&(t.preventDefault(),e.drag||(e.setDrag(!0),e.element.classList.add("dragscroll"),wa.a.reset(),e.element.addEventListener("keyup",function(e){return function t(){e.setDrag(!1),e.element.classList.remove("dragscroll"),wa.a.reset(),e.element.removeEventListener("keyup",t)}}(e))))}}),xa={behavior:"smooth",block:"center",inline:"center"},ja=function(e){return c.a.createElement(r.c,{onClick:function(){var t=ie(e.tables.map((function(e){return e.id})));e.diagramDispatch({type:"add-table",payload:{id:t}}),window.setTimeout((function(){e.setSelectIds([{type:"table",value:t}]),z(t).scrollIntoView(xa)}),0)},size:e.size.button,icon:s.a.plus,children:"Table"})},Da=n(9),_a=n.n(Da),Ia=n(19),Oa=n(126),za=n.n(Oa),Sa=CSSStyleDeclaration.prototype;Object.defineProperty(Sa,"cssText",{value:""}),Object.defineProperty(Sa,"getPropertyValueOriginal",{value:Sa.getPropertyValue}),Object.defineProperty(Sa,"getPropertyValue",{value:function(e){var t=this.getPropertyValueOriginal(e);return"marker-start"===e&&t.endsWith('edge-from")')?"url(#edge-from)":"marker-end"===e&&t.endsWith('edge-to")')?"url(#edge-to)":t}});var Aa={svg:"data:image/svg+xml;charset=utf-8,",png:"data:image/png;base64,"},ka=function(){var e=Object(Ia.a)(_a.a.mark((function e(t){return _a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.format,e.next="png"===e.t0?3:"svg"===e.t0?6:9;break;case 3:return e.next=5,za.a.toPng(t.canvas);case 5:return e.abrupt("return",e.sent);case 6:return e.next=8,za.a.toSvg(t.canvas);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ta=function(){var e=Object(Ia.a)(_a.a.mark((function e(t){return _a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return window.setTimeout((function(){return e()}),t)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ma=function(){var e=Object(Ia.a)(_a.a.mark((function e(t){var n,a,r;return _a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setIsCapture(!0),Ta(100),e.next=4,ka(t);case 4:return n=e.sent,t.setIsCapture(!1),a=Aa[t.format],r=n.replace(a,""),e.abrupt("return",{prefix:a,body:r});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ca=n(206),La=["&%23xA;","&%239;"],Pa=function(e){if(e.prefix.includes("base64"))return e.body;if(e.prefix.includes("utf-8")){var t=e.body;return La.forEach((function(e){t=t.split(e).join("")})),Object(Ca.a)(t)}throw Error("Unknown file prefix: ".concat(e.prefix))},Na=function(e){switch(e.platform){case"web":return function(e){var t=document.createElement("a");t.download="diagram.".concat(e.format),t.href="".concat(e.file.prefix).concat(e.file.body),t.click()}(e);case"mac":case"win":return function(e,t){var n={data:Pa(e.file),ext:e.format,name:"diagram",title:"Save diagram as\u2026"};switch(t){case"mac":return void window.webkit.messageHandlers.saveFile.postMessage(n);case"win":var a={message:"saveFile",args:n};return void window.chrome.webview.postMessage(a)}}(e,e.platform)}},Ba=function(){var e=Object(Ia.a)(_a.a.mark((function e(t){var n,a,r,i,o;return _a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.setIsCapture,a=t.format,r=t.platform,null!==(i=document.getElementById("canvas"))){e.next=4;break}throw Error("Canvas is null");case 4:return e.next=6,Ma({canvas:i,format:a,setIsCapture:n});case 6:o=e.sent,Na({file:o,format:a,platform:r});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ra=["MySQL","MariaDB","SQLite","PostgreSQL","Cassandra","Snowflake","MicrosoftSQLServer"],Ha=function(e){var t=e.diagram,n=e.setIsCapture,a=Ie(),i=[{label:"Save as Image (PNG)",fn:function(){return Ba({setIsCapture:n,platform:a,format:"png"})}},{label:"Save as Web page (SVG)",fn:function(){return Ba({setIsCapture:n,platform:a,format:"svg"})}},{label:"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500",fn:function(){},disabled:!0}].concat(Object(g.a)(Ra.map((function(e){return{label:"Export to ".concat(e),fn:function(){return function(e){var t={data:h(e.diagram),driver:e.driver};switch(e.platform){case"web":return window.alert("Export to SQL requires TablePlus app");case"mac":return void window.webkit.messageHandlers.exportSQL.postMessage(t);case"win":var n={message:"exportSQL",args:t};return void window.chrome.webview.postMessage(n)}}({diagram:t,driver:e,platform:a})}}}))));return c.a.createElement(r.e,{icon:s.a.share,actions:i,size:e.size.button})},Fa=function(e){return c.a.createElement(r.d,null,[c.a.createElement(r.c,{key:"undo",onClick:function(){return e.dispatch({type:"undo"})},icon:s.a.undo,size:e.size.button,disabled:0===e.past.length}),c.a.createElement(r.c,{key:"redo",onClick:function(){return e.dispatch({type:"redo"})},icon:s.a.redo,size:e.size.button,disabled:0===e.future.length})])},Qa="https://diagramplus.com/samples",Va=function(){var e=Object(Ia.a)(_a.a.mark((function e(t,n){var a,r;return _a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n).then((function(e){return e.json()}));case 2:a=e.sent,r={raw:a,isAppend:!1},t.diagramDispatch({type:"import-raw",payload:r});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Wa=function(e){return o.createElement(r.e,{icon:s.a.import,children:"Import",actions:[{label:"Import from Database (require TablePlus app)",disabled:!0,fn:function(){}},{label:"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500",fn:function(){},disabled:!0},{label:"Load sample 1 (3 small tables)",fn:function(){return Va(e,"".concat(Qa,"/1.json"))}},{label:"Load sample 2 (Table with many columns)",fn:function(){return Va(e,"".concat(Qa,"/2.json"))}},{label:"Load sample 3 (28 tables)",fn:function(){return Va(e,"".concat(Qa,"/3.json"))}},{label:"Load sample 4 (1710 tables)",fn:function(){return Va(e,"".concat(Qa,"/4.json"))}}],size:e.size.button})},Ua={type:"set-layout",payload:{type:"auto"}},Xa=function(e,t){e.diagramDispatch({type:"set-all-tables-rows-expand",payload:t}),window.setTimeout((function(){return e.diagramDispatch(Ua)}),0)},Ka=function(e){return[{label:"Expand all columns and Arrange",fn:function(){return Xa(e,!0)}},{label:"Collapse columns and Arrange",fn:function(){return Xa(e,!1)}}]},qa=function(e){return c.a.createElement(r.d,null,[c.a.createElement(r.c,{key:"arrange",icon:s.a.layoutAuto,onClick:function(){e.diagramDispatch(Ua)},children:"Arrange",size:e.size.button}),c.a.createElement(r.e,{key:"more",actions:Ka(e),icon:s.a.caret,size:e.size.button})])},Ga=function(e,t){var n,a=t.filter((n=e,function(e){return[e.from.table,e.to.table].includes(n)})).map((function(e){return{type:"ref",value:e.id}}));return a.push({type:"table",value:e}),a},Ya={behavior:"smooth",block:"center",inline:"center"},Za=function(e){var t=e.diagram,n=e.setSelectIds,a=c.a.useMemo((function(){var e=new Set;return t.tables.forEach((function(t){e.add(t.value.name)})),Object(g.a)(e)}),[t.tables]),o=c.a.useState(""),l=Object(i.a)(o,2),u=l[0],d=l[1],f=function(e){!1!==a.includes(e)&&function(e,t,n){var a=e.tables.find((function(e){return e.value.name===n}));if(void 0===a)throw Error("table is undefined");t(Ga(a.id,e.refs)),z(a.id).scrollIntoView(Ya)}(t,n,e)};return c.a.createElement("div",{style:{flex:"1 1 0px"}},c.a.createElement(r.k,{icon:s.a.search,placeholder:"Find table\u2026",value:u,setValue:function(e){d(e),f(e)},list:{id:"header-search",values:a},onKeyUp:function(e){"Enter"===e.key&&f(u)},size:e.size.input}))},Ja=n(90),$a=n.n(Ja),er=n(207),tr=n.n(er),nr=n(208),ar=n.n(nr),rr=[{value:"theme-light",icon:s.a.flash,key:"light"},{value:"theme-auto",label:"System",key:"auto"},{value:"theme-dark",icon:s.a.moon,key:"dark"}],ir=function(e){return c.a.createElement(r.q,{value:e.theme,setValue:e.setTheme,options:rr,size:e.size.button})},or=function(){switch(Ie()){case"mac":return o.createElement(o.Fragment,null,o.createElement(r.i,{size:16}),o.createElement(r.i,{size:16}));default:return o.createElement(o.Fragment,null,o.createElement(r.i,{size:16}),o.createElement(r.b,{color:"weak"}),o.createElement(r.i,{size:16}))}},cr=function(e){return c.a.createElement(r.d,null,[c.a.createElement(r.c,{key:"out",icon:s.a.zoomOut,onClick:function(){return e.setZoom(e.zoom-.25)},size:e.size.button}),c.a.createElement(r.o,{key:"select",value:e.zoom,setValue:e.setZoom,options:[25,50,75,100,125,150,175,200].map((function(e){return{label:"".concat(e,"%"),value:e/100}})),size:e.size.select}),c.a.createElement(r.c,{key:"in",icon:s.a.zoomIn,onClick:function(){return e.setZoom(e.zoom+.25)},size:e.size.button})])},lr=function(e){var t=[$a.a.container];return"mac"===e&&t.push(tr.a.container),"win"===e&&t.push(ar.a.container),t.join(" ")},sr=c.a.memo((function(e){var t=Ie(),n=function(e){switch(e){case"mac":return{button:r.c.size.small,input:r.k.size.small,select:r.o.size.small};default:return{button:r.c.size.medium,input:r.k.size.medium,select:r.o.size.medium}}}(t);return c.a.createElement("div",{className:[$a.a.container,lr(t)].join(" ")},c.a.createElement("div",{className:$a.a.platformPad}),c.a.createElement(r.i,{size:16}),"win"===t&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Ha,{diagram:e.diagram,setIsCapture:e.setIsCapture,size:n}),c.a.createElement(or,null)),"web"===t&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Wa,{diagramDispatch:e.diagramDispatch,size:n}),c.a.createElement(or,null)),c.a.createElement(ja,{tables:e.diagram.tables,diagramDispatch:e.diagramDispatch,setSelectIds:e.setSelectIds,size:n}),c.a.createElement(r.i,{size:16}),c.a.createElement(Fa,{past:e.diagramPast,future:e.diagramFuture,dispatch:e.diagramDispatch,size:n}),c.a.createElement(or,null),c.a.createElement(Za,{diagram:e.diagram,setSelectIds:e.setSelectIds,size:n}),c.a.createElement(or,null),c.a.createElement(qa,{diagramDispatch:e.diagramDispatch,size:n}),c.a.createElement(r.i,{size:16}),c.a.createElement(cr,{viewportRef:e.viewportRef,zoom:e.zoom,setZoom:e.setZoom,size:n}),"win"!==t&&c.a.createElement(c.a.Fragment,null,c.a.createElement(r.i,{size:16}),c.a.createElement(Ha,{diagram:e.diagram,setIsCapture:e.setIsCapture,size:n})),"web"===t&&c.a.createElement(c.a.Fragment,null,c.a.createElement(or,null),c.a.createElement(ir,{theme:e.theme,setTheme:e.setTheme,size:n})),c.a.createElement(r.i,{size:16}))})),ur=n(127),dr=n.n(ur),fr=y("setProgressIndicator"),mr=function(){var e=c.a.useState(!1),t=Object(i.a)(e,2),n=t[0],a=t[1],o=c.a.useState(void 0),l=Object(i.a)(o,2),s=l[0],u=l[1];return c.a.useEffect((function(){fr((function(e,t){a(e),u(t)}))}),[]),!1===n?null:c.a.createElement("div",{className:[dr.a.container,r.s.secondary].join(" ")},c.a.createElement("div",{className:dr.a.body},c.a.createElement(r.n,{size:24,value:!0===n?null:n}),void 0!==s&&c.a.createElement(c.a.Fragment,null,c.a.createElement(r.i,{size:16}),c.a.createElement("div",null,s))))},pr=function(e){var t=e.ids,n=e.diagram;o.useEffect((function(){var e=function(e){return function(e,t){var n;if(!(t.target instanceof HTMLInputElement)&&!(t.target instanceof HTMLTextAreaElement)&&0!==e.ids.length){var a=yt(e.ids).tables;if(0!==a.size){var r={columns:e.diagram.columns,tables:e.diagram.tables.filter((function(e){return a.has(e.id)})),refs:e.diagram.refs.filter((function(e){return a.has(e.from.table)&&a.has(e.to.table)})),size:{width:0,height:0},schema:e.diagram.schema},i=h(r),o=JSON.stringify(i);null===(n=t.clipboardData)||void 0===n||n.setData("text/plain",o),t.preventDefault()}}}({ids:t,diagram:n},e)};return document.addEventListener("copy",e),function(){return document.removeEventListener("copy",e)}}),[t,n])},vr=function(e,t){return e.filter((function(e){return e.type===t})).map((function(e){return e.value}))},hr=function(e){var t=e.dispatch;o.useEffect((function(){var e=function(e){return function(e,t){var n,a;if(!(t.target instanceof HTMLInputElement)&&!(t.target instanceof HTMLTextAreaElement)){var r={text:null!==(n=null===(a=t.clipboardData)||void 0===a?void 0:a.getData("text/plain"))&&void 0!==n?n:"",isAppend:!0};e.dispatch({type:"import-json",payload:r})}}({dispatch:t},e)};return document.addEventListener("paste",e),function(){return document.removeEventListener("paste",e)}}),[t])},gr=n(54),br=n.n(gr),Er="theme-light";w("setTheme",(function(e){Er=e.includes("theme-")?e:"theme-".concat(e),document.documentElement.classList.add(Er)}));var wr=function(){var e=Ie(),t=c.a.useState((function(){return function(e){var t;switch(e){case"mac":return"theme-auto";case"win":return Er;case"web":return null!==(t=localStorage.getItem("theme"))&&void 0!==t?t:"theme-auto";default:throw Error("Unknown platform")}}(e)})),n=Object(i.a)(t,2),a=n[0],r=n[1];return c.a.useEffect((function(){"web"===e&&window.localStorage.setItem("theme",a)}),[a,e]),c.a.useEffect((function(){document.documentElement.classList.remove(Er)}),[]),c.a.useEffect((function(){return document.documentElement.classList.add(a),function(){return document.documentElement.classList.remove(a)}}),[a]),c.a.useEffect((function(){w("setTheme",(function(e){var t=e.includes("theme-")?e:"theme-".concat(e);r(t)}))}),[]),{theme:a,setTheme:r}},yr=function(){var e=Pe(),t=c.a.useState(1),n=Object(i.a)(t,2),a=n[0],l=n[1],s=c.a.useRef(null),u=function(){var e=o.useState([]),t=Object(i.a)(e,2),n=t[0],a=t[1],r=o.useMemo((function(){return yt(n)}),[n]),c=r.tables,l=r.refs;return{ids:n,setIds:a,tables:c,refs:l}}(),d=wr(),f=d.theme,m=d.setTheme,v=c.a.useState(!1),h=Object(i.a)(v,2),g=h[0],b=h[1];return pr({diagram:e.history.present,ids:u.ids}),hr({dispatch:e.dispatch}),function(e){var t=c.a.useState(!1),n=Object(i.a)(t,2),a=n[0],r=n[1];c.a.useEffect((function(){var t=e.current;if(null!==t){var n={drag:a,setDrag:r,element:t};t.tabIndex=0;var i=ya(n);return t.addEventListener("keydown",i),function(){return t.removeEventListener("keydown",i)}}}),[a,e])}(s),c.a.createElement("div",{className:br.a.container},c.a.createElement("div",{className:br.a.header},c.a.createElement(sr,{diagram:e.history.present,diagramPast:e.history.past,diagramFuture:e.history.future,diagramDispatch:e.dispatch,theme:f,setTheme:m,viewportRef:s,zoom:a,setZoom:l,setIsCapture:b,setSelectIds:u.setIds})),c.a.createElement(r.b,{color:"strong"}),c.a.createElement("div",{className:"".concat(br.a.body," ").concat(r.s.secondary)},c.a.createElement("div",{className:br.a.viewport,tabIndex:0,ref:s,onKeyUp:function(t){!function(e){var t=e.ids,n=e.event,a=e.diagramDispatch;!1!==["Backspace","Delete"].includes(n.key)&&(n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||(a({type:"remove-multiple-refs",payload:{ids:vr(t,"ref")}}),a({type:"remove-multiple-tables",payload:{ids:vr(t,"table")}}),n.stopPropagation()))}({ids:u.ids,diagramDispatch:e.dispatch,event:t})}},c.a.createElement(ba,{diagram:e.history.present,diagramDispatch:e.dispatch,zoom:a,viewportRef:s,isCapture:g,selectedRefs:u.refs,selectedTables:u.tables,setSelectIds:u.setIds})),c.a.createElement(mr,null)),c.a.createElement(p,{viewportRef:s}))},xr=n(91),jr=n.n(xr),Dr=n(209),_r=n.n(Dr),Ir=n(41),Or=n.n(Ir),zr=function(){return c.a.createElement("span",null,c.a.createElement("span",null,"\xa9 2020 "),c.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://tableplus.com"},"TablePlus Inc."))},Sr=function(){return c.a.createElement(r.l,null,c.a.createElement("div",{className:Or.a.container},c.a.createElement(r.m,null,c.a.createElement("a",{href:"mailto:nick@tableplus.com"},"Email us"),c.a.createElement(r.g,null),c.a.createElement("a",{rel:"noopener noreferrer",href:"https://github.com/TablePlus/"},"Issue tracker"),c.a.createElement("span",{className:Or.a.tptop},c.a.createElement(r.g,null),c.a.createElement(zr,null))),c.a.createElement(r.m,null,c.a.createElement("span",{className:Or.a.nobreak},"1100-1959 Upper Water Street"),c.a.createElement("span",null," "),c.a.createElement("span",{className:Or.a.nobreak},"Halifax NS Canada."),c.a.createElement("span",null," "),c.a.createElement("span",{className:Or.a.nobreak},"All rights reserved"))))},Ar=n(210),kr=n.n(Ar),Tr=function(e){var t=e.dataText;return c.a.createElement("div",{className:kr.a.container},c.a.createElement(r.m,null,c.a.createElement(r.p,null,"Your data are safe here. "),c.a.createElement("span",null,"We process your ",t," right in the browser, so no data shall leave this device.")))},Mr=n(128),Cr=n.n(Mr),Lr=function(){return c.a.createElement("a",{className:Cr.a.logo,href:"https://tableplus.com",target:"_blank",rel:"noopener noreferrer"},c.a.createElement("img",{alt:"TablePlus logo",src:_r.a,width:"auto",height:32}))},Pr=function(){return c.a.createElement("div",{className:Cr.a.container},c.a.createElement(r.i,{size:16}),c.a.createElement(Tr,{dataText:"diagram"}),c.a.createElement(r.h,null),c.a.createElement(Sr,null),c.a.createElement(r.i,{size:16}),c.a.createElement(Lr,null),c.a.createElement(r.i,{size:16}))},Nr=function(){var e=Ie();return c.a.createElement("div",{className:[jr.a.container,r.v.custom].join(" ")},c.a.createElement("div",{className:jr.a.body},c.a.createElement(yr,null)),"web"===e&&c.a.createElement(c.a.Fragment,null,c.a.createElement(r.b,{color:"strong"}),c.a.createElement("div",{className:jr.a.footer},c.a.createElement(Pr,null))))},Br=(n(440),n(212)),Rr=n(213),Hr=n(23),Fr=n.n(Hr),Qr=(n(441),n(211)),Vr=n(55),Wr=n.n(Vr),Ur=function(e){var t=o.useState(!0),n=Object(i.a)(t,2),a=n[0],r=n[1],c=o.useState(e),l=Object(i.a)(c,2);return{has:a,setHas:r,text:l[0],setText:l[1]}},Xr=function(e){return o.createElement("div",{className:Wr.a.container},o.createElement("div",{className:Wr.a.input},o.createElement("div",{className:Wr.a.has},o.createElement(r.f,{value:e.state.has,setValue:e.state.setHas,children:e.label})),o.createElement("div",{className:Wr.a.text},o.createElement(r.k,{value:e.state.text,setValue:e.state.setText,disabled:!e.state.has,placeholder:e.placeholder}))),e.children&&o.createElement(r.l,null,o.createElement(r.m,null,e.children)))},Kr=n(30),qr=n.n(Kr),Gr=function(e){return e.has?e.text:void 0},Yr=function(e){var t="uncaught"===e.type,n=Ur((function(){return""})),a=Ur((function(){return""})),c=Ur((function(){var t;return null!==(t=e.error)&&void 0!==t?t:""})),l=Ur((function(){return JSON.stringify(E)})),s=Ur((function(){return function(){var e;return null!==(e=window.localStorage.getItem("diagram"))&&void 0!==e?e:"None"}()})),u=Ie(),d=o.useState(!1),f=Object(i.a)(d,2),m=f[0],p=f[1],v=function(){var r=Object(Ia.a)(_a.a.mark((function r(){var i,o;return _a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return p(!0),o={title:t?"Uncaught error":"Manual report",platform:u,error:Gr(c),message:Gr(n),contact:Gr(a),diagram:Gr(s),log:Gr(l)},r.next=4,window.fetch("https://diagramplus.com/api/report",{method:"POST",body:JSON.stringify(o),headers:{"Content-type":"application/json"}});case 4:window.alert("The report has been sent successfully"),p(!1),null===(i=e.onDone)||void 0===i||i.call(e);case 7:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),h=o.createElement(o.Fragment,null,o.createElement("h1",{className:qr.a.title},e.title),o.createElement(r.i,{size:16}),o.createElement(r.b,{color:"weak"}),o.createElement(r.i,{size:16}),e.description,o.createElement(r.r,{autoFocus:!0,rows:3,value:n.text,setValue:n.setText}),o.createElement(r.i,{size:16}),t&&o.createElement(o.Fragment,null,o.createElement(Xr,{label:"Include error detail",state:c}),o.createElement(r.i,{size:8})),o.createElement(Xr,{label:"Include the diagram",state:s}),o.createElement(r.i,{size:8}),o.createElement(Xr,{label:"Include application log",state:l}),o.createElement(r.i,{size:8}),o.createElement(Xr,{state:a,label:"Allow us to contact you at:",placeholder:"name@example.com"}),o.createElement(r.i,{size:16}),o.createElement(r.b,{color:"weak"}),o.createElement(r.i,{size:16}),o.createElement("div",{className:qr.a.footer},e.footer,o.createElement(r.i,{size:16}),o.createElement(r.c,{disabled:m,highlight:!0,onClick:v,children:m?"Sending report\u2026":"Send Report"})));return o.createElement("div",{className:qr.a.container},o.createElement("div",{className:[qr.a.backdrop,r.s.secondary].join(" ")}),o.createElement("div",{className:qr.a.main,onClick:function(t){var n;t.target===t.currentTarget&&(null===(n=e.onClickOutside)||void 0===n||n.call(e))}},o.createElement("div",{className:[qr.a.body,r.t.strong,r.s.primary].join(" "),children:h})))},Zr=function(){return o.createElement(o.Fragment,null,o.createElement(r.m,null,"Please tell us about this problem. We will treat your report as confidential and anonymous."),o.createElement(r.i,{size:8}),o.createElement(r.m,null,"To help us diagnose the problem, please describe what you were doing when this error occured:"),o.createElement(r.i,{size:8}))},Jr=function(){if("web"!==Ie())return null;return o.createElement(r.c,{onClick:function(){return window.location.reload()},children:"Reload"})},$r=function(e){return wr(),o.createElement(Yr,{type:"uncaught",title:"There was an unexpected error",description:o.createElement(Zr,null),footer:o.createElement(Jr,null),error:"".concat(e.error)})},ei=function(e){Object(Y.a)(n,e);var t=Object(Z.a)(n);function n(e){var a;return Object(G.a)(this,n),(a=t.call(this,e)).state={hasError:!1,error:null},a}return Object(Qr.a)(n,[{key:"render",value:function(){return this.state.hasError?o.createElement($r,{error:this.state.error}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}]),n}(o.Component);"6"!==window.localStorage.getItem("version")&&(window.localStorage.clear(),window.localStorage.setItem("version","6")),window.Diagram=b,window.Logger=E;var ti=function(){var e=function(){var e=c.a.useState(De),t=Object(i.a)(e,2),n=t[0],a=t[1];return c.a.useEffect((function(){Oe((function(e){a(e)}))}),[]),n}();return c.a.createElement(c.a.StrictMode,null,c.a.createElement(_e.Provider,{value:e},c.a.createElement(ei,null,c.a.createElement(Br.a,{options:Rr.a},c.a.createElement(Nr,null)))))};Fr.a.render(c.a.createElement(ti,null),document.getElementById("root"))},51:function(e,t,n){e.exports={container:"layer_container__1DSen",svg:"layer_svg__1kDpM",line:"layer_line__24WBc",icon:"layer_icon__1W0JP"}},52:function(e,t,n){e.exports={container:"string_container__6Pyow",view:"string_view__1oiV8",weak:"string_weak__3HpXd",edit:"string_edit__2m0iK",empty:"string_empty__3u9-r"}},53:function(e,t,n){e.exports={container:"header_container__1QU6W",main:"header_main__1XQwN",edit:"header_edit__3vvV8",remove:"header_remove__SIzDW",title:"header_title__l4mqY"}},54:function(e,t,n){e.exports={container:"view_container__2oDm-",body:"view_body__1Z1mW",viewport:"view_viewport__1l3sB",header:"view_header__3f7ol"}},55:function(e,t,n){e.exports={input:"item_input__3LNOA",has:"item_has__2s9Zu",text:"item_text__3PN9Y"}},86:function(e,t,n){e.exports={container:"header_container__2zpDr","slide-in":"header_slide-in__TPuT0",field:"header_field__nquLg",rightField:"header_rightField__3R_Ju"}},87:function(e,t,n){e.exports={container:"source_container__3TgWW","slide-in":"source_slide-in__P2Ug9",dragging:"source_dragging__1rxAg",button:"source_button__2cu3w"}},88:function(e,t,n){e.exports={container:"main_container__24nAp",selected:"main_selected__1OzJ8",edit:"main_edit__KBdPX"}},89:function(e,t,n){e.exports={container:"drag_container__1_FJJ",box:"drag_box__2nmY1",boxBg:"drag_boxBg__32YQk"}},90:function(e,t,n){e.exports={container:"header_container__-KQI5"}},91:function(e,t,n){e.exports={container:"app_container__2pv2U",body:"app_body__3dFS1",footer:"app_footer__1cpy9"}}},[[215,1,2]]]);
//# sourceMappingURL=main.d20394fe.chunk.js.map