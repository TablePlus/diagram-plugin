{"version":3,"sources":["app/edge/create/create.module.css","app/edge/create/footer/footer.module.css","app/edge/create/rows/rows.module.css","app/app/error/report/form/form.module.css","app/edge/canvas/marker/marker.module.scss","app/table/active/body/body.module.scss","app/table/active/header/name/name.module.scss","app/view/canvas/canvas.module.scss","app/view/library/item/name/name.module.scss","app/view/progress/progress.module.scss","app/app/footer/footer.module.scss","app/edge/create/header/header.module.css","diagram/export/image/html2canvas.js","app/header/primary/style/base.module.scss","app/header/primary/style/mac.module.scss","app/header/primary/style/win.module.scss","app/header/secondary/style/base.module.scss","app/header/secondary/style/mac.module.scss","app/header/secondary/style/win.module.scss","app/header/style/mac.module.scss","app/header/style/win.module.scss","app/edge/canvas/canvas.module.css","app/table/active/active.module.css","app/table/active/body/add/add.module.scss","app/row/field/boolean/boolean.module.css","app/row/remove/remove.module.scss","app/table/active/header/menu/menu.module.css","app/table/blank/blank.module.css","app/view/resizer/resizer.module.css","app/app/footer/logo.png","app/app/footer/privacy/privacy.module.scss","app/row/row.module.scss","app/edge/edge.module.scss","utils/resize-div/resize-div.module.scss","app/view/view.module.scss","app/edge/create/arrow/arrow.tsx","app/edge/create/footer/footer.tsx","app/edge/create/header/header.tsx","app/edge/create/rows/rows.tsx","app/edge/create/side/side.tsx","app/edge/create/create.tsx","utils/external.ts","utils/platform.ts","app/header/utils/div.tsx","app/dom/dom.ts","diagram/reducer/id.ts","app/header/primary/add.tsx","diagram/export/image/image.ts","diagram/export/base.ts","diagram/export/sql/sql.ts","utils/encode.ts","diagram/export/export.ts","diagram/export/text/text.ts","utils/file/web.ts","utils/host.tsx","utils/file/app.ts","utils/file/file.ts","app/header/primary/export/sql.tsx","utils/clipboard.ts","app/header/primary/export/text.tsx","app/header/primary/export/export.tsx","app/header/primary/export/image.ts","app/header/primary/history.tsx","app/header/primary/import/sample.ts","app/header/primary/import/sql.tsx","app/header/primary/import/text.ts","app/header/primary/import/import.tsx","app/header/primary/layout/layout.tsx","app/header/primary/library/library.tsx","app/view/select/table.ts","app/header/primary/search.tsx","app/header/primary/setting/setting.tsx","app/header/primary/zoom/zoom.tsx","app/header/primary/primary.tsx","app/app/error/report/item/item.tsx","diagram/models/base/base.ts","diagram/models/base/base-v1.ts","diagram/models/base/base-v2.ts","diagram/models/edit/edit.ts","diagram/models/edit/edit-v1.ts","diagram/models/edit/edit-v2.ts","app/dom/constants.ts","app/dom/size.ts","diagram/layout/dagree.ts","diagram/layout/masonry.ts","diagram/layout/merge.ts","diagram/layout/split.ts","diagram/layout/layout.ts","diagram/import/base.ts","diagram/import/import.ts","diagram/library/fallback.ts","diagram/library/actions.ts","diagram/library/state.ts","app/app/error/report/form/form.tsx","utils/version.ts","app/app/error/report/report.tsx","app/header/report/report.tsx","app/header/secondary/animation/animation.tsx","app/header/secondary/footer/footer.tsx","app/header/secondary/report/report.tsx","app/header/secondary/theme/theme.tsx","app/header/secondary/secondary.tsx","app/header/header.tsx","app/header/utils/size.ts","app/header/utils/style.ts","app/row/drag/layer/layer.tsx","diagram/reducer/row/add.ts","diagram/state/undo/undo.ts","diagram/reducer/table/add.ts","diagram/reducer/import/import.ts","diagram/reducer/import/append.ts","diagram/reducer/ref/remove.ts","diagram/reducer/ref/ref.ts","diagram/reducer/ref/add.ts","diagram/reducer/row/remove.ts","diagram/reducer/row/update.ts","diagram/reducer/table/remove.ts","diagram/reducer/table/update-name.ts","diagram/reducer/table/table.ts","diagram/reducer/table/position.ts","diagram/reducer/table/row.ts","diagram/reducer/table/duplicate.ts","diagram/state/external/external.ts","diagram/state/undo/shortcut.ts","diagram/state/use-diagram.ts","diagram/reducer/reducer.ts","diagram/reducer/row/row.ts","diagram/reducer/layout/layout.ts","app/view/select/edge.ts","app/edge/state/box.ts","app/edge/state/observe.ts","app/edge/state/intersect/segment.ts","app/edge/state/intersect/split.ts","app/edge/state/intersect/arc.ts","app/edge/state/intersect/intersect.ts","app/edge/state/path.ts","app/edge/state/point.ts","app/edge/state/split-y.ts","app/edge/state/split-x.ts","app/edge/state/state.ts","app/edge/utils.ts","app/edge/highlight.tsx","app/edge/edge.tsx","app/edge/canvas/marker/marker.tsx","app/edge/canvas/canvas.tsx","app/table/active/drag/move.ts","app/table/active/drag/stop.ts","app/view/select/select.ts","app/table/active/body/add/add.tsx","app/dom/navigate.ts","app/table/active/body/events/navigate.ts","app/table/active/body/header/header.tsx","app/row/drag/source/source.tsx","app/row/field/boolean/boolean.tsx","app/row/field/string/leave.ts","app/row/field/string/string.tsx","app/row/field/field.tsx","app/row/remove/remove.tsx","app/row/row.tsx","app/row/drag/drop/drop.ts","app/table/rows/headless.tsx","app/table/rows/group.ts","app/table/active/body/rows/hidden.tsx","app/table/active/body/rows/rows.tsx","app/table/active/body/events/create.ts","app/table/active/body/body.tsx","app/table/active/header/name/name.tsx","app/table/active/header/menu/menu.tsx","app/table/active/header/header.tsx","app/table/active/main/event.ts","app/table/active/main/main.tsx","app/table/active/active.tsx","app/table/blank/blank.tsx","app/table/inactive/inactive.tsx","app/table/table.tsx","app/view/select/canvas/drag/box.ts","app/view/select/canvas/drag/overlap.ts","app/view/select/canvas/drag/element.ts","app/view/select/canvas/drag/drag.tsx","app/view/canvas/edge.ts","app/view/canvas/canvas.tsx","app/view/drag/use-drag.ts","app/view/library/create/create.tsx","app/view/library/item/menu/export.ts","app/view/library/item/menu/remove.ts","app/view/library/item/menu/menu.tsx","app/view/library/item/name/name.tsx","app/view/library/item/item.tsx","app/view/library/library.tsx","app/view/progress/progress.tsx","utils/resize-div/resize-div.tsx","app/view/resizer/resizer.tsx","app/view/select/canvas/copy.ts","app/view/select/canvas/delete.ts","app/view/select/canvas/paste.ts","app/view/view.tsx","app/edge/create/state.ts","pref/theme.ts","pref/pref.ts","app/app/footer/links/links.tsx","app/app/footer/privacy/privacy.tsx","app/app/footer/close/close.tsx","app/app/footer/footer.tsx","app/app/error/error.tsx","app/app/app.tsx","index.tsx","app/app/footer/links/links.module.scss","app/edge/create/arrow/arrow.module.scss","app/app/error/report/item/item.module.css","app/app/error/report/report.module.css","app/row/drag/layer/layer.module.scss","app/row/field/string/string.module.scss","app/table/active/header/header.module.scss","app/edge/create/side/side.module.css","app/table/active/body/header/header.module.scss","app/row/drag/source/source.module.scss","app/table/active/main/main.module.scss","app/view/select/canvas/drag/drag.module.css","app/view/library/item/item.module.css","app/view/library/library.module.css","app/app/app.module.scss"],"names":["module","exports","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","push","Bounds","x","w","h","left","top","width","height","add","fromClientRect","clientRect","parseBounds","node","getBoundingClientRect","toCodePoints","str","codePoints","charCodeAt","extra","fromCodePoint","_i","String","codeUnits","index","codePoint","fromCharCode","chars","lookup","Uint8Array","TokenType","slice16","view","start","end","slice","Uint16Array","Trie","initialValue","errorValue","highStart","highValueIndex","data","get","ix","UTRIE2_DATA_BLOCK_LENGTH","UTRIE2_INDEX_1_OFFSET","UTRIE2_INDEX_2_BLOCK_LENGTH","SP","BA","HY","CL","CP","EX","IN","NS","OP","IS","NU","PO","PR","SY","AL","EB","EM","H2","H3","ID","JL","JV","JT","SA","UnicodeTrie","base64","buffer","encoded1","encoded2","encoded3","encoded4","bufferLength","len","ArrayBuffer","bytes","isArray","decode","view32","polyUint32Array","Uint32Array","view16","polyUint16Array","headerLength","Math","ceil","createTrieFromBase64","ALPHABETICS","HARD_LINE_BREAKS","SPACE","PREFIX_POSTFIX","LINE_BREAKS","concat","KOREAN_SYLLABLE_BLOCK","HYPHEN","isAdjacentWithSpaceIgnored","a","currentIndex","classTypes","current","indexOf","prev","previousNonSpaceClassType","type","_lineBreakAtIndex","indicies","forbiddenBreaks","beforeIndex","afterIndex","before","prevIndex","count","cssFormattedClasses","options","lineBreak","wordBreak","_a","types","categories","forEach","classType","codePointsToCharacterClasses","isLetterNumber","map","letterNumber","undefined","Break","required","isDigit","isHex","isWhiteSpace","isNameStartCodePoint","isLowerCaseLetter","isUpperCaseLetter","isLetter","isNonASCIICodePoint","isNameCodePoint","isNonPrintableCodePoint","isValidEscape","c1","c2","isIdentifierStart","c3","isNumberStart","stringToNumber","c","sign","integers","int","parseInt","fraction","fracd","frac","expsign","exponent","exp","pow","LEFT_PARENTHESIS_TOKEN","RIGHT_PARENTHESIS_TOKEN","COMMA_TOKEN","SUFFIX_MATCH_TOKEN","PREFIX_MATCH_TOKEN","COLUMN_TOKEN","DASH_MATCH_TOKEN","INCLUDE_MATCH_TOKEN","LEFT_CURLY_BRACKET_TOKEN","RIGHT_CURLY_BRACKET_TOKEN","SUBSTRING_MATCH_TOKEN","BAD_URL_TOKEN","BAD_STRING_TOKEN","CDO_TOKEN","CDC_TOKEN","COLON_TOKEN","SEMICOLON_TOKEN","LEFT_SQUARE_BRACKET_TOKEN","RIGHT_SQUARE_BRACKET_TOKEN","WHITESPACE_TOKEN","EOF_TOKEN","Tokenizer","_value","write","chunk","read","tokens","token","consumeToken","consumeCodePoint","consumeStringToken","peekCodePoint","flags","consumeName","HASH_TOKEN","reconsumeCodePoint","consumeNumericToken","e1","e2","e3","consumeIdentLikeToken","a1","a2","a3","AT_KEYWORD_TOKEN","u1","u2","consumeUnicodeRangeToken","consumeWhiteSpace","DELIM_TOKEN","shift","unshift","delta","digits","questionMarks","start_1","digit","UNICODE_RANGE_TOKEN","endDigits","toLowerCase","consumeUrlToken","FUNCTION_TOKEN","IDENT_TOKEN","URL_TOKEN","stringToken","STRING_TOKEN","consumeBadUrlRemnants","consumeEscapedCodePoint","consumeStringSlice","amount","min","splice","endingCodePoint","consumeNumber","repr","number","unit","DIMENSION_TOKEN","PERCENTAGE_TOKEN","NUMBER_TOKEN","hex","hexCodePoint","isSurrogateCodePoint","Parser","_tokens","tokenizer","parseValue","parseComponentValue","parseValues","parseComponentValues","SyntaxError","reconsumeToken","consumeComponentValue","values","consumeSimpleBlock","consumeFunction","block","isEndingTokenFor","functionToken","cssFunction","name","FUNCTION","isDimensionToken","isNumberToken","isIdentToken","isStringToken","isIdentWithValue","nonWhiteSpace","nonFunctionArgSeparator","parseFunctionArgs","args","arg","Error","isLength","isLengthPercentage","parseLengthPercentageTuple","ZERO_LENGTH","FIFTY_PERCENT","HUNDRED_PERCENT","getAbsoluteValueForTuple","tuple","getAbsoluteValue","parent","angle","PI","isAngle","parseNamedSide","filter","ident","join","deg","color","colorFunction","SUPPORTED_COLOR_FUNCTIONS","r","substring","pack","namedColor","COLORS","toUpperCase","TRANSPARENT","isTransparent","asString","alpha","blue","green","red","round","getTokenColorValue","max","rgb","_b","hue2rgb","t1","t2","hue","PropertyDescriptorParsingType","BACKGROUND_CLIP","hsl","saturation","lightness","l","hsla","rgba","ALICEBLUE","ANTIQUEWHITE","AQUA","AQUAMARINE","AZURE","BEIGE","BISQUE","BLACK","BLANCHEDALMOND","BLUE","BLUEVIOLET","BROWN","BURLYWOOD","CADETBLUE","CHARTREUSE","CHOCOLATE","CORAL","CORNFLOWERBLUE","CORNSILK","CRIMSON","CYAN","DARKBLUE","DARKCYAN","DARKGOLDENROD","DARKGRAY","DARKGREEN","DARKGREY","DARKKHAKI","DARKMAGENTA","DARKOLIVEGREEN","DARKORANGE","DARKORCHID","DARKRED","DARKSALMON","DARKSEAGREEN","DARKSLATEBLUE","DARKSLATEGRAY","DARKSLATEGREY","DARKTURQUOISE","DARKVIOLET","DEEPPINK","DEEPSKYBLUE","DIMGRAY","DIMGREY","DODGERBLUE","FIREBRICK","FLORALWHITE","FORESTGREEN","FUCHSIA","GAINSBORO","GHOSTWHITE","GOLD","GOLDENROD","GRAY","GREEN","GREENYELLOW","GREY","HONEYDEW","HOTPINK","INDIANRED","INDIGO","IVORY","KHAKI","LAVENDER","LAVENDERBLUSH","LAWNGREEN","LEMONCHIFFON","LIGHTBLUE","LIGHTCORAL","LIGHTCYAN","LIGHTGOLDENRODYELLOW","LIGHTGRAY","LIGHTGREEN","LIGHTGREY","LIGHTPINK","LIGHTSALMON","LIGHTSEAGREEN","LIGHTSKYBLUE","LIGHTSLATEGRAY","LIGHTSLATEGREY","LIGHTSTEELBLUE","LIGHTYELLOW","LIME","LIMEGREEN","LINEN","MAGENTA","MAROON","MEDIUMAQUAMARINE","MEDIUMBLUE","MEDIUMORCHID","MEDIUMPURPLE","MEDIUMSEAGREEN","MEDIUMSLATEBLUE","MEDIUMSPRINGGREEN","MEDIUMTURQUOISE","MEDIUMVIOLETRED","MIDNIGHTBLUE","MINTCREAM","MISTYROSE","MOCCASIN","NAVAJOWHITE","NAVY","OLDLACE","OLIVE","OLIVEDRAB","ORANGE","ORANGERED","ORCHID","PALEGOLDENROD","PALEGREEN","PALETURQUOISE","PALEVIOLETRED","PAPAYAWHIP","PEACHPUFF","PERU","PINK","PLUM","POWDERBLUE","PURPLE","REBECCAPURPLE","RED","ROSYBROWN","ROYALBLUE","SADDLEBROWN","SALMON","SANDYBROWN","SEAGREEN","SEASHELL","SIENNA","SILVER","SKYBLUE","SLATEBLUE","SLATEGRAY","SLATEGREY","SNOW","SPRINGGREEN","STEELBLUE","TAN","TEAL","THISTLE","TOMATO","TURQUOISE","VIOLET","WHEAT","WHITE","WHITESMOKE","YELLOW","YELLOWGREEN","CSSImageType","CSSRadialShape","CSSRadialExtent","backgroundClip","prefix","LIST","parse","PADDING_BOX","CONTENT_BOX","BORDER_BOX","backgroundColor","TYPE_VALUE","format","parseColorStop","color$1","stop","processColorStops","stops","lineLength","first","last","processStops","previous","stop_1","absoluteValue","gapBegin","stop_2","gapLength","gapValue","calculateGradientDirection","radian","corner","centerX","centerY","atan2","getAngleFromCorner","abs","sin","cos","halfWidth","halfHeight","halfLineLength","yDiff","xDiff","distance","sqrt","findCorner","closest","reduce","stat","cx","cy","optimumDistance","optimumCorner","Infinity","prefixLinearGradient","angle$1","firstToken","colorStop","LINEAR_GRADIENT","isGreenPixel","createForeignObjectSVG","xmlns","svg","document","createElementNS","foreignObject","setAttributeNS","toString","appendChild","loadSerializedSVG","img","Image","onload","onerror","src","encodeURIComponent","XMLSerializer","serializeToString","FEATURES","createRange","range","testElement","createElement","style","TEST_HEIGHT","display","selectNode","rangeBounds","rangeHeight","removeChild","testRangeBounds","defineProperty","canvas","ctx","getContext","drawImage","toDataURL","testSVG","from","window","fetch","fillStyle","fillRect","greenImageSrc","getImageData","backgroundImage","size","testForeignObject","crossOrigin","XMLHttpRequest","responseType","Logger","id","enabled","Date","now","debug","console","getTime","info","instances","destroy","getInstance","instance","error","CacheStorage","_caches","Cache","open","cache","getOrigin","url","link","_link","href","protocol","hostname","port","isSameOrigin","_origin","setContext","location","_current","attachInstance","detachInstance","_options","_cache","addImage","has","isBlobImage","isRenderable","loadImage","match","key","useCORS","useProxy","_this","isInlineImage","SUPPORT_CORS_IMAGES","proxy","SUPPORT_CORS_XHR","allowTaint","isInlineBase64Image","complete","setTimeout","imageTimeout","keys","SUPPORT_RESPONSE_TYPE","xhr","status","response","reader_1","FileReader","addEventListener","readAsDataURL","timeout_1","timeout","ontimeout","send","INLINE_SVG","INLINE_BASE64","INLINE_IMG","SUPPORT_SVG_DRAWING","isSVG","test","substr","prefixRadialGradient","shape","CIRCLE","FARTHEST_CORNER","position","isColorStop","acc","ELLIPSE","CLOSEST_SIDE","FARTHEST_SIDE","CLOSEST_CORNER","RADIAL_GRADIENT","BACKGROUND_REPEAT","image","image_1","URL","imageFunction","SUPPORTED_IMAGE_FUNCTIONS","isAtPosition_1","isSupportedImage","backgroundOrigin","backgroundPosition","BACKGROUND_SIZE","backgroundRepeat","parseBackgroundRepeat","NO_REPEAT","REPEAT_X","REPEAT_Y","REPEAT","BORDER_STYLE","backgroundSize","isBackgroundSizeInfoToken","borderColorForSide","side","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","borderRadiusForSide","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","FLOAT","borderStyleForSide","IDENT_VALUE","NONE","SOLID","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderWidthForSide","VALUE","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","bit","parseDisplayValue","LINE_BREAK","float","LEFT","RIGHT","INLINE_START","INLINE_END","letterSpacing","LIST_STYLE_POSITION","STRICT","NORMAL","lineHeight","TOKEN_VALUE","listStyleImage","LIST_STYLE_TYPE","listStylePosition","INSIDE","OUTSIDE","OVERFLOW","listStyleType","DISC","SQUARE","DECIMAL","CJK_DECIMAL","DECIMAL_LEADING_ZERO","LOWER_ROMAN","UPPER_ROMAN","LOWER_GREEK","LOWER_ALPHA","UPPER_ALPHA","ARABIC_INDIC","ARMENIAN","BENGALI","CAMBODIAN","CJK_EARTHLY_BRANCH","CJK_HEAVENLY_STEM","CJK_IDEOGRAPHIC","DEVANAGARI","ETHIOPIC_NUMERIC","GEORGIAN","GUJARATI","GURMUKHI","HEBREW","HIRAGANA","HIRAGANA_IROHA","JAPANESE_FORMAL","JAPANESE_INFORMAL","KANNADA","KATAKANA","KATAKANA_IROHA","KHMER","KOREAN_HANGUL_FORMAL","KOREAN_HANJA_FORMAL","KOREAN_HANJA_INFORMAL","LAO","LOWER_ARMENIAN","MALAYALAM","MONGOLIAN","MYANMAR","ORIYA","PERSIAN","SIMP_CHINESE_FORMAL","SIMP_CHINESE_INFORMAL","TAMIL","TELUGU","THAI","TIBETAN","TRAD_CHINESE_FORMAL","TRAD_CHINESE_INFORMAL","UPPER_ARMENIAN","DISCLOSURE_OPEN","DISCLOSURE_CLOSED","marginForSide","marginTop","marginRight","marginBottom","marginLeft","OVERFLOW_WRAP","overflow","HIDDEN","SCROLL","AUTO","VISIBLE","TEXT_ALIGN","overflowWrap","BREAK_WORD","paddingForSide","paddingTop","paddingRight","paddingBottom","paddingLeft","POSITION","textAlign","CENTER","TEXT_TRANSFORM","RELATIVE","ABSOLUTE","FIXED","STICKY","STATIC","textShadow","shadow","offsetX","offsetY","blur","VISIBILITY","textTransform","UPPERCASE","LOWERCASE","CAPITALIZE","transform","transformFunction","SUPPORTED_TRANSFORM_FUNCTIONS","matrix","matrix3d","b1","b2","a4","b4","DEFAULT_VALUE","DEFAULT","transformOrigin","origins","WORD_BREAK","visibility","COLLAPSE","FONT_STYLE","BREAK_ALL","KEEP_ALL","zIndex","auto","order","opacity","textDecorationColor","textDecorationLine","line","fontFamily","accumulator","results","fontSize","fontWeight","fontVariant","PseudoElementType","fontStyle","OBLIQUE","ITALIC","contains","content","counterIncrement","increments","filtered","counter","increment","counterReset","resets","reset","quotes","open_1","close_1","close","getQuote","depth","quote","boxShadow","spread","inset","CSSParsedDeclaration","declaration","cssFloat","overflowTuple","overflowX","overflowY","isVisible","isTransformed","isPositioned","isPositionedWithZIndex","isFloating","isInlineLevel","CSSParsedPseudoDeclaration","CSSParsedCounterDeclaration","descriptor","parser","length_1","value_1","ElementContainer","element","styles","getComputedStyle","textNodes","elements","isHTMLElementNode","bounds","TextBounds","text","getWrapperBounds","ownerDocument","wrapper","cloneNode","parentNode","replaceChild","firstChild","getRangeBounds","offset","setStart","setEnd","breakText","breakWords","bk","breaker","forbiddenBreakpoints","lastEnd","nextIndex","LineBreaker","words","TextContainer","transform$1","textBounds","textList","trim","SUPPORT_RANGE_BOUNDS","replacementNode","splitText","parseTextBounds","replace","capitalize","m","p1","p2","ImageElementContainer","_super","currentSrc","intrinsicWidth","naturalWidth","intrinsicHeight","naturalHeight","CanvasElementContainer","SVGElementContainer","baseVal","LIElementContainer","OLElementContainer","reversed","CHECKBOX_BORDER_RADIUS","RADIO_BORDER_RADIUS","PASSWORD","InputElementContainer","input","checked","placeholder","getInputValue","SelectElementContainer","option","selectedIndex","TextareaElementContainer","parseColor","IFrameElementContainer","iframe","contentWindow","documentElement","tree","parseTree","documentBackgroundColor","bodyBackgroundColor","LIST_OWNERS","createContainer","isImageElement","isCanvasElement","isSVGElement","isLIElement","isOLElement","isInputElement","isSelectElement","isTextareaElement","isIFrameElement","container","parseNodeTree","root","childNode","nextNode","nextSibling","isTextNode","isElementNode","createsRealStackingContext","createsStackingContext","tagName","isBodyElement","nodeType","Node","TEXT_NODE","ELEMENT_NODE","isSVGElementNode","className","isStyleElement","isScriptElement","CounterState","counters","getCounterValue","getCounterValues","canReset","entry","counterNames","ROMAN_UPPER","createAdditiveCounter","symbols","fallback","suffix","createCounterText","string","integer","createCounterStyleWithSymbolResolver","codePointRangeLength","isNumeric","resolver","createCounterStyleFromRange","codePointRangeStart","codePointRangeEnd","floor","createCounterStyleFromSymbols","createCJKCounter","numbers","multipliers","negativeSign","tmp","coefficient","appendSuffix","defaultSuffix","cjkSuffix","koreanSuffix","spaceSuffix","CJK_TEN_COEFFICIENTS","CJK_ZEROS","DocumentCloner","scrolledElements","referenceElement","quoteDepth","toIFrame","windowSize","createIFrameContainer","scrollX","defaultView","pageXOffset","scrollY","pageYOffset","cloneWindow","documentClone","iframeLoad","iframeLoader","onclone","restoreNodeScroll","scrollTo","navigator","userAgent","clonedReferenceElement","nodeName","fonts","ready","serializeDoctype","doctype","restoreOwnerScroll","adoptNode","createElementClone","createCanvasClone","createStyleClone","clone","loading","sheet","cssRules","css","rule","cssText","textContent","inlineImages","clonedCanvas","clonedCtx","putImageData","createTextNode","styleBefore","styleAfter","createPseudoHideStyles","resolvePseudoContent","BEFORE","child","hasAttribute","ignoreElements","copyStyles","insertBefore","after","AFTER","copyCSSStyles","scrollTop","scrollLeft","pseudoElt","anonymousReplacedElement","attr","getAttribute","counterStyle","counterState","counterType","delim","counterStates","counterType_1","separator","PSEUDO_HIDE_ELEMENT_CLASS_BEFORE","PSEUDO_HIDE_ELEMENT_CLASS_AFTER","newClassName","baseValue","PathType","cloneIframeContainer","border","scrolling","setAttribute","onreadystatechange","interval","setInterval","childNodes","readyState","clearInterval","target","property","item","setProperty","getPropertyValue","HACK","internalSubset","publicId","systemId","createStyles","CORNER","equalPath","some","Vector","VECTOR","deltaX","deltaY","lerp","BezierCurve","startControl","endControl","BEZIER_CURVE","subdivide","firstHalf","ab","bc","cd","abbc","bccd","dest","reverse","isBezierCurve","path","BoundCurves","tlh","tlv","trh","trv","_c","brh","brv","_d","blh","blv","factors","maxFactor","topWidth","rightHeight","bottomWidth","leftHeight","topLeftBorderBox","getCurvePoints","TOP_LEFT","topRightBorderBox","TOP_RIGHT","bottomRightBorderBox","BOTTOM_RIGHT","bottomLeftBorderBox","BOTTOM_LEFT","topLeftPaddingBox","topRightPaddingBox","bottomRightPaddingBox","bottomLeftPaddingBox","topLeftContentBox","topRightContentBox","bottomRightContentBox","bottomLeftContentBox","r1","r2","kappa","ox","oy","xm","ym","calculateBorderBoxPath","curves","calculatePaddingBoxPath","TransformEffect","ClipEffect","StackingContext","inlineLevel","nonInlineLevel","negativeZIndex","zeroOrAutoZIndexOrTransformedOrOpacity","positiveZIndex","nonPositionedFloats","nonPositionedInlineLevel","ElementPaint","parentStack","effects","borderBox","paddingBox","getParentEffects","processListItems","owner","numbering","listValue","parseStackingContexts","paintContainer","listItems","parseStackTree","stackingContext","realStackingContext","treatAsRealStackingContext","listOwnerItems","stack","order_1","index_1","index_2","createPathFromCurves","outer1","inner1","outer2","inner2","contentBox","calculateBackgroundRendering","intrinsicSize","backgroundPositioningArea","calculateBackgroundPositioningArea","getBackgroundValueForIndex","backgroundPaintingArea","calculateBackgroundPaintingArea","backgroundImageSize","calculateBackgroundSize","sizeWidth","sizeHeight","calculateBackgroundRepeatPath","isAuto","hasIntrinsicValue","intrinsicProportion","second","hasIntrinsicProportion","CONTAIN","COVER","hasIntrinsicWidth","hasIntrinsicHeight","hasIntrinsicDimensions","width_3","height_3","repeat","FontMetrics","_data","_document","parseMetrics","span","margin","padding","verticalAlign","baseline","offsetTop","middle","getMetrics","CanvasRenderer","_activeEffects","scale","fontMetrics","translate","textBaseline","applyEffects","popEffect","effect","applyEffect","save","isTransformEffect","isClipEffect","clip","restore","renderStack","globalAlpha","renderStackContent","renderNode","paint","renderNodeBackgroundAndBorders","renderNodeContent","renderTextWithLetterSpacing","fillText","letter","measureText","createFontStyle","variant","renderTextNode","font","textShadows","shadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","renderReplacedElement","box","windowWidth","windowHeight","render","fill","beginPath","arc","isTextInputElement","canvasTextAlign","computeLineHeight","_e","_f","_g","_h","_j","_k","_l","_m","_o","_p","mask","paths","moveTo","lineTo","formatPath","closePath","point","bezierCurveTo","renderRepeat","pattern","resizeImage","renderBackgroundImage","_loop_1","this_1","x0","x1","y0","y1","gradient_1","top_1","rx","ry","radialGradient_1","midX","midY","invF","createPattern","createLinearGradient","addColorStop","background","isRadialGradient","gradient","calculateRadius","createRadialGradient","renderBorder","curvePoints","borderSide","parsePathForBorder","hasBackground","borders","borders_1","calculateBackgroundCurvedPaintingArea","deltaW","deltaH","borderBoxArea","maskOffset","shadowPaintingArea","calculateContentBoxPath","ForeignObjectRenderer","loadSerializedSVG$1","parseColor$1","renderElement","opts","instanceName","resourceOptions","defaultOptions","windowBounds","documentCloner","clonedElement","bgColor","defaultBackgroundColor","renderOptions","random","scrollWidth","offsetWidth","clientWidth","scrollHeight","offsetHeight","clientHeight","parseDocumentSize","logging","removeContainer","foreignObjectRendering","devicePixelRatio","innerWidth","innerHeight","factory","CreateEdgeArrow","props","ref","setArrow","attributes","borderColor","strong","primary","CreateEdgeFooter","help","Button","medium","highlight","outset","children","CreateEdgeHeader","secondary","getList","table","rows","row","idKey","includes","dispatchRemove","event","setRows","_r","removeRow","stopPropagation","nativeEvent","stopImmediatePropagation","CreateEdgeRows","setValue","setRow","list","Input","small","flat","onClick","icon","icons","plus","title","cross","tables","getTable","find","CreateEdgeSide","setTable","autoFocus","fromTable","getEdgeSide","tableName","rowsIds","portalContainer","getElementById","sArrow","menu","CreateEdge","React","getInitialFromTable","setFromTable","ids","fromRows","getInitialFromRows","setFromRows","toTable","setToTable","toRows","setToRows","popup","setPopup","popper","form","onSubmit","preventDefault","to","payload","diagramDispatch","showAlert","message","submit","setVisible","arrow","ReactDOM","globalFns","globalLogger","addExternalFnDirect","fn","addExternalFn","internalFn","pendingArgs","webDomains","initial","startsWith","platform","PlatformContext","createContext","usePlatform","useContext","registerExternal","HeaderBigDiv","getTableElementId","tableId","getTableElement","HTMLDivElement","getRowElementId","rowId","focusChild","column","querySelector","HTMLElement","focus","getGenericId","makeId","set","Set","getStringId","getNumberId","scrollOption","behavior","inline","HeaderAddTable","setSelectIds","scrollIntoView","button","html2canvas","domtoimage","toSvg","exportDiagramAsImage","_diagram","makeRefSide","editId","realId","schema","makeBaseDiagramFromEdit","edit","version","columns","items","refs","idsMap","Map","idsTable","makeIdsMap","exportSqlDrivers","encoder","TextEncoder","encodeText","unicode","encode","byte","btoa","decoder","TextDecoder","toCharCode","char","exportDiagram","diagram","obj","level","json","JSON","stringify","exportDiagramAsText","driver","base","exportDiagramAsSql","mimes","png","post","method","webkit","messageHandlers","postMessage","CefSharp","PostMessage","UseHostInstruction","toBase64","isBase64Format","word","split","clean","saveFileInApp","ext","fileExtensions","saveFile","download","click","saveFileInWeb","exportSql","appMessage","getHeaderExportSqlItems","Export","copyToClipboard","clipboard","writeText","showPrompt","toText","toClipboard","getHeaderExportTextItems","toFile","sleep","num","getImageItems","setIsCapture","HeaderExport","share","HeaderHistory","dispatch","undo","disabled","past","redo","future","loadRemote","setIsBusy","source","isAppend","importText","getHeaderImportTextItems","file","files","reader","readAsText","importFile","getItems","getHeaderImportSampleItems","sql","getHeaderImportSqlItems","HeaderImport","isBusy","layoutAction","setExpandAndArrange","getMenuItems","HeaderLayout","layoutAuto","caret","toggle","prefs","libraryVisible","HeaderLibrary","setPrefs","selected","menuOpen","getTableRelatedIds","HeaderSearch","useMemo","useState","_setValue","focusIfNecessary","focusTable","flex","search","newValue","onKeyUp","HeaderSetting","isHeaderExpand","setIsHeaderExpand","bool","cog","zoomOptions","HeaderZoom","setZoom","zoom","zoomOut","select","zoomIn","getContainerClass","cls","sBase","sMac","sWin","HeaderPrimary","diagramPast","diagramFuture","useReportItem","getInitial","setHas","setText","ReportItem","state","migrateBaseDiagram","unknown","v1","V2","migrateEditDiagram","TABLE_ROW_SELECTOR","TABLE_COLUMN_CLASS","TABLE_COLUMN_SELECTOR","getTableEstimatedSize","GRID_CELL","isRowsExpand","Constants","getRowHeight","edgesToHereCount","additionalHeight","roundPoint","applyDagreeLayout","dagre","graphlib","Graph","multigraph","setGraph","rankdir","nodesep","TABLE_MARGIN_SINGLE","ranksep","marginx","marginy","setDefaultEdgeLabel","dataset","getTableSize","setNode","setEdge","layout","graph","TABLE_CLIENT_WIDTH","area","getMasonryLayout","diagrams","nodes","columnsCount","minWidth","totalArea","sum","expectedWidth","getColumnCount","tops","positions","getAppendPosition","_top","leftIndex","getRangeMaxTop","sort","newHeight","getSize","masonry","right","bottom","screen","availWidth","availHeight","getTables","params","originalDiagram","splitDiagram","bigDiagram","tableMap","refMap","pushTableToDiagram","applyAutoLayout","fallbackSchema","makeTable","makeColumn","makeEditDiagramFromBase","makeRef","importObject","Base","latest","Edit","importJson","object","importBase64","atob","decodeText","importDiagram","emptyDiagram","fallbackDiagram","getStorageKey","getLibraryDiagram","stored","localStorage","getItem","setLibraryDiagram","setItem","createLibraryDiagram","all","createUpdater","names","getAllLibraryDiagrams","createInStorage","deleteInStorage","removeItem","deleteLibraryDiagram","deleteUpdater","renameInStorage","fromName","toName","showConfirm","fromValue","renameUpdater","renameLibraryDiagram","DEFAULT_DIAGRAM_NAME","openLibraryDiagram","openUpdater","getInitialCurrent","useDiagramLibrary","getInitialState","library","setLibrary","ReportForm","isUncaught","contact","getError","log","getDiagram","agent","submitReport","headers","onDone","description","footer","ErrorReport","backdrop","main","currentTarget","onClickOutside","Description","Footer","cancel","HeaderReportDialog","reportVisible","closeReport","setReportVisible","createPortal","HeaderAnimation","edgeAnimation","HeaderFooter","footerVisible","HeaderReportButton","issue","flash","moon","HeaderTheme","theme","HeaderSecondary","Header","isExpand","setIsExpand","Moai","getHeaderSize","useEffect","listener","metaKey","ctrlKey","removeEventListener","useHeaderReport","classes","borderStrong","borderWeak","getPlatformClasses","collect","monitor","isDragging","getItemType","getClientOffset","ToIcon","memo","locate","RowDragLayer","dragging","useDragLayer","initialRef","useRef","dragTargetRef","elementRef","viewportRef","sourceRef","viewport","diffLeft","diffTop","x2","y2","defaultFields","orgReducer","getDefaultRow","allValueIds","valueId","field","getRowField","addRow","update","updateTable","toMaxLeft","getTableNewPosition","getNewSize","diagramImportReducer","action","original","appendDiagram","removeRef","diagramRefReducer","isFromPayload","prevIds","addRef","removeMultipleRefs","isSideRelated","isRelated","updateEditRow","updateRow","attribute","isSame","removeTable","updateTableName","updateName","diagramTableReducer","valueIds","addTable","removeMultipleTables","setTablePosition","setTableRowsExpand","setAllTablesRowsExpand","duplicateTable","registerJson","registerObject","registerBase64","useDiagramUndoShortcut","HTMLInputElement","HTMLTextAreaElement","shiftKey","makeListener","undoReducer","diagramRowReducer","diagramLayoutReducer","present","useDiagram","useReducer","Undo","history","bound","bind","selectOnRefClick","refId","getEdgeSideBoxes","edge","tablePosition","tableTop","tableLeft","getRowElement","offsetLeft","offsetParent","getOffsetUntil","rowTop","rowLeft","mutationInit","attributeFilter","subtractPoints","point1","point2","addPoints","multiplyPoint","crossProduct","getSegmentIntersection","q1","q2","uNumerator","denominator","u","addend","getSegmentLength","A","B","splitSegment","dAB","dCB","getArc","radius","getLineWithIntersection","edgesPoints","edgeId","edgesIds","points","j","E","M","N","getAnchorAxis","getAnchor","isDiagonal","pushPoint","C","ps","X","Y","getEdgePath","edgePoints","mid","inners","outer","D","getPoints","orgPoints","getPathD","toPoint","getOuterPoint","getEndPoints","rowYMap","boxes","fromSide","toSide","fromInners","fromOuter","toInners","rowYId","edgeYMap","free","getNextFree","getRowFreeY","getEdgePoints","edgesMids","direction","maxX","getMidPoints","edgesMap","usedMids","midPoints","getClosestAvailable","detail","avoidMidCollision","getEdgeState","getEdgeBoxes","useEdgeState","changed","setChanged","resize","ResizeObserver","resizeCb","observe","mutation","MutationObserver","records","record","attributeName","mutationCb","disconnect","useEdgeObserve","setState","clearTimeout","newState","__hack__diagram","getEdgeElementId","getEdgeSubElementId","getEdgeSubElement","SVGElement","EdgeHighlight","dot","dur","repeatCount","getClassName","array","isSelected","Edge","hitarea","From","viewBox","refX","refY","markerWidth","markerHeight","markerUnits","To","orient","EdgeMarkers","EdgesCanvas","tablesMap","edges","useEdgesMids","edgeIds","useRowYMap","edgesSet","useEdgesPoints","selectedRefs","onTableDragMove","_event","relatedTables","related","other","isTo","updateEdgeElements","onTableDragStop","filterId","getSelectSets","TableBodyAdd","isFullWidth","getSibling","previousElementSibling","nextElementSibling","getAdjacentRow","currRow","targetRow","classList","getColumnByIndex","querySelectorAll","Element","getAdjacentColumn","adjacentInRow","getAdjacentColumInRow","isLeft","adjacentRow","getJumpColumn","getColumnIndex","navigateOnArrowKeys","getNextColumn","weak","muted","renderColumn","rightField","TABLE_BODY_WIDTH","TableBodyHeader","blank","iconSize","doubleChevronLeft","doubleChevronRight","RowDragSource","useDrag","begin","beginDrag","_item","getDropResult","endDrag","collectDrag","dragRefCallback","previewRef","getEmptyImage","isHover","setIsHover","isActive","iconNode","selection","circle","outline","normal","tabIndex","showCreateEdge","onMouseEnter","onMouseLeave","TRUE_PREFIX","RowInputBoolean","charAt","Select","setJustLeftEdit","defaultValue","onBlur","setIsEdit","onKeyDown","viewRef","focusView","viewClass","always","ViewValue","empty","View","onDoubleClick","onFocus","RowInputString","isEdit","internal","updateRowField","RowFieldInput","getInput","RowRemoveButton","remove","renderField","fieldCls","field1st","field2nd","Row","useDrop","accept","drop","isOver","dropRef","over","rowRemoveOnKeyDown","isTableEdit","fields","isTableColumnsExpand","edgeFromHere","Item","getHiddenRows","rowEdgesMap","getRow","TableRowsHeadless","orgRowEdgesMap","slotCount","prevGroup","groupTableRows","getHideRowsButton","TableHiddenRows","TableHideRowsButton","RowContainer","rowEdges","isColumnsExpand","TableBodyRows","createRowOnTab","nextRow","nextColumn","relatedTarget","HTMLButtonElement","TableBody","header","HeaderName","onMouseDown","clientX","clientY","exportOptions","copy","TableHeaderMenu","duplicate","more","TableHeader","onTableBlur","isRowDragging","createEdge","getCls","toEdgeId","tableEdgesInfo","every","TableMain","isMyRow","TableActive","dragRef","onDrag","onStop","nodeRef","setSelectId","TableBlank","Field","textOverflow","whiteSpace","getRowStyle","alignItems","containerProps","borderStyle","borderWidth","headerStyle","HiddenRows","TableInactive","Table","setSelfVisible","setIsVisible","callback","entries","isIntersecting","observer","IntersectionObserver","threshold","data-name","data-is-visible","isCapture","getInnerTable","getDragBox","startRef","setOpacity","emptyBox","setSize","setDragBoxStyles","boxRef","isTableOverlap","getIds","getOverlapIds","getOverlapTables","getOverlapRefs","setClass","isOverlap","setTempSelect","SVGGElement","getEdgeElement","setContainerStyles","emptyIds","SelectDragLayer","isDraggingRef","containerRef","spaceLockRef","onMouseMove","onMouseUp","boxBg","newInfo","getTableEdgesInfoMap","otherTables","updateEdgeFrom","updateEdgeTo","getContainerStyle","halfMargin","toTablesMap","Canvas","tableEdgesInfoMap","grid","selectedTables","drag","setDrag","dragscroll","me","LibraryCreate","libraryItemExport","libraryItemRemove","Actions","prevAll","fromIndex","nextAll","duplicateLibraryDiagram","LibraryItemMenu","exportItem","rename","LibraryItemName","LibraryItem","isCurrent","LibraryPane","ViewProgress","progress","setProgress","ResizeDiv","setIsDragging","getWidth","whileDrag","onChange","stopDrag","disable","noDrag","ViewResizer","libraryRef","libraryWidth","setLibraryWidth","useCanvasCatchCopy","clipboardData","setData","catchCopy","filterIds","useCanvasCatchPaste","getData","catchPaste","useDiagramFull","libraryState","legacy","diagramState","setIds","useSelect","visible","setTarget","usePopper","placement","modifiers","showPopup","useCreateEdge","useDragToScroll","catchDelete","libraryPane","themes","applyTheme","themeClasses","getTheme","isTheme","initialTheme","defaultPrefs","TPLink","rel","FooterLinks","tptop","nobreak","FooterPrivacy","dataText","closeFooter","FooterClose","chevronDown","Logo","logo","alt","reload","ErrorBoundary","hasError","App","usePrefs","useTheme","scrollbar","custom","clear","Diagram","Root","setPlatform","usePlatformProvider","StrictMode","Provider","HTML5toTouch"],"mappings":"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AGJ2f,GAAS,CACTlmB,SAAU,CACN,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,GAEJuG,OAAQ,CACJ,eACA,eACA,eACA,eACA,eACA,eACA,eACA,eACA,eACA,eACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,eACA,eACA,eACA,eACA,eACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,WAGJwf,GAAW,CACX/lB,SAAU,CACN,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,GACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,GAEJuG,OAAQ,CACJ,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,WAGJ8vB,GAAwB,SAAUxhC,EAAOmQ,EAAK+E,EAAKusB,EAASC,EAAUC,GACtE,OAAI3hC,EAAQmQ,GAAOnQ,EAAQkV,EAChB0sB,GAAkB5hC,EAAO0hC,EAAUC,EAAOviC,OAAS,GAEtDqiC,EAAQt2B,SAASkX,QAAO,SAAUwf,EAAQC,EAAS7+B,GACvD,KAAOjD,GAAS8hC,GACZ9hC,GAAS8hC,EACTD,GAAUJ,EAAQ/vB,OAAOzO,GAE7B,OAAO4+B,IACR,IAAMF,GAETI,GAAuC,SAAU/hC,EAAOgiC,EAAsBC,EAAWC,GACzF,IAAIL,EAAS,GACb,GACSI,GACDjiC,IAEJ6hC,EAASK,EAASliC,GAAS6hC,EAC3B7hC,GAASgiC,QACJhiC,EAAQgiC,GAAwBA,GACzC,OAAOH,GAEPM,GAA8B,SAAUniC,EAAOoiC,EAAqBC,EAAmBJ,EAAWN,GAClG,IAAIK,EAAuBK,EAAoBD,EAAsB,EACrE,OAASpiC,EAAQ,EAAI,IAAM,KACtB+hC,GAAqC36B,KAAKqa,IAAIzhB,GAAQgiC,EAAsBC,GAAW,SAAU/+B,GAC9F,OAAOL,EAAcuE,KAAKk7B,MAAMp/B,EAAY8+B,GAAwBI,MAEpET,IAERY,GAAgC,SAAUviC,EAAOyhC,EAASE,QAC3C,IAAXA,IAAqBA,EAAS,MAClC,IAAIK,EAAuBP,EAAQriC,OACnC,OAAQ2iC,GAAqC36B,KAAKqa,IAAIzhB,GAAQgiC,GAAsB,GAAO,SAAU9+B,GAAa,OAAOu+B,EAAQr6B,KAAKk7B,MAAMp/B,EAAY8+B,OAA6BL,GAMrLa,GAAmB,SAAUxiC,EAAOyiC,EAASC,EAAaC,EAAchB,EAAQ9zB,GAChF,GAAI7N,GAAS,MAAQA,EAAQ,KACzB,OAAO4hC,GAAkB5hC,EAAOyvB,GAAgBS,YAAayR,EAAOviC,OAAS,GAEjF,IAAIwjC,EAAMx7B,KAAKqa,IAAIzhB,GACf6hC,EAASF,EACb,GAAY,IAARiB,EACA,OAAOH,EAAQ,GAAKZ,EAExB,IAAK,IAAIxyB,EAAQ,EAAGuzB,EAAM,GAAKvzB,GAAS,EAAGA,IAAS,CAChD,IAAIwzB,EAAcD,EAAM,GACJ,IAAhBC,GAAqBhL,GAAShqB,EAf1B,IAe0D,KAAXg0B,EACnDA,EAASY,EAAQI,GAAehB,EAE3BgB,EAAc,GACF,IAAhBA,GAA+B,IAAVxzB,GACL,IAAhBwzB,GAA+B,IAAVxzB,GAAewoB,GAAShqB,EAnB/B,IAoBE,IAAhBg1B,GAA+B,IAAVxzB,GAAewoB,GAAShqB,EAnB1B,IAmB+D7N,EAAQ,KAC1E,IAAhB6iC,GAAqBxzB,EAAQ,GAAKwoB,GAAShqB,EAnBzB,GAoBnBg0B,EAASY,EAAQI,IAAgBxzB,EAAQ,EAAIqzB,EAAYrzB,EAAQ,GAAK,IAAMwyB,EAEvD,IAAhBgB,GAAqBxzB,EAAQ,IAClCwyB,EAASa,EAAYrzB,EAAQ,GAAKwyB,GAEtCe,EAAMx7B,KAAKk7B,MAAMM,EAAM,IAE3B,OAAQ5iC,EAAQ,EAAI2iC,EAAe,IAAMd,GAMzCD,GAAoB,SAAU5hC,EAAOuI,EAAMu6B,GAC3C,IAAIC,EAAgBD,EAAe,KAAO,GACtCE,EAAYF,EAAe,SAAM,GACjCG,EAAeH,EAAe,KAAO,GACrCI,EAAcJ,EAAe,IAAM,GACvC,OAAQv6B,GACJ,KAAKknB,GAAgBM,KACjB,MAAO,SAAMmT,EACjB,KAAKzT,GAAgBvE,OACjB,MAAO,SAAMgY,EACjB,KAAKzT,GAAgBO,OACjB,MAAO,SAAMkT,EACjB,KAAKzT,GAAgBU,qBACjB,IAAI0R,EAASM,GAA4BniC,EAAO,GAAI,IAAI,EAAM+iC,GAC9D,OAAOlB,EAAOziC,OAAS,EAAI,IAAMyiC,EAASA,EAC9C,KAAKpS,GAAgBS,YACjB,OAAOqS,GAA8BviC,EAAO,+DAAcgjC,GAC9D,KAAKvT,GAAgBW,YACjB,OAAOoR,GAAsBxhC,EAAO,EAAG,KAAMuhC,GAAa9R,GAAgBQ,QAAS8S,GAAevzB,cACtG,KAAKigB,GAAgBY,YACjB,OAAOmR,GAAsBxhC,EAAO,EAAG,KAAMuhC,GAAa9R,GAAgBQ,QAAS8S,GACvF,KAAKtT,GAAgBa,YACjB,OAAO6R,GAA4BniC,EAAO,IAAK,KAAK,EAAO+iC,GAC/D,KAAKtT,GAAgBc,YACjB,OAAO4R,GAA4BniC,EAAO,GAAI,KAAK,EAAO+iC,GAC9D,KAAKtT,GAAgBe,YACjB,OAAO2R,GAA4BniC,EAAO,GAAI,IAAI,EAAO+iC,GAC7D,KAAKtT,GAAgBgB,aACjB,OAAO0R,GAA4BniC,EAAO,KAAM,MAAM,EAAM+iC,GAChE,KAAKtT,GAAgBiB,SACrB,KAAKjB,GAAgBuD,eACjB,OAAOwO,GAAsBxhC,EAAO,EAAG,KAAM0wB,GAAUjB,GAAgBQ,QAAS8S,GACpF,KAAKtT,GAAgByC,eACjB,OAAOsP,GAAsBxhC,EAAO,EAAG,KAAM0wB,GAAUjB,GAAgBQ,QAAS8S,GAAevzB,cACnG,KAAKigB,GAAgBkB,QACjB,OAAOwR,GAA4BniC,EAAO,KAAM,MAAM,EAAM+iC,GAChE,KAAKtT,GAAgBmB,UACrB,KAAKnB,GAAgBoC,MACjB,OAAOsQ,GAA4BniC,EAAO,KAAM,MAAM,EAAM+iC,GAChE,KAAKtT,GAAgBoB,mBACjB,OAAO0R,GAA8BviC,EAAO,2EAAgBgjC,GAChE,KAAKvT,GAAgBqB,kBACjB,OAAOyR,GAA8BviC,EAAO,+DAAcgjC,GAC9D,KAAKvT,GAAgBsB,gBACrB,KAAKtB,GAAgBsD,sBACjB,OAAOyP,GAAiBxiC,EAAO,+DAjDR,2BAiDoD,SAAKgjC,EAAWG,IAC/F,KAAK1T,GAAgBqD,oBACjB,OAAO0P,GAAiBxiC,EAAO,+DAlDV,2BAkDoD,SAAKgjC,EAAWI,IAC7F,KAAK3T,GAAgBgD,sBACjB,OAAO+P,GAAiBxiC,EAAO,+DArDR,2BAqDoD,SAAKgjC,EAAWG,IAC/F,KAAK1T,GAAgB+C,oBACjB,OAAOgQ,GAAiBxiC,EAAO,+DAtDV,2BAsDoD,SAAKgjC,EAAWI,IAC7F,KAAK3T,GAAgBgC,kBACjB,OAAO+Q,GAAiBxiC,EAAO,+DAAc,2BAvDjC,2BAuD4DgjC,EAAW,GACvF,KAAKvT,GAAgB+B,gBACjB,OAAOgR,GAAiBxiC,EAAO,+DAAc,2BAzDjC,2BAyD4DgjC,EAAWI,GACvF,KAAK3T,GAAgBqC,qBACjB,OAAO0Q,GAAiBxiC,EAAO,+DAAc,2BA1DnC,2BA0D4DijC,EAAcG,GACxF,KAAK3T,GAAgBuC,sBACjB,OAAOwQ,GAAiBxiC,EAAO,+DAAc,2BA5DnC,2BA4D4DijC,EAAc,GACxF,KAAKxT,GAAgBsC,oBACjB,OAAOyQ,GAAiBxiC,EAAO,+DAAc,qBA9DnC,2BA8D2DijC,EAAcG,GACvF,KAAK3T,GAAgBuB,WACjB,OAAOmR,GAA4BniC,EAAO,KAAO,MAAO,EAAM+iC,GAClE,KAAKtT,GAAgByB,SACjB,OAAOsQ,GAAsBxhC,EAAO,EAAG,MAAOkxB,GAAUzB,GAAgBQ,QAAS8S,GACrF,KAAKtT,GAAgB0B,SACjB,OAAOgR,GAA4BniC,EAAO,KAAO,MAAO,EAAM+iC,GAClE,KAAKtT,GAAgB2B,SACjB,OAAO+Q,GAA4BniC,EAAO,KAAO,MAAO,EAAM+iC,GAClE,KAAKtT,GAAgB4B,OACjB,OAAOmQ,GAAsBxhC,EAAO,EAAG,MAAOqxB,GAAQ5B,GAAgBQ,QAAS8S,GACnF,KAAKtT,GAAgB6B,SACjB,OAAOiR,GAA8BviC,EAAO,oSAChD,KAAKyvB,GAAgB8B,eACjB,OAAOgR,GAA8BviC,EAAO,8RAChD,KAAKyvB,GAAgBiC,QACjB,OAAOyQ,GAA4BniC,EAAO,KAAO,MAAO,EAAM+iC,GAClE,KAAKtT,GAAgBkC,SACjB,OAAO4Q,GAA8BviC,EAAO,mSAAoDgjC,GACpG,KAAKvT,GAAgBmC,eACjB,OAAO2Q,GAA8BviC,EAAO,6RAAmDgjC,GACnG,KAAKvT,GAAgBwC,IACjB,OAAOkQ,GAA4BniC,EAAO,KAAO,MAAO,EAAM+iC,GAClE,KAAKtT,GAAgB2C,UACjB,OAAO+P,GAA4BniC,EAAO,KAAQ,MAAQ,EAAM+iC,GACpE,KAAKtT,GAAgB4C,QACjB,OAAO8P,GAA4BniC,EAAO,KAAQ,MAAQ,EAAM+iC,GACpE,KAAKtT,GAAgB6C,MACjB,OAAO6P,GAA4BniC,EAAO,KAAO,MAAO,EAAM+iC,GAClE,KAAKtT,GAAgB8C,QACjB,OAAO4P,GAA4BniC,EAAO,KAAO,MAAO,EAAM+iC,GAClE,KAAKtT,GAAgBiD,MACjB,OAAOyP,GAA4BniC,EAAO,KAAO,MAAO,EAAM+iC,GAClE,KAAKtT,GAAgBkD,OACjB,OAAOwP,GAA4BniC,EAAO,KAAO,MAAO,EAAM+iC,GAClE,KAAKtT,GAAgBmD,KACjB,OAAOuP,GAA4BniC,EAAO,KAAO,MAAO,EAAM+iC,GAClE,KAAKtT,GAAgBoD,QACjB,OAAOsP,GAA4BniC,EAAO,KAAO,MAAO,EAAM+iC,GAClE,KAAKtT,GAAgBQ,QACrB,QACI,OAAOkS,GAA4BniC,EAAO,GAAI,IAAI,EAAM+iC,KAKhEM,GAAgC,WAChC,SAASA,EAAejJ,EAASnxB,GAM7B,GALAxK,KAAKwK,QAAUA,EACfxK,KAAK6kC,iBAAmB,GACxB7kC,KAAK8kC,iBAAmBnJ,EACxB37B,KAAKwiC,SAAW,IAAID,GACpBviC,KAAK+kC,WAAa,GACbpJ,EAAQU,cACT,MAAM,IAAIjoB,MAAM,kDAEpBpU,KAAKmgC,gBAAkBngC,KAAKu8B,UAAUZ,EAAQU,cAAc8D,iBA+UhE,OA7UAyE,EAAe1kC,UAAU8kC,SAAW,SAAU3I,EAAe4I,GACzD,IAAIxa,EAAQzqB,KACRigC,EAASiF,GAAsB7I,EAAe4I,GAClD,IAAKhF,EAAOC,cACR,OAAO/+B,QAAQE,OAAO,gCAE1B,IAAI8jC,EAAU9I,EAAc+I,YAAYC,YACpCC,EAAUjJ,EAAc+I,YAAYG,YACpCC,EAAcvF,EAAOC,cACrBuF,EAAgBD,EAAY5gB,SAI5B8gB,EAAaC,GAAa1F,GAAQn+B,MAAK,WAAc,OAAOhB,EAAU2pB,OAAO,OAAQ,GAAQ,WAC7F,IAAImb,EACJ,OAAO7jC,EAAY/B,MAAM,SAAU2K,GAC/B,OAAQA,EAAGtI,OACP,KAAK,EAYD,OAXArC,KAAK6kC,iBAAiB/5B,QAAQ+6B,IAC1BL,IACAA,EAAYM,SAASb,EAAW5hC,KAAM4hC,EAAW3hC,MAC7C,sBAAsB+oB,KAAK0Z,UAAUC,YACpCR,EAAYF,UAAYL,EAAW3hC,KAAOkiC,EAAYL,UAAYF,EAAW5hC,OAC9EoiC,EAActF,gBAAgBna,MAAM1iB,KAAO2hC,EAAW3hC,IAAM,KAC5DmiC,EAActF,gBAAgBna,MAAM3iB,MAAQ4hC,EAAW5hC,KAAO,KAC9DoiC,EAActF,gBAAgBna,MAAM2G,SAAW,aAGvDiZ,EAAU5lC,KAAKwK,QAAQo7B,QACoB,qBAAhC5lC,KAAKimC,uBACL,CAAC,EAAc9kC,QAAQE,OAAO,qBAAuBrB,KAAK8kC,iBAAiBoB,SAAW,4BAE3FT,EAAcU,OAASV,EAAcU,MAAMC,MAC1C,CAAC,EAAaX,EAAcU,MAAMC,OADuB,CAAC,EAAa,GAElF,KAAK,EACDz7B,EAAGrI,OACHqI,EAAGtI,MAAQ,EACf,KAAK,EACD,MAAuB,oBAAZujC,EACA,CAAC,EAAczkC,QAAQC,UACrBU,MAAK,WAAc,OAAO8jC,EAAQH,MAClC3jC,MAAK,WAAc,OAAOm+B,MAEhC,CAAC,EAAcA,aAUtC,OANAwF,EAAc5c,OACd4c,EAAc92B,MAAM03B,GAAiBzhB,SAAS0hB,SAAW,iBAEzDC,GAAmBvmC,KAAK8kC,iBAAiBzI,cAAe8I,EAASG,GACjEG,EAAchJ,aAAagJ,EAAce,UAAUxmC,KAAKmgC,iBAAkBsF,EAActF,iBACxFsF,EAAcxL,QACPyL,GAEXd,EAAe1kC,UAAUumC,mBAAqB,SAAU5iC,GACpD,GAAI88B,GAAgB98B,GAChB,OAAO7D,KAAK0mC,kBAAkB7iC,GAOlC,GAAIw+B,GAAex+B,GACf,OAAO7D,KAAK2mC,iBAAiB9iC,GAEjC,IAAI+iC,EAAQ/iC,EAAK04B,WAAU,GAM3B,OAJImE,GAAekG,IAA4B,SAAlBA,EAAMC,UAE/BD,EAAMC,QAAU,SAEbD,GAEXhC,EAAe1kC,UAAUymC,iBAAmB,SAAU9iC,GAClD,IACI,IAAIijC,EAAQjjC,EAAKijC,MACjB,GAAIA,GAASA,EAAMC,SAAU,CACzB,IAAIC,EAAM,GAAG7hC,MAAMvE,KAAKkmC,EAAMC,SAAU,GAAGnjB,QAAO,SAAUojB,EAAKC,GAC7D,OAAIA,GAAgC,kBAAjBA,EAAKC,QACbF,EAAMC,EAAKC,QAEfF,IACR,IACChhB,EAAQniB,EAAK04B,WAAU,GAE3B,OADAvW,EAAMmhB,YAAcH,EACbhhB,GAGf,MAAOtkB,GAGH,GADAkmB,GAAOW,YAAYvoB,KAAKwK,QAAQqd,IAAIY,MAAM,qCAAsC/mB,GACjE,kBAAXA,EAAE8R,KACF,MAAM9R,EAGd,OAAOmC,EAAK04B,WAAU,IAE1BqI,EAAe1kC,UAAUwmC,kBAAoB,SAAUjgB,GACnD,GAAIzmB,KAAKwK,QAAQ48B,cAAgB3gB,EAAO4V,cAAe,CACnD,IAAIlX,EAAMsB,EAAO4V,cAActW,cAAc,OAC7C,IAEI,OADAZ,EAAII,IAAMkB,EAAOI,YACV1B,EAEX,MAAOzjB,GACHkmB,GAAOW,YAAYvoB,KAAKwK,QAAQqd,IAAIO,KAAK,uDAGjD,IAAIif,EAAe5gB,EAAO8V,WAAU,GACpC,IACI8K,EAAa9jC,MAAQkjB,EAAOljB,MAC5B8jC,EAAa7jC,OAASijB,EAAOjjB,OAC7B,IAAIkjB,EAAMD,EAAOE,WAAW,MACxB2gB,EAAYD,EAAa1gB,WAAW,MASxC,OARI2gB,IACI5gB,EACA4gB,EAAUC,aAAa7gB,EAAIW,aAAa,EAAG,EAAGZ,EAAOljB,MAAOkjB,EAAOjjB,QAAS,EAAG,GAG/E8jC,EAAU1gB,UAAUH,EAAQ,EAAG,IAGhC4gB,EAEX,MAAO3lC,IACP,OAAO2lC,GA+DXzC,EAAe1kC,UAAUq8B,UAAY,SAAU14B,GAC3C,GAAI49B,GAAW59B,GACX,OAAO+gB,SAAS4iB,eAAe3jC,EAAK6B,MAExC,IAAK7B,EAAKw4B,cACN,OAAOx4B,EAAK04B,WAAU,GAE1B,IAAIvV,EAASnjB,EAAKw4B,cAAc+I,YAChC,GAAIpe,GAAU0a,GAAc79B,KAAUm4B,GAAkBn4B,IAASs+B,GAAiBt+B,IAAQ,CACtF,IAAI+iC,EAAQ5mC,KAAKymC,mBAAmB5iC,GAChCmiB,EAAQgB,EAAO6U,iBAAiBh4B,GAChC4jC,EAAczgB,EAAO6U,iBAAiBh4B,EAAM,WAC5C6jC,EAAa1gB,EAAO6U,iBAAiBh4B,EAAM,UAC3C7D,KAAK8kC,mBAAqBjhC,GAAQm4B,GAAkB4K,KACpD5mC,KAAKimC,uBAAyBW,GAE9B9E,GAAc8E,IACde,GAAuBf,GAI3B,IAFA,IAAIpE,EAAWxiC,KAAKwiC,SAASthB,MAAM,IAAIma,GAA4BrV,IAC/D5b,EAASpK,KAAK4nC,qBAAqB/jC,EAAM+iC,EAAOa,EAAazO,GAAkB6O,QAC1EC,EAAQjkC,EAAK64B,WAAYoL,EAAOA,EAAQA,EAAMtG,YAC9CE,GAAcoG,KACbxF,GAAgBwF,IACbA,EAAMC,aAnOR,4BAoOyC,oBAAhC/nC,KAAKwK,QAAQw9B,gBAAkChoC,KAAKwK,QAAQw9B,eAAeF,KAClF9nC,KAAKwK,QAAQy9B,YAAevG,GAAcoG,IAAWzF,GAAeyF,IACrElB,EAAM3hB,YAAYjlB,KAAKu8B,UAAUuL,IAIzC19B,GACAw8B,EAAMsB,aAAa99B,EAAQw8B,EAAMlK,YAErC,IAAIyL,EAAQnoC,KAAK4nC,qBAAqB/jC,EAAM+iC,EAAOc,EAAY1O,GAAkBoP,OAgBjF,OAfID,GACAvB,EAAM3hB,YAAYkjB,GAEtBnoC,KAAKwiC,SAASz/B,IAAIy/B,GACdxc,IAAUhmB,KAAKwK,QAAQy9B,YAAc9F,GAAiBt+B,MAAWq9B,GAAgBr9B,IACjFwkC,GAAcriB,EAAO4gB,GAGF,IAAnB/iC,EAAKykC,WAAuC,IAApBzkC,EAAK0kC,YAC7BvoC,KAAK6kC,iBAAiB7hC,KAAK,CAAC4jC,EAAO/iC,EAAK0kC,WAAY1kC,EAAKykC,aAExDrH,GAAkBp9B,IAASm9B,GAAgBn9B,MAC3Co9B,GAAkB2F,IAAU5F,GAAgB4F,MAC7CA,EAAMrlC,MAAQsC,EAAKtC,OAEhBqlC,EAEX,OAAO/iC,EAAK04B,WAAU,IAE1BqI,EAAe1kC,UAAU0nC,qBAAuB,SAAU/jC,EAAM+iC,EAAO5gB,EAAOwiB,GAC1E,IAAI/d,EAAQzqB,KACZ,GAAKgmB,EAAL,CAGA,IAAIzkB,EAAQykB,EAAMqT,QACdzU,EAAWgiB,EAAMvK,cACrB,GAAKzX,GAAarjB,GAAmB,SAAVA,GAA8B,qBAAVA,GAAkD,SAAlBykB,EAAME,QAArF,CAGAlmB,KAAKwiC,SAASthB,MAAM,IAAIma,GAA4BrV,IACpD,IAAIyU,EAAc,IAAIW,GAA2BpV,GAC7CyiB,EAA2B7jB,EAASmB,cAAc,4BACtDsiB,GAAcriB,EAAOyiB,GACrBhO,EAAYpB,QAAQvuB,SAAQ,SAAUiE,GAClC,GAAIA,EAAMjF,OAAShF,EAAUuM,aACzBo3B,EAAyBxjB,YAAYL,EAAS4iB,eAAez4B,EAAMxN,aAElE,GAAIwN,EAAMjF,OAAShF,EAAUqM,UAAW,CACzC,IAAIgU,EAAMP,EAASmB,cAAc,OACjCZ,EAAII,IAAMxW,EAAMxN,MAChB4jB,EAAIa,MAAMsS,QAAU,IACpBmQ,EAAyBxjB,YAAYE,QAEpC,GAAIpW,EAAMjF,OAAShF,EAAU2O,UAC9B,GAAmB,SAAf1E,EAAMyE,KAAiB,CACvB,IAAIk1B,EAAO35B,EAAMkE,OAAOkC,OAAOvB,IAC3B80B,EAAK/nC,QACL8nC,EAAyBxjB,YAAYL,EAAS4iB,eAAe3jC,EAAK8kC,aAAaD,EAAK,GAAGnnC,QAAU,UAGpG,GAAmB,YAAfwN,EAAMyE,KAAoB,CAC/B,IAAI7I,EAAKoE,EAAMkE,OAAOkC,OAAOnB,IAA0BylB,EAAU9uB,EAAG,GAAIi+B,EAAej+B,EAAG,GAC1F,GAAI8uB,GAAW7lB,GAAa6lB,GAAU,CAClC,IAAIoP,EAAepe,EAAM+X,SAASC,gBAAgBhJ,EAAQl4B,OACtDunC,EAAcF,GAAgBh1B,GAAag1B,GACzCvX,GAAcnQ,MAAM0nB,EAAarnC,OACjCyvB,GAAgBQ,QACtBiX,EAAyBxjB,YAAYL,EAAS4iB,eAAerE,GAAkB0F,EAAcC,GAAa,WAG7G,GAAmB,aAAf/5B,EAAMyE,KAAqB,CAChC,IAAImD,EAAK5H,EAAMkE,OAAOkC,OAAOnB,IAA2C+0B,GAAjBtP,EAAU9iB,EAAG,GAAYA,EAAG,IACnF,GADuFiyB,EAAejyB,EAAG,GACrG8iB,GAAW7lB,GAAa6lB,GAAU,CAClC,IAAIuP,EAAgBve,EAAM+X,SAASE,iBAAiBjJ,EAAQl4B,OACxD0nC,EAAgBL,GAAgBh1B,GAAag1B,GAC3CvX,GAAcnQ,MAAM0nB,EAAarnC,OACjCyvB,GAAgBQ,QAClB0X,EAAYH,GAASA,EAAMj/B,OAAShF,EAAUuM,aAAe03B,EAAMxnC,MAAQ,GAC3E46B,EAAO6M,EACN99B,KAAI,SAAU3J,GAAS,OAAO4hC,GAAkB5hC,EAAO0nC,GAAe,MACtE5zB,KAAK6zB,GACVT,EAAyBxjB,YAAYL,EAAS4iB,eAAerL,WAIpE,GAAIptB,EAAMjF,OAAShF,EAAUoM,YAC9B,OAAQnC,EAAMxN,OACV,IAAK,aACDknC,EAAyBxjB,YAAYL,EAAS4iB,eAAetN,GAASO,EAAYX,OAAQrP,EAAMsa,cAAc,KAC9G,MACJ,IAAK,cACD0D,EAAyBxjB,YAAYL,EAAS4iB,eAAetN,GAASO,EAAYX,SAAUrP,EAAMsa,YAAY,KAC9G,MACJ,QAEI0D,EAAyBxjB,YAAYL,EAAS4iB,eAAez4B,EAAMxN,YAInFknC,EAAyBrG,UAAY+G,GAAmC,IAAMC,GAC9E,IAAIC,EAAeb,IAAcxP,GAAkB6O,OAC7C,IAAMsB,GACN,IAAMC,GAOZ,OANIjH,GAAiByE,GACjBA,EAAMxE,UAAUkH,WAAaD,EAG7BzC,EAAMxE,WAAaiH,EAEhBZ,KAEX7D,EAAetc,QAAU,SAAU6Y,GAC/B,QAAIA,EAAU3E,aACV2E,EAAU3E,WAAWlW,YAAY6a,IAC1B,IAIRyD,EAzVyB,IA4VpC,SAAW5L,GACPA,EAAkBA,EAAiB,OAAa,GAAK,SACrDA,EAAkBA,EAAiB,MAAY,GAAK,QAFxD,CAGGA,KAAsBA,GAAoB,KAC7C,IA8FIuQ,GA9FArE,GAAwB,SAAU7I,EAAeJ,GACjD,IAAIuN,EAAuBnN,EAActW,cAAc,UAYvD,OAXAyjB,EAAqBpH,UAAY,wBACjCoH,EAAqBxjB,MAAM8R,WAAa,SACxC0R,EAAqBxjB,MAAM2G,SAAW,QACtC6c,EAAqBxjB,MAAM3iB,KAAO,WAClCmmC,EAAqBxjB,MAAM1iB,IAAM,MACjCkmC,EAAqBxjB,MAAMyjB,OAAS,IACpCD,EAAqBjmC,MAAQ04B,EAAO14B,MAAMyhB,WAC1CwkB,EAAqBhmC,OAASy4B,EAAOz4B,OAAOwhB,WAC5CwkB,EAAqBE,UAAY,KACjCF,EAAqBG,aA5WF,0BA4WiC,QACpDtN,EAAcr6B,KAAKijB,YAAYukB,GACxBA,GAEP7D,GAAe,SAAU1F,GACzB,OAAO,IAAI9+B,SAAQ,SAAUC,EAASC,GAClC,IAAImkC,EAAcvF,EAAOC,cACzB,IAAKsF,EACD,OAAOnkC,EAAO,iCAElB,IAAIokC,EAAgBD,EAAY5gB,SAChC4gB,EAAYngB,OAAS4a,EAAO5a,OAASogB,EAAcmE,mBAAqB,WACpEpE,EAAYngB,OAAS4a,EAAO5a,OAASogB,EAAcmE,mBAAqB,KACxE,IAAIC,EAAWC,aAAY,WACnBrE,EAAczjC,KAAK+nC,WAAWppC,OAAS,GAAkC,aAA7B8kC,EAAcuE,aAC1DC,cAAcJ,GACdzoC,EAAQ6+B,MAEb,SAIXoI,GAAgB,SAAUriB,EAAOkkB,GAGjC,IAFA,IAES1pC,EAAIwlB,EAAMrlB,OAAS,EAAGH,GAAK,EAAGA,IAAK,CACxC,IAAI2pC,EAAWnkB,EAAMokB,KAAK5pC,GAET,YAAb2pC,GACAD,EAAOlkB,MAAMqkB,YAAYF,EAAUnkB,EAAMskB,iBAAiBH,KAjzKzD,SAACnkB,EAAOkkB,GACjB,CACI,OACA,SACA,eACA,kBACA,aACA,gBACFp/B,SAAQ,SAACwf,GACP4f,EAAOlkB,MAAMqkB,YAAY/f,EAAKtE,EAAMskB,iBAAiBhgB,OA2yKzDigB,CAAKvkB,EAAOkkB,IAEZ7D,GAAmB,SAAUC,GAC7B,IAAItiC,EAAM,GAiBV,OAhBIsiC,IACAtiC,GAAO,aACHsiC,EAAQ9yB,OACRxP,GAAOsiC,EAAQ9yB,MAEf8yB,EAAQkE,iBACRxmC,GAAOsiC,EAAQkE,gBAEflE,EAAQmE,WACRzmC,GAAO,IAAOsiC,EAAQmE,SAAW,KAEjCnE,EAAQoE,WACR1mC,GAAO,IAAOsiC,EAAQoE,SAAW,KAErC1mC,GAAO,KAEJA,GAEPuiC,GAAqB,SAAUlK,EAAen5B,EAAGhB,GAC7Cm6B,GACAA,EAAc+I,cACbliC,IAAMm5B,EAAc+I,YAAYC,aAAenjC,IAAMm6B,EAAc+I,YAAYG,cAChFlJ,EAAc+I,YAAYU,SAAS5iC,EAAGhB,IAG1C2jC,GAAoB,SAAUl7B,GAC9B,IAAIgxB,EAAUhxB,EAAG,GAAIzH,EAAIyH,EAAG,GAAIzI,EAAIyI,EAAG,GACvCgxB,EAAQ4M,WAAarlC,EACrBy4B,EAAQ2M,UAAYpmC,GAIpBinC,GAAmC,wCACnCC,GAAkC,uCAElCzB,GAAyB,SAAU3lC,GACnC2oC,GAAa3oC,EAAM,IAAMmnC,GAAN,sFAAsGC,GAAtG,2EAEnBuB,GAAe,SAAU3oC,EAAM45B,GAC/B,IAAIhX,EAAW5iB,EAAKq6B,cACpB,GAAIzX,EAAU,CACV,IAAIoB,EAAQpB,EAASmB,cAAc,SACnCC,EAAMmhB,YAAcvL,EACpB55B,EAAKijB,YAAYe,MAKzB,SAAWujB,GACPA,EAASA,EAAQ,OAAa,GAAK,SACnCA,EAASA,EAAQ,aAAmB,GAAK,eAF7C,CAGGA,KAAaA,GAAW,KAC3B,IAuJIqB,GAvJAC,GAAY,SAAUthC,EAAGhK,GACzB,OAAIgK,EAAE5I,SAAWpB,EAAEoB,QACR4I,EAAEuhC,MAAK,SAAUloC,EAAGpC,GAAK,OAAOoC,IAAMrD,EAAEiB,OAoBnDuqC,GAAwB,WACxB,SAASA,EAAO7nC,EAAGhB,GACflC,KAAK8J,KAAOy/B,GAASyB,OACrBhrC,KAAKkD,EAAIA,EACTlD,KAAKkC,EAAIA,EAKb,OAHA6oC,EAAO7qC,UAAUuD,IAAM,SAAUwnC,EAAQC,GACrC,OAAO,IAAIH,EAAO/qC,KAAKkD,EAAI+nC,EAAQjrC,KAAKkC,EAAIgpC,IAEzCH,EATiB,GAYxBI,GAAO,SAAU5hC,EAAGhK,EAAGe,GACvB,OAAO,IAAIyqC,GAAOxhC,EAAErG,GAAK3D,EAAE2D,EAAIqG,EAAErG,GAAK5C,EAAGiJ,EAAErH,GAAK3C,EAAE2C,EAAIqH,EAAErH,GAAK5B,IAE7D8qC,GAA6B,WAC7B,SAASA,EAAYnmC,EAAOomC,EAAcC,EAAYpmC,GAClDlF,KAAK8J,KAAOy/B,GAASgC,aACrBvrC,KAAKiF,MAAQA,EACbjF,KAAKqrC,aAAeA,EACpBrrC,KAAKsrC,WAAaA,EAClBtrC,KAAKkF,IAAMA,EAiBf,OAfAkmC,EAAYlrC,UAAUsrC,UAAY,SAAUlrC,EAAGmrC,GAC3C,IAAIC,EAAKP,GAAKnrC,KAAKiF,MAAOjF,KAAKqrC,aAAc/qC,GACzCqrC,EAAKR,GAAKnrC,KAAKqrC,aAAcrrC,KAAKsrC,WAAYhrC,GAC9CsrC,EAAKT,GAAKnrC,KAAKsrC,WAAYtrC,KAAKkF,IAAK5E,GACrCurC,EAAOV,GAAKO,EAAIC,EAAIrrC,GACpBwrC,EAAOX,GAAKQ,EAAIC,EAAItrC,GACpByrC,EAAOZ,GAAKU,EAAMC,EAAMxrC,GAC5B,OAAOmrC,EAAY,IAAIL,EAAYprC,KAAKiF,MAAOymC,EAAIG,EAAME,GAAQ,IAAIX,EAAYW,EAAMD,EAAMF,EAAI5rC,KAAKkF,MAE1GkmC,EAAYlrC,UAAUuD,IAAM,SAAUwnC,EAAQC,GAC1C,OAAO,IAAIE,EAAYprC,KAAKiF,MAAMxB,IAAIwnC,EAAQC,GAASlrC,KAAKqrC,aAAa5nC,IAAIwnC,EAAQC,GAASlrC,KAAKsrC,WAAW7nC,IAAIwnC,EAAQC,GAASlrC,KAAKkF,IAAIzB,IAAIwnC,EAAQC,KAE5JE,EAAYlrC,UAAU8rC,QAAU,WAC5B,OAAO,IAAIZ,EAAYprC,KAAKkF,IAAKlF,KAAKsrC,WAAYtrC,KAAKqrC,aAAcrrC,KAAKiF,QAEvEmmC,EAvBsB,GAyB7Ba,GAAgB,SAAUC,GAAQ,OAAOA,EAAKpiC,OAASy/B,GAASgC,cAEhEY,GACA,SAAqBxQ,GACjB,IAAIC,EAASD,EAAQC,OACjBK,EAASN,EAAQM,OACjBtxB,EAAKgK,GAAyBinB,EAAO9M,oBAAqBmN,EAAO14B,MAAO04B,EAAOz4B,QAAS4oC,EAAMzhC,EAAG,GAAI0hC,EAAM1hC,EAAG,GAC9GgM,EAAKhC,GAAyBinB,EAAO7M,qBAAsBkN,EAAO14B,MAAO04B,EAAOz4B,QAAS8oC,EAAM31B,EAAG,GAAI41B,EAAM51B,EAAG,GAC/G61B,EAAK73B,GAAyBinB,EAAO5M,wBAAyBiN,EAAO14B,MAAO04B,EAAOz4B,QAASipC,EAAMD,EAAG,GAAIE,EAAMF,EAAG,GAClHG,EAAKh4B,GAAyBinB,EAAO3M,uBAAwBgN,EAAO14B,MAAO04B,EAAOz4B,QAASopC,EAAMD,EAAG,GAAIE,EAAMF,EAAG,GACjHG,EAAU,GACdA,EAAQ9pC,MAAMopC,EAAME,GAAOrQ,EAAO14B,OAClCupC,EAAQ9pC,MAAM4pC,EAAMH,GAAOxQ,EAAO14B,OAClCupC,EAAQ9pC,MAAMqpC,EAAMQ,GAAO5Q,EAAOz4B,QAClCspC,EAAQ9pC,MAAMupC,EAAMG,GAAOzQ,EAAOz4B,QAClC,IAAIupC,EAAYpkC,KAAK8N,IAAI5V,MAAM8H,KAAMmkC,GACjCC,EAAY,IACZX,GAAOW,EACPV,GAAOU,EACPT,GAAOS,EACPR,GAAOQ,EACPN,GAAOM,EACPL,GAAOK,EACPH,GAAOG,EACPF,GAAOE,GAEX,IAAIC,EAAW/Q,EAAO14B,MAAQ+oC,EAC1BW,EAAchR,EAAOz4B,OAASkpC,EAC9BQ,EAAcjR,EAAO14B,MAAQkpC,EAC7BU,EAAalR,EAAOz4B,OAASqpC,EAC7Bhd,EAAiB+L,EAAO/L,eACxBC,EAAmB8L,EAAO9L,iBAC1BC,EAAoB6L,EAAO7L,kBAC3BC,EAAkB4L,EAAO5L,gBACzByF,EAAa5gB,GAAiB+mB,EAAOnG,WAAYkG,EAAQM,OAAO14B,OAChEmyB,EAAe7gB,GAAiB+mB,EAAOlG,aAAciG,EAAQM,OAAO14B,OACpEoyB,EAAgB9gB,GAAiB+mB,EAAOjG,cAAegG,EAAQM,OAAO14B,OACtEqyB,EAAc/gB,GAAiB+mB,EAAOhG,YAAa+F,EAAQM,OAAO14B,OACtEvD,KAAKotC,iBACDhB,EAAM,GAAKC,EAAM,EACXgB,GAAepR,EAAO54B,KAAM44B,EAAO34B,IAAK8oC,EAAKC,EAAKzB,GAAO0C,UACzD,IAAIvC,GAAO9O,EAAO54B,KAAM44B,EAAO34B,KACzCtD,KAAKutC,kBACDjB,EAAM,GAAKC,EAAM,EACXc,GAAepR,EAAO54B,KAAO2pC,EAAU/Q,EAAO34B,IAAKgpC,EAAKC,EAAK3B,GAAO4C,WACpE,IAAIzC,GAAO9O,EAAO54B,KAAO44B,EAAO14B,MAAO04B,EAAO34B,KACxDtD,KAAKytC,qBACDhB,EAAM,GAAKC,EAAM,EACXW,GAAepR,EAAO54B,KAAO6pC,EAAajR,EAAO34B,IAAM2pC,EAAaR,EAAKC,EAAK9B,GAAO8C,cACrF,IAAI3C,GAAO9O,EAAO54B,KAAO44B,EAAO14B,MAAO04B,EAAO34B,IAAM24B,EAAOz4B,QACrExD,KAAK2tC,oBACDf,EAAM,GAAKC,EAAM,EACXQ,GAAepR,EAAO54B,KAAM44B,EAAO34B,IAAM6pC,EAAYP,EAAKC,EAAKjC,GAAOgD,aACtE,IAAI7C,GAAO9O,EAAO54B,KAAM44B,EAAO34B,IAAM24B,EAAOz4B,QACtDxD,KAAK6tC,kBACDzB,EAAM,GAAKC,EAAM,EACXgB,GAAepR,EAAO54B,KAAO2sB,EAAiBiM,EAAO34B,IAAMusB,EAAgBlnB,KAAK8N,IAAI,EAAG21B,EAAMpc,GAAkBrnB,KAAK8N,IAAI,EAAG41B,EAAMxc,GAAiB+a,GAAO0C,UACzJ,IAAIvC,GAAO9O,EAAO54B,KAAO2sB,EAAiBiM,EAAO34B,IAAMusB,GACjE7vB,KAAK8tC,mBACDxB,EAAM,GAAKC,EAAM,EACXc,GAAepR,EAAO54B,KAAOsF,KAAK+I,IAAIs7B,EAAU/Q,EAAO14B,MAAQysB,GAAkBiM,EAAO34B,IAAMusB,EAAgBmd,EAAW/Q,EAAO14B,MAAQysB,EAAkB,EAAIsc,EAAMtc,EAAiBuc,EAAM1c,EAAgB+a,GAAO4C,WAClN,IAAIzC,GAAO9O,EAAO54B,KAAO44B,EAAO14B,MAAQusB,EAAkBmM,EAAO34B,IAAMusB,GACjF7vB,KAAK+tC,sBACDtB,EAAM,GAAKC,EAAM,EACXW,GAAepR,EAAO54B,KAAOsF,KAAK+I,IAAIw7B,EAAajR,EAAO14B,MAAQysB,GAAkBiM,EAAO34B,IAAMqF,KAAK+I,IAAIu7B,EAAahR,EAAOz4B,OAASqsB,GAAiBlnB,KAAK8N,IAAI,EAAGg2B,EAAM3c,GAAmB4c,EAAM3c,EAAmB6a,GAAO8C,cAC7N,IAAI3C,GAAO9O,EAAO54B,KAAO44B,EAAO14B,MAAQusB,EAAkBmM,EAAO34B,IAAM24B,EAAOz4B,OAASusB,GACjG/vB,KAAKguC,qBACDpB,EAAM,GAAKC,EAAM,EACXQ,GAAepR,EAAO54B,KAAO2sB,EAAiBiM,EAAO34B,IAAM6pC,EAAYxkC,KAAK8N,IAAI,EAAGm2B,EAAM5c,GAAkB6c,EAAM9c,EAAmB6a,GAAOgD,aAC3I,IAAI7C,GAAO9O,EAAO54B,KAAO2sB,EAAiBiM,EAAO34B,IAAM24B,EAAOz4B,OAASusB,GACjF/vB,KAAKiuC,kBACD7B,EAAM,GAAKC,EAAM,EACXgB,GAAepR,EAAO54B,KAAO2sB,EAAkB4F,EAAaqG,EAAO34B,IAAMusB,EAAiB4F,EAAY9sB,KAAK8N,IAAI,EAAG21B,GAAOpc,EAAkB4F,IAAejtB,KAAK8N,IAAI,EAAG41B,GAAOxc,EAAiB4F,IAAcmV,GAAO0C,UACnN,IAAIvC,GAAO9O,EAAO54B,KAAO2sB,EAAkB4F,EAAaqG,EAAO34B,IAAMusB,EAAiB4F,GAChGz1B,KAAKkuC,mBACD5B,EAAM,GAAKC,EAAM,EACXc,GAAepR,EAAO54B,KAAOsF,KAAK+I,IAAIs7B,EAAU/Q,EAAO14B,MAAQysB,EAAkB4F,GAAcqG,EAAO34B,IAAMusB,EAAiB4F,EAAYuX,EAAW/Q,EAAO14B,MAAQysB,EAAkB4F,EAAc,EAAI0W,EAAMtc,EAAkB4F,EAAa2W,GAAO1c,EAAiB4F,GAAamV,GAAO4C,WACxR,IAAIzC,GAAO9O,EAAO54B,KAAO44B,EAAO14B,OAASusB,EAAmB4F,GAAeuG,EAAO34B,IAAMusB,EAAiB4F,GACnHz1B,KAAKmuC,sBACD1B,EAAM,GAAKC,EAAM,EACXW,GAAepR,EAAO54B,KAAOsF,KAAK+I,IAAIw7B,EAAajR,EAAO14B,OAASysB,EAAkB4F,IAAeqG,EAAO34B,IAAMqF,KAAK+I,IAAIu7B,EAAahR,EAAOz4B,OAASqsB,EAAiB4F,GAAa9sB,KAAK8N,IAAI,EAAGg2B,GAAO3c,EAAmB4F,IAAgBgX,GAAO3c,EAAoB4F,GAAgBiV,GAAO8C,cAC7R,IAAI3C,GAAO9O,EAAO54B,KAAO44B,EAAO14B,OAASusB,EAAmB4F,GAAeuG,EAAO34B,IAAM24B,EAAOz4B,QAAUusB,EAAoB4F,IACvI31B,KAAKouC,qBACDxB,EAAM,GAAKC,EAAM,EACXQ,GAAepR,EAAO54B,KAAO2sB,EAAkB4F,EAAaqG,EAAO34B,IAAM6pC,EAAYxkC,KAAK8N,IAAI,EAAGm2B,GAAO5c,EAAkB4F,IAAeiX,GAAO9c,EAAoB4F,GAAgBiV,GAAOgD,aAC3L,IAAI7C,GAAO9O,EAAO54B,KAAO2sB,EAAkB4F,EAAaqG,EAAO34B,IAAM24B,EAAOz4B,QAAUusB,EAAoB4F,MAK5H,SAAWiV,GACPA,EAAOA,EAAM,SAAe,GAAK,WACjCA,EAAOA,EAAM,UAAgB,GAAK,YAClCA,EAAOA,EAAM,aAAmB,GAAK,eACrCA,EAAOA,EAAM,YAAkB,GAAK,cAJxC,CAKGA,KAAWA,GAAS,KACvB,IAAIyC,GAAiB,SAAUnqC,EAAGhB,EAAGmsC,EAAIC,EAAI3hB,GACzC,IAAI4hB,GAAc5lC,KAAK8a,KAAK,GAAK,GAAK,EAA1B,EACR+qB,EAAKH,EAAKE,EACVE,EAAKH,EAAKC,EACVG,EAAKxrC,EAAImrC,EACTM,EAAKzsC,EAAIosC,EACb,OAAQ3hB,GACJ,KAAKie,GAAO0C,SACR,OAAO,IAAIlC,GAAY,IAAIL,GAAO7nC,EAAGyrC,GAAK,IAAI5D,GAAO7nC,EAAGyrC,EAAKF,GAAK,IAAI1D,GAAO2D,EAAKF,EAAItsC,GAAI,IAAI6oC,GAAO2D,EAAIxsC,IAC7G,KAAK0oC,GAAO4C,UACR,OAAO,IAAIpC,GAAY,IAAIL,GAAO7nC,EAAGhB,GAAI,IAAI6oC,GAAO7nC,EAAIsrC,EAAItsC,GAAI,IAAI6oC,GAAO2D,EAAIC,EAAKF,GAAK,IAAI1D,GAAO2D,EAAIC,IAC5G,KAAK/D,GAAO8C,aACR,OAAO,IAAItC,GAAY,IAAIL,GAAO2D,EAAIxsC,GAAI,IAAI6oC,GAAO2D,EAAIxsC,EAAIusC,GAAK,IAAI1D,GAAO7nC,EAAIsrC,EAAIG,GAAK,IAAI5D,GAAO7nC,EAAGyrC,IAC5G,KAAK/D,GAAOgD,YACZ,QACI,OAAO,IAAIxC,GAAY,IAAIL,GAAO2D,EAAIC,GAAK,IAAI5D,GAAO2D,EAAKF,EAAIG,GAAK,IAAI5D,GAAO7nC,EAAGhB,EAAIusC,GAAK,IAAI1D,GAAO7nC,EAAGhB,MAGjH0sC,GAAyB,SAAUC,GACnC,MAAO,CAACA,EAAOzB,iBAAkByB,EAAOtB,kBAAmBsB,EAAOpB,qBAAsBoB,EAAOlB,sBAU/FmB,GAA0B,SAAUD,GACpC,MAAO,CACHA,EAAOhB,kBACPgB,EAAOf,mBACPe,EAAOd,sBACPc,EAAOb,uBAIXe,GACA,SAAyBvY,EAASC,EAASU,GACvCn3B,KAAK8J,KAAO,EACZ9J,KAAKw2B,QAAUA,EACfx2B,KAAKy2B,QAAUA,EACfz2B,KAAKm3B,OAASA,EACdn3B,KAAKkqC,OAAS,GAIlB8E,GACA,SAAoB9C,EAAMhC,GACtBlqC,KAAK8J,KAAO,EACZ9J,KAAKkqC,OAASA,EACdlqC,KAAKksC,KAAOA,GAShB+C,GACA,SAAyB9N,GACrBnhC,KAAK27B,QAAUwF,EACfnhC,KAAKkvC,YAAc,GACnBlvC,KAAKmvC,eAAiB,GACtBnvC,KAAKovC,eAAiB,GACtBpvC,KAAKqvC,uCAAyC,GAC9CrvC,KAAKsvC,eAAiB,GACtBtvC,KAAKuvC,oBAAsB,GAC3BvvC,KAAKwvC,yBAA2B,IAIpCC,GAA8B,WAC9B,SAASA,EAAa9T,EAAS+T,GAI3B,GAHA1vC,KAAKmhC,UAAYxF,EACjB37B,KAAK2vC,QAAUD,EAAYvqC,MAAM,GACjCnF,KAAK6uC,OAAS,IAAI1C,GAAYxQ,GACG,OAA7BA,EAAQC,OAAO5E,UAAoB,CACnC,IAAIR,EAAUmF,EAAQM,OAAO54B,KAAOs4B,EAAQC,OAAOjE,gBAAgB,GAAG5lB,OAClE0kB,EAAUkF,EAAQM,OAAO34B,IAAMq4B,EAAQC,OAAOjE,gBAAgB,GAAG5lB,OACjEolB,EAASwE,EAAQC,OAAO5E,UAC5Bh3B,KAAK2vC,QAAQ3sC,KAAK,IAAI+rC,GAAgBvY,EAASC,EAASU,IAE5D,GAAIwE,EAAQC,OAAOhB,YAAcxJ,GAASgE,QAAS,CAC/C,IAAIwa,EAAYhB,GAAuB5uC,KAAK6uC,QACxCgB,EAAaf,GAAwB9uC,KAAK6uC,QAC1ChE,GAAU+E,EAAWC,GACrB7vC,KAAK2vC,QAAQ3sC,KAAK,IAAIgsC,GAAWY,EAAW,KAG5C5vC,KAAK2vC,QAAQ3sC,KAAK,IAAIgsC,GAAWY,EAAW,IAC5C5vC,KAAK2vC,QAAQ3sC,KAAK,IAAIgsC,GAAWa,EAAY,MAezD,OAXAJ,EAAavvC,UAAU4vC,iBAAmB,WACtC,IAAIH,EAAU3vC,KAAK2vC,QAAQxqC,MAAM,GACjC,GAAInF,KAAKmhC,UAAUvF,OAAOhB,YAAcxJ,GAASgE,QAAS,CACtD,IAAIwa,EAAYhB,GAAuB5uC,KAAK6uC,QACxCgB,EAAaf,GAAwB9uC,KAAK6uC,QACzChE,GAAU+E,EAAWC,IACtBF,EAAQ3sC,KAAK,IAAIgsC,GAAWa,EAAY,IAGhD,OAAOF,GAEJF,EAlCuB,GA0G9BM,GAAmB,SAAUC,EAAOjU,GAGpC,IAFA,IAAIkU,EAAYD,aAAiB/Q,GAAqB+Q,EAAM/qC,MAAQ,EAChEi6B,EAAW8Q,aAAiB/Q,IAAqB+Q,EAAM9Q,SAClD1+B,EAAI,EAAGA,EAAIu7B,EAASp7B,OAAQH,IAAK,CACtC,IAAI4pC,EAAOrO,EAASv7B,GAChB4pC,EAAKjJ,qBAAqBnC,IACM,kBAAzBoL,EAAKjJ,UAAU5/B,OACG,IAAzB6oC,EAAKjJ,UAAU5/B,QACf0uC,EAAY7F,EAAKjJ,UAAU5/B,OAE/B6oC,EAAK8F,UAAY/M,GAAkB8M,EAAW7F,EAAKjJ,UAAUvF,OAAOvK,eAAe,GACnF4e,GAAa/Q,GAAY,EAAI,IAGjCiR,GAAwB,SAAUhP,GAClC,IAAIiP,EAAiB,IAAIX,GAAatO,EAAW,IAC7CE,EAAO,IAAI4N,GAAgBmB,GAC3BC,EAAY,GAGhB,OA1FiB,SAAjBC,EAA2Bx7B,EAAQy7B,EAAiBC,EAAqBH,GACzEv7B,EAAOqsB,UAAUpF,SAASjxB,SAAQ,SAAUg9B,GACxC,IAAI2I,EAA6BrX,GAAS0O,EAAM14B,MAAO,GACnDwyB,EAAyBxI,GAAS0O,EAAM14B,MAAO,GAC/CghC,EAAiB,IAAIX,GAAa3H,EAAOhzB,EAAOg7B,oBAChD1W,GAAS0O,EAAMlM,OAAO1V,QAAS,OAC/BmqB,EAAUrtC,KAAKotC,GAEnB,IAAIM,EAAiBtX,GAAS0O,EAAM14B,MAAO,GAAyB,GAAKihC,EACzE,GAAII,GAA8B7O,EAAwB,CACtD,IAAI8N,EAAce,GAA8B3I,EAAMlM,OAAOZ,eAAiBwV,EAAsBD,EAChGI,EAAQ,IAAI1B,GAAgBmB,GAChC,GAAItI,EAAMlM,OAAOZ,gBAAkB8M,EAAMlM,OAAOtD,QAAU,GAAKwP,EAAMlM,OAAOb,gBAAiB,CACzF,IAAI6V,EAAU9I,EAAMlM,OAAOzD,OAAOE,MAClC,GAAIuY,EAAU,EAAG,CACb,IAAIC,EAAU,EACdnB,EAAYN,eAAetE,MAAK,SAAUphC,EAASlJ,GAC/C,OAAIowC,EAAUlnC,EAAQiyB,QAAQwF,UAAUvF,OAAOzD,OAAOE,OAClDwY,EAAUrwC,GACH,GAEFqwC,EAAU,KAKvBnB,EAAYN,eAAez9B,OAAOk/B,EAAS,EAAGF,QAE7C,GAAIC,EAAU,EAAG,CAClB,IAAIE,EAAU,EACdpB,EAAYJ,eAAexE,MAAK,SAAUphC,EAASlJ,GAC/C,OAAIowC,GAAWlnC,EAAQiyB,QAAQwF,UAAUvF,OAAOzD,OAAOE,OACnDyY,EAAUtwC,EAAI,GACP,GAEFswC,EAAU,KAKvBpB,EAAYJ,eAAe39B,OAAOm/B,EAAS,EAAGH,QAG9CjB,EAAYL,uCAAuCrsC,KAAK2tC,QAIxD7I,EAAMlM,OAAOV,aACbwU,EAAYH,oBAAoBvsC,KAAK2tC,GAGrCjB,EAAYF,yBAAyBxsC,KAAK2tC,GAGlDL,EAAeF,EAAgBO,EAAOF,EAA6BE,EAAQH,EAAqBE,QAG5F5I,EAAMlM,OAAOT,gBACboV,EAAgBrB,YAAYlsC,KAAKotC,GAGjCG,EAAgBpB,eAAensC,KAAKotC,GAExCE,EAAeF,EAAgBG,EAAiBC,EAAqBE,GAErEtX,GAAS0O,EAAM14B,MAAO,IACtB2gC,GAAiBjI,EAAO4I,MAsBhCJ,CAAeF,EAAgB/O,EAAMA,EAAMgP,GAC3CN,GAAiBK,EAAejP,UAAWkP,GACpChP,GAgBP0P,GAAuB,SAAUC,EAAQC,EAAQC,EAAQC,GACzD,IAAIjF,EAAO,GAyBX,OAxBID,GAAc+E,GACd9E,EAAKlpC,KAAKguC,EAAOxF,UAAU,IAAK,IAGhCU,EAAKlpC,KAAKguC,GAEV/E,GAAciF,GACdhF,EAAKlpC,KAAKkuC,EAAO1F,UAAU,IAAK,IAGhCU,EAAKlpC,KAAKkuC,GAEVjF,GAAckF,GACdjF,EAAKlpC,KAAKmuC,EAAO3F,UAAU,IAAK,GAAMQ,WAGtCE,EAAKlpC,KAAKmuC,GAEVlF,GAAcgF,GACd/E,EAAKlpC,KAAKiuC,EAAOzF,UAAU,IAAK,GAAOQ,WAGvCE,EAAKlpC,KAAKiuC,GAEP/E,GAGP2D,GAAa,SAAUlU,GACvB,IAAIM,EAASN,EAAQM,OACjBL,EAASD,EAAQC,OACrB,OAAOK,EAAOx4B,IAAIm4B,EAAO5L,gBAAiB4L,EAAO/L,iBAAkB+L,EAAO9L,iBAAmB8L,EAAO5L,mBAAoB4L,EAAO/L,eAAiB+L,EAAO7L,qBAEvJqhB,GAAa,SAAUzV,GACvB,IAAIC,EAASD,EAAQC,OACjBK,EAASN,EAAQM,OACjBrG,EAAc/gB,GAAiB+mB,EAAOhG,YAAaqG,EAAO14B,OAC1DmyB,EAAe7gB,GAAiB+mB,EAAOlG,aAAcuG,EAAO14B,OAC5DkyB,EAAa5gB,GAAiB+mB,EAAOnG,WAAYwG,EAAO14B,OACxDoyB,EAAgB9gB,GAAiB+mB,EAAOjG,cAAesG,EAAO14B,OAClE,OAAO04B,EAAOx4B,IAAImyB,EAAcgG,EAAO5L,gBAAiByF,EAAamG,EAAO/L,iBAAkB+L,EAAO9L,iBAAmB8L,EAAO5L,gBAAkB4F,EAAcF,KAAiBkG,EAAO/L,eAAiB+L,EAAO7L,kBAAoB0F,EAAaE,KAqBhP0b,GAA+B,SAAUlQ,EAAW38B,EAAO8sC,GAC3D,IAAIC,EAnBiC,SAAU5jB,EAAkBgO,GACjE,OAAyB,IAArBhO,EACOgO,EAAQM,OAEM,IAArBtO,EACOyjB,GAAWzV,GAEfkU,GAAWlU,GAYc6V,CAAmCC,GAA2BtQ,EAAUvF,OAAOjO,iBAAkBnpB,GAAQ28B,GACrIuQ,EAX8B,SAAU3wB,EAAgB4a,GAC5D,OAAI5a,IAAmB9J,GAAgBoK,WAC5Bsa,EAAQM,OAEflb,IAAmB9J,GAAgBmK,YAC5BgwB,GAAWzV,GAEfkU,GAAWlU,GAIWgW,CAAgCF,GAA2BtQ,EAAUvF,OAAO7a,eAAgBvc,GAAQ28B,GAC7HyQ,EAAsBC,GAAwBJ,GAA2BtQ,EAAUvF,OAAOvN,eAAgB7pB,GAAQ8sC,EAAeC,GACjIO,EAAYF,EAAoB,GAAIG,EAAaH,EAAoB,GACrEjlB,EAAWhY,GAAyB88B,GAA2BtQ,EAAUvF,OAAOhO,mBAAoBppB,GAAQ+sC,EAA0BhuC,MAAQuuC,EAAWP,EAA0B/tC,OAASuuC,GAIhM,MAAO,CAHIC,GAA8BP,GAA2BtQ,EAAUvF,OAAO9N,iBAAkBtpB,GAAQmoB,EAAUilB,EAAqBL,EAA2BG,GAC3J/oC,KAAK4N,MAAMg7B,EAA0BluC,KAAOspB,EAAS,IACrDhkB,KAAK4N,MAAMg7B,EAA0BjuC,IAAMqpB,EAAS,IAClCmlB,EAAWC,IAE3CE,GAAS,SAAUljC,GAAS,OAAO6E,GAAa7E,IAAUA,EAAMxN,QAAUssB,GAAgBsH,MAC1F+c,GAAoB,SAAU3wC,GAAS,MAAwB,kBAAVA,GACrDswC,GAA0B,SAAUtqB,EAAM5c,EAAIsxB,GAC9C,IAAIwC,EAAiB9zB,EAAG,GAAIg0B,EAAkBh0B,EAAG,GAAIwnC,EAAsBxnC,EAAG,GAC1EoX,EAAQwF,EAAK,GAAI6qB,EAAS7qB,EAAK,GACnC,GAAIjT,GAAmByN,IAAUqwB,GAAU99B,GAAmB89B,GAC1D,MAAO,CAACv9B,GAAiBkN,EAAOka,EAAO14B,OAAQsR,GAAiBu9B,EAAQnW,EAAOz4B,SAEnF,IAAI6uC,EAAyBH,GAAkBC,GAC/C,GAAIv+B,GAAamO,KAAWA,EAAMxgB,QAAUssB,GAAgBykB,SAAWvwB,EAAMxgB,QAAUssB,GAAgB0kB,OACnG,OAAIL,GAAkBC,GACAlW,EAAO14B,MAAQ04B,EAAOz4B,OACnB2uC,KAAyBpwB,EAAMxgB,QAAUssB,GAAgB0kB,OACxE,CAACtW,EAAO14B,MAAO04B,EAAO14B,MAAQ4uC,GAC9B,CAAClW,EAAOz4B,OAAS2uC,EAAqBlW,EAAOz4B,QAEhD,CAACy4B,EAAO14B,MAAO04B,EAAOz4B,QAEjC,IAAIgvC,EAAoBN,GAAkBzT,GACtCgU,EAAqBP,GAAkBvT,GACvC+T,EAAyBF,GAAqBC,EAElD,GAAIR,GAAOlwB,MAAYqwB,GAAUH,GAAOG,IAEpC,OAAII,GAAqBC,EACd,CAAChU,EAAgBE,GAIvB0T,GAA2BK,EAM5BA,GAA0BL,EAOnB,CANOG,EACR/T,EACAE,EAAkBwT,EACTM,EACT9T,EACAF,EAAiB0T,GAOpB,CAFOK,EAAoB/T,EAAiBxC,EAAO14B,MAC3CkvC,EAAqB9T,EAAkB1C,EAAOz4B,QAjBlD,CAACy4B,EAAO14B,MAAO04B,EAAOz4B,QAsBrC,GAAI6uC,EAAwB,CACxB,IAAIM,EAAU,EACVC,EAAW,EAaf,OAZIt+B,GAAmByN,GACnB4wB,EAAU99B,GAAiBkN,EAAOka,EAAO14B,OAEpC+Q,GAAmB89B,KACxBQ,EAAW/9B,GAAiBu9B,EAAQnW,EAAOz4B,SAE3CyuC,GAAOlwB,GACP4wB,EAAUC,EAAWT,EAEfC,IAAUH,GAAOG,KACvBQ,EAAWD,EAAUR,GAElB,CAACQ,EAASC,GAMrB,IAAIrvC,EAAQ,KACRC,EAAS,KAmBb,GAlBI8Q,GAAmByN,GACnBxe,EAAQsR,GAAiBkN,EAAOka,EAAO14B,OAElC6uC,GAAU99B,GAAmB89B,KAClC5uC,EAASqR,GAAiBu9B,EAAQnW,EAAOz4B,SAE/B,OAAVD,GAAoB6uC,IAAUH,GAAOG,KACrC5uC,EACIgvC,GAAqBC,EACdlvC,EAAQk7B,EAAkBE,EAC3B1C,EAAOz4B,QAEN,OAAXA,GAAmByuC,GAAOlwB,KAC1Bxe,EACIivC,GAAqBC,EACdjvC,EAASm7B,EAAmBF,EAC7BxC,EAAO14B,OAEP,OAAVA,GAA6B,OAAXC,EAClB,MAAO,CAACD,EAAOC,GAEnB,MAAM,IAAI4Q,MAAM,oDAEhBq9B,GAA6B,SAAUx+B,EAAQzO,GAC/C,IAAIjD,EAAQ0R,EAAOzO,GACnB,MAAqB,qBAAVjD,EACA0R,EAAO,GAEX1R,GAEPywC,GAAgC,SAAUa,EAAQloC,EAAIgM,EAAI46B,EAA2BG,GACrF,IAAIxuC,EAAIyH,EAAG,GAAIzI,EAAIyI,EAAG,GAClBpH,EAAQoT,EAAG,GAAInT,EAASmT,EAAG,GAC/B,OAAQk8B,GACJ,KAAK1lB,GAAkBc,SACnB,MAAO,CACH,IAAI8c,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,MAAOsF,KAAK4N,MAAMg7B,EAA0BjuC,IAAMpB,IAClG,IAAI6oC,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,KAAOkuC,EAA0BhuC,OAAQoF,KAAK4N,MAAMg7B,EAA0BjuC,IAAMpB,IACpI,IAAI6oC,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,KAAOkuC,EAA0BhuC,OAAQoF,KAAK4N,MAAM/S,EAAS+tC,EAA0BjuC,IAAMpB,IAC7I,IAAI6oC,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,MAAOsF,KAAK4N,MAAM/S,EAAS+tC,EAA0BjuC,IAAMpB,KAEnH,KAAKirB,GAAkBe,SACnB,MAAO,CACH,IAAI6c,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,KAAOH,GAAIyF,KAAK4N,MAAMg7B,EAA0BjuC,MAChG,IAAIynC,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,KAAOH,EAAIK,GAAQoF,KAAK4N,MAAMg7B,EAA0BjuC,MACxG,IAAIynC,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,KAAOH,EAAIK,GAAQoF,KAAK4N,MAAMg7B,EAA0B/tC,OAAS+tC,EAA0BjuC,MAC3I,IAAIynC,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,KAAOH,GAAIyF,KAAK4N,MAAMg7B,EAA0B/tC,OAAS+tC,EAA0BjuC,OAE3I,KAAK6pB,GAAkBa,UACnB,MAAO,CACH,IAAI+c,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,KAAOH,GAAIyF,KAAK4N,MAAMg7B,EAA0BjuC,IAAMpB,IACtG,IAAI6oC,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,KAAOH,EAAIK,GAAQoF,KAAK4N,MAAMg7B,EAA0BjuC,IAAMpB,IAC9G,IAAI6oC,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,KAAOH,EAAIK,GAAQoF,KAAK4N,MAAMg7B,EAA0BjuC,IAAMpB,EAAIsB,IAClH,IAAIunC,GAAOpiC,KAAK4N,MAAMg7B,EAA0BluC,KAAOH,GAAIyF,KAAK4N,MAAMg7B,EAA0BjuC,IAAMpB,EAAIsB,KAElH,QACI,MAAO,CACH,IAAIunC,GAAOpiC,KAAK4N,MAAMm7B,EAAuBruC,MAAOsF,KAAK4N,MAAMm7B,EAAuBpuC,MACtF,IAAIynC,GAAOpiC,KAAK4N,MAAMm7B,EAAuBruC,KAAOquC,EAAuBnuC,OAAQoF,KAAK4N,MAAMm7B,EAAuBpuC,MACrH,IAAIynC,GAAOpiC,KAAK4N,MAAMm7B,EAAuBruC,KAAOquC,EAAuBnuC,OAAQoF,KAAK4N,MAAMm7B,EAAuBluC,OAASkuC,EAAuBpuC,MACrJ,IAAIynC,GAAOpiC,KAAK4N,MAAMm7B,EAAuBruC,MAAOsF,KAAK4N,MAAMm7B,EAAuBluC,OAASkuC,EAAuBpuC,SAQlIwvC,GAA6B,WAC7B,SAASA,EAAYluB,GACjB5kB,KAAK+yC,MAAQ,GACb/yC,KAAKgzC,UAAYpuB,EA0CrB,OAxCAkuB,EAAY5yC,UAAU+yC,aAAe,SAAUva,EAAYG,GACvD,IAAIsI,EAAYnhC,KAAKgzC,UAAUjtB,cAAc,OACzCZ,EAAMnlB,KAAKgzC,UAAUjtB,cAAc,OACnCmtB,EAAOlzC,KAAKgzC,UAAUjtB,cAAc,QACpC/jB,EAAOhC,KAAKgzC,UAAUhxC,KAC1Bm/B,EAAUnb,MAAM8R,WAAa,SAC7BqJ,EAAUnb,MAAM0S,WAAaA,EAC7ByI,EAAUnb,MAAM6S,SAAWA,EAC3BsI,EAAUnb,MAAMmtB,OAAS,IACzBhS,EAAUnb,MAAMotB,QAAU,IAC1BpxC,EAAKijB,YAAYkc,GACjBhc,EAAII,IAnBM,iFAoBVJ,EAAI5hB,MAAQ,EACZ4hB,EAAI3hB,OAAS,EACb2hB,EAAIa,MAAMmtB,OAAS,IACnBhuB,EAAIa,MAAMotB,QAAU,IACpBjuB,EAAIa,MAAMqtB,cAAgB,WAC1BH,EAAKltB,MAAM0S,WAAaA,EACxBwa,EAAKltB,MAAM6S,SAAWA,EACtBqa,EAAKltB,MAAMmtB,OAAS,IACpBD,EAAKltB,MAAMotB,QAAU,IACrBF,EAAKjuB,YAAYjlB,KAAKgzC,UAAUxL,eA3BtB,gBA4BVrG,EAAUlc,YAAYiuB,GACtB/R,EAAUlc,YAAYE,GACtB,IAAImuB,EAAWnuB,EAAIouB,UAAYL,EAAKK,UAAY,EAChDpS,EAAU7a,YAAY4sB,GACtB/R,EAAUlc,YAAYjlB,KAAKgzC,UAAUxL,eAhC3B,gBAiCVrG,EAAUnb,MAAM6K,WAAa,SAC7B1L,EAAIa,MAAMqtB,cAAgB,QAC1B,IAAIG,EAASruB,EAAIouB,UAAYpS,EAAUoS,UAAY,EAEnD,OADAvxC,EAAKskB,YAAY6a,GACV,CAAEmS,SAAUA,EAAUE,OAAQA,IAEzCV,EAAY5yC,UAAUuzC,WAAa,SAAU/a,EAAYG,GACrD,IAAIvO,EAAMoO,EAAa,IAAMG,EAI7B,MAH+B,qBAApB74B,KAAK+yC,MAAMzoB,KAClBtqB,KAAK+yC,MAAMzoB,GAAOtqB,KAAKizC,aAAava,EAAYG,IAE7C74B,KAAK+yC,MAAMzoB,IAEfwoB,EA7CsB,GAiD7BY,GAAgC,WAChC,SAASA,EAAelpC,GACpBxK,KAAK2zC,eAAiB,GACtB3zC,KAAKymB,OAASjc,EAAQic,OAASjc,EAAQic,OAAS7B,SAASmB,cAAc,UACvE/lB,KAAK0mB,IAAM1mB,KAAKymB,OAAOE,WAAW,MAClC3mB,KAAKwK,QAAUA,EACVA,EAAQic,SACTzmB,KAAKymB,OAAOljB,MAAQoF,KAAKk7B,MAAMr5B,EAAQjH,MAAQiH,EAAQopC,OACvD5zC,KAAKymB,OAAOjjB,OAASmF,KAAKk7B,MAAMr5B,EAAQhH,OAASgH,EAAQopC,OACzD5zC,KAAKymB,OAAOT,MAAMziB,MAAQiH,EAAQjH,MAAQ,KAC1CvD,KAAKymB,OAAOT,MAAMxiB,OAASgH,EAAQhH,OAAS,MAEhDxD,KAAK6zC,YAAc,IAAIf,GAAYluB,UACnC5kB,KAAK0mB,IAAIktB,MAAM5zC,KAAKwK,QAAQopC,MAAO5zC,KAAKwK,QAAQopC,OAChD5zC,KAAK0mB,IAAIotB,WAAWtpC,EAAQtH,EAAIsH,EAAQ26B,SAAU36B,EAAQtI,EAAIsI,EAAQ86B,SACtEtlC,KAAK0mB,IAAIqtB,aAAe,SACxB/zC,KAAK2zC,eAAiB,GACtB/rB,GAAOW,YAAY/d,EAAQqd,IAAII,MAAM,gCAAkCzd,EAAQjH,MAAQ,IAAMiH,EAAQhH,OAAS,OAASgH,EAAQtH,EAAI,IAAMsH,EAAQtI,EAAI,gBAAkBsI,EAAQopC,OAusBnL,OArsBAF,EAAexzC,UAAU8zC,aAAe,SAAUrE,EAASzF,GAEvD,IADA,IAAIzf,EAAQzqB,KACLA,KAAK2zC,eAAehzC,QACvBX,KAAKi0C,YAETtE,EAAQx6B,QAAO,SAAU++B,GAAU,OAAO9a,GAAS8a,EAAOhK,OAAQA,MAAYp/B,SAAQ,SAAUopC,GAAU,OAAOzpB,EAAM0pB,YAAYD,OAEvIR,EAAexzC,UAAUi0C,YAAc,SAAUD,GAC7Cl0C,KAAK0mB,IAAI0tB,OApcO,SAAUF,GAC9B,OAAuB,IAAhBA,EAAOpqC,KAocNuqC,CAAkBH,KAClBl0C,KAAK0mB,IAAIotB,UAAUI,EAAO1d,QAAS0d,EAAOzd,SAC1Cz2B,KAAK0mB,IAAIsQ,UAAUkd,EAAO/c,OAAO,GAAI+c,EAAO/c,OAAO,GAAI+c,EAAO/c,OAAO,GAAI+c,EAAO/c,OAAO,GAAI+c,EAAO/c,OAAO,GAAI+c,EAAO/c,OAAO,IAC3Hn3B,KAAK0mB,IAAIotB,WAAWI,EAAO1d,SAAU0d,EAAOzd,UArcrC,SAAUyd,GAAU,OAAuB,IAAhBA,EAAOpqC,KAuczCwqC,CAAaJ,KACbl0C,KAAKksC,KAAKgI,EAAOhI,MACjBlsC,KAAK0mB,IAAI6tB,QAEbv0C,KAAK2zC,eAAe3wC,KAAKkxC,IAE7BR,EAAexzC,UAAU+zC,UAAY,WACjCj0C,KAAK2zC,eAAe5wC,MACpB/C,KAAK0mB,IAAI8tB,WAEbd,EAAexzC,UAAUu0C,YAAc,SAAU9D,GAC7C,OAAO7vC,EAAUd,UAAM,OAAQ,GAAQ,WACnC,IAAI47B,EACJ,OAAO75B,EAAY/B,MAAM,SAAU2K,GAC/B,OAAQA,EAAGtI,OACP,KAAK,EAED,OADAu5B,EAAS+U,EAAMhV,QAAQwF,UAAUvF,QACrBd,aACZ96B,KAAK0mB,IAAIguB,YAAc9Y,EAAOtD,QACvB,CAAC,EAAat4B,KAAK20C,mBAAmBhE,KAFb,CAAC,EAAa,GAGlD,KAAK,EACDhmC,EAAGrI,OACHqI,EAAGtI,MAAQ,EACf,KAAK,EAAG,MAAO,CAAC,WAKhCqxC,EAAexzC,UAAU00C,WAAa,SAAUC,GAC5C,OAAO/zC,EAAUd,UAAM,OAAQ,GAAQ,WACnC,OAAO+B,EAAY/B,MAAM,SAAU2K,GAC/B,OAAQA,EAAGtI,OACP,KAAK,EACD,OAAKwyC,EAAM1T,UAAUvF,OAAOd,YACrB,CAAC,EAAa96B,KAAK80C,+BAA+BD,IADT,CAAC,EAAa,GAElE,KAAK,EAED,OADAlqC,EAAGrI,OACI,CAAC,EAAatC,KAAK+0C,kBAAkBF,IAChD,KAAK,EACDlqC,EAAGrI,OACHqI,EAAGtI,MAAQ,EACf,KAAK,EAAG,MAAO,CAAC,WAKhCqxC,EAAexzC,UAAU80C,4BAA8B,SAAU7Y,EAAM1L,GACnE,IAAIhG,EAAQzqB,KACU,IAAlBywB,EACAzwB,KAAK0mB,IAAIuuB,SAAS9Y,EAAKA,KAAMA,EAAKF,OAAO54B,KAAM84B,EAAKF,OAAO34B,IAAM64B,EAAKF,OAAOz4B,QAG/DO,EAAao4B,EAAKA,MAAMjxB,KAAI,SAAU1K,GAAK,OAAO4D,EAAc5D,MACtEojB,QAAO,SAAUvgB,EAAM6xC,GAE3B,OADAzqB,EAAM/D,IAAIuuB,SAASC,EAAQ7xC,EAAM84B,EAAKF,OAAO34B,IAAM64B,EAAKF,OAAOz4B,QACxDH,EAAOonB,EAAM/D,IAAIyuB,YAAYD,GAAQ3xC,QAC7C44B,EAAKF,OAAO54B,OAGvBqwC,EAAexzC,UAAUk1C,gBAAkB,SAAUxZ,GACjD,IAAI7C,EAAc6C,EAAO7C,YACpB5jB,QAAO,SAAUkgC,GAAW,MAAmB,WAAZA,GAAoC,eAAZA,KAC3DhgC,KAAK,IACNqjB,EAAakD,EAAOlD,WAAWrjB,KAAK,MACpCwjB,EAAWnlB,GAAiBkoB,EAAO/C,UACjC,GAAK+C,EAAO/C,SAAS9mB,OAAS6pB,EAAO/C,SAAS7mB,KAC9C4pB,EAAO/C,SAAS9mB,OAAS,KAC/B,MAAO,CACH,CAAC6pB,EAAO3C,UAAWF,EAAa6C,EAAO9C,WAAYD,EAAUH,GAAYrjB,KAAK,KAC9EqjB,EACAG,IAGR6a,EAAexzC,UAAUo1C,eAAiB,SAAUnZ,EAAMP,GACtD,OAAO96B,EAAUd,UAAM,OAAQ,GAAQ,WACnC,IAAI2K,EAAI4qC,EAAM7c,EAAYG,EACtBpO,EAAQzqB,KACZ,OAAO+B,EAAY/B,MAAM,SAAU2W,GA8C/B,OA7CAhM,EAAK3K,KAAKo1C,gBAAgBxZ,GAAS2Z,EAAO5qC,EAAG,GAAI+tB,EAAa/tB,EAAG,GAAIkuB,EAAWluB,EAAG,GACnF3K,KAAK0mB,IAAI6uB,KAAOA,EAChBpZ,EAAKuB,WAAW5yB,SAAQ,SAAUqxB,GAC9B1R,EAAM/D,IAAIQ,UAAYhR,GAAS0lB,EAAOrmB,OACtCkV,EAAMuqB,4BAA4B7Y,EAAMP,EAAOnL,eAC/C,IAAI+kB,EAAc5Z,EAAOtF,WACrBkf,EAAY70C,QAAUw7B,EAAKA,KAAKyB,OAAOj9B,SACvC60C,EACKrwC,MAAM,GACN6mC,UACAlhC,SAAQ,SAAUwrB,GACnB7L,EAAM/D,IAAI+uB,YAAcv/B,GAASogB,EAAW/gB,OAC5CkV,EAAM/D,IAAIgvB,cAAgBpf,EAAWE,QAAQzkB,OAAS0Y,EAAMjgB,QAAQopC,MACpEnpB,EAAM/D,IAAIivB,cAAgBrf,EAAWG,QAAQ1kB,OAAS0Y,EAAMjgB,QAAQopC,MACpEnpB,EAAM/D,IAAIkvB,WAAatf,EAAWI,KAAK3kB,OACvC0Y,EAAM/D,IAAIuuB,SAAS9Y,EAAKA,KAAMA,EAAKF,OAAO54B,KAAM84B,EAAKF,OAAO34B,IAAM64B,EAAKF,OAAOz4B,WAElFinB,EAAM/D,IAAI+uB,YAAc,GACxBhrB,EAAM/D,IAAIgvB,cAAgB,EAC1BjrB,EAAM/D,IAAIivB,cAAgB,EAC1BlrB,EAAM/D,IAAIkvB,WAAa,GAEvBha,EAAOpD,mBAAmB73B,SAC1B8pB,EAAM/D,IAAIQ,UAAYhR,GAAS0lB,EAAOrD,qBAAuBqD,EAAOrmB,OACpEqmB,EAAOpD,mBAAmB1tB,SAAQ,SAAU0tB,GACxC,OAAQA,GACJ,KAAK,EAID,IAAI8a,EAAW7oB,EAAMopB,YAAYJ,WAAW/a,EAAYG,GAAUya,SAClE7oB,EAAM/D,IAAIS,SAASgV,EAAKF,OAAO54B,KAAMsF,KAAK4N,MAAM4lB,EAAKF,OAAO34B,IAAMgwC,GAAWnX,EAAKF,OAAO14B,MAAO,GAChG,MACJ,KAAK,EACDknB,EAAM/D,IAAIS,SAASgV,EAAKF,OAAO54B,KAAMsF,KAAK4N,MAAM4lB,EAAKF,OAAO34B,KAAM64B,EAAKF,OAAO14B,MAAO,GACrF,MACJ,KAAK,EAED,IAAIiwC,EAAS/oB,EAAMopB,YAAYJ,WAAW/a,EAAYG,GAAU2a,OAChE/oB,EAAM/D,IAAIS,SAASgV,EAAKF,OAAO54B,KAAMsF,KAAKC,KAAKuzB,EAAKF,OAAO34B,IAAMkwC,GAASrX,EAAKF,OAAO14B,MAAO,WAM1G,CAAC,UAIpBmwC,EAAexzC,UAAU21C,sBAAwB,SAAU1U,EAAW0N,EAAQzhB,GAC1E,GAAIA,GAAS+T,EAAU1C,eAAiB,GAAK0C,EAAUxC,gBAAkB,EAAG,CACxE,IAAImX,EAAM1E,GAAWjQ,GACjB+K,EAAO4C,GAAwBD,GACnC7uC,KAAKksC,KAAKA,GACVlsC,KAAK0mB,IAAI0tB,OACTp0C,KAAK0mB,IAAI6tB,OACTv0C,KAAK0mB,IAAIE,UAAUwG,EAAO,EAAG,EAAG+T,EAAU1C,eAAgB0C,EAAUxC,gBAAiBmX,EAAIzyC,KAAMyyC,EAAIxyC,IAAKwyC,EAAIvyC,MAAOuyC,EAAItyC,QACvHxD,KAAK0mB,IAAI8tB,YAGjBd,EAAexzC,UAAU60C,kBAAoB,SAAUF,GACnD,OAAO/zC,EAAUd,UAAM,OAAQ,GAAQ,WACnC,IAAImhC,EAAW0N,EAAQjT,EAAQv3B,EAAIsG,EAAIm9B,EAA+CrhB,EAAQc,EAAcrkB,EAAGw6B,EAAYvY,EAAKiI,EAAOpE,EAAUiT,EACjJ,OAAOl6B,EAAY/B,MAAM,SAAU2W,GAC/B,OAAQA,EAAGtU,OACP,KAAK,EACDrC,KAAKg0C,aAAaa,EAAMlF,QAAS,GACjCxO,EAAY0T,EAAM1T,UAClB0N,EAASgG,EAAMhG,OACfjT,EAASuF,EAAUvF,OACnBv3B,EAAK,EAAGsG,EAAKw2B,EAAUrF,UACvBnlB,EAAGtU,MAAQ,EACf,KAAK,EACD,OAAMgC,EAAKsG,EAAGhK,QACdmnC,EAAQn9B,EAAGtG,GACJ,CAAC,EAAarE,KAAKs1C,eAAexN,EAAOlM,KAFlB,CAAC,EAAa,GAGhD,KAAK,EACDjlB,EAAGrU,OACHqU,EAAGtU,MAAQ,EACf,KAAK,EAED,OADAgC,IACO,CAAC,EAAa,GACzB,KAAK,EACD,KAAM88B,aAAqB7C,IAAwB,MAAO,CAAC,EAAa,GACxE3nB,EAAGtU,MAAQ,EACf,KAAK,EAED,OADAsU,EAAGpU,KAAKS,KAAK,CAAC,EAAG,EAAJ,CAAS,IACf,CAAC,EAAahD,KAAKwK,QAAQse,MAAMuB,MAAM8W,EAAU5b,MAC5D,KAAK,EAGD,OAFA6H,EAAQzW,EAAGrU,OACXtC,KAAK61C,sBAAsB1U,EAAW0N,EAAQzhB,GACvC,CAAC,EAAa,GACzB,KAAK,EAGD,OAFMzW,EAAGrU,OACTslB,GAAOW,YAAYvoB,KAAKwK,QAAQqd,IAAIY,MAAM,uBAAyB0Y,EAAU5b,KACtE,CAAC,EAAa,GACzB,KAAK,EAID,GAHI4b,aAAqBtC,IACrB7+B,KAAK61C,sBAAsB1U,EAAW0N,EAAQ1N,EAAU1a,UAEtD0a,aAAqBrC,IAAsB,MAAO,CAAC,EAAa,IACtEnoB,EAAGtU,MAAQ,EACf,KAAK,EAED,OADAsU,EAAGpU,KAAKS,KAAK,CAAC,EAAG,GAAJ,CAAU,KAChB,CAAC,EAAahD,KAAKwK,QAAQse,MAAMuB,MAAM8W,EAAUxc,MAC5D,KAAK,GAGD,OAFAyI,EAAQzW,EAAGrU,OACXtC,KAAK61C,sBAAsB1U,EAAW0N,EAAQzhB,GACvC,CAAC,EAAa,IACzB,KAAK,GAGD,OAFMzW,EAAGrU,OACTslB,GAAOW,YAAYvoB,KAAKwK,QAAQqd,IAAIY,MAAM,qBAAuB0Y,EAAUxc,IAAIhP,UAAU,EAAG,MACrF,CAAC,EAAa,IACzB,KAAK,GACD,OAAMwrB,aAAqBnB,IAA0BmB,EAAUf,KAexD,CAAC,EAdS,IAAIsT,EAAe,CAChC7rB,GAAI7nB,KAAKwK,QAAQqd,GACjB+rB,MAAO5zC,KAAKwK,QAAQopC,MACpBtyB,gBAAiB6f,EAAU7f,gBAC3Bpe,EAAG,EACHhB,EAAG,EACHijC,QAAS,EACTG,QAAS,EACT/hC,MAAO49B,EAAU59B,MACjBC,OAAQ29B,EAAU39B,OAClBslB,MAAO9oB,KAAKwK,QAAQse,MACpBitB,YAAa5U,EAAU59B,MACvByyC,aAAc7U,EAAU39B,SAEQyyC,OAAO9U,EAAUf,OAfwB,CAAC,EAAa,IAgB/F,KAAK,GACD3Z,EAAS9P,EAAGrU,OACR6+B,EAAU59B,OAAS49B,EAAU39B,QAC7BxD,KAAK0mB,IAAIE,UAAUH,EAAQ,EAAG,EAAG0a,EAAU59B,MAAO49B,EAAU39B,OAAQ29B,EAAUlF,OAAO54B,KAAM89B,EAAUlF,OAAO34B,IAAK69B,EAAUlF,OAAO14B,MAAO49B,EAAUlF,OAAOz4B,QAE9JmT,EAAGtU,MAAQ,GACf,KAAK,GA+BD,GA9BI8+B,aAAqB7B,KACrB/X,EAAO5e,KAAK+I,IAAIyvB,EAAUlF,OAAO14B,MAAO49B,EAAUlF,OAAOz4B,QAt8DtE,aAu8DiB29B,EAAUr3B,KACNq3B,EAAU3B,UACVx/B,KAAK0mB,IAAI0tB,OACTp0C,KAAKksC,KAAK,CACN,IAAInB,GAAO5J,EAAUlF,OAAO54B,KAAc,OAAPkkB,EAAgB4Z,EAAUlF,OAAO34B,IAAa,IAAPikB,GAC1E,IAAIwjB,GAAO5J,EAAUlF,OAAO54B,KAAc,IAAPkkB,EAAa4Z,EAAUlF,OAAO34B,IAAa,MAAPikB,GACvE,IAAIwjB,GAAO5J,EAAUlF,OAAO54B,KAAc,OAAPkkB,EAAgB4Z,EAAUlF,OAAO34B,IAAa,OAAPikB,GAC1E,IAAIwjB,GAAO5J,EAAUlF,OAAO54B,KAAc,OAAPkkB,EAAgB4Z,EAAUlF,OAAO34B,IAAa,MAAPikB,GAC1E,IAAIwjB,GAAO5J,EAAUlF,OAAO54B,KAAc,OAAPkkB,EAAgB4Z,EAAUlF,OAAO34B,IAAa,IAAPikB,GAC1E,IAAIwjB,GAAO5J,EAAUlF,OAAO54B,KAAc,IAAPkkB,EAAa4Z,EAAUlF,OAAO34B,IAAa,OAAPikB,GACvE,IAAIwjB,GAAO5J,EAAUlF,OAAO54B,KAAc,OAAPkkB,EAAgB4Z,EAAUlF,OAAO34B,IAAa,IAAPikB,KAE9EvnB,KAAK0mB,IAAIQ,UAAYhR,GAh9DvC,WAi9DkBlW,KAAK0mB,IAAIwvB,OACTl2C,KAAK0mB,IAAI8tB,WAp9DjC,UAu9DyBrT,EAAUr3B,MACXq3B,EAAU3B,UACVx/B,KAAK0mB,IAAI0tB,OACTp0C,KAAK0mB,IAAIyvB,YACTn2C,KAAK0mB,IAAI0vB,IAAIjV,EAAUlF,OAAO54B,KAAOkkB,EAAO,EAAG4Z,EAAUlF,OAAO34B,IAAMikB,EAAO,EAAGA,EAAO,EAAG,EAAa,EAAV5e,KAAKqM,IAAQ,GAC1GhV,KAAK0mB,IAAIQ,UAAYhR,GA19DvC,WA29DkBlW,KAAK0mB,IAAIwvB,OACTl2C,KAAK0mB,IAAI8tB,YAIjB6B,GAAmBlV,IAAcA,EAAU5/B,MAAMZ,OAAQ,CAOzD,OANAX,KAAK0mB,IAAI6uB,KAAOv1C,KAAKo1C,gBAAgBxZ,GAAQ,GAC7C57B,KAAK0mB,IAAIQ,UAAYhR,GAAS0lB,EAAOrmB,OACrCvV,KAAK0mB,IAAIqtB,aAAe,SACxB/zC,KAAK0mB,IAAIoP,UAAYwgB,GAAgBnV,EAAUvF,OAAO9F,WACtDmG,EAASmV,GAAWjQ,GACpBj+B,EAAI,EACIi+B,EAAUvF,OAAO9F,WACrB,KAAKT,GAAWU,OACZ7yB,GAAK+4B,EAAO14B,MAAQ,EACpB,MACJ,KAAK8xB,GAAW/E,MACZptB,GAAK+4B,EAAO14B,MAGpBm6B,EAAazB,EAAOx4B,IAAIP,EAAG,EAAG,GAAI+4B,EAAOz4B,OAAS,EAAI,GACtDxD,KAAK0mB,IAAI0tB,OACTp0C,KAAKksC,KAAK,CACN,IAAInB,GAAO9O,EAAO54B,KAAM44B,EAAO34B,KAC/B,IAAIynC,GAAO9O,EAAO54B,KAAO44B,EAAO14B,MAAO04B,EAAO34B,KAC9C,IAAIynC,GAAO9O,EAAO54B,KAAO44B,EAAO14B,MAAO04B,EAAO34B,IAAM24B,EAAOz4B,QAC3D,IAAIunC,GAAO9O,EAAO54B,KAAM44B,EAAO34B,IAAM24B,EAAOz4B,UAEhDxD,KAAK0mB,IAAI6tB,OACTv0C,KAAKg1C,4BAA4B,IAAI9Y,GAAWiF,EAAU5/B,MAAOm8B,GAAa9B,EAAOnL,eACrFzwB,KAAK0mB,IAAI8tB,UACTx0C,KAAK0mB,IAAIqtB,aAAe,SACxB/zC,KAAK0mB,IAAIoP,UAAY,OAEzB,IAAKsD,GAAS+H,EAAUvF,OAAO1V,QAAS,MAAuB,MAAO,CAAC,EAAa,IACpF,GAA0C,OAApCib,EAAUvF,OAAO7K,eAA0B,MAAO,CAAC,EAAa,IAEtE,IADA5L,EAAMgc,EAAUvF,OAAO7K,gBACbjnB,OAAS8W,GAAa0M,IAAM,MAAO,CAAC,EAAa,IAC3DF,OAAQ,EACRpE,EAAM7D,EAAI6D,IACVrS,EAAGtU,MAAQ,GACf,KAAK,GAED,OADAsU,EAAGpU,KAAKS,KAAK,CAAC,GAAI,GAAL,CAAW,KACjB,CAAC,EAAahD,KAAKwK,QAAQse,MAAMuB,MAAMrB,IAClD,KAAK,GAGD,OAFAoE,EAAQzW,EAAGrU,OACXtC,KAAK0mB,IAAIE,UAAUwG,EAAO+T,EAAUlF,OAAO54B,MAAQ+pB,EAAM7pB,MAAQ,IAAK49B,EAAUlF,OAAO34B,KAChF,CAAC,EAAa,IACzB,KAAK,GAGD,OAFMqT,EAAGrU,OACTslB,GAAOW,YAAYvoB,KAAKwK,QAAQqd,IAAIY,MAAM,kCAAoCO,GACvE,CAAC,EAAa,IACzB,KAAK,GAAI,MAAO,CAAC,EAAa,IAC9B,KAAK,GACG6rB,EAAM3E,WAAa/O,EAAUvF,OAAOvK,gBAAkBL,GAAgB3B,OACtErvB,KAAK0mB,IAAI6uB,KAAOv1C,KAAKo1C,gBAAgBxZ,GAAQ,GAC7C57B,KAAK0mB,IAAIQ,UAAYhR,GAAS0lB,EAAOrmB,OACrCvV,KAAK0mB,IAAIqtB,aAAe,SACxB/zC,KAAK0mB,IAAIoP,UAAY,QACrBmG,EAAS,IAAIh5B,EAAOk+B,EAAUlF,OAAO54B,KAAM89B,EAAUlF,OAAO34B,IAAMuR,GAAiBssB,EAAUvF,OAAOnG,WAAY0L,EAAUlF,OAAO14B,OAAQ49B,EAAUlF,OAAO14B,MA9qG9J,SAAUwL,EAAO8pB,GACrC,OAAIjlB,GAAa7E,IAA0B,WAAhBA,EAAMxN,MACtB,IAAMs3B,EAER9pB,EAAMjF,OAAShF,EAAUqN,aACvB0mB,EAAW9pB,EAAMgD,OAEnBuC,GAAmBvF,GACjB8F,GAAiB9F,EAAO8pB,GAE5BA,EAoqGkL0d,CAAkB3a,EAAO/K,WAAY+K,EAAO/C,SAAS9mB,QAAU,EAAI,GACpO/R,KAAKg1C,4BAA4B,IAAI9Y,GAAW2Y,EAAM3E,UAAWjU,GAASL,EAAOnL,eACjFzwB,KAAK0mB,IAAIqtB,aAAe,SACxB/zC,KAAK0mB,IAAIoP,UAAY,QAEzBnf,EAAGtU,MAAQ,GACf,KAAK,GAAI,MAAO,CAAC,WAKjCqxC,EAAexzC,UAAUy0C,mBAAqB,SAAUhE,GACpD,OAAO7vC,EAAUd,UAAM,OAAQ,GAAQ,WACnC,IAAIqE,EAAIsG,EAAWgM,EAAI61B,EAAWG,EAAI6J,EAAWC,EAAIC,EAAWC,EAAIC,EAAWC,EAAIC,EAAWC,EAAIC,EAAIlP,EACtG,OAAO/lC,EAAY/B,MAAM,SAAUi3C,GAC/B,OAAQA,EAAG50C,OACP,KAAK,EAGL,MAAO,CAAC,EAAarC,KAAK80C,+BAA+BnE,EAAMhV,UAC/D,KAAK,EAGDsb,EAAG30C,OACH+B,EAAK,EAAGsG,EAAKgmC,EAAMvB,eACnB6H,EAAG50C,MAAQ,EACf,KAAK,EACD,OAAMgC,EAAKsG,EAAGhK,QACdmnC,EAAQn9B,EAAGtG,GACJ,CAAC,EAAarE,KAAKy0C,YAAY3M,KAFR,CAAC,EAAa,GAGhD,KAAK,EACDmP,EAAG30C,OACH20C,EAAG50C,MAAQ,EACf,KAAK,EAED,OADAgC,IACO,CAAC,EAAa,GACzB,KAAK,EAEL,MAAO,CAAC,EAAarE,KAAK+0C,kBAAkBpE,EAAMhV,UAClD,KAAK,EAEDsb,EAAG30C,OACHqU,EAAK,EAAG61B,EAAKmE,EAAMxB,eACnB8H,EAAG50C,MAAQ,EACf,KAAK,EACD,OAAMsU,EAAK61B,EAAG7rC,QACdmnC,EAAQ0E,EAAG71B,GACJ,CAAC,EAAa3W,KAAK40C,WAAW9M,KAFP,CAAC,EAAa,IAGhD,KAAK,EACDmP,EAAG30C,OACH20C,EAAG50C,MAAQ,EACf,KAAK,EAED,OADAsU,IACO,CAAC,EAAa,GACzB,KAAK,GACDg2B,EAAK,EAAG6J,EAAK7F,EAAMpB,oBACnB0H,EAAG50C,MAAQ,GACf,KAAK,GACD,OAAMsqC,EAAK6J,EAAG71C,QACdmnC,EAAQ0O,EAAG7J,GACJ,CAAC,EAAa3sC,KAAKy0C,YAAY3M,KAFR,CAAC,EAAa,IAGhD,KAAK,GACDmP,EAAG30C,OACH20C,EAAG50C,MAAQ,GACf,KAAK,GAED,OADAsqC,IACO,CAAC,EAAa,IACzB,KAAK,GACD8J,EAAK,EAAGC,EAAK/F,EAAMnB,yBACnByH,EAAG50C,MAAQ,GACf,KAAK,GACD,OAAMo0C,EAAKC,EAAG/1C,QACdmnC,EAAQ4O,EAAGD,GACJ,CAAC,EAAaz2C,KAAKy0C,YAAY3M,KAFR,CAAC,EAAa,IAGhD,KAAK,GACDmP,EAAG30C,OACH20C,EAAG50C,MAAQ,GACf,KAAK,GAED,OADAo0C,IACO,CAAC,EAAa,IACzB,KAAK,GACDE,EAAK,EAAGC,EAAKjG,EAAMzB,YACnB+H,EAAG50C,MAAQ,GACf,KAAK,GACD,OAAMs0C,EAAKC,EAAGj2C,QACdmnC,EAAQ8O,EAAGD,GACJ,CAAC,EAAa32C,KAAK40C,WAAW9M,KAFP,CAAC,EAAa,IAGhD,KAAK,GACDmP,EAAG30C,OACH20C,EAAG50C,MAAQ,GACf,KAAK,GAED,OADAs0C,IACO,CAAC,EAAa,IACzB,KAAK,GACDE,EAAK,EAAGC,EAAKnG,EAAMtB,uCACnB4H,EAAG50C,MAAQ,GACf,KAAK,GACD,OAAMw0C,EAAKC,EAAGn2C,QACdmnC,EAAQgP,EAAGD,GACJ,CAAC,EAAa72C,KAAKy0C,YAAY3M,KAFR,CAAC,EAAa,IAGhD,KAAK,GACDmP,EAAG30C,OACH20C,EAAG50C,MAAQ,GACf,KAAK,GAED,OADAw0C,IACO,CAAC,EAAa,IACzB,KAAK,GACDE,EAAK,EAAGC,EAAKrG,EAAMrB,eACnB2H,EAAG50C,MAAQ,GACf,KAAK,GACD,OAAM00C,EAAKC,EAAGr2C,QACdmnC,EAAQkP,EAAGD,GACJ,CAAC,EAAa/2C,KAAKy0C,YAAY3M,KAFR,CAAC,EAAa,IAGhD,KAAK,GACDmP,EAAG30C,OACH20C,EAAG50C,MAAQ,GACf,KAAK,GAED,OADA00C,IACO,CAAC,EAAa,IACzB,KAAK,GAAI,MAAO,CAAC,WAKjCrD,EAAexzC,UAAUg3C,KAAO,SAAUC,GACtCn3C,KAAK0mB,IAAIyvB,YACTn2C,KAAK0mB,IAAI0wB,OAAO,EAAG,GACnBp3C,KAAK0mB,IAAI2wB,OAAOr3C,KAAKymB,OAAOljB,MAAO,GACnCvD,KAAK0mB,IAAI2wB,OAAOr3C,KAAKymB,OAAOljB,MAAOvD,KAAKymB,OAAOjjB,QAC/CxD,KAAK0mB,IAAI2wB,OAAO,EAAGr3C,KAAKymB,OAAOjjB,QAC/BxD,KAAK0mB,IAAI2wB,OAAO,EAAG,GACnBr3C,KAAKs3C,WAAWH,EAAMhyC,MAAM,GAAG6mC,WAC/BhsC,KAAK0mB,IAAI6wB,aAEb7D,EAAexzC,UAAUgsC,KAAO,SAAUiL,GACtCn3C,KAAK0mB,IAAIyvB,YACTn2C,KAAKs3C,WAAWH,GAChBn3C,KAAK0mB,IAAI6wB,aAEb7D,EAAexzC,UAAUo3C,WAAa,SAAUH,GAC5C,IAAI1sB,EAAQzqB,KACZm3C,EAAMrsC,SAAQ,SAAU0sC,EAAOhzC,GAC3B,IAAIS,EAAQgnC,GAAcuL,GAASA,EAAMvyC,MAAQuyC,EACnC,IAAVhzC,EACAimB,EAAM/D,IAAI0wB,OAAOnyC,EAAM/B,EAAG+B,EAAM/C,GAGhCuoB,EAAM/D,IAAI2wB,OAAOpyC,EAAM/B,EAAG+B,EAAM/C,GAEhC+pC,GAAcuL,IACd/sB,EAAM/D,IAAI+wB,cAAcD,EAAMnM,aAAanoC,EAAGs0C,EAAMnM,aAAanpC,EAAGs1C,EAAMlM,WAAWpoC,EAAGs0C,EAAMlM,WAAWppC,EAAGs1C,EAAMtyC,IAAIhC,EAAGs0C,EAAMtyC,IAAIhD,OAI/IwxC,EAAexzC,UAAUw3C,aAAe,SAAUxL,EAAMyL,EAASnhB,EAASC,GACtEz2B,KAAKksC,KAAKA,GACVlsC,KAAK0mB,IAAIQ,UAAYywB,EACrB33C,KAAK0mB,IAAIotB,UAAUtd,EAASC,GAC5Bz2B,KAAK0mB,IAAIwvB,OACTl2C,KAAK0mB,IAAIotB,WAAWtd,GAAUC,IAElCid,EAAexzC,UAAU03C,YAAc,SAAUxqB,EAAO7pB,EAAOC,GAC3D,GAAI4pB,EAAM7pB,QAAUA,GAAS6pB,EAAM5pB,SAAWA,EAC1C,OAAO4pB,EAEX,IAAI3G,EAASzmB,KAAKymB,OAAO4V,cAActW,cAAc,UAKrD,OAJAU,EAAOljB,MAAQA,EACfkjB,EAAOjjB,OAASA,EACNijB,EAAOE,WAAW,MACxBC,UAAUwG,EAAO,EAAG,EAAGA,EAAM7pB,MAAO6pB,EAAM5pB,OAAQ,EAAG,EAAGD,EAAOC,GAC5DijB,GAEXitB,EAAexzC,UAAU23C,sBAAwB,SAAU1W,GACvD,OAAOrgC,EAAUd,UAAM,OAAQ,GAAQ,WACnC,IAAIwE,EAAOszC,EAASC,EAAQ1zC,EAAIsG,EAAI2c,EACpC,OAAOvlB,EAAY/B,MAAM,SAAU2W,GAC/B,OAAQA,EAAGtU,OACP,KAAK,EACDmC,EAAQ28B,EAAUvF,OAAOtU,gBAAgB3mB,OAAS,EAClDm3C,EAAU,SAAUxwB,GAChB,IAAI8F,EAAOpE,EAAUre,EAAwCgM,EAA+B61B,EAAI1qB,EAAYk2B,EAAIC,EAAIC,EAAIC,EAAI1xB,EAAQC,EAAK0xB,EAAYT,EAAShL,EAAIT,EAAM7oC,EAAMg1C,EAAO90C,EAAOC,EAAQmpB,EAAUzpB,EAAGhB,EAAGs0C,EAAI8B,EAAIC,EAAIC,EAAkBC,EAAMC,EAAMz2C,EAAG02C,EACjQ,OAAO52C,EAAY/B,MAAM,SAAUy2C,GAC/B,OAAQA,EAAGp0C,OACP,KAAK,EACD,GAAMilB,EAAgBxd,OAAS8W,GAAa0M,IAAM,MAAO,CAAC,EAAa,GACvEF,OAAQ,EACRpE,EAAM1B,EAAgB0B,IACtBytB,EAAGp0C,MAAQ,EACf,KAAK,EAED,OADAo0C,EAAGl0C,KAAKS,KAAK,CAAC,EAAG,EAAJ,CAAS,IACf,CAAC,EAAa+0C,EAAOvtC,QAAQse,MAAMuB,MAAMrB,IACpD,KAAK,EAED,OADAoE,EAAQqpB,EAAGn0C,OACJ,CAAC,EAAa,GACzB,KAAK,EAGD,OAFMm0C,EAAGn0C,OACTslB,GAAOW,YAAYwvB,EAAOvtC,QAAQqd,IAAIY,MAAM,kCAAoCO,GACzE,CAAC,EAAa,GACzB,KAAK,EAUD,OATIoE,IACAziB,EAAK0mC,GAA6BlQ,EAAW38B,EAAO,CAChD4oB,EAAM7pB,MACN6pB,EAAM5pB,OACN4pB,EAAM7pB,MAAQ6pB,EAAM5pB,SACpB0oC,EAAOvhC,EAAG,GAAIzH,EAAIyH,EAAG,GAAIzI,EAAIyI,EAAG,GAAIpH,EAAQoH,EAAG,GAAInH,EAASmH,EAAG,GACnEgtC,EAAUI,EAAOrxB,IAAIkyB,cAAcb,EAAOH,YAAYxqB,EAAO7pB,EAAOC,GAAS,UAC7Eu0C,EAAOL,aAAaxL,EAAMyL,EAASz0C,EAAGhB,IAEnC,CAAC,EAAa,GACzB,KAAK,EACoBolB,EA9vHvCxd,OAAS8W,GAAa2D,iBA+vHA5N,EAAK06B,GAA6BlQ,EAAW38B,EAAO,CAAC,KAAM,KAAM,OAAQ0nC,EAAOv1B,EAAG,GAAIzT,EAAIyT,EAAG,GAAIzU,EAAIyU,EAAG,GAAIpT,EAAQoT,EAAG,GAAInT,EAASmT,EAAG,GACxI61B,EAAK/pB,GAA2B6E,EAAgBvS,MAAOxR,EAAOC,GAASse,EAAa0qB,EAAG,GAAIwL,EAAKxL,EAAG,GAAIyL,EAAKzL,EAAG,GAAI0L,EAAK1L,EAAG,GAAI2L,EAAK3L,EAAG,IACvI/lB,EAAS7B,SAASmB,cAAc,WACzBxiB,MAAQA,EACfkjB,EAAOjjB,OAASA,EAChBkjB,EAAMD,EAAOE,WAAW,MACxByxB,EAAa1xB,EAAImyB,qBAAqBb,EAAIE,EAAID,EAAIE,GAClDv2B,GAAkB0F,EAAgBzF,MAAOC,GAAYhX,SAAQ,SAAUwZ,GACnE,OAAO8zB,EAAWU,aAAax0B,EAAU3C,KAAMzL,GAASoO,EAAU/O,WAEtEmR,EAAIQ,UAAYkxB,EAChB1xB,EAAIS,SAAS,EAAG,EAAG5jB,EAAOC,GACtBD,EAAQ,GAAKC,EAAS,IACtBm0C,EAAUI,EAAOrxB,IAAIkyB,cAAcnyB,EAAQ,UAC3CsxB,EAAOL,aAAaxL,EAAMyL,EAASz0C,EAAGhB,KA3wH/D,SAAU62C,GAC7B,OAAOA,EAAWjvC,OAAS8W,GAAasM,gBA6wHK8rB,CAAiB1xB,KACtBqlB,EAAK0E,GAA6BlQ,EAAW38B,EAAO,CAChD,KACA,KACA,OACA0nC,EAAOS,EAAG,GAAItpC,EAAOspC,EAAG,GAAI0L,EAAQ1L,EAAG,GAAIppC,EAAQopC,EAAG,GAAInpC,EAASmpC,EAAG,GAC1EhgB,EAA+C,IAApCrF,EAAgBqF,SAAShsB,OAAe,CAAC8T,IAAiB6S,EAAgBqF,SACrFzpB,EAAI2R,GAAiB8X,EAAS,GAAIppB,GAClCrB,EAAI2S,GAAiB8X,EAASA,EAAShsB,OAAS,GAAI6C,GACpDgzC,EAj+ItB,SAAUyC,EAAU/1C,EAAGhB,EAAGqB,EAAOC,GACnD,IAAI80C,EAAK,EACLC,EAAK,EACT,OAAQU,EAAS1xB,MACb,KAAKzG,GAAgBiM,aAGbksB,EAASzsB,QAAU3L,GAAe4L,OAClC6rB,EAAKC,EAAK5vC,KAAK+I,IAAI/I,KAAKqa,IAAI9f,GAAIyF,KAAKqa,IAAI9f,EAAIK,GAAQoF,KAAKqa,IAAI9gB,GAAIyG,KAAKqa,IAAI9gB,EAAIsB,IAE1Ey1C,EAASzsB,QAAU3L,GAAeiM,UACvCwrB,EAAK3vC,KAAK+I,IAAI/I,KAAKqa,IAAI9f,GAAIyF,KAAKqa,IAAI9f,EAAIK,IACxCg1C,EAAK5vC,KAAK+I,IAAI/I,KAAKqa,IAAI9gB,GAAIyG,KAAKqa,IAAI9gB,EAAIsB,KAE5C,MACJ,KAAKsd,GAAgBmM,eAGjB,GAAIgsB,EAASzsB,QAAU3L,GAAe4L,OAClC6rB,EAAKC,EAAK5vC,KAAK+I,IAAI8R,GAAStgB,EAAGhB,GAAIshB,GAAStgB,EAAGhB,EAAIsB,GAASggB,GAAStgB,EAAIK,EAAOrB,GAAIshB,GAAStgB,EAAIK,EAAOrB,EAAIsB,SAE3G,GAAIy1C,EAASzsB,QAAU3L,GAAeiM,QAAS,CAEhD,IAAItgB,EAAI7D,KAAK+I,IAAI/I,KAAKqa,IAAI9gB,GAAIyG,KAAKqa,IAAI9gB,EAAIsB,IAAWmF,KAAK+I,IAAI/I,KAAKqa,IAAI9f,GAAIyF,KAAKqa,IAAI9f,EAAIK,IACrFoH,EAAK+Y,GAAWngB,EAAOC,EAAQN,EAAGhB,GAAG,GAAO4hB,EAAKnZ,EAAG,GAAIoZ,EAAKpZ,EAAG,GAEpE4tC,EAAK/rC,GADL8rC,EAAK90B,GAASM,EAAK5gB,GAAI6gB,EAAK7hB,GAAKsK,IAGrC,MACJ,KAAKsU,GAAgBkM,cAEbisB,EAASzsB,QAAU3L,GAAe4L,OAClC6rB,EAAKC,EAAK5vC,KAAK8N,IAAI9N,KAAKqa,IAAI9f,GAAIyF,KAAKqa,IAAI9f,EAAIK,GAAQoF,KAAKqa,IAAI9gB,GAAIyG,KAAKqa,IAAI9gB,EAAIsB,IAE1Ey1C,EAASzsB,QAAU3L,GAAeiM,UACvCwrB,EAAK3vC,KAAK8N,IAAI9N,KAAKqa,IAAI9f,GAAIyF,KAAKqa,IAAI9f,EAAIK,IACxCg1C,EAAK5vC,KAAK8N,IAAI9N,KAAKqa,IAAI9gB,GAAIyG,KAAKqa,IAAI9gB,EAAIsB,KAE5C,MACJ,KAAKsd,GAAgB4L,gBAGjB,GAAIusB,EAASzsB,QAAU3L,GAAe4L,OAClC6rB,EAAKC,EAAK5vC,KAAK8N,IAAI+M,GAAStgB,EAAGhB,GAAIshB,GAAStgB,EAAGhB,EAAIsB,GAASggB,GAAStgB,EAAIK,EAAOrB,GAAIshB,GAAStgB,EAAIK,EAAOrB,EAAIsB,SAE3G,GAAIy1C,EAASzsB,QAAU3L,GAAeiM,QAAS,CAE5CtgB,EAAI7D,KAAK8N,IAAI9N,KAAKqa,IAAI9gB,GAAIyG,KAAKqa,IAAI9gB,EAAIsB,IAAWmF,KAAK8N,IAAI9N,KAAKqa,IAAI9f,GAAIyF,KAAKqa,IAAI9f,EAAIK,IAAzF,IACIoT,EAAK+M,GAAWngB,EAAOC,EAAQN,EAAGhB,GAAG,GAAQ4hB,EAAKnN,EAAG,GAAIoN,EAAKpN,EAAG,GAErE4hC,EAAK/rC,GADL8rC,EAAK90B,GAASM,EAAK5gB,GAAI6gB,EAAK7hB,GAAKsK,KAS7C,OAJI7M,MAAMwI,QAAQ8wC,EAAS1xB,QACvB+wB,EAAKzjC,GAAiBokC,EAAS1xB,KAAK,GAAIhkB,GACxCg1C,EAA8B,IAAzBU,EAAS1xB,KAAK5mB,OAAekU,GAAiBokC,EAAS1xB,KAAK,GAAI/jB,GAAU80C,GAE5E,CAACA,EAAIC,GAu6IiCW,CAAgB5xB,EAAiBpkB,EAAGhB,EAAGqB,EAAOC,GAAS80C,EAAK9B,EAAG,GAAI+B,EAAK/B,EAAG,GAC5E8B,EAAK,GAAKA,EAAK,IACfE,EAAmBT,EAAOrxB,IAAIyyB,qBAAqB91C,EAAOH,EAAGm1C,EAAQn2C,EAAG,EAAGmB,EAAOH,EAAGm1C,EAAQn2C,EAAGo2C,GAChG12B,GAAkB0F,EAAgBzF,MAAY,EAALy2B,GAAQxtC,SAAQ,SAAUwZ,GAC/D,OAAOk0B,EAAiBM,aAAax0B,EAAU3C,KAAMzL,GAASoO,EAAU/O,WAE5EwiC,EAAO7L,KAAKA,GACZ6L,EAAOrxB,IAAIQ,UAAYsxB,EACnBF,IAAOC,GACPE,EAAOtX,EAAUlF,OAAO54B,KAAO,GAAM89B,EAAUlF,OAAO14B,MACtDm1C,EAAOvX,EAAUlF,OAAO34B,IAAM,GAAM69B,EAAUlF,OAAOz4B,OAErDm1C,EAAO,GADP12C,EAAIs2C,EAAKD,GAETP,EAAOrxB,IAAI0tB,OACX2D,EAAOrxB,IAAIotB,UAAU2E,EAAMC,GAC3BX,EAAOrxB,IAAIsQ,UAAU,EAAG,EAAG,EAAG/0B,EAAG,EAAG,GACpC81C,EAAOrxB,IAAIotB,WAAW2E,GAAOC,GAC7BX,EAAOrxB,IAAIS,SAAS9jB,EAAMs1C,GAAQN,EAAQK,GAAQA,EAAMn1C,EAAOC,EAASm1C,GACxEZ,EAAOrxB,IAAI8tB,WAGXuD,EAAOrxB,IAAIwvB,SAIvBO,EAAGp0C,MAAQ,EACf,KAAK,EAED,OADAmC,IACO,CAAC,QAIxBuzC,EAAS/3C,KACTqE,EAAK,EAAGsG,EAAKw2B,EAAUvF,OAAOtU,gBAAgBniB,MAAM,GAAG6mC,UACvDr1B,EAAGtU,MAAQ,EACf,KAAK,EACD,OAAMgC,EAAKsG,EAAGhK,QACd2mB,EAAkB3c,EAAGtG,GACd,CAAC,EAAcyzC,EAAQxwB,KAFA,CAAC,EAAa,GAGhD,KAAK,EACD3Q,EAAGrU,OACHqU,EAAGtU,MAAQ,EACf,KAAK,EAED,OADAgC,IACO,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,WAKhCqvC,EAAexzC,UAAUk5C,aAAe,SAAU7jC,EAAOiZ,EAAM6qB,GAC3D,OAAOv4C,EAAUd,UAAM,OAAQ,GAAQ,WACnC,OAAO+B,EAAY/B,MAAM,SAAU2K,GAI/B,OAHA3K,KAAKksC,KAp4BI,SAAU2C,EAAQyK,GACvC,OAAQA,GACJ,KAAK,EACD,OAAOvI,GAAqBlC,EAAOzB,iBAAkByB,EAAOhB,kBAAmBgB,EAAOtB,kBAAmBsB,EAAOf,oBACpH,KAAK,EACD,OAAOiD,GAAqBlC,EAAOtB,kBAAmBsB,EAAOf,mBAAoBe,EAAOpB,qBAAsBoB,EAAOd,uBACzH,KAAK,EACD,OAAOgD,GAAqBlC,EAAOpB,qBAAsBoB,EAAOd,sBAAuBc,EAAOlB,oBAAqBkB,EAAOb,sBAC9H,KAAK,EACL,QACI,OAAO+C,GAAqBlC,EAAOlB,oBAAqBkB,EAAOb,qBAAsBa,EAAOzB,iBAAkByB,EAAOhB,oBA03BvG0L,CAAmBF,EAAa7qB,IAC1CxuB,KAAK0mB,IAAIQ,UAAYhR,GAASX,GAC9BvV,KAAK0mB,IAAIwvB,OACF,CAAC,UAIpBxC,EAAexzC,UAAU40C,+BAAiC,SAAUD,GAChE,OAAO/zC,EAAUd,UAAM,OAAQ,GAAQ,WACnC,IAAI47B,EAAQ4d,EAAeC,EAAS/H,EAAwBljB,EAAMnqB,EAAIq1C,EAAWjQ,EAC7Ehf,EAAQzqB,KACZ,OAAO+B,EAAY/B,MAAM,SAAU2K,GAC/B,OAAQA,EAAGtI,OACP,KAAK,EAWD,OAVArC,KAAKg0C,aAAaa,EAAMlF,QAAS,GACjC/T,EAASiZ,EAAM1T,UAAUvF,OACzB4d,GAAiBvjC,GAAc2lB,EAAOta,kBAAoBsa,EAAOtU,gBAAgB3mB,OACjF84C,EAAU,CACN,CAAEzzB,MAAO4V,EAAOrM,eAAgBha,MAAOqmB,EAAOnN,gBAC9C,CAAEzI,MAAO4V,EAAOpM,iBAAkBja,MAAOqmB,EAAOlN,kBAChD,CAAE1I,MAAO4V,EAAOnM,kBAAmBla,MAAOqmB,EAAOjN,mBACjD,CAAE3I,MAAO4V,EAAOlM,gBAAiBna,MAAOqmB,EAAOhN,kBAEnD8iB,EAAyBiI,GAAsClI,GAA2B7V,EAAO7a,eAAgB,GAAI8zB,EAAMhG,QACrH2K,GAAiB5d,EAAOvB,UAAU15B,QACxCX,KAAK0mB,IAAI0tB,OACTp0C,KAAKksC,KAAKwF,GACV1xC,KAAK0mB,IAAI6tB,OACJt+B,GAAc2lB,EAAOta,mBACtBthB,KAAK0mB,IAAIQ,UAAYhR,GAAS0lB,EAAOta,iBACrCthB,KAAK0mB,IAAIwvB,QAEN,CAAC,EAAal2C,KAAK63C,sBAAsBhD,EAAM1T,aARE,CAAC,EAAa,GAS1E,KAAK,EACDx2B,EAAGrI,OACHtC,KAAK0mB,IAAI8tB,UACT5Y,EAAOvB,UACFl1B,MAAM,GACN6mC,UACAlhC,SAAQ,SAAUyrB,GACnB9L,EAAM/D,IAAI0tB,OACV,IAhxCElI,EAAMjB,EAAQC,EAAQ0O,EAAQC,EAgxC5BC,EAAgBlL,GAAuBiG,EAAMhG,QAC7CkL,EAAaxjB,EAAOgE,MAAQ,EAzpB1C,IA0pBcyf,GAlxCF9N,EAkxCqC4N,EAlxC/B7O,GAkxC+C8O,GAAcxjB,EAAOgE,MAAQ,GAAK,GAAKhE,EAAO+D,OAAOvoB,OAlxC5Fm5B,GAkxCqG3U,EAAOgE,MAAQ,GAAK,GAAKhE,EAAO+D,OAAOvoB,OAlxCpI6nC,EAkxC4IrjB,EAAO+D,OAAOvoB,QAAUwkB,EAAOgE,OAAS,EAAI,GAlxChLsf,EAkxCoLtjB,EAAO+D,OAAOvoB,QAAUwkB,EAAOgE,OAAS,EAAI,GAjxCjR2R,EAAKhhC,KAAI,SAAUssC,EAAOhzC,GAC7B,OAAQA,GACJ,KAAK,EACD,OAAOgzC,EAAM/zC,IAAIwnC,EAAQC,GAC7B,KAAK,EACD,OAAOsM,EAAM/zC,IAAIwnC,EAAS2O,EAAQ1O,GACtC,KAAK,EACD,OAAOsM,EAAM/zC,IAAIwnC,EAAS2O,EAAQ1O,EAAS2O,GAC/C,KAAK,EACD,OAAOrC,EAAM/zC,IAAIwnC,EAAQC,EAAS2O,GAE1C,OAAOrC,MAuwCiBjhB,EAAOgE,OACP9P,EAAMyhB,KAAK4N,GACXrvB,EAAM/D,IAAI6tB,OACV9pB,EAAMysB,KAAK8C,KAGXvvB,EAAMysB,KAAK4C,GACXrvB,EAAM/D,IAAI6tB,OACV9pB,EAAMyhB,KAAK8N,IAEfvvB,EAAM/D,IAAIgvB,cAAgBnf,EAAOC,QAAQzkB,OAASgoC,EAClDtvB,EAAM/D,IAAIivB,cAAgBpf,EAAOE,QAAQ1kB,OACzC0Y,EAAM/D,IAAI+uB,YAAcv/B,GAASqgB,EAAOhhB,OACxCkV,EAAM/D,IAAIkvB,WAAarf,EAAOG,KAAK3kB,OACnC0Y,EAAM/D,IAAIQ,UAAYqP,EAAOgE,MAAQrkB,GAASqgB,EAAOhhB,OAAS,gBAC9DkV,EAAM/D,IAAIwvB,OACVzrB,EAAM/D,IAAI8tB,aAEd7pC,EAAGtI,MAAQ,EACf,KAAK,EACDmsB,EAAO,EACPnqB,EAAK,EAAGq1C,EAAYD,EACpB9uC,EAAGtI,MAAQ,EACf,KAAK,EACD,OAAMgC,EAAKq1C,EAAU/4C,QACrB8oC,EAASiQ,EAAUr1C,IACN2hB,QAAUoI,GAAaiB,MAASpZ,GAAcwzB,EAAOl0B,OAAgB,CAAC,EAAa,GACzF,CAAC,EAAavV,KAAKo5C,aAAa3P,EAAOl0B,MAAOiZ,EAAMqmB,EAAMhG,SAH5B,CAAC,EAAa,GAIvD,KAAK,EACDlkC,EAAGrI,OACHqI,EAAGtI,MAAQ,EACf,KAAK,EACDmsB,IACA7jB,EAAGtI,MAAQ,EACf,KAAK,EAED,OADAgC,IACO,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,WAKhCqvC,EAAexzC,UAAU+1C,OAAS,SAAUta,GACxC,OAAO76B,EAAUd,UAAM,OAAQ,GAAQ,WACnC,IAAI2wC,EACJ,OAAO5uC,EAAY/B,MAAM,SAAU2K,GAC/B,OAAQA,EAAGtI,OACP,KAAK,EAMD,OALIrC,KAAKwK,QAAQ8W,kBACbthB,KAAK0mB,IAAIQ,UAAYhR,GAASlW,KAAKwK,QAAQ8W,iBAC3CthB,KAAK0mB,IAAIS,SAASnnB,KAAKwK,QAAQtH,EAAIlD,KAAKwK,QAAQ26B,QAASnlC,KAAKwK,QAAQtI,EAAIlC,KAAKwK,QAAQ86B,QAAStlC,KAAKwK,QAAQjH,MAAOvD,KAAKwK,QAAQhH,SAErImtC,EAAQR,GAAsBxU,GACvB,CAAC,EAAa37B,KAAKy0C,YAAY9D,IAC1C,KAAK,EAGD,OAFAhmC,EAAGrI,OACHtC,KAAKg0C,aAAa,GAAI,GACf,CAAC,EAAch0C,KAAKymB,gBAKxCitB,EAxtByB,GA0tBhC2C,GAAqB,SAAUlV,GAC/B,OAAIA,aAAqBrB,IAGhBqB,aAAqBxB,IAGrBwB,aAAqB7B,IA76EtB,UA66E+C6B,EAAUr3B,MA96EtD,aA86EwEq3B,EAAUr3B,MAK7F6vC,GAAwC,SAAUpF,EAAM1F,GACxD,OAAQ0F,GACJ,KAAKt9B,GAAgBoK,WACjB,OAAOutB,GAAuBC,GAClC,KAAK53B,GAAgBmK,YACjB,OAvrCkB,SAAUytB,GACpC,MAAO,CACHA,EAAOZ,kBACPY,EAAOX,mBACPW,EAAOV,sBACPU,EAAOT,sBAkrCI6L,CAAwBpL,GACnC,KAAK53B,GAAgBkK,YACrB,QACI,OAAO2tB,GAAwBD,KAGvCyH,GAAkB,SAAUxgB,GAC5B,OAAQA,GACJ,KAAKT,GAAWU,OACZ,MAAO,SACX,KAAKV,GAAW/E,MACZ,MAAO,QACX,KAAK+E,GAAWhF,KAChB,QACI,MAAO,SAIf6pB,GAAuC,WACvC,SAASA,EAAsB1vC,GAC3BxK,KAAKymB,OAASjc,EAAQic,OAASjc,EAAQic,OAAS7B,SAASmB,cAAc,UACvE/lB,KAAK0mB,IAAM1mB,KAAKymB,OAAOE,WAAW,MAClC3mB,KAAKwK,QAAUA,EACfxK,KAAKymB,OAAOljB,MAAQoF,KAAKk7B,MAAMr5B,EAAQjH,MAAQiH,EAAQopC,OACvD5zC,KAAKymB,OAAOjjB,OAASmF,KAAKk7B,MAAMr5B,EAAQhH,OAASgH,EAAQopC,OACzD5zC,KAAKymB,OAAOT,MAAMziB,MAAQiH,EAAQjH,MAAQ,KAC1CvD,KAAKymB,OAAOT,MAAMxiB,OAASgH,EAAQhH,OAAS,KAC5CxD,KAAK0mB,IAAIktB,MAAM5zC,KAAKwK,QAAQopC,MAAO5zC,KAAKwK,QAAQopC,OAChD5zC,KAAK0mB,IAAIotB,WAAWtpC,EAAQtH,EAAIsH,EAAQ26B,SAAU36B,EAAQtI,EAAIsI,EAAQ86B,SACtE1d,GAAOW,YAAY/d,EAAQqd,IAAII,MAAM,oDAAsDzd,EAAQjH,MAAQ,IAAMiH,EAAQhH,OAAS,OAASgH,EAAQtH,EAAI,IAAMsH,EAAQtI,EAAI,gBAAkBsI,EAAQopC,OAsBvM,OApBAsG,EAAsBh6C,UAAU+1C,OAAS,SAAUta,GAC/C,OAAO76B,EAAUd,UAAM,OAAQ,GAAQ,WACnC,IAAI2kB,EAAKQ,EACT,OAAOpjB,EAAY/B,MAAM,SAAU2K,GAC/B,OAAQA,EAAGtI,OACP,KAAK,EAED,OADAsiB,EAAMF,GAAuB9b,KAAK8N,IAAIzW,KAAKwK,QAAQurC,YAAa/1C,KAAKwK,QAAQjH,OAASvD,KAAKwK,QAAQopC,MAAOjrC,KAAK8N,IAAIzW,KAAKwK,QAAQwrC,aAAch2C,KAAKwK,QAAQhH,QAAUxD,KAAKwK,QAAQopC,MAAO5zC,KAAKwK,QAAQ26B,QAAUnlC,KAAKwK,QAAQopC,MAAO5zC,KAAKwK,QAAQ86B,QAAUtlC,KAAKwK,QAAQopC,MAAOjY,GACxQ,CAAC,EAAawe,GAAoBx1B,IAC7C,KAAK,EAOD,OANAQ,EAAMxa,EAAGrI,OACLtC,KAAKwK,QAAQ8W,kBACbthB,KAAK0mB,IAAIQ,UAAYhR,GAASlW,KAAKwK,QAAQ8W,iBAC3CthB,KAAK0mB,IAAIS,SAAS,EAAG,EAAGnnB,KAAKwK,QAAQjH,MAAQvD,KAAKwK,QAAQopC,MAAO5zC,KAAKwK,QAAQhH,OAASxD,KAAKwK,QAAQopC,QAExG5zC,KAAK0mB,IAAIE,UAAUzB,GAAMnlB,KAAKwK,QAAQtH,EAAIlD,KAAKwK,QAAQopC,OAAQ5zC,KAAKwK,QAAQtI,EAAIlC,KAAKwK,QAAQopC,OACtF,CAAC,EAAc5zC,KAAKymB,gBAKxCyzB,EAjCgC,GAmCvCC,GAAsB,SAAUx1B,GAChC,OAAO,IAAIxjB,SAAQ,SAAUC,EAASC,GAClC,IAAI8jB,EAAM,IAAIC,MACdD,EAAIE,OAAS,WACTjkB,EAAQ+jB,IAEZA,EAAIG,QAAUjkB,EACd8jB,EAAII,IAAM,oCAAsCC,oBAAmB,IAAIC,eAAgBC,kBAAkBf,QAK7Gy1B,GAAe,SAAU74C,GAAS,OAAOgU,GAAYhD,GAAOpS,OAAOoB,GAAOoR,wBAKxD,qBAAXqU,QACP0B,GAAae,WAAWzC,QAE5B,IAAIqzB,GAAgB,SAAU1e,EAAS2e,GAAQ,OAAOx5C,OAT1CsK,OAS2D,OAAQ,GAAQ,WACnF,IAAIixB,EAAe+I,EAAamV,EAAc5vC,EAAIpH,EAAOC,EAAQH,EAAMC,EAA6Bk3C,EAAiBC,EAAgBjwC,EAASkwC,EAAcC,EAAgBC,EAAezZ,EAAWb,EAAyBC,EAAqBsa,EAASC,EAAwBx5B,EAAiBy5B,EAAet0B,EAAkB4a,EACvU,OAAOt/B,EAAY/B,MAAM,SAAU2W,GAC/B,OAAQA,EAAGtU,OACP,KAAK,EAED,KADAg6B,EAAgBV,EAAQU,eAEpB,MAAM,IAAIjoB,MAAM,yCAGpB,KADAgxB,EAAc/I,EAAc+I,aAExB,MAAM,IAAIhxB,MAAM,wCAwCpB,OAtCAmmC,GAAgB5xC,KAAK4N,MAAsB,IAAhB5N,KAAKqyC,UAAmBjzB,KAAKC,OAAOhD,SAAS,IACxEra,EAAKm3B,GAAcnG,IAp2E2B,SAo2EDA,EAp2EXkG,QA71I1B,SAAUjd,GAC9B,IAAI5iB,EAAO4iB,EAAS5iB,KAChBm+B,EAAkBvb,EAASub,gBAC/B,IAAKn+B,IAASm+B,EACV,MAAM,IAAI/rB,MAAM,+BAEpB,IAAI7Q,EAAQoF,KAAK8N,IAAI9N,KAAK8N,IAAIzU,EAAKi5C,YAAa9a,EAAgB8a,aAActyC,KAAK8N,IAAIzU,EAAKk5C,YAAa/a,EAAgB+a,aAAcvyC,KAAK8N,IAAIzU,EAAKm5C,YAAahb,EAAgBgb,cAC9K33C,EAASmF,KAAK8N,IAAI9N,KAAK8N,IAAIzU,EAAKo5C,aAAcjb,EAAgBib,cAAezyC,KAAK8N,IAAIzU,EAAKq5C,aAAclb,EAAgBkb,cAAe1yC,KAAK8N,IAAIzU,EAAKs5C,aAAcnb,EAAgBmb,eACxL,OAAO,IAAIr4C,EAAO,EAAG,EAAGM,EAAOC,GAyrNqC+3C,CAAkBlf,GAAiBz4B,EAAY+3B,GAAUp4B,EAAQoH,EAAGpH,MAAOC,EAASmH,EAAGnH,OAAQH,EAAOsH,EAAGtH,KAAMC,EAAMqH,EAAGrH,IAOhLk3C,EAAkBp6C,EAAS,GANF,CACrB0qB,YAAY,EACZI,aAAc,KACdN,WAAOxf,EACPmf,SAAS,GAE0C+vB,GACvDG,EAAiB,CACbn5B,gBAAiB,UACjBwH,MAAOwxB,EAAKxxB,MAAQwxB,EAAKxxB,MAAQJ,GAAavoB,OAAOo6C,EAAcC,GACnEgB,SAAS,EACTC,iBAAiB,EACjBC,wBAAwB,EACxB9H,MAAOxO,EAAYuW,kBAAoB,EACvC5F,YAAa3Q,EAAYwW,WACzB5F,aAAc5Q,EAAYyW,YAC1B1W,QAASC,EAAYC,YACrBC,QAASF,EAAYG,YACrBriC,EAAGG,EACHnB,EAAGoB,EACHC,MAAOoF,KAAKC,KAAKrF,GACjBC,OAAQmF,KAAKC,KAAKpF,GAClBqkB,GAAI0yB,GAER/vC,EAAUpK,EAAS,GAAIq6C,EAAgBD,EAAiBF,GACxDI,EAAe,IAAIz3C,EAAOuH,EAAQ26B,QAAS36B,EAAQ86B,QAAS96B,EAAQurC,YAAavrC,EAAQwrC,cACzFpuB,GAAOznB,OAAO,CAAE0nB,GAAI0yB,EAAczyB,QAAStd,EAAQgxC,UACnD5zB,GAAOW,YAAYgyB,GAActyB,MAAM,2BACvC0yB,EAAiB,IAAI/V,GAAejJ,EAAS,CACzC9T,GAAI0yB,EACJ3U,QAASp7B,EAAQo7B,QACjBoC,eAAgBx9B,EAAQw9B,eACxBZ,aAAc58B,EAAQkxC,uBACtBzT,WAAYz9B,EAAQkxC,0BAExBd,EAAgBD,EAAe1U,wBAIxB,CAAC,EAAa0U,EAAe3V,SAAS3I,EAAeqe,IAFjD,CAAC,EAAcv5C,QAAQE,OAAO,4CAG7C,KAAK,EAgCD,OA/BA8/B,EAAYxqB,EAAGrU,OACfg+B,EAA0BjE,EAAc8D,gBAClCia,GAAave,iBAAiBQ,EAAc8D,iBAAiB7e,iBAC7DxL,GAAOE,YACbuqB,EAAsBlE,EAAcr6B,KAC9Bo4C,GAAave,iBAAiBQ,EAAcr6B,MAAMsf,iBAClDxL,GAAOE,YACb6kC,EAAUP,EAAKh5B,gBACfw5B,EAA4C,kBAAZD,EAAuBT,GAAaS,GAAuB,OAAZA,EAAmB/kC,GAAOE,YAAc,WACvHsL,EAAkBqa,IAAYU,EAAc8D,gBACtClqB,GAAcqqB,GACVrqB,GAAcsqB,GACVua,EACAva,EACJD,EACJwa,EACNC,EAAgB,CACZlzB,GAAI0yB,EACJzxB,MAAOte,EAAQse,MACfrC,OAAQjc,EAAQic,OAChBnF,gBAAiBA,EACjBsyB,MAAOppC,EAAQopC,MACf1wC,EAAGsH,EAAQtH,EACXhB,EAAGsI,EAAQtI,EACXijC,QAAS36B,EAAQ26B,QACjBG,QAAS96B,EAAQ86B,QACjB/hC,MAAOiH,EAAQjH,MACfC,OAAQgH,EAAQhH,OAChBuyC,YAAavrC,EAAQurC,YACrBC,aAAcxrC,EAAQwrC,cAErBxrC,EAAQkxC,wBACb9zB,GAAOW,YAAYgyB,GAActyB,MAAM,mDAEhC,CAAC,EADG,IAAIiyB,GAAsBa,GACP9E,OAAO2E,KAHO,CAAC,EAAa,GAI9D,KAAK,EAED,OADAn0B,EAAS9P,EAAGrU,OACL,CAAC,EAAa,GACzB,KAAK,EAWD,OAVAslB,GAAOW,YAAYgyB,GAActyB,MAAM,6CACvCS,GAAakB,eAAepf,EAAQse,OACpClB,GAAOW,YAAYgyB,GAActyB,MAAM,wBACvCoZ,EAAOhB,GAAUua,GACjBlyB,GAAamB,iBACTvI,IAAoB+f,EAAKzF,OAAOta,kBAChC+f,EAAKzF,OAAOta,gBAAkBxL,GAAOE,aAEzC4R,GAAOW,YAAYgyB,GAActyB,MAAM,qBAEhC,CAAC,EADG,IAAIyrB,GAAeqH,GACA9E,OAAO5U,IACzC,KAAK,EACD5a,EAAS9P,EAAGrU,OACZqU,EAAGtU,MAAQ,EACf,KAAK,EASD,OARgC,IAA5BmI,EAAQixC,kBACH7W,GAAetc,QAAQ6Y,IACxBvZ,GAAOW,YAAYgyB,GAAc9xB,MAAM,gEAG/Cb,GAAOW,YAAYgyB,GAActyB,MAAM,sBACvCL,GAAOU,QAAQiyB,GACf7xB,GAAaJ,QAAQiyB,GACd,CAAC,EAAc9zB,WAKtC,OAlIkB,SAAUkV,EAASnxB,GAEjC,YADgB,IAAZA,IAAsBA,EAAU,IAC7B6vC,GAAc1e,EAASnxB,IA/xN8CsxC,I,oBCPpF38C,EAAOC,QAAU,CAAC,UAAY,0B,oBCA9BD,EAAOC,QAAU,CAAC,UAAY,yB,oBCA9BD,EAAOC,QAAU,CAAC,UAAY,yB,oBCA9BD,EAAOC,QAAU,CAAC,UAAY,0B,oBCA9BD,EAAOC,QAAU,CAAC,UAAY,yB,oBCA9BD,EAAOC,QAAU,CAAC,UAAY,yB,oBCA9BD,EAAOC,QAAU,CAAC,UAAY,uBAAuB,WAAa,wBAAwB,aAAe,4B,oBCAzGD,EAAOC,QAAU,CAAC,UAAY,yB,oBCA9BD,EAAOC,QAAU,CAAC,UAAY,4B,oBCA9BD,EAAOC,QAAU,CAAC,UAAY,0BAA0B,2BAA2B,2C,oBCAnFD,EAAOC,QAAU,CAAC,UAAY,uBAAuB,WAAW,wB,oBCAhED,EAAOC,QAAU,CAAC,UAAY,6B,oBCA9BD,EAAOC,QAAU,CAAC,UAAY,0BAA0B,WAAW,2B,oBCAnED,EAAOC,QAAU,CAAC,UAAY,0B,oBCA9BD,EAAOC,QAAU,CAAC,UAAY,2B,oBCA9BD,EAAOC,QAAU,CAAC,UAAY,6B,kBCD9BD,EAAOC,QAAU,8uN,oBCCjBD,EAAOC,QAAU,CAAC,UAAY,6B,yDCA9BD,EAAOC,QAAU,CAAC,UAAY,uBAAuB,KAAO,kBAAkB,MAAQ,mBAAmB,SAAW,sBAAsB,SAAW,sBAAsB,OAAS,sB,mBCApLD,EAAOC,QAAU,CAAC,UAAY,wBAAwB,KAAO,mBAAmB,GAAK,iBAAiB,KAAO,mBAAmB,IAAM,kBAAkB,SAAW,uBAAuB,QAAU,wB,mBCApMD,EAAOC,QAAU,CAAC,UAAY,8BAA8B,KAAO,yBAAyB,OAAS,2BAA2B,KAAO,yBAAyB,QAAU,8B,mBCA1KD,EAAOC,QAAU,CAAC,UAAY,wBAAwB,OAAS,qBAAqB,KAAO,mBAAmB,QAAU,sBAAsB,OAAS,uB,+JCS1I28C,EAAkB,SAACC,GAAD,OAC9B,qCACCh2B,MAAOg2B,EAAMh2B,MACboc,UAAW7hC,IAAE4gC,UACb8a,IAAKD,EAAME,UACPF,EAAMG,YAEV,uBACC/Z,UAAW,CACV7hC,IAAEisB,MACF4vB,IAAYC,OACZtD,IAAWuD,SACVjnC,KAAK,S,oCClBGknC,EAAmB,kBAC5B,gBAAC,IAAD,CAAYhnC,MAAM,aACd,uBAAK6sB,UAAW7hC,IAAE4gC,WACd,gBAAC,IAAD,KACI,uBAAKiB,UAAW7hC,IAAEi8C,MAAlB,8BAC+B,2BAD/B,+BAKJ,gBAAC,IAAD,MACA,gBAAC,IAAD,CACI1yC,KAAK,SACLyd,KAAMk1B,IAAOl1B,KAAKm1B,OAClBC,WAAS,EACT32B,MAAOy2B,IAAOz2B,MAAM42B,OACpBC,SAAS,c,kBCfZC,EAAmB,kBAC5B,uBAAK1a,UAAW,CAAC7hC,IAAE4gC,UAAW4X,IAAWgE,WAAW1nC,KAAK,MACrD,gBAAC,IAAD,2B,yBCqBF2nC,EAAU,SAAChB,GACb,OAAoB,OAAhBA,EAAMiB,MAAuB,GAC1BjB,EAAMiB,MAAM17C,MAAM27C,KACpBhyC,KAAI,SAACiyC,GAAD,OAASA,EAAI57C,MAAMy6C,EAAMoB,UAC7BjoC,QAAO,SAACgoC,GAAD,OAAUnB,EAAMkB,KAAKG,SAASF,OAGxCG,EAAiB,SAACtB,EAAcx3C,GAClC,OAAO,SAAC+4C,GACJvB,EAAMwB,QAjBI,SAACh5C,GACf,OAAO,SAAC04C,GAAD,OAAUA,EAAK/nC,QAAO,SAACsoC,EAAIj9C,GAAL,OAAWA,IAAMgE,MAgB5Bk5C,CAAUl5C,IACxB+4C,EAAMI,kBAGNJ,EAAMK,YAAYC,6BAIbC,EAAiB,SAAC9B,GAAD,OAC1B,2BACKA,EAAMkB,KAAKhyC,KAAI,SAACiyC,EAAK34C,GAAN,aACZ,uBAAK49B,UAAW7hC,IAAE48C,IAAK7yB,IAAK9lB,GACxB,uBAAK49B,UAAW7hC,IAAEg/B,OACd,gBAAC,IAAD,CACIh+B,MAAO47C,EACPY,SAAU,SAACx8C,GACPy6C,EAAMwB,QA7BnB,SAACh5C,EAAe24C,GAC3B,OAAO,SAACD,GAAD,OAAUA,EAAKhyC,KAAI,SAACwK,EAAGlV,GAAJ,OAAWA,IAAMgE,EAAQ24C,EAAMznC,MA4BnBsoC,CAAOx5C,EAAOjD,KAIhC08C,KAAM,CACFp2B,GAAG,GAAD,iBAAKm0B,EAAMiB,aAAX,aAAK,EAAap1B,GAAlB,iBAA6BrjB,GAC/ByO,OAAQ+pC,EAAQhB,IAEpBz0B,KAAM22B,IAAM32B,KAAK42B,MACjBn4B,MAAOk4B,IAAMl4B,MAAMo4B,KACnB3e,YAAY,YAGpB,gBAAC,IAAD,CAAOlY,KAAM,IACb,gBAAC,IAAD,CAAQhS,MAAM,SACd,gBAAC,IAAD,CAAOgS,KAAM,IACF,IAAV/iB,EACG,gBAAC,IAAD,CACI65C,QAAS,WAAWrC,EAAMwB,SAtDvC,SAACN,GAAD,OAAUA,EAAK/zC,OAAO,QAuDTm1C,KAAMC,IAAMC,KACZx4B,MAAOy2B,IAAOz2B,MAAMo4B,KACpB72B,KAAMk1B,IAAOl1B,KAAK42B,MAClBM,MAAM,uCAGV,gBAAC,IAAD,CACIJ,QAASf,EAAetB,EAAOx3C,GAC/B85C,KAAMC,IAAMG,MACZ14B,MAAOy2B,IAAOz2B,MAAMo4B,KACpB72B,KAAMk1B,IAAOl1B,KAAK42B,MAClBM,MAAM,uC,iBCjExBzB,EAAU,SAAChB,GACb,OAAOA,EAAM2C,OAAOzzC,KAAI,SAAC+xC,GAAD,OAAWA,EAAM17C,MAAMiS,SAG7CorC,EAAW,SAAC5C,GAAoC,IAAD,EAIjD,iBAAOA,EAAM2C,OAAOE,MAHL,SAAC5B,GACZ,OAAOA,EAAM17C,MAAMiS,OAASwoC,EAAMiB,gBAEtC,QAAoC,MAG3B6B,EAAiB,SAAC9C,GAAD,OAC1B,uBAAK5Z,UAAW7hC,IAAE4gC,WACd,uBAAKiB,UAAW7hC,IAAE8B,OACd,gBAAC,IAAD,KAAY25C,EAAM35C,QAEtB,gBAAC,IAAD,CAAOklB,KAAM,IACb,uBAAK6a,UAAW7hC,IAAE08C,OACd,gBAAC,IAAD,CACI17C,MAAOy6C,EAAMiB,MACbc,SAAU/B,EAAM+C,SAChBC,UAAWhD,EAAMgD,UACjBz3B,KAAM22B,IAAM32B,KAAK42B,MACjBn4B,MAAOk4B,IAAMl4B,MAAMo4B,KACnB3e,YAAY,QACZwe,KAAM,CACFp2B,GAAG,GAAD,OAAKm0B,EAAM35C,MAAX,UACF4Q,OAAQ+pC,EAAQhB,OAI5B,gBAAC,IAAD,CAAOz0B,KAAM,IACb,gBAAC,IAAD,CAAQhS,MAAM,SACd,gBAAC,IAAD,CAAOgS,KAAM,IACb,gBAAC,EAAD,CACI61B,MAAOpB,EAAMoB,MACbH,MAAO2B,EAAS5C,GAChBkB,KAAMlB,EAAMkB,KACZM,QAASxB,EAAMwB,YClCrBoB,EAAW,SAAC5C,GACd,IAAMn0B,EAAKm0B,EAAMiD,UACXhC,EAAQjB,EAAM2C,OAAOE,MAAK,SAACv+C,GAAD,OAAOA,EAAEunB,KAAOA,KAChD,QAAczc,IAAV6xC,EAAqB,MAAM7oC,MAAM,UAAD,OAAWyT,EAAX,gBACpC,OAAOo1B,GAmBLiC,EAAc,SAChBlD,EACAmD,EACAC,GAEA,IAAMnC,EAAQjB,EAAM2C,OAAOE,MAAK,SAAC5B,GAAD,OAAWA,EAAM17C,MAAMiS,OAAS2rC,KAChE,QAAc/zC,IAAV6xC,EAAqB,MAAM7oC,MAAM,UAAD,OAAW+qC,EAAX,mBACpC,IAAMjC,EAAiBkC,EAAQl0C,KAAI,SAAC2c,GAChC,IAAMs1B,EAAMF,EAAM17C,MAAM27C,KAAK2B,MAAK,SAAC1B,GAC/B,OAAOA,EAAI57C,MAAMy6C,EAAMoB,SAAWv1B,KAEtC,QAAYzc,IAAR+xC,EAAmB,OAAOA,EAAIt1B,GAClC,MAAMzT,MAAM,QAAD,OAASyT,EAAT,mBAEf,MAAO,CAAEo1B,MAAOA,EAAMp1B,GAAIq1B,SAmBxBmC,EAAkBz6B,SAAS06B,eAAe,WAChD,GAAwB,OAApBD,EAA0B,MAAMjrC,MAAM,oBAE1C,IAAMguB,EAAY,CACd7hC,IAAE4gC,UACFoe,IAAOC,KACPzG,IAAWuD,QACXjiB,IAAUgiB,OACVD,IAAYC,QACdhnC,KAAK,KAEMoqC,EAAa,SAACzD,GAAkB,IAAD,EACN0D,YAAuB,WACrD,OA9DoB,SAAC1D,GAA0B,IAAD,EAC5CiB,EAAQ2B,EAAS5C,GACvB,wBAAOiB,QAAP,IAAOA,OAAP,EAAOA,EAAO17C,MAAMiS,YAApB,QAA4B,GA4DjBmsC,CAAoB3D,MAFS,mBACjCiD,EADiC,KACtBW,EADsB,OAIRF,YAAyB,WACrD,OA5DmB,SAAC1D,GACxB,IAAM6D,EAAM7D,EAAM8D,SACZ7C,EAAQ2B,EAAS5C,GAMvB,OALwB6D,EAAI30C,KAAI,SAAC2c,GAC7B,IAAMs1B,EAAMF,EAAM17C,MAAM27C,KAAK2B,MAAK,SAAC1B,GAAD,OAASA,EAAIt1B,KAAOA,KACtD,QAAYzc,IAAR+xC,EAAmB,OAAOA,EAC9B,MAAM/oC,MAAM,QAAD,OAASyT,EAAT,mBAEH3c,KAAI,SAACiyC,GAAD,OAASA,EAAI57C,MAAMy6C,EAAMoB,UAoD9B2C,CAAmB/D,MALU,mBAIjC8D,EAJiC,KAIvBE,EAJuB,OAOVN,WAAuB,IAPb,mBAOjCO,EAPiC,KAOxBC,EAPwB,OAQZR,WAAyB,CAAC,KARd,mBAQjCS,EARiC,KAQzBC,EARyB,KAUlCC,EACF,qCACIx4B,GAAG,oBACHua,UAAWA,EACX6Z,IAAKD,EAAMsE,SACXt6B,MAAOg2B,EAAMpgB,OAAO2kB,QAChBvE,EAAMG,WAAWoE,QAErB,wBACIne,UAAW7hC,IAAEigD,KACbC,SAAU,SAAClD,GACPA,EAAMmD,iBAhDX,SACX1E,EACAj1B,EACA45B,GAEA,IACI,IAAMC,EAAyB,CAC3B75B,KAAMm4B,EAAYlD,EAAOj1B,EAAK,GAAIA,EAAK,IACvC45B,GAAIzB,EAAYlD,EAAO2E,EAAG,GAAIA,EAAG,KAErC3E,EAAM6E,gBAAgB,CAAE/2C,KAAM,UAAW82C,YAC3C,MAAOn4B,GACLq4B,YAAU,CAAC,oBAAqBr4B,EAAMs4B,WAqC1BC,CAAOhF,EAAO,CAACiD,EAAWa,GAAW,CAACG,EAASE,IAC/CnE,EAAMiF,YAAW,KAGrB,gBAAC,EAAD,MACA,gBAAC,IAAD,CAAQ1rC,MAAM,SACd,gBAAC,EAAD,CACIlT,MAAM,OACN+6C,MAAOpB,EAAMoB,MACbuB,OAAQ3C,EAAM2C,OACd1B,MAAOgC,EACPF,SAAUa,EACV1C,KAAM4C,EACNtC,QAASwC,EACThB,WAAW,IAEf,gBAAC,IAAD,CAAQzpC,MAAM,SACd,gBAAC,EAAD,CACIlT,MAAM,KACN+6C,MAAOpB,EAAMoB,MACbuB,OAAQ3C,EAAM2C,OACd1B,MAAOgD,EACPlB,SAAUmB,EACVhD,KAAMiD,EACN3C,QAAS4C,EACTpB,WAAW,IAEf,gBAAC,IAAD,CAAQzpC,MAAM,SACd,gBAAC,EAAD,OAEJ,gBAAC,EAAD,CACI2mC,SAAUF,EAAME,SAChBl2B,MAAOg2B,EAAMpgB,OAAOslB,MACpB/E,WAAYH,EAAMG,WAAW+E,SAKzC,OAAOC,eAAsBd,EAAOhB,I,gBCjJlC+B,EAA0C,GAEnCC,EAAgC,CAAC,CAAC,cAAe,KAEjDC,EAAsB,SAAC9tC,EAAc+tC,GAC9CH,EAAU5tC,GAAQ+tC,GAGTC,EAAgB,SAAChuC,GAC1B,IAAIiuC,EAA4B,KAC1BC,EAAuB,GAY7BN,EAAU5tC,GATS,WAAqB,IAAD,uBAAhBU,EAAgB,yBAAhBA,EAAgB,gBACnC,GAAmB,OAAfutC,EAEA,OADAJ,EAAar+C,KAAK,CAAC,UAAWkR,IACvButC,EAAU,WAAV,EAAcvtC,GAErBmtC,EAAar+C,KAAK,CAAC,UAAWkR,IAC9BwtC,EAAY1+C,KAAKkR,IAczB,OARmB,SAACqtC,GAEhB,IADAE,EAAaF,EACNG,EAAY/gD,OAAS,GAAG,CAC3B,IAAMuT,EAAOwtC,EAAYpxC,QACzB+wC,EAAar+C,KAAK,CAAC,uBAAwBkR,IAC1CutC,EAAD,yBAA0BvtC,OC5BhCytC,EAAa,CAAC,YAAa,mBAE3BC,EAAqB,WACvB,GAAID,EAAWtE,SAASr2B,OAAO0C,SAASL,UAAW,MAAO,MAC1D,GAAIrC,OAAO0C,SAASL,SAASw4B,WAAW,aAAc,MAAO,MAC7D,IAAMC,EAAW/b,UAAU+b,SAAS/wC,cACpC,OAAI+wC,EAASzE,SAAS,OAAe,MACjCyE,EAASzE,SAAS,OAAe,MAC9B,MANgB,GASd0E,EAAkBrC,IAAMsC,cAAwBJ,GAMhDK,EAAc,WACvB,OAAOvC,IAAMwC,WAAWH,IAGtBI,EAAmBX,EAAc,eCtB1BY,EAAe,WAExB,OADiBH,KAEb,IAAK,MACL,IAAK,MACD,OAAO,gBAAC,IAAD,CAAO16B,KAAM,KACxB,IAAK,MACD,OACI,gCACI,gBAAC,IAAD,CAAOA,KAAM,KACb,gBAAC,IAAD,CAAQhS,MAAM,SACd,gBAAC,IAAD,CAAOgS,KAAM,QCfpB86B,EAAoB,SAACC,GAAD,wBAAgCA,IAEpDC,EAAkB,SAACD,GAC5B,IAAM3mB,EAAU/W,SAAS06B,eAAe+C,EAAkBC,IAC1D,GAAI3mB,aAAmB6mB,eAAgB,OAAO7mB,EAC9C,MAAMvnB,MAAM,kCAGHquC,EAAkB,SAACH,EAAiBI,GAAlB,sBAClBJ,EADkB,cACLI,IAabC,EAAa,SAACC,GACvB,IAAMjnB,EAAUinB,EAAOC,cAAc,kCACrC,GAAIlnB,aAAmBmnB,YAAa,OAAOnnB,EAAQonB,QACnD,MAAM3uC,MAAM,sCCzBV4uC,EAAe,SAAInD,EAAUoD,GAI/B,IAHA,IAAMC,EAAM,IAAIC,IAAItD,GAChBpmB,EAAU,EACV5R,EAAKo7B,EAAOxpB,GACTypB,EAAIj5B,IAAIpC,IAEXA,EAAKo7B,EADLxpB,GAAoB,GAGxB,OAAO5R,GAGEu7B,EAAc,SAACvD,EAAe7+B,GAAhB,OACvBgiC,EAAanD,GAAK,SAACpmB,GAAD,OACF,IAAZA,EAAgBzY,EAAhB,UAA4BA,EAA5B,YAAsCyY,OAGjC4pB,GAAc,SAACxD,GAAD,OACvBmD,EAAanD,GAAK,SAACpmB,GAAD,OAAaA,MCA7B6pB,GAAsC,CACxCC,SAAU,SACVnwC,MAAO,SACPowC,OAAQ,UAGCC,GAAiB,SAACzH,GAS3B,OACI,kBAAC,IAAD,CACIqC,QAVQ,WACZ,IAAMx2B,EAAKw7B,GAAYrH,EAAM2C,OAAOzzC,KAAI,SAAC5K,GAAD,OAAOA,EAAEunB,OACjDm0B,EAAM6E,gBAAgB,CAAE/2C,KAAM,YAAa82C,QAAS,CAAE/4B,QACtDb,OAAOiE,YAAW,WACd+wB,EAAM0H,aAAa,CAAC,CAAE55C,KAAM,QAASvI,MAAOsmB,KAC5C06B,EAAgB16B,GAAI87B,eAAeL,MACpC,IAKC/7B,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,OACnBtF,KAAMC,IAAMC,KACZ3B,SAAS,QACT4B,MAAM,gC,qEC5BZp3B,GAAY,yCAAG,WACjBZ,EACAjc,GAFiB,oBAAAjB,EAAA,sDAITiY,EAAkBhX,EAAlBgX,OAAQoyB,EAAUppC,EAAVopC,MAJC,KAKTpyB,EALS,OAMR,QANQ,OASR,QATQ,uCAOYqiC,KAAYp9B,EAAQ,CAAEmtB,UAPlC,cAOHhyC,EAPG,yBAQFA,EAAOilB,aARL,wBAUIi9B,KAAWC,MAAMt9B,GAVrB,qFAAH,wDAcLu9B,GAAoB,yCAAG,WAGhCC,EACAz5C,GAJgC,oBAAAjB,EAAA,yDAOjB,QADTkd,EAAS7B,SAAS06B,eAAe,WANP,sBAOLlrC,MAAM,2BAPD,uBAQbiT,GAAaZ,EAAQjc,GARR,cAQ1B9E,EAR0B,OAU1B1D,EAAO0D,EAAKP,MAAMO,EAAKiE,QAAQ,KAAO,GAVZ,kBAWzB,CAAE3H,SAXuB,2CAAH,wDCJ3BkiD,GAAc,SAACh5C,EAAasjB,GAC9B,IAAMqxB,EAAM30C,EAAIvF,IAAI6oB,EAAKyuB,OACzB,IAAK4C,EAAK,MAAMzrC,MAAM,cAAD,OAAeoa,EAAKyuB,MAApB,gBACrB,IAAMC,EAAO1uB,EAAK0uB,KAAKhyC,KAAI,SAACi5C,GACxB,IAAMC,EAASvE,EAAI3C,KAAKv3C,IAAIw+C,GAC5B,IAAKC,EAAQ,MAAMhwC,MAAM,WAAD,OAAY+vC,EAAZ,gBACxB,OAAOC,KANgE,EAQlDvE,EAAI5C,MAC7B,MAAO,CAAEzpC,KATkE,EAQnEA,KACO6wC,OAT4D,EAQ7DA,OACSnH,SAGdoH,GAA0B,SACnCC,GADmC,MAEf,CACpBz6C,KAAM,OACN06C,QAASD,EAAKC,QACdC,QAASF,EAAKE,QAAQv5C,KAAI,SAAC03C,GAAD,OAAYA,EAAOrhD,SAC7CmjD,MAAOH,EAAK5F,OAAOzzC,KAAI,SAAC+xC,GAAD,MAAY,CAC/BoH,OAAQpH,EAAM17C,MAAM8iD,OACpB7wC,KAAMypC,EAAM17C,MAAMiS,KAClBqU,GAAIo1B,EAAM17C,MAAMsmB,GAChBq1B,KAAMD,EAAM17C,MAAM27C,KAAKhyC,KAAI,SAACiyC,GAAD,OAASA,EAAI57C,aAE5CojD,KAAO,WACH,IAAMC,EApCK,SAACjG,GAChB,IAAMiG,EAAS,IAAIC,IAOnB,OANAlG,EAAO7zC,SAAQ,SAACmyC,GACZ,IAAMC,EAAO,IAAI2H,IACjB5H,EAAM17C,MAAM27C,KAAKpyC,SAAQ,SAACqyC,GAAaD,EAAKgG,IAAI/F,EAAIt1B,GAAIs1B,EAAI57C,MAAMsmB,OAClE,IAAMi9B,EAAW,CAAEtxC,KAAMypC,EAAM17C,MAAMiS,KAAM6wC,OAAQpH,EAAM17C,MAAM8iD,QAC/DO,EAAO1B,IAAIjG,EAAMp1B,GAAI,CAAEo1B,MAAO6H,EAAU5H,YAErC0H,EA4BYG,CAAWR,EAAK5F,QAC/B,OAAO4F,EAAKI,KAAKz5C,KAAI,SAAC+wC,GAAD,MAAU,CAC3Bl1B,KAAMm9B,GAAYU,EAAQ3I,EAAIl1B,MAC9B45B,GAAIuD,GAAYU,EAAQ3I,EAAI0E,QAJ7B,GAOP0D,OAAQE,EAAKF,SChDJW,GAAmB,CAC5B,QACA,UACA,SACA,aACA,YACA,YACA,sBCLEC,GAAU,IAAIC,YAEPC,GAAa,SAACC,GACvB,IAAMl9C,EAAoB+8C,GAAQI,OAAOD,GAEnCzgD,EAAkB,IAAIhF,MAAMuI,EAAMvH,QAExC,OADAuH,EAAM4C,SAAQ,SAACw6C,GAAc3gD,EAAM3B,KAAKsB,OAAOI,aAAa4gD,OACrDC,KAAK5gD,EAAM0Q,KAAK,MAGrBmwC,GAAU,IAAIC,YAEdC,GAAa,SAACC,GAAD,OAA0BA,EAAKzhD,WAAW,ICgChD0hD,GAAgB,SACzBC,EACAr7C,GAIA,OAAQA,EAAQV,MACZ,IAAK,OACD,OCrDuB,SAC/B+7C,EACAr7C,GAEA,IAAMs7C,EAAe,WACjB,OAAQt7C,EAAQu7C,OACZ,IAAK,OACD,OAAOzB,GAAwBuB,GACnC,IAAK,OACD,OAAOA,GALE,GAQfG,EAAeC,KAAKC,UAAUJ,GASpC,MAAO,CAAEvkD,MARc,WACnB,OAAQiJ,EAAQgX,QACZ,IAAK,OACD,OAAOwkC,EACX,IAAK,SACD,OAAOb,GAAWa,IALP,IDwCRG,CAAoBN,EAASr7C,GACxC,IAAK,QACD,OAAOw5C,GAAqB6B,EAASr7C,GACzC,IAAK,MACD,OFhDsB,SAC9Bq7C,EACAr7C,GAIA,IAAkD,IAA9Cw6C,GAAiB3H,SAAS7yC,EAAQ47C,QAClC,MAAMhyC,MAAM,mBAAD,OAAoB5J,EAAQ47C,SAG3C,MAAO,CAAEC,KADI/B,GAAwBuB,IEuCtBS,CAAmBT,EAASr7C,KE5DzC+7C,GAEF,CACAC,IAAK,mBACL7hC,IAAK,8BACLkhC,QAAS,cCFPY,GAAO,SAAC3E,EAAoB4E,EAAgBhhD,GAC9C,OAAQo8C,GACJ,IAAK,MAGD,YAFkB96B,OAAe2/B,OAAOC,gBAC/BF,GAAQG,YAAYnhD,GAEjC,IAAK,MACD,IAAMq7C,EAAU,CAAEA,QAAS2F,EAAQxyC,KAAMxO,GAEzC,YADCshB,OAAe8/B,SAASC,YAAYhG,KA2BpCiG,GAAqB,kBAC9B,4BACI,mDACA,qBAAG79B,KALE,+CAKU0zB,SAAS,mBACxB,kECpBFoK,GAAW,SAACjL,GAEd,OAZmB,SAACx6B,GACpB,OAAQA,GACJ,IAAK,UACL,IAAK,MACD,OAAO,EACX,IAAK,MACD,OAAO,GAMX0lC,CAAelL,EAAMx6B,QAAgBw6B,EAAM3iB,QAExC8rB,GAxBG,SAAChpB,GACX,IAAIv6B,EAASu6B,EAMb,MAHA,CAAC,UAAW,UAAUrxB,SAAQ,SAACq8C,GAC3BvlD,EAASA,EAAOwlD,MAAMD,GAAM9xC,KAAK,OAE9BzT,EAiBWylD,CAAMrL,EAAM3iB,WAGrBiuB,GAAgB,SAACtL,GAC1B,GAAuB,QAAnBA,EAAM8F,SACN,MAAM1tC,MAAM,6CDCU,IAAC0tC,EAAoBp8C,EAApBo8C,ECAZ9F,EAAM8F,SDA0Bp8C,ECAhB,CAC3BA,KAAMuhD,GAASjL,GACfuL,IAAKC,GAAexL,EAAMx6B,QAC1BhO,KAAMwoC,EAAMxoC,KACZirC,MAAM,QAAD,OAAUzC,EAAMxoC,KAAhB,QDHTizC,GAAK3E,EAAU,WAAYp8C,IE7BlB8hD,GAET,CACAhB,IAAK,MACL7hC,IAAK,MACLkhC,QAAS,WAUA4B,GAAW,SAACzL,GACrB,OAAQA,EAAM8F,UACV,IAAK,MACD,OHdiB,SAAC9F,GAC1B,IAAM/yB,EAAOrE,SAASmB,cAAc,KACpCkD,EAAKy+B,SAAL,UAAmB1L,EAAMxoC,KAAzB,YAAiCg0C,GAAexL,EAAMx6B,SACtDyH,EAAKE,KAAL,eAAoBo9B,GAAMvK,EAAMx6B,QAAhC,YAA2Cw6B,EAAM3iB,SACjDpQ,EAAK0+B,QGUUC,CAAc5L,GACzB,IAAK,MACL,IAAK,MACD,OAAOsL,GAActL,KCZ3B6L,GAAY,SAAC7L,GACf,GAAuB,QAAnBA,EAAM8F,SACN,MAAM1tC,MAAM,mDHMW,IAAC0tC,EAAoBp8C,EAApBo8C,EGLZ9F,EAAM8F,SHK0Bp8C,EGLhB,CAC5BA,KAAMs2C,EAAMp6C,OAAOykD,KACnBD,OAAQpK,EAAMxxC,QAAQ47C,QHI1BK,GAAK3E,EAAU,YAAap8C,IGK1BoiD,GAAa,CACf,4CACA,gBAAC,GAAD,OAGSC,GAA0B,SAAC/L,GAAoC,IAChE6J,EAAsB7J,EAAtB6J,QAAS/D,EAAa9F,EAAb8F,SACjB,MAAiB,QAAbA,EACO,CACH,CACIz/C,MAAO,6BACPk/C,GAAI,WAAWT,YAAUgH,OAI1B9C,GAAiB95C,KAAI,SAACk7C,GAAD,MAAa,CACrC/jD,MAAM,aAAD,OAAe+jD,GACpB7E,GAAI,WAEA,IAAM/2C,EAAmB,CAAEV,KAAM,MAAOs8C,UAClCxkD,EAASomD,GAAqBnC,EAASr7C,GAC7Cq9C,GAAU,CAAEjmD,SAAQ4I,UAASs3C,mBChDhCmG,GAAe,yCAAG,WAAO9rB,GAAP,UAAA5yB,EAAA,+EAEjBw8B,UAAUmiB,UAAUC,UAAUhsB,GAFb,sEAIjBisB,YAAW,sCAAuCjsB,GAJjC,wDAAH,sDCMtBksB,GAAS,SAACxC,GAGZ,OAAOmC,GAAqBnC,EADH,CAAE/7C,KAAM,OAAQi8C,MAAO,OAAQvkC,OAAQ,SAClBjgB,OAG5C+mD,GAAW,yCAAG,WAAOzC,GAAP,gBAAAt8C,EAAA,6DACV4yB,EAAOksB,GAAOxC,GADJ,SAEVoC,GAAgB9rB,GAFN,uBAGV2kB,YAAU,CACZ,sCADY,sDAHA,2CAAH,sDAkBJyH,GAA2B,SACpCzG,EACA+D,GAFoC,MAGjB,CACnB,CAAExjD,MAAO,eAAgBk/C,GAAI,kBAblB,SAACO,EAAoB+D,GAChC4B,GAAS,CACL3F,WACAtgC,OAAQ,UACRhO,KAAM,UACN6lB,QAASgvB,GAAOxC,KAQe2C,CAAO1G,EAAU+D,KACpD,CAAExjD,MAAO,oBAAqBk/C,GAAI,WAAW+G,GAAYzC,OCrBvD4C,GAAK,yCAAG,WAAOC,GAAP,UAAAn/C,EAAA,sEACJ,IAAIpI,SAAQ,SAACC,GAAD,OAAa4lB,OAAOiE,YAAW,kBAAM7pB,MAAWsnD,MADxD,2CAAH,sDAILC,GAAgB,SAClB9C,EACA/D,EACA8G,GAOA,MALuE,CACnE,CAAC,6BAA8B,MAAO,GACtC,CAAC,4BAA6B,MAAO,GACrC,CAAC,yBAA0B,MAAO,IAExB19C,KAAI,YAA6B,IAAD,mBAA1B7I,EAA0B,KAAnBmf,EAAmB,KAAXoyB,EAAW,KAU1C,MAAO,CAAEvxC,QAAOk/C,GATR,yCAAG,+BAAAh4C,EAAA,6DACPq/C,GAAa,GADN,SAEDH,GAAM,KAFL,cAIDj+C,EAAmB,CAAEV,KAAM,QAAS0X,SAAQoyB,SAJ3C,SAKcoU,GAAqBnC,EAASr7C,GAL5C,OAKD5I,EALC,OCpBf6lD,GAAS,CACL3F,UAFoB9F,ED2BJ,CAAEp6C,SAAQ4I,UAASs3C,aCzBnBA,SAChBtgC,OAAQw6B,EAAMxxC,QAAQgX,OACtB6X,QAAS2iB,EAAMp6C,OAAOI,KACtBwR,KAAM,YDuBFo1C,GAAa,GAPN,iCCrBQ,IAAC5M,IDqBT,OAAH,0DAaH6M,GAAe,SAAC7M,GAAkB,IACnC6J,EAA0B7J,EAA1B6J,QAAS+C,EAAiB5M,EAAjB4M,aACX9G,EAAWG,IACjB,OACI,kBAAC,IAAD,CACIyC,MAAK,sBACE6D,GAAyBzG,EAAU+D,IADrC,CAED,WAFC,YAGE8C,GAAc9C,EAAS/D,EAAU8G,IAHnC,CAID,WAJC,YAKEb,GAAwB,CAAElC,UAAS/D,eAE1C8B,OAAQ,CACJtF,KAAMC,IAAMuK,MACZvhC,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,OACnBnF,MAAO,aEhDVsK,GAAgB,SAAK/M,GAAL,OACzB,kBAAC,IAAD,KACK,CACG,kBAAC,IAAD,CACI1xB,IAAI,OACJ+zB,QAAS,kBAAMrC,EAAMgN,SAAS,CAAEl/C,KAAM,UACtCw0C,KAAMC,IAAM0K,KACZ1hC,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,OACnBsF,SAAgC,IAAtBlN,EAAMmN,KAAKxoD,OACrB89C,MAAM,SAEV,kBAAC,IAAD,CACIn0B,IAAI,OACJ+zB,QAAS,kBAAMrC,EAAMgN,SAAS,CAAEl/C,KAAM,UACtCw0C,KAAMC,IAAM6K,KACZ7hC,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,OACnBsF,SAAkC,IAAxBlN,EAAMqN,OAAO1oD,OACvB89C,MAAM,YCzBhB6K,GAAU,yCAAG,WAAOtN,EAAchzB,GAArB,kBAAAzf,EAAA,6DACfyyC,EAAMuN,WAAU,GADD,SAEMtiC,MAAM+B,GAAKlnB,MAAK,SAACypB,GAAD,OAAcA,EAASy6B,UAF7C,OAETwD,EAFS,OAGT5I,EAAyB,CAAE4I,SAAQC,UAAU,GACnDzN,EAAM6E,gBAAgB,CAAE/2C,KAAM,SAAU82C,YACxC5E,EAAMuN,WAAU,GALD,2CAAH,wDCIVhI,GAAK,WACPT,YAAU,CACN,+CACA,gBAAC,GAAD,SCRFkI,GAAW,SAAChN,EAAcwN,GAC5B,IAAM5I,EAAyB,CAAE4I,SAAQC,UAAU,GACnDzN,EAAM6E,gBAAgB,CAAE/2C,KAAM,SAAU82C,aAGtC8I,GAAU,yCAAG,WAAO1N,GAAP,gBAAAzyC,EAAA,sEACM6+C,YAAW,CAC5B,yCACA,qEAHW,UAKA,QAJToB,EADS,SAKSA,EALT,iDAMfR,GAAShN,EAAOwN,GAND,2CAAH,sDA8BHG,GAA2B,SAAC3N,GAAD,MAAoC,CACxE,CAAE35C,MAAM,kBAAek/C,GAAI,kBAtBZ,SAACvF,GAChB,IAAMzc,EAAQ3a,SAASmB,cAAc,SACrCwZ,EAAMz1B,KAAO,OACby1B,EAAM7T,iBAAiB,UAAU,SAAC6xB,GAC9B,IAAMqM,EAAQrM,EAAcrT,OAAO2f,MAAM,GACnCC,EAAS,IAAIr+B,WACnBq+B,EAAOC,WAAWH,GAClBE,EAAOp+B,iBAAiB,QAAQ,SAAC6xB,GAAW,IAAD,EACjCiM,EAAM,UAAGjM,EAAMrT,cAAT,aAAG,EAActoC,OAC7B,GAAsB,kBAAX4nD,EACP,MAAMp1C,MAAM,yBAAD,cAAiCo1C,IAChDR,GAAShN,EAAOwN,SAGxBjqB,EAAMooB,QAQ2BqC,CAAWhO,KAC5C,CAAE35C,MAAM,yBAAsBk/C,GAAI,kBAAMmI,GAAW1N,OC1BjDiO,GAAW,SAACjO,GACd,IAAM0I,EAAuB,sBACtBiF,GAAyB3N,IADH,CAEzB,WAFyB,YHES,SAACA,GAAD,MACtC,CACI,CAAC,2BAA4B,YAC7B,CAAC,uBAAwB,QACzB,CAAC,4BAA6B,cAMhC9wC,KAAI,SAACk/B,GAAS,kBAEUA,EAFV,GAEL/nC,EAFK,KAEEmR,EAFF,KAGNwV,EAAG,0CAAsCxV,EAAtC,SACT,MAAO,CAAEnR,QAAOk/C,GAAI,kBAAM+H,GAAWtN,EAAOhzB,QGbzCkhC,CAA2BlO,KAE5BmO,EFL6B,SAACnO,GACpC,MAAuB,QAAnBA,EAAM8F,SAA2B,GAC9B,CAAC,CAAEz/C,MAAO,iCAA6Bk/C,QEGlC6I,CAAwBpO,GAEpC,OADImO,EAAIxpD,OAAS,GAAG+jD,EAAM1hD,KAAN,MAAA0hD,EAAK,CAAM,WAAN,mBAAoByF,KACtCzF,GAOE2F,GAAe,SAACrO,GAAkB,IAAD,EACd0D,YAAe,GADD,mBACnC4K,EADmC,KAC3Bf,EAD2B,KAEpCzH,EAAWG,IACTpB,EAAoB7E,EAApB6E,gBACR,OACI,gBAAC,IAAD,CACI+C,OAAQ,CACJr8B,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,OACnBtF,KAAMC,IAAK,OACX1B,SAAU,SACVyN,SACA7L,MAAO,oBAEXiG,MAAOuF,GAAS,CAAEV,YAAWzH,WAAUjB,uBCnC7C0J,GAA8B,CAChCzgD,KAAM,aACN82C,QAAS,CAAE92C,KAAM,SAGf0gD,GAAsB,SAACxO,EAAc4E,GAEvC5E,EAAM6E,gBAAgB,CAAE/2C,KAAM,6BAA8B82C,YAC5D55B,OAAOiE,YAAW,kBAAM+wB,EAAM6E,gBAAgB0J,MAAe,IAG3DE,GAAe,SAACzO,GAAD,MAAoC,CACrD,CACI35C,MAAO,iCACPk/C,GAAI,kBAAMiJ,GAAoBxO,GAAO,KAEzC,CACI35C,MAAO,+BACPk/C,GAAI,kBAAMiJ,GAAoBxO,GAAO,OAIhC0O,GAAe,SAAC1O,GAAD,OACxB,kBAAC,IAAD,KACK,CACG,kBAAC,IAAD,CACI1xB,IAAI,UACJg0B,KAAMC,IAAMoM,WACZtM,QAAS,WAAWrC,EAAM6E,gBAAgB0J,KAC1C1N,SAAS,UACTt1B,KAAMy0B,EAAMz0B,KAAKq8B,OACjC59B,MAAOg2B,EAAMh2B,MAAM49B,OACHnF,MAAM,wBAEV,kBAAC,IAAD,CACIn0B,IAAI,OACJs5B,OAAQ,CACJtF,KAAMC,IAAMqM,MACZrjC,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,OACnBnF,MAAO,wBAEXiG,MAAO+F,GAAazO,Q,QC5C9B6O,GAAS,SAACC,GAAD,oBAAC,gBACTA,GADQ,IAEXC,gBAAiBD,EAAMC,kBAGdC,GAAgB,SAAChP,GAAD,OACzB,gBAAC,IAAD,CACIqC,QAAS,WAAWrC,EAAMiP,SAASJ,KACnCK,SAAUlP,EAAM8O,MAAMC,eACtBxjC,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,OACnBtF,KAAMC,IAAM4M,YCLPC,GAAqB,SAC9B9I,EACAqC,GAEA,IATeza,EAST2V,EAAkB8E,EACnBxvC,QAVU+0B,EAUOoY,EAVY,SAACrG,GAAD,MAClC,CAACA,EAAIl1B,KAAKk2B,MAAOhB,EAAI0E,GAAG1D,OAAOI,SAASnT,MAUnCh/B,KAAI,SAAC+wC,GAAD,MAAU,CAAEnyC,KAAM,MAAOvI,MAAO06C,EAAIp0B,OAE7C,OADAg4B,EAAI78C,KAAK,CAAE8G,KAAM,QAASvI,MAAO+gD,IAC1BzC,GCRLyD,GAAsC,CACxCC,SAAU,SACVnwC,MAAO,SACPowC,OAAQ,UAiBC6H,GAAe,SAACrP,GAAkB,IACnC6J,EAA0B7J,EAA1B6J,QAASnC,EAAiB1H,EAAjB0H,aAEX/E,EAAmBe,IAAM4L,SAAQ,WACnC,IAAMpI,EAAM,IAAIC,IAEhB,OADA0C,EAAQlH,OAAO7zC,SAAQ,SAACmyC,GAAeiG,EAAIz/C,IAAIw5C,EAAM17C,MAAMiS,SACpD,YAAI0vC,KACZ,CAAC2C,EAAQlH,SAP8B,EASfe,IAAM6L,SAAS,IATA,mBASnChqD,EATmC,KAS5BiqD,EAT4B,KAWpCC,EAAmB,SAACj4C,IACQ,IAA1BmrC,EAAOtB,SAAS7pC,IA1BT,SACfqyC,EACAnC,EACAlwC,GAGA,IAAMypC,EAAQ4I,EAAQlH,OAAOE,MAAK,SAAC5B,GAAD,OAAWA,EAAM17C,MAAMiS,OAASA,KAElE,QAAcpI,IAAV6xC,EAAqB,MAAM7oC,MAAM,sBACrCsvC,EAAa0H,GAAmBnO,EAAMp1B,GAAIg+B,EAAQlB,OAElDpC,EAAgBtF,EAAMp1B,IAAI87B,eAAeL,IAgBrCoI,CAAW7F,EAASnC,EAAclwC,IAGtC,OACI,yBAAKwS,MAAO,CAAE2lC,KAAM,YAChB,kBAAC,IAAD,CACIrN,KAAMC,IAAMqN,OACZnsB,YAAY,mBACZl+B,MAAOA,EACPw8C,SAAU,SAAC8N,GACPL,EAAUK,GACVJ,EAAiBI,IAErB5N,KAAM,CAAEp2B,GAAI,gBAAiB5U,OAAQ0rC,GACrCmN,QAAS,SAACvO,GACY,UAAdA,EAAMjzB,KACVmhC,EAAiBlqD,IAErBgmB,KAAMy0B,EAAMz0B,KAAKgY,MACjBvZ,MAAOg2B,EAAMh2B,MAAMuZ,UCxDtBwsB,GAAgB,SAAC/P,GAAD,OACzB,gBAAC,IAAD,CACIkP,SAAUlP,EAAMgQ,eAChB3N,QAAS,kBAAMrC,EAAMiQ,mBAAkB,SAACC,GAAD,OAAWA,MAClD5N,KAAMC,IAAM4N,IACZ5kC,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,OACnBnF,MAAM,c,+DCTR2N,GAAc,CAAC,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,KAAKlhD,KAAI,SAAC3J,GAC3D,MAAO,CAAEc,MAAM,GAAD,OAAKd,EAAL,KAAeA,MAAOA,EAAQ,QAGnC8qD,GAAa,SAACrQ,GACvB,IAAMsQ,EAAU,SAACC,GAAD,OACZvQ,EAAMiP,UAAS,SAACrhD,GAAD,oBAAC,gBAAeA,GAAhB,IAAsB2iD,aACzC,OACI,kBAAC,IAAD,KACK,CACG,kBAAC,IAAD,CACIjiC,IAAI,MACJg0B,KAAMC,IAAMiO,QACZnO,QAAS,kBAAMiO,EAAQtQ,EAAM8O,MAAMyB,KAAO,MAC1ChlC,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,OACnBnF,MAAM,aAEV,kBAAC,IAAD,CACIn0B,IAAI,SACJ/oB,MAAOy6C,EAAM8O,MAAMyB,KACnBxO,SAAUuO,EACV9hD,QAAS4hD,GACT7kC,KAAMy0B,EAAMz0B,KAAKklC,OACjBzmC,MAAOg2B,EAAMh2B,MAAMymC,OACnBhO,MAAM,mBAEV,kBAAC,IAAD,CACIn0B,IAAI,KACJg0B,KAAMC,IAAMmO,OACZrO,QAAS,kBAAMiO,EAAQtQ,EAAM8O,MAAMyB,KAAO,MAC1ChlC,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,OACnBnF,MAAM,eCApBkO,GAAoB,SAAC7K,GACvB,IAAM8K,EAAM,CAACC,KAAM1rB,WAGnB,MAFiB,QAAb2gB,GAAoB8K,EAAI5pD,KAAK8pD,KAAK3rB,WACrB,QAAb2gB,GAAoB8K,EAAI5pD,KAAK+pD,KAAK5rB,WAC/ByrB,EAAIv3C,KAAK,MAGP23C,GAAgB,SAAChR,GAC1B,IAAM8F,EAAWG,IACjB,OACI,yBAAK7f,UAAWuqB,GAAkB7K,IAC9B,kBAAC,IAAD,CAAOv6B,KAAM,KACb,kBAAC,GAAD,CACIujC,MAAO9O,EAAM8O,MACbG,SAAUjP,EAAMiP,SAChB1jC,KAAMy0B,EAAMz0B,KACZvB,MAAOg2B,EAAMh2B,QAEjB,kBAAC,IAAD,CAAOuB,KAAM,KACb,kBAAC,GAAD,CACIs5B,gBAAiB7E,EAAM6E,gBACvBt5B,KAAMy0B,EAAMz0B,KACZvB,MAAOg2B,EAAMh2B,QAEjB,kBAAC,EAAD,MACA,kBAAC,GAAD,CACI24B,OAAQ3C,EAAM6J,QAAQlH,OACtBkC,gBAAiB7E,EAAM6E,gBACvB6C,aAAc1H,EAAM0H,aACpBn8B,KAAMy0B,EAAMz0B,KACZvB,MAAOg2B,EAAMh2B,QAEjB,kBAAC,IAAD,CAAOuB,KAAM,KACb,kBAAC,GAAD,CACI4hC,KAAMnN,EAAMiR,YACZ5D,OAAQrN,EAAMkR,cACdlE,SAAUhN,EAAM6E,gBAChBt5B,KAAMy0B,EAAMz0B,KACZvB,MAAOg2B,EAAMh2B,QAEjB,kBAAC,EAAD,MACA,kBAAC,GAAD,CACI6/B,QAAS7J,EAAM6J,QACfnC,aAAc1H,EAAM0H,aACpBn8B,KAAMy0B,EAAMz0B,KACZvB,MAAOg2B,EAAMh2B,QAEjB,kBAAC,EAAD,MACA,kBAAC,GAAD,CACI66B,gBAAiB7E,EAAM6E,gBACvBt5B,KAAMy0B,EAAMz0B,KACZvB,MAAOg2B,EAAMh2B,QAEjB,kBAAC,IAAD,CAAOuB,KAAM,KACb,kBAAC,GAAD,CACIujC,MAAO9O,EAAM8O,MACbG,SAAUjP,EAAMiP,SAChB1jC,KAAMy0B,EAAMz0B,KACZvB,MAAOg2B,EAAMh2B,QAEjB,kBAAC,IAAD,CAAOuB,KAAM,KACb,kBAAC,GAAD,CACIs+B,QAAS7J,EAAM6J,QACf+C,aAAc5M,EAAM4M,aACpBrhC,KAAMy0B,EAAMz0B,KACZvB,MAAOg2B,EAAMh2B,QAEjB,kBAAC,EAAD,MACA,kBAAC,GAAD,CACIgmC,eAAgBhQ,EAAMgQ,eACtBC,kBAAmBjQ,EAAMiQ,kBACzB1kC,KAAMy0B,EAAMz0B,KACZvB,MAAOg2B,EAAMh2B,QAEjB,kBAAC,IAAD,CAAOuB,KAAM,O,oBCjGZ4lC,GAAgB,SAACC,GAA+C,IAAD,EAClD1N,YAAe,GADmC,mBACjEz1B,EADiE,KAC5DojC,EAD4D,OAEhD3N,WAAe0N,GAFiC,mBAGxE,MAAO,CAAEnjC,MAAKojC,SAAQlxB,KAHkD,KAG5CmxB,QAH4C,OAM/DC,GAAa,SAACvR,GAAD,OACtB,uBAAK5Z,UAAW7hC,KAAE4gC,WACd,uBAAKiB,UAAW7hC,KAAEg/B,OACd,uBAAK6C,UAAW7hC,KAAE0pB,KACd,gBAAC,IAAD,CACI1oB,MAAOy6C,EAAMwR,MAAMvjC,IACnB8zB,SAAU/B,EAAMwR,MAAMH,OACtBxQ,SAAUb,EAAM35C,SAGxB,uBAAK+/B,UAAW7hC,KAAE47B,MACd,gBAAC,IAAD,CACI56B,MAAOy6C,EAAMwR,MAAMrxB,KACnB4hB,SAAU/B,EAAMwR,MAAMF,QACtBpE,UAAWlN,EAAMwR,MAAMvjC,IACvBwV,YAAauc,EAAMvc,gBAI9Buc,EAAMa,UACH,gBAAC,IAAD,KACI,gBAAC,IAAD,KAAYb,EAAMa,a,qBC/BrB4Q,GAAqB,SAC9BC,GAEA,GCyBO,YDzBgBA,KCyBS,EDxB5B,OEJiCC,EFIED,EEJH,aAAC,gBAClCC,GADiC,IAEpC7jD,KAAM,OACN06C,QAAS,IAH2B,IAACmJ,EFMrC,GEZ2B,SAC3B9H,GAEA,MAAO,YAAaA,GAA+B,IAApBA,EAAQrB,QFSnCoJ,CAAmBF,GACnB,OAAOA,EAEX,MAAMt5C,MAAM,iCGNHy5C,GAAqB,SAC9BH,GAEA,GCkCO,YDlCgBA,KCkCS,EDjC5B,OEPiCC,EFOED,EEPH,aAAC,gBAClCC,GADiC,IAEpC7jD,KAAM,OACN06C,QAAS,IAH2B,IAACmJ,EFSrC,GEf2B,SAC3B9H,GAEA,MAAO,YAAaA,GAA+B,IAApBA,EAAQrB,QFYnCoJ,CAAmBF,GACnB,OAAOA,EAEX,MAAMt5C,MAAM,iCGdH05C,GAAkB,WADA,aAElBC,GAAqB,cACrBC,GAAqB,WAAOD,ICL5BE,GAAwB,SAAChR,GAOlC,MAAO,CAAE15C,MDbqB2qD,ICagB1qD,OAAgB,IALhDy5C,EAAMkR,aACdlR,EAAM17C,MAAM27C,KAAKv8C,OACjBgI,KAAK+I,IAAIurC,EAAM17C,MAAM27C,KAAKv8C,OAAQytD,KAG2B,KAmB1DC,GAAe,SAACC,GACzB,IAAMC,EACF,IAACD,EAAmB,GACxB,ODtCsB,GCsCQ3lD,KAAK8N,IAAI83C,EAAkB,I,qBChCvDC,GAAa,SAAC9F,GAAD,OAAuC,EAAtB//C,KAAK4N,MAAMmyC,EAAM,IAIxC+F,GAAoB,SAAC5I,GAA2C,IAAD,IAHxD6C,EAIVvmD,EAAI,IAAIusD,KAAMC,SAASC,MAAM,CAAEC,YAAY,IAuBjD,OAtBA1sD,EAAE2sD,SAAS,CACPC,QAAS,KACTC,QFN2BC,GEO3BC,QFP2BD,GEQ3BE,QFT2BjB,GEU3BkB,QFV2BlB,KEY/B/rD,EAAEktD,qBAAoB,iBAAO,MAG7BxJ,EAAQlH,OAAO7zC,SAAQ,SAACmyC,GAAW,IAAD,EDHV,SAACA,GAEzB,IACI,IAAMthB,EAAU4mB,EAAgBtF,EAAMp1B,IAGtC,GAAI8T,EAAQ2zB,QAAQ97C,OAASypC,EAAM17C,MAAMiS,KACrC,MAAMY,MAAM,wCAChB,MAAO,CAAE7Q,MAAOo4B,EAAQwf,YAAa33C,OAAQm4B,EAAQ2f,cACvD,MAAO55C,GAGL,OAAOusD,GAAsBhR,ICRHsS,CAAatS,GAA/B15C,EADsB,EACtBA,MAAOC,EADe,EACfA,OACfrB,EAAEqtD,QAAQvS,EAAMp1B,GAAG7C,WAAY,CAAE3iB,MAAO,GAAIkB,QAAOC,cAIvDqiD,EAAQlB,KAAK75C,SAAQ,SAACmxC,GAClB95C,EAAEstD,QAAQxT,EAAIl1B,KAAKk2B,MAAMj4B,WAAYi3B,EAAI0E,GAAG1D,MAAMj4B,eAGtD0pC,KAAMgB,OAAOvtD,GAEN,CACHw8C,OAAQkH,EAAQlH,OAAOzzC,KAAI,SAACtB,GACxB,IAAMksC,EAAM3zC,EAAE0B,KAAK+F,EAAKie,GAAG7C,YAErB2H,EAAqB,CAAErpB,IAAK,EAAGD,KAAM,GAG3C,OAFAspB,EAASrpB,IAAMkrD,GAAW1Y,EAAI5zC,EAAI4zC,EAAItyC,OAAS,GAC/CmpB,EAAStpB,KAAOmrD,GAAW1Y,EAAI5yC,EAAI4yC,EAAIvyC,MAAQ,GACxC,6BAAKqG,GAAZ,IAAkB+iB,gBAEtBg4B,KAAMkB,EAAQlB,KACdp9B,KAAM,CACFhkB,OAtCQmlD,EAsCS,UAACvmD,EAAEwtD,QAAQpsD,aAAX,SAAqB,EFpChBqsD,IED9BjnD,KAAKC,KAAK8/C,EFCoBkH,MEqCtBpsD,OAAQgrD,GAAU,UAACrsD,EAAEwtD,QAAQnsD,cAAX,SAAsB,MCzB9CqsD,GAAO,SAAChsD,GAAD,OAAuBA,EAAKL,OAASK,EAAKN,OAgB1CusD,GAAmB,SAACC,GAC7B,IAAMC,EAAuBD,EAAS7kD,KAAI,SAAC26C,GAAD,MAAc,CACpDh+B,GAAIg+B,EAAQlH,OAAO,GAAG92B,GACtBtkB,MAAOsiD,EAAQt+B,KAAKhkB,MACpBC,OAAQqiD,EAAQt+B,KAAK/jB,WAGnBysD,EApBa,SAACD,GAEpB,IAAME,EAAWF,EAAMpsC,QAAO,SAACnN,EAAK5S,GAChC,OAAO4S,EAAM5S,EAAKN,MAAQkT,EAAM5S,EAAKN,SACrC2gB,KAEEisC,EAAYH,EAAMpsC,QAAO,SAACwsC,EAAKvsD,GAAN,OAAeusD,EAAMP,GAAKhsD,KAAO,GAC1DwsD,EAA2C,EAA3B1nD,KAAK8a,KAAK0sC,EAAY,GACtC5sD,EAAQoF,KAAK8N,IAAI45C,EAAeH,GAEtC,OAAOvnD,KAAKC,KAAKrF,EHzBaqsD,KGmCTU,CAAeN,GAC9BO,EAAO5wD,MAAMswD,GAAc/Z,KAAK,GAChCsa,EAAY,IAAI3L,IAahB4L,EAAoB,SAAChM,GAOvB,OALmB8L,EAAKrlD,KAAI,SAACwlD,EAAMlsD,GAE/B,MAAO,CAAEmsD,UAAWnsD,EAAOlB,IAdZ,SAAC2B,EAAew/C,GACnC,GAAIx/C,EAAQw/C,EAAU8L,EAAK5vD,OAAQ,OAAOujB,IAE1C,IADA,IAAIzN,GAAOyN,IACF1jB,EAAI,EAAGA,EAAIikD,EAASjkD,IAAK,CAC9B,IAAM8C,EAAMitD,EAAKtrD,EAAQzE,GACzBiW,EAAM9N,KAAK8N,IAAInT,EAAKmT,GAExB,OAAOA,EAMYm6C,CAAepsD,EAAOigD,OAIvB7gC,QAAO,SAACha,EAAMF,GAAP,OACrBA,EAAQpG,IAAMsG,EAAKtG,IAAMoG,EAAUE,MAsB3C,OAHAomD,EACKa,MAAK,SAACtnD,EAAGhK,GAAJ,OAAUswD,GAAKtwD,GAAKswD,GAAKtmD,MAC9BuB,SAjBgB,SAACo/B,GAKlB,IAJA,IAAMua,EAAUva,EAAO3mC,MH/DGqsD,IGgEpBjjC,EAAW8jC,EAAkBhM,GAE7BqM,EAAYnkC,EAASrpB,IAAM4mC,EAAO1mC,OAC/BhD,EAAI,EAAGA,EAAIikD,EAASjkD,IACzB+vD,EAAK5jC,EAASgkC,UAAYnwD,GAAKswD,EAGnCN,EAAUtN,IAAIhZ,EAAOriB,GAAI,CACrBxkB,KHxEsBusD,IGwEhBjjC,EAASgkC,UACfrtD,IAAKqpB,EAASrpB,SAOfktD,GCrELO,GAAU,SAAC,GAAyC,IAAvChB,EAAsC,EAAtCA,SAAUiB,EAA4B,EAA5BA,QACpBztD,EAAkB,EAAXC,EAAc,EAC1BusD,EAASjlD,SAAQ,SAAC+6C,GACd,IAAMl5B,EAAWqkC,EAAQrrD,IAAIkgD,EAAQlH,OAAO,GAAG92B,IAC/C,QAAiBzc,IAAbuhB,EAAwB,MAAMvY,MAAM,yBACxC,IAAM68C,EAAQtkC,EAAStpB,KAAOwiD,EAAQt+B,KAAKhkB,MAC3CA,EAAQoF,KAAK8N,IAAIlT,EAAO0tD,GACxB,IAAMC,EAASvkC,EAASrpB,IAAMuiD,EAAQt+B,KAAK/jB,OAC3CA,EAASmF,KAAK8N,IAAIjT,EAAQ0tD,MARuB,MAUnC,CAAC3tD,EJtBY0rD,GIsBWzrD,EJtBXyrD,II4B/B,OANC1rD,EAVoD,KAU7CC,EAV6C,KAarDD,EAAQoF,KAAK8N,IAAIuQ,OAAOmqC,OAAOC,WAAa,GAAI7tD,GAChDC,EAASmF,KAAK8N,IAAIuQ,OAAOmqC,OAAOE,YAAa7tD,GAEtC,CAAED,QAAOC,WAGd8tD,GAAY,SAACC,GACf,IAAM5S,EAAsB,GAY5B,GAXA4S,EAAOxB,SAASjlD,SAAQ,SAAC+6C,GACrB,IAAM/R,EAAYyd,EAAOP,QAAQrrD,IAAIkgD,EAAQlH,OAAO,GAAG92B,IACvD,QAAkBzc,IAAd0oC,EAAyB,MAAM1/B,MAAM,0BACzCyxC,EAAQlH,OAAO7zC,SAAQ,SAAClB,GACpB,IAAM+iB,EAAqB,CACvBrpB,IAAKwwC,EAAUxwC,IAAMsG,EAAK+iB,SAASrpB,IJvChB4qD,GIwCnB7qD,KAAMywC,EAAUzwC,KAAOuG,EAAK+iB,SAAStpB,KJxClB6qD,II0CvBvP,EAAO37C,KAAP,6BAAiB4G,GAAjB,IAAuB+iB,oBAG3BgyB,EAAOh+C,SAAW4wD,EAAOC,gBAAgB7S,OAAOh+C,OAAQ,OAAOg+C,EACnE,MAAMvqC,MAAM,oDCnBHq9C,GAAe,SAACC,GAEzB,IAAM3B,EAA4B,GAE5BluD,EAAO,IAAIgjD,IAGX8M,EAAW,IAAI9M,IACrB6M,EAAW/S,OAAO7zC,SAAQ,SAACmyC,GACvB0U,EAASzO,IAAIjG,EAAMp1B,GAAIo1B,MAI3B,IAAM2U,EAAS,IAAI/M,IAmBnB,OAlBA6M,EAAW/M,KAAK75C,SAAQ,SAACmxC,GAAS,IAAD,MACV,CAACA,EAAIl1B,KAAKk2B,MAAOhB,EAAI0E,GAAG1D,OAApCl2B,EADsB,KAChB45B,EADgB,KAE7BiR,EAAO1O,IAAIn8B,GAAM,UAAC6qC,EAAOjsD,IAAIohB,UAAZ,QAAqB,IAAI5d,OAAO8yC,IACjD2V,EAAO1O,IAAIvC,GAAI,UAACiR,EAAOjsD,IAAIg7C,UAAZ,QAAmB,IAAIx3C,OAAO8yC,OAGjDyV,EAAW/S,OAAO7zC,SAAQ,SAACmyC,GACvB,IAA2B,IAAvBp7C,EAAK8D,IAAIs3C,EAAMp1B,IAAnB,CACA,IACMg+B,EAAyB,CAAElH,OAAQ,GAAIgG,KAAM,GAAIp9B,KAD1C,CAAEhkB,MAAO,EAAGC,OAAQ,KA7Cd,SAArBquD,EAAsBrE,EAAcvQ,GAA4B,IAAD,IACzD4I,EAAoC2H,EAApC3H,QAAShkD,EAA2B2rD,EAA3B3rD,KAAM+vD,EAAqBpE,EAArBoE,OAAQD,EAAanE,EAAbmE,UACJ,IAAvB9vD,EAAK8D,IAAIs3C,EAAMp1B,MACnBg+B,EAAQlH,OAAO37C,KAAKi6C,GACpB,UAAA2U,EAAOjsD,IAAIs3C,EAAMp1B,WAAjB,SAAsB/c,SAAQ,SAACmxC,GACvB4J,EAAQlB,KAAKtH,SAASpB,IAC1B4J,EAAQlB,KAAK3hD,KAAKi5C,MAEtBp6C,EAAKqhD,IAAIjG,EAAMp1B,IAAI,IACnB,UAAC+pC,EAAOjsD,IAAIs3C,EAAMp1B,WAAlB,QAAyB,IAAI/c,SAAQ,SAACmxC,GAClC,IAAMgD,EAAY0S,EAAShsD,IAAIs2C,EAAIl1B,KAAKk2B,OAClCgD,EAAU0R,EAAShsD,IAAIs2C,EAAI0E,GAAG1D,OACpC,QAAkB7xC,IAAd6zC,QAAuC7zC,IAAZ60C,EAC3B,MAAM7rC,MAAM,yCAChBy9C,EAAmBrE,EAAOvO,GAC1B4S,EAAmBrE,EAAOvN,OAgC1B4R,CAAmB,CAAEhM,UAAShkD,OAAM8vD,WAAUC,UAAU3U,GACxD8S,EAAS/sD,KAAK6iD,OAGlBkK,EAASjlD,SAAQ,SAAC+6C,GACd4I,GAAkB5I,MAGfkK,GChDE+B,GAAkB,SAC3BN,GAGA,IAAIzB,EAAW0B,GAAaD,GAE5BzB,EAAWA,EAAS7kD,IAAIujD,IAExB,IF8ByB8C,EE9BnBP,EAAUlB,GAAiBC,GAEjC,MF4B0D,CAC1DjmD,KAAM,OACN06C,SAFyB+M,EE5BL,CAAEC,kBAAiBR,UAASjB,aF8BhCyB,gBAAgBhN,QAChCC,QAAS8M,EAAOC,gBAAgB/M,QAChC9F,OAAQ2S,GAAUC,GAClB5M,KAAM4M,EAAOC,gBAAgB7M,KAC7Bp9B,KAAMwpC,GAAQQ,GACdlN,OAAQkN,EAAOC,gBAAgBnN,SGvC7BH,GAAc,SAChB6N,EACA7mD,EACAsjB,GACoB,IAAD,EACb61B,EAAM,UAAG71B,EAAK61B,cAAR,QAAkB0N,EACxBlS,EAAM30C,EAAIvF,IAAJ,UAAW0+C,EAAX,cAAuB71B,EAAKhb,OACxC,QAAYpI,IAARy0C,EAAmB,MAAMzrC,MAAM,cAAD,OAAeoa,EAAKhb,KAApB,gBAClC,IAAM0pC,EAAO1uB,EAAK0uB,KAAKhyC,KAAI,SAACi5C,GACxB,IAAMC,EAASvE,EAAI3C,KAAKv3C,IAAIw+C,GAC5B,QAAe/4C,IAAXg5C,EAAsB,MAAMhwC,MAAM,WAAD,OAAY+vC,EAAZ,gBACrC,OAAOC,KAEX,MAAO,CAAEnH,MAAO4C,EAAI5C,MAAOC,SAGzB8U,GAAY,SAAC3L,EAAqB7hD,GAKpC,MAAO,CAAEjD,MAF0B,CAAE27C,KAFxBmJ,EAAKnJ,KAAKhyC,KAAI,SAAC3J,EAAOsmB,GAAR,MAAgB,CAAEA,KAAItmB,YAENiS,KADd6yC,EAArB7yC,KACyCqU,GADpBw+B,EAAfx+B,GACuCw8B,OADxBgC,EAAXhC,QAGF13B,SADC,CAAErpB,IAAK,EAAGD,KAAM,GACPwkB,GAAIrjB,EAAO2pD,cAAc,IAGjD8D,GAAa,SAAC5L,EAAuB7hD,GACvC,MAAO,CAAEqjB,GAAIrjB,EAAOjD,MAAO8kD,IAWlB6L,GAA0B,SACnC7L,GAEA,IAAMhC,EAASgC,EAAKhC,OACd1F,EAA2B0H,EAAK3B,MAAMx5C,IAAI8mD,IAC1CzN,EAAyB,CAC3Bz6C,KAAM,OACN06C,QAAS6B,EAAK7B,QACdH,SACA1F,SACAgG,KAAO,WACH,IAAMC,EA9DC,SACfmN,EACApT,GAEA,IAAMiG,EAAS,IAAIC,IAQnB,OAPAlG,EAAO7zC,SAAQ,SAACmyC,GAAW,IAAD,EAChBC,EAAO,IAAI2H,IACjB5H,EAAM17C,MAAM27C,KAAKpyC,SAAQ,SAACqyC,GAAaD,EAAKgG,IAAI/F,EAAI57C,MAAMsmB,GAAIs1B,EAAIt1B,OAClE,IAAMw8B,EAAM,UAAGpH,EAAM17C,MAAM8iD,cAAf,QAAyB0N,EAC/Bn9C,EAAK,UAAMyvC,EAAN,cAAkBpH,EAAM17C,MAAMiS,MACzCoxC,EAAO1B,IAAItuC,EAAO,CAAEqoC,MAAOA,EAAMp1B,GAAIq1B,YAElC0H,EAkDgBG,CAAWV,EAAQ1F,GAClC,OAAO0H,EAAK1B,KAAKz5C,IApBb,SAACm5C,EAAgBO,GAC7B,OAAO,SAACyB,EAAoB7hD,GAArB,MAAsD,CACzDqjB,GAAIrjB,EACJuiB,KAAMm9B,GAAYG,EAAQO,EAAQyB,EAAKt/B,MACvC45B,GAAIuD,GAAYG,EAAQO,EAAQyB,EAAK1F,MAgBZwR,CAAQ9N,EAAQO,IAFlC,GAIPH,QAAS4B,EAAK5B,QAAQv5C,IAAI+mD,IAC1B1qC,KAAM,CAAEhkB,MAAO,EAAGC,OAAQ,IAE9B,OAAOsuD,GAAgBvN,ICvErB6N,GAAe,SAACvM,GAClB,GdmB+B,SAC/BA,GAGA,MAA2C,SAAtCA,EAA6B/7C,WAEUsB,IAAvCy6C,EAA6BnB,MczB9B2N,CAAyBxM,GAAU,CACnC,IAAMyM,EAASD,GAAwBxM,GACvC,OAAOqM,GAAwBI,GAEnC,GXkB+B,SAC/BzM,GAGA,MAA2C,SAAtCA,EAA6B/7C,WAEWsB,IAAxCy6C,EAA6BlH,OWxB9B4T,CAAyB1M,GACzB,OAAO0M,GAAwB1M,GAEnC,MAAMzxC,MAAM,yCAGVo+C,GAAa,SAACxM,GAChB,IAAMyM,EAASxM,KAAK/kC,MAAM8kC,GAC1B,OAAOoM,GAAaK,IAGlBC,GAAe,SAACjrD,GAClB,IAAMu+C,EvCHgB,SAACv+C,GACvB,IAAMS,EAAQrD,WAAWkiB,KAAK4rC,KAAKlrD,GAASi+C,IAC5C,OAAOF,GAAQp9C,OAAOF,GuCCT0qD,CAAWnrD,GACxB,OAAO+qD,GAAWxM,IAGT6M,GAAgB,SAACrJ,GAC1B,GAAsB,kBAAXA,EACP,OAAIA,EAAO3H,WAAW,KACX2Q,GAAWhJ,GAEXkJ,GAAalJ,GAErB,GAAsB,kBAAXA,EACd,OAAO4I,GAAa5I,GAExB,MAAMp1C,MAAM,yBClCH0+C,GAA4BZ,GAAwB,CAC7DpoD,KAAM,OACN06C,QAAS,EACTC,QAAS,CACL,CAAE58B,GAAI,IAAKrU,KAAM,OAAQ1J,KAAM,UAC/B,CAAE+d,GAAI,IAAKrU,KAAM,OAAQ1J,KAAM,UAC/B,CAAE+d,GAAI,IAAKrU,KAAM,WAAY1J,KAAM,YAEvCu6C,OAAQ,OACRK,MAAO,GACPC,KAAM,KAGGoO,GAA+Bb,GAAwB,CAChEpoD,KAAM,OACN06C,QAAS,EACTC,QAAS,CACL,CAAE58B,GAAI,IAAKrU,KAAM,OAAQ1J,KAAM,UAC/B,CAAE+d,GAAI,IAAKrU,KAAM,OAAQ1J,KAAM,UAC/B,CAAE+d,GAAI,IAAKrU,KAAM,WAAY1J,KAAM,YAEvC46C,MAAO,CACH,CACI78B,GAAI,QACJrU,KAAM,WACN6wC,OAAQ,MACRnH,KAAM,CACF,CAAEr1B,GAAI,SAAUrU,KAAM,WAAY1J,KAAM,WACxC,CACI+d,GAAI,WACJrU,KAAM,YACN1J,KAAM,eAEV,CACI+d,GAAI,WACJrU,KAAM,eACN1J,KAAM,mBAIlB,CACI+d,GAAI,UACJrU,KAAM,UACN6wC,OAAQ,MACRnH,KAAM,CACF,CAAEr1B,GAAI,SAAUrU,KAAM,YAAa1J,KAAM,YACzC,CAAE+d,GAAI,WAAYrU,KAAM,WAAY1J,KAAM,WAC1C,CACI+d,GAAI,WACJrU,KAAM,eACN1J,KAAM,eAEV,CAAE+d,GAAI,WAAYrU,KAAM,iBAAkB1J,KAAM,QAChD,CAAE+d,GAAI,WAAYrU,KAAM,eAAgB1J,KAAM,WAGtD,CACI+d,GAAI,UACJrU,KAAM,iBACN6wC,OAAQ,MACRnH,KAAM,CACF,CAAEr1B,GAAI,SAAUrU,KAAM,YAAa1J,KAAM,YACzC,CAAE+d,GAAI,WAAYrU,KAAM,YAAa1J,KAAM,WAC3C,CACI+d,GAAI,WACJrU,KAAM,kBACN1J,KAAM,eAEV,CAAE+d,GAAI,WAAYrU,KAAM,SAAU1J,KAAM,mBAGhD,CACI+d,GAAI,UACJrU,KAAM,kBACN6wC,OAAQ,MACRnH,KAAM,CACF,CAAEr1B,GAAI,SAAUrU,KAAM,YAAa1J,KAAM,YACzC,CAAE+d,GAAI,WAAYrU,KAAM,YAAa1J,KAAM,WAC3C,CAAE+d,GAAI,WAAYrU,KAAM,cAAe1J,KAAM,WAC7C,CAAE+d,GAAI,WAAYrU,KAAM,UAAW1J,KAAM,gBAGjD,CACI+d,GAAI,UACJrU,KAAM,UACN6wC,OAAQ,MACRnH,KAAM,CACF,CAAEr1B,GAAI,SAAUrU,KAAM,YAAa1J,KAAM,UACzC,CAAE+d,GAAI,WAAYrU,KAAM,YAAa1J,KAAM,WAC3C,CACI+d,GAAI,WACJrU,KAAM,sBACN1J,KAAM,eAEV,CACI+d,GAAI,WACJrU,KAAM,oBACN1J,KAAM,eAEV,CACI+d,GAAI,WACJrU,KAAM,oBACN1J,KAAM,WAEV,CACI+d,GAAI,WACJrU,KAAM,kBACN1J,KAAM,WAEV,CAAE+d,GAAI,WAAYrU,KAAM,SAAU1J,KAAM,eACxC,CACI+d,GAAI,WACJrU,KAAM,gBACN1J,KAAM,WAEV,CACI+d,GAAI,WACJrU,KAAM,mBACN1J,KAAM,eAEV,CACI+d,GAAI,YACJrU,KAAM,iBACN1J,KAAM,iBAIlB,CACI+d,GAAI,UACJrU,KAAM,WACN6wC,OAAQ,MACRnH,KAAM,CACF,CAAEr1B,GAAI,SAAUrU,KAAM,eAAgB1J,KAAM,WAC5C,CAAE+d,GAAI,WAAYrU,KAAM,eAAgB1J,KAAM,QAC9C,CAAE+d,GAAI,WAAYrU,KAAM,OAAQ1J,KAAM,QACtC,CAAE+d,GAAI,WAAYrU,KAAM,cAAe1J,KAAM,SAC7C,CAAE+d,GAAI,WAAYrU,KAAM,WAAY1J,KAAM,UAGlD,CACI+d,GAAI,UACJrU,KAAM,YACN6wC,OAAQ,MACRnH,KAAM,CACF,CAAEr1B,GAAI,SAAUrU,KAAM,gBAAiB1J,KAAM,WAC7C,CAAE+d,GAAI,WAAYrU,KAAM,QAAS1J,KAAM,QACvC,CAAE+d,GAAI,WAAYrU,KAAM,QAAS1J,KAAM,aAG/C,CACI+d,GAAI,UACJrU,KAAM,QACN6wC,OAAQ,MACRnH,KAAM,CACF,CAAEr1B,GAAI,SAAUrU,KAAM,gBAAiB1J,KAAM,WAC7C,CAAE+d,GAAI,WAAYrU,KAAM,UAAW1J,KAAM,cACzC,CACI+d,GAAI,WACJrU,KAAM,kBACN1J,KAAM,kBAKtB66C,KAAM,CACF,CACI59B,KAAM,CACFvT,KAAM,UACN6wC,OAAQ,MACRnH,KAAM,CAAC,aAEXyD,GAAI,CAAEntC,KAAM,WAAY6wC,OAAQ,MAAOnH,KAAM,CAAC,YAElD,CACIn2B,KAAM,CACFvT,KAAM,iBACN6wC,OAAQ,MACRnH,KAAM,CAAC,WAEXyD,GAAI,CAAEntC,KAAM,UAAW6wC,OAAQ,MAAOnH,KAAM,CAAC,YAEjD,CACIn2B,KAAM,CACFvT,KAAM,kBACN6wC,OAAQ,MACRnH,KAAM,CAAC,SAAU,aAErByD,GAAI,CACAntC,KAAM,iBACN6wC,OAAQ,MACRnH,KAAM,CAAC,SAAU,cAGzB,CACIn2B,KAAM,CACFvT,KAAM,iBACN6wC,OAAQ,MACRnH,KAAM,CAAC,aAEXyD,GAAI,CAAEntC,KAAM,UAAW6wC,OAAQ,MAAOnH,KAAM,CAAC,YAEjD,CACIn2B,KAAM,CACFvT,KAAM,UACN6wC,OAAQ,MACRnH,KAAM,CAAC,aAEXyD,GAAI,CAAEntC,KAAM,WAAY6wC,OAAQ,MAAOnH,KAAM,CAAC,YAElD,CACIn2B,KAAM,CACFvT,KAAM,UACN6wC,OAAQ,MACRnH,KAAM,CAAC,aAEXyD,GAAI,CAAEntC,KAAM,YAAa6wC,OAAQ,MAAOnH,KAAM,CAAC,YAEnD,CACIn2B,KAAM,CAAEvT,KAAM,QAAS6wC,OAAQ,MAAOnH,KAAM,CAAC,WAC7CyD,GAAI,CAAEntC,KAAM,YAAa6wC,OAAQ,MAAOnH,KAAM,CAAC,YAEnD,CACIn2B,KAAM,CACFvT,KAAM,UACN6wC,OAAQ,MACRnH,KAAM,CAAC,aAEXyD,GAAI,CAAEntC,KAAM,WAAY6wC,OAAQ,MAAOnH,KAAM,CAAC,aAGtDmH,OAAQ,SC5NN2O,GAAgB,SAACnrC,GAAD,gBAFH,WAEG,OAAwCA,IAIjDorC,GAAoB,SAACz/C,GAC9B,IAAM8W,EAAM0oC,GAAcx/C,GACpB0/C,EAASlsC,OAAOmsC,aAAaC,QAAQ9oC,GAC3C,OAAe,OAAX4oC,EAAwB,KACrBL,GAAcK,IAKZG,GAAoB,SAACxN,EAAsBh+B,GAEpD,IACMtmB,EAAQqkD,GAAcC,EADH,CAAE/7C,KAAM,OAAQi8C,MAAO,OAAQvkC,OAAQ,SAE1D8I,EAAM0oC,GAAcnrC,GAC1Bb,OAAOmsC,aAAaG,QAAQhpC,EAAK/oB,EAAMA,QAiB9BgyD,GAAuB,SAChC1N,EACAmD,GAGAA,EAVkB,SAACx1C,GAAD,OAAkB,SAAC5J,GAAD,MAA6B,CACjEF,QAAS8J,EACTggD,IAAI,CAAEhgD,GAAH,mBAAY5J,EAAK4pD,QAQXC,CAjBW,SAAC5N,GACrB,IAAM6N,EAAQC,KACRngD,EAAO4vC,EAAYsQ,EAAO,YAEhC,OADAL,GAAkBxN,EAASryC,GACpBA,EAYMogD,CAAgB/N,MA6B3BgO,GAAkB,SAACrgD,GACrBwT,OAAOmsC,aAAaW,WAAWd,GAAcx/C,KAGpCugD,GAAuB,SAChCvgD,EACAw1C,GAEA6K,GAAgBrgD,GAChBw1C,EAdkB,SAACx1C,GAAD,OAAkB,SAAC5J,GACrC,IAAM4pD,EAAM5pD,EAAK4pD,IAAIr+C,QAAO,SAAC1U,GAAD,OAAOA,IAAM+S,KACzC,OAAO,6BAAK5J,GAAZ,IAAkB4pD,SAYTQ,CAAcxgD,KAKrBygD,GAAe,yCAAG,WACpBC,EACAC,GAFoB,gBAAA5qD,EAAA,yDAKJ,OADA0pD,GAAkBkB,GAJd,gCAMGC,YAAY,4BAAD,OAA6BD,EAA7B,OANd,WAOH,IAPG,iDAOW,GAPX,UAUF,QADZE,EAAYpB,GAAkBiB,IAThB,uBAUU9/C,MAAM,kBAAD,OAAmB8/C,EAAnB,MAVf,eAWpBb,GAAkBgB,EAAWF,GAC7BN,GAAgBK,GAZI,mBAab,GAba,4CAAH,wDAgBfI,GAAgB,SAACvtC,EAAc45B,GACjC,OAAO,SAAC/2C,GACJ,IAGI4pD,EAHE9pD,EAAUE,EAAKF,UAAYqd,EAAO45B,EAAK/2C,EAAKF,QAC5ClF,EAAQoF,EAAK4pD,IAAI7pD,QAAQod,GAC/B,IAAe,IAAXviB,EAAc,MAAM4P,MAAM,IAAD,OAAK2S,EAAL,gBAQ7B,OANInd,EAAK4pD,IAAInW,SAASsD,GAClB6S,EAAM5pD,EAAK4pD,IAAIr+C,QAAO,SAAC3B,GAAD,OAAUA,IAASuT,MAEzCysC,EAAG,YAAO5pD,EAAK4pD,MACXhvD,GAASm8C,EAEV,CAAEj3C,UAAS8pD,SAIbe,GAAoB,yCAAG,WAChCvL,EACAkL,EACAC,GAHgC,UAAA5qD,EAAA,sEAKV0qD,GAAgBC,EAAUC,GALhB,eAMnBnL,EAASsL,GAAcJ,EAAUC,IANd,2CAAH,0DAWpBR,GAAwB,WACjC,IAAM1V,EAAOz+C,OAAO2rB,KAAKnE,OAAOmsC,cAC3Bh+C,QAAO,SAACmV,GAAD,OAASA,EAAIu3B,WAjIV,cAkIV32C,KAAI,SAACof,GAAD,OAASA,EAAI2T,QAlIP,UAkI2B,OAE1C,OADoB,IAAhBggB,EAAKt9C,QAAcs9C,EAAKj7C,KAAKwxD,IAC1BvW,GA2BEwW,GAAqB,SAC9BjhD,EACAw1C,GAEA,IAAMnD,EAAUoN,GAAkBz/C,GAClC,GAAgB,OAAZqyC,EAAkB,MAAMzxC,MAAM,sBAAD,OAAuBZ,EAAvB,MAEjC,OADAw1C,EAXgB,SAACx1C,GAAD,OAAkB,SAAC5J,GAAD,oBAAC,gBAChCA,GAD+B,IAElCF,QAAS8J,KASAkhD,CAAYlhD,IACdqyC,GCjKE2O,GAAuB,WAE9BG,GAAoB,SAAC7S,GACvB,GAAiB,QAAbA,EAAoB,OAAO0S,GAC/B,IAAMtB,EAASlsC,OAAOmsC,aAAaC,QALJ,cAM/B,cAAOF,QAAP,IAAOA,IAAUsB,IAeRI,GAAoB,WAC7B,IAAM9S,EAAWG,IAEXuL,EAAQ9N,WAfM,SAACoC,GAAD,MAAkC,CACtDp4C,QAASirD,GAAkB7S,GAC3B0R,IAAKG,MAaiCkB,CAAgB/S,IAHL,cAInB0L,EAJmB,GAI1CsH,EAJ0C,KAIjCC,EAJiC,KAKzCrrD,EAAYorD,EAAZprD,QAaR,OAVAg2C,aAAgB,WACZ14B,OAAOmsC,aAAaG,QA9BO,aA8BsB5pD,KAClD,CAACA,IAGJg2C,aAAgB,WACZ,IAAM1+B,EAAqB,OAAZtX,EAAmB,GAAnB,UAA2BA,EAA3B,OACfkb,SAAS65B,MAAT,UAAoBz9B,GAApB,OAjBY,0BAkBb,CAACtX,IAEG,CAAEorD,UAASC,eCZhB3B,GAAU,SAAC5F,GAAD,OACZA,EAAMvjC,IAAMujC,EAAMrxB,UAAO/wB,GAOhB4pD,GAAa,SAAChZ,GACvB,IAAMiZ,EAA4B,aAAfjZ,EAAMlyC,KAEnBi3C,EAAUoM,IAAc,iBAAM,MAC9B+H,EAAU/H,IAAc,iBAAM,MAC9B1kC,EAAQ0kC,IAAc,kBAVf,SAAC1kC,GACd,OAAKA,EACC,GAAN,OAAUA,EAAV,aAAoBA,EAAMkoB,OADP,GASewkB,CAASnZ,EAAMvzB,UAC3C2sC,EAAMjI,IAAc,kBAAMlH,KAAKC,UAAU7E,MACzCwE,EAAUsH,IAAc,kBAjCf,WAAe,IAAD,EACvB35C,EAAOwT,OAAOmsC,aAAaC,QDVF,cCWzB9oC,EAAG,wBAAa9W,QAAb,IAAaA,IAAQghD,IAC9B,iBAAOxtC,OAAOmsC,aAAaC,QAAQ9oC,UAAnC,QAA2C,YA8BP+qC,MAC9BC,EAAQnI,IAAc,kBAAMnmC,OAAO+e,UAAUC,aAC7C8b,EAAWG,IATiC,EAUtBvC,YAAe,GAVO,mBAU3C4K,EAV2C,KAUnCf,EAVmC,KAY5CgM,EAAY,yCAAG,WAAOhY,GAAP,kBAAAh0C,EAAA,6DACjBg0C,EAAMmD,iBACN6I,GAAU,GACJvnD,EAAmB,CACrBy8C,MAAOwW,EAAa,iBAAmB,gBACvCnT,WACA0C,QCxDe,KDyDf/7B,MAAO2qC,GAAQ3qC,GACfs4B,QAASqS,GAAQrS,GACjBmU,QAAS9B,GAAQ8B,GACjBI,MAAOlC,GAAQkC,GACfzP,QAASuN,GAAQvN,GACjBuP,IAAKhC,GAAQgC,IAZA,SAcXpuC,OAAOC,MAAM,qCAAsC,CACrDy/B,OAAQ,OACR1kD,KAAMikD,KAAKC,UAAUlkD,GACrBwzD,QAAS,CAAE,eAAgB,sBAjBd,OAmBjB1U,YAAU,yCACVyI,GAAU,GACV,UAAAvN,EAAMyZ,cAAN,cAAAzZ,GArBiB,2CAAH,sDAwBlB,OACI,wBAAMyE,SAAU,SAAClD,GAAD,OAAWgY,EAAahY,KACpC,sBAAInb,UAAW7hC,KAAEk+C,OAAQzC,EAAMyC,OAC/B,gBAAC,IAAD,CAAOl3B,KAAM,KACb,gBAAC,IAAD,CAAQhS,MAAM,SACd,gBAAC,IAAD,CAAOgS,KAAM,KACZy0B,EAAM0Z,YACP,gBAAC,IAAD,CACI1W,WAAS,EACT9B,KAAM,EACN37C,MAAOw/C,EAAQ5kB,KACf4hB,SAAUgD,EAAQuM,UAEtB,gBAAC,IAAD,CAAO/lC,KAAM,KACZ0tC,GACG,gCACI,gBAAC,GAAD,CAAY5yD,MAAM,uBAAuBmrD,MAAO/kC,IAChD,gBAAC,IAAD,CAAOlB,KAAM,KAGrB,gBAAC,GAAD,CAAYllB,MAAM,sBAAsBmrD,MAAO3H,IAC/C,gBAAC,IAAD,CAAOt+B,KAAM,IACb,gBAAC,GAAD,CAAYllB,MAAM,qBAAqBmrD,MAAO8H,IAC9C,gBAAC,IAAD,CAAO/tC,KAAM,IACb,gBAAC,GAAD,CAAYllB,MAAM,0BAA0BmrD,MAAO4H,IACnD,gBAAC,IAAD,CAAO7tC,KAAM,IACb,gBAAC,GAAD,CACIimC,MAAO0H,EACP7yD,MAAM,8BACNo9B,YAAY,qBAEhB,gBAAC,IAAD,CAAOlY,KAAM,KACb,gBAAC,IAAD,CAAQhS,MAAM,SACd,gBAAC,IAAD,CAAOgS,KAAM,KACb,uBAAK6a,UAAW7hC,KAAEo1D,QACb3Z,EAAM2Z,OACP,gBAAC,IAAD,CAAOpuC,KAAM,KACb,gBAAC,IAAD,CACIzd,KAAK,SACL6yC,WAAS,EACTE,SAAS,cACTyN,OAAQA,O,oBEtHfsL,GAAc,SAAC5Z,GAAD,OACvB,uBAAK5Z,UAAW7hC,KAAE4gC,WACd,uBAAKiB,UAAW,CAAC7hC,KAAEs1D,SAAU9c,IAAWgE,WAAW1nC,KAAK,OACxD,uBACI+sB,UAAW7hC,KAAEu1D,KACbzX,QAAS,SAACd,GAAW,IAAD,EACZA,EAAMrT,SAAWqT,EAAMwY,gBAC3B,UAAA/Z,EAAMga,sBAAN,cAAAha,MAGJ,uBACI5Z,UAAW,CACP7hC,KAAEyB,KACFo6C,IAAYC,OACZtD,IAAWuD,QACXjiB,IAAUgiB,QACZhnC,KAAK,MAEP,gBAAC,GAAe2mC,OCR1Bia,GAAc,kBAChB,oCACI,kBAAC,IAAD,2GAIA,kBAAC,IAAD,CAAO1uC,KAAM,IACb,kBAAC,IAAD,wEAGA,kBAAC,IAAD,CAAOA,KAAM,MAIf2uC,GAAS,SAACla,GAAD,OACX,kBAAC,IAAD,CAAQqC,QAAS,kBAAMrC,EAAMma,UAAUtZ,SAAS,YAQvCuZ,GAAqB,SAACpa,GAC/B,IAA4B,IAAxBA,EAAMqa,cAAyB,OAAO,KAC1C,IAAMhX,EAAkBz6B,SAAS06B,eAAe,WAChD,GAAwB,OAApBD,EAA0B,MAAMjrC,MAAM,oBAC1C,IAAMkiD,EAAc,kBAAMta,EAAMua,kBAAiB,IACjD,OAAOpV,IAASqV,aACZ,kBAAC,GAAD,CACI1sD,KAAK,SACL20C,MAAM,kBACNiX,YAAa,kBAAC,GAAD,MACbC,OAAQ,kBAAC,GAAD,CAAQQ,OAAQG,IACxBb,OAAQa,EACRN,eAAgBM,IAEpBjX,IClDKoX,GAAkB,SAACza,GAAD,OAC3B,gBAAC,IAAD,CACIz6C,MAAOy6C,EAAM8O,MAAM4L,cACnB3Y,SAAU,SAACx8C,GAAD,OACNy6C,EAAMiP,UAAS,SAACrhD,GAAD,oBAAC,gBAAeA,GAAhB,IAAsB8sD,cAAen1D,QAExDs7C,SAAS,0CCNJ8Z,GAAe,SAAC3a,GAAD,OACxB,gBAAC,IAAD,CACIz6C,MAAOy6C,EAAM8O,MAAM8L,cACnB7Y,SAAU,SAACx8C,GAAD,OACNy6C,EAAMiP,UAAS,SAACrhD,GAAD,oBAAC,gBAAeA,GAAhB,IAAsBgtD,cAAer1D,QAExDs7C,SAAS,iBCHJga,GAAqB,SAAC7a,GAAD,OAC9B,kBAAC,IAAD,CACIqC,QAAS,kBAAMrC,EAAMua,kBAAiB,IACtChvC,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,OACnBtF,KAAMC,IAAMuY,MACZja,SAAS,kB,+DCRXryC,GAAmC,CACrC,CAAEjJ,MAAO,QAASc,MAAO,QAASi8C,KAAMC,IAAMwY,MAAOzsC,IAAK,SAC1D,CAAE/oB,MAAO,OAAQc,MAAO,SAAUioB,IAAK,QACvC,CAAE/oB,MAAO,OAAQc,MAAO,OAAQi8C,KAAMC,IAAMyY,KAAM1sC,IAAK,SAK9C2sC,GAAc,SAACjb,GAAD,OACvB,kBAAC,IAAD,CACIz6C,MAAOy6C,EAAM8O,MAAMoM,MACnBnZ,SAAU,SAACmZ,GAAD,OAAWlb,EAAMiP,UAAS,SAACrhD,GAAD,oBAAC,gBAAeA,GAAhB,IAAsBstD,cAC1D1sD,QAASA,GACT+c,KAAMy0B,EAAMz0B,KAAKq8B,OACjB59B,MAAOg2B,EAAMh2B,MAAM49B,UCHrB+I,GAAoB,SAAC7K,GACvB,IAAM8K,EAAM,CAACC,KAAM1rB,WAGnB,MAFiB,QAAb2gB,GAAoB8K,EAAI5pD,KAAK8pD,KAAK3rB,WACrB,QAAb2gB,GAAoB8K,EAAI5pD,KAAK+pD,KAAK5rB,WAC/ByrB,EAAIv3C,KAAK,MAGP8hD,GAAkB,SAACnb,GAC5B,IAAM8F,EAAWG,IACjB,OACI,uBAAK7f,UAAWuqB,GAAkB7K,IAC9B,gBAAC,IAAD,CAAOv6B,KAAM,KACC,QAAbu6B,GACG,gCACI,gBAAC,GAAgB9F,GACjB,gBAAC,EAAD,OAGR,gBAAC,GAAoBA,GACrB,gBAAC,IAAD,CAAOz0B,KAAM,KACC,QAAbu6B,GACG,gCACI,gBAAC,GAAiB9F,IAG1B,gBAAC,IAAD,MACA,gBAAC,GAAD,CACIua,iBAAkBva,EAAMua,iBACxBhvC,KAAMy0B,EAAMz0B,KACZvB,MAAOg2B,EAAMh2B,QAEjB,gBAAC,IAAD,CAAOuB,KAAM,O,8DC6BZ6vC,GAAS1X,QAxCH,SAAC1D,GAAkB,IAAD,EACD0D,YAAe,GADd,mBAC1B2X,EAD0B,KAChBC,EADgB,KAE3BxV,EAAWG,IACX16B,EChCmB,SAACu6B,GAC1B,OAAQA,GACJ,IAAK,MACD,MAAO,CACH8B,OAAQ2T,IAAYhwC,KAAK42B,MACzB5e,MAAOg4B,IAAWhwC,KAAK42B,MACvBsO,OAAQ8K,IAAYhwC,KAAK42B,OAEjC,QACI,MAAO,CACHyF,OAAQ2T,IAAYhwC,KAAKm1B,OACzBnd,MAAOg4B,IAAWhwC,KAAKm1B,OACvB+P,OAAQ8K,IAAYhwC,KAAKm1B,SDoBxB8a,CAAc1V,GACrB97B,EExBS,CACH49B,OAAQ2T,IAAYvxC,MAAM42B,OAC1Brd,MAAOg4B,IAAWvxC,MAAM42B,OACxB6P,OAAQ8K,IAAYvxC,MAAM42B,QFiBL,ENjCN,WAAO,IAAD,EACS8C,IAAM6L,UAAS,GADxB,mBAC1B8K,EAD0B,KACXE,EADW,KAWjC,OATA7W,IAAM+X,WAAU,WACZ,IAAMC,EAAW,SAACna,IACTA,EAAMoa,SAAYpa,EAAMqa,UACX,MAAdra,EAAMjzB,KACVisC,GAAiB,SAACrK,GAAD,OAAWA,MAGhC,OADAtnC,SAAS8G,iBAAiB,UAAWgsC,GAC9B,kBAAM9yC,SAASizC,oBAAoB,UAAWH,MACtD,IACI,CAAErB,gBAAeE,oBM2BoBuB,GAApCzB,EALyB,EAKzBA,cAAeE,EALU,EAKVA,iBACjBwB,EAfiB,SAACjW,GAAwB,IAAD,MACzCvhD,EAAiB,QAAbuhD,EAAqBgL,KAAoB,QAAbhL,EAAqBiL,KAAO,KAClE,MAAO,CACH5rB,UAAW,CAAC0rB,KAAM1rB,UAAP,iBAAkB5gC,QAAlB,IAAkBA,OAAlB,EAAkBA,EAAG4gC,iBAArB,QAAkC,IAAI9rB,KAAK,KACtD2iD,aAAc,CAACnL,KAAMmL,aAAP,iBAAqBz3D,QAArB,IAAqBA,OAArB,EAAqBA,EAAGy3D,oBAAxB,QAAwC,IAAI3iD,KAAK,KAC/D4iD,WAAY,CAACpL,KAAMoL,WAAP,iBAAmB13D,QAAnB,IAAmBA,OAAnB,EAAmBA,EAAG03D,kBAAtB,QAAoC,IAAI5iD,KAAK,MAU7C6iD,CAAmBpW,GACnC,OACI,uBAAK1f,UAAW21B,EAAQ52B,WACpB,gBAAC,GAAD,iBACQ6a,EADR,CAEIgQ,eAAgBqL,EAChBpL,kBAAmBqL,EACnB/vC,KAAMA,EACNvB,MAAOA,KAEVqxC,GACG,gCACI,uBAAKj1B,UAAW21B,EAAQE,YACpB,gBAAC,IAAD,CAAQ1iD,MAAM,UAElB,gBAAC,GAAD,iBACQymC,EADR,CAEIua,iBAAkBA,EAClBhvC,KAAMA,EACNvB,MAAOA,MAInB,gBAAC,GAAD,CACIqwC,cAAeA,EACfE,iBAAkBA,IAEtB,uBAAKn0B,UAAW21B,EAAQC,cACpB,gBAAC,IAAD,CAAQziD,MAAM,gB,8BG1DxB4iD,GAAU,SAACC,GACb,IAAKA,EAAQC,aAAc,OAAO,KAClC,GAA8B,QAA1BD,EAAQE,cAAyB,OAAO,KAC5C,IAAM17B,EAASw7B,EAAQG,kBACjBnuB,EAAOguB,EAAQhF,UACrB,OAAa,OAAThpB,GAA4B,OAAXxN,EAAwB,KACtC,CAAEwN,OAAM9mC,IAAKs5B,EAAO16B,EAAGmB,KAAMu5B,EAAO15B,IAoCzCs1D,GAAS9Y,IAAM+Y,MARF,SAAC,GAAD,IAAGn1D,EAAH,EAAGA,IAAKD,EAAR,EAAQA,KAAR,OACf,yBAAK2iB,MAAO,CAAEzQ,MAAO,oBACjB,yBAAK6sB,UAAW7hC,KAAE+9C,KAAMt4B,MAAO,CAAE1iB,IAAKA,EAAM,EAAGD,KAAMA,EAAO,IACxD,kBAAC,IAAD,CAAM6oC,KAAMqS,IAAMma,OAAQnxC,KAAM,UA+C/BoxC,GAAejZ,IAAM+Y,MAxCT,SAACzc,GAGtB,IAAM4c,EAAWC,aAAaV,IACxBW,EAAapZ,IAAMqZ,OAA4B,MAG/CC,EAAa,OAAGJ,QAAH,IAAGA,OAAH,EAAGA,EAAUxuB,KAAK6uB,WAC7BC,EAAgBld,EAAhBkd,YACRxZ,IAAM+X,WAAU,WACZqB,EAAWpvD,aACW0B,IAAlB4tD,EACM,KApCM,SACpBE,EACAC,GAEA,IAAMC,EAAWF,EAAYxvD,QAC7B,GAAiB,OAAb0vD,EAAmB,MAAMhlD,MAAM,2BACnC,IAAMo1C,EAAS2P,EAAUzvD,QACzB,GAAe,OAAX8/C,EAAiB,MAAMp1C,MAAM,8BACjC,IAAM0hC,EAAM0T,EAAO1lD,wBALJ,EAMK,CAACgyC,EAAIxyC,IAAMwyC,EAAItyC,OAAS,EAAGsyC,EAAIzyC,KAAOyyC,EAAIvyC,MAAQ,GAEtE,MAAO,CAAED,IARM,KAQDD,KARC,KAQKilC,UADc8wB,EAA1B9wB,UACuBC,WADG6wB,EAAf7wB,YA2BLssB,CAAgBqE,EAAaF,KACxC,CAACE,EAAaF,IAEjB,IAAMpX,EAAUkX,EAAWpvD,QAC3B,GAAiB,OAAbkvD,GAAiC,OAAZhX,EAAkB,OAAO,KAClD,IAAMwX,EAAWpd,EAAMkd,YAAYxvD,QACnC,GAAiB,OAAb0vD,EAAmB,MAAMhlD,MAAM,2BAEnC,IAAMilD,EAAWD,EAAS7wB,WAAaqZ,EAAQrZ,WACzC+wB,EAAUF,EAAS9wB,UAAYsZ,EAAQtZ,UAE7C,OACI,yBAAKlG,UAAW7hC,KAAE4gC,WACd,yBAAKiB,UAAW7hC,KAAEokB,KACd,0BACIyd,UAAW7hC,KAAEk4B,KACbwf,GAAI2J,EAAQv+C,KAAOg2D,EACnBlhB,GAAIyJ,EAAQt+C,IAAMg2D,EAClBC,GAAIX,EAASv1D,KACbm2D,GAAIZ,EAASt1D,OAGrB,kBAACk1D,GAAD,CAAQl1D,IAAKs1D,EAASt1D,IAAKD,KAAMu1D,EAASv1D,WClFhDo2D,GAAiD,IAAI5U,IAC3D4U,GAAcvW,IAAI,UAAW,SAC7BuW,GAAcvW,IAAI,SAAU,IAE5B,ICKIwW,GDCSC,GAAgB,SACzBlV,EACAvH,GAIA,IAAMr1B,EAAaw7B,GAAYnG,EAAKhyC,KAAI,SAACwK,GAAD,OAAOA,EAAEmS,OAG3C+xC,EAAwB1c,EAAKhyC,KAAI,SAACwK,GAAD,OAAOA,EAAEnU,MAAMsmB,MAChDgyC,EAAkBzW,EAAYwW,EAAa,UAK3Cr4D,EAA0B,CAAEsmB,GAAIgyC,GAOtC,OANApV,EAAQ35C,SAAQ,SAAC83C,EAAQp+C,GAGrBjD,EAAMqhD,EAAOrhD,MAAMiS,MAAkB,IAAVhP,EAAcq1D,EAzB7B,SAACjX,GACjB,IAAMkX,EAAQL,GAAc9zD,IAAIi9C,EAAOrhD,MAAMuI,MAC7C,QAAcsB,IAAV0uD,EAAqB,OAAOA,EAChC,MAAM1lD,MAAM,wBAAD,OAAyBwuC,EAAOrhD,MAAMuI,KAAtC,MAsB4CiwD,CAAYnX,MAG5D,CAAE/6B,KAAItmB,UAYJy4D,GAAkC,SAACnU,EAASjF,GACrD,IAAMqZ,EAVU,SAACrZ,EAAkB6D,GACnC,OAAO,SAACxH,GACJ,GAAIA,EAAMp1B,KAAO+4B,EAAQ0B,QAAS,OAAOrF,EACzC,IAAME,EAAMwc,GAAclV,EAASxH,EAAM17C,MAAM27C,MACzCA,EAAOD,EAAM17C,MAAM27C,KAAK/zC,OAAOg0C,GACrC,OAAO,6BAAKF,GAAZ,IAAmB17C,MAAM,6BAAM07C,EAAM17C,OAAb,IAAoB27C,YAKjCgd,CAAYtZ,EAASiF,EAAQpB,SAC5C,OAAO,6BAAKoB,GAAZ,IAAqBlH,OAAQkH,EAAQlH,OAAOzzC,IAAI+uD,ME5C9CE,GAAY,SAACvwD,EAAcqzC,GAAf,OACdt0C,KAAK8N,IAAIwmC,EAAMtwB,SAAStpB,KAAMuG,IAKrBwwD,GAAsB,SAACzb,GAEhC,MAAO,CAAEr7C,I3BbsB2rD,G2BaI5rD,KADnBs7C,EAAO/6B,OAAOu2C,GAAW,GAJzBvK,MAQdyK,GAAa,SAAC9yC,EAAYoF,GAC5B,IAAMppB,EAAQoF,KAAK8N,IAAI8Q,EAAKhkB,MAAOopB,EAAStpB,KAT5BusD,KAUhB,OAAOrsD,IAAUgkB,EAAKhkB,MAAQgkB,EAAvB,6BAAmCA,GAAnC,IAAyChkB,WCfvC+2D,GAAuC,SAAC1wD,EAAM2wD,GACvD,OAAQA,EAAOzwD,MACX,IAAK,SACD,IAAMrI,EAAOoxD,GAAc0H,EAAO3Z,QAAQ4I,QAC1C,OAAgC,IAA5B+Q,EAAO3Z,QAAQ6I,SAA2BhoD,ECT7B,SACzB+4D,EACAtwB,GAEA,GAAIswB,EAAS/V,QAAQ9jD,SAAWupC,EAAOua,QAAQ9jD,OAC3C,MAAMyT,MAAM,gDAEhB,IAAMyrC,EAAM2a,EAAS7b,OAAOzzC,KAAI,SAAC5K,GAAD,OAAOA,EAAEunB,MAGnC+U,EAASw9B,GAAoBI,EAAS7b,QAC5C/hB,EAAOt5B,IAAMs5B,EAAOt5B,I7BTW2rD,G6BU/BryB,EAAOv5B,KAAOu5B,EAAOv5B,K7BVU4rD,G6BY/B,IAAMtQ,EAAM,YAAO6b,EAAS7b,QAC5BzU,EAAOyU,OAAO7zC,SAAQ,SAACmyC,GAGnB,IAAMp1B,EAAKw7B,GAAYxD,GACvBA,EAAI78C,KAAK6kB,GACT,IAAM8E,EAAqB,CACvBrpB,IAAK25C,EAAMtwB,SAASrpB,IAAMs5B,EAAOt5B,IACjCD,KAAM45C,EAAMtwB,SAAStpB,KAAOu5B,EAAOv5B,MAEvCs7C,EAAO37C,KAAP,6BAAiBi6C,GAAjB,IAAwBp1B,KAAI8E,iBAGhC,IAAMppB,EAAQq5B,EAAOv5B,KAAO6mC,EAAO3iB,KAAKhkB,MAClCgkB,EAAU,6BAAQizC,EAASjzC,MAAjB,IAAuBhkB,UACvC,OAAO,6BAAKi3D,GAAZ,IAAsB7b,SAAQp3B,SDnBfkzC,CAAc7wD,EAAMnI,GAC/B,QACI,OAAOmI,IELN8wD,GAAqC,SAAC7U,EAASjF,GACxD,IAAM+D,EAAOkB,EAAQlB,KAAKxvC,QAAO,SAAC8mC,GAAD,OAASA,EAAIp0B,KAAO+4B,EAAQ/4B,MAC7D,OAAO,6BAAKg+B,GAAZ,IAAqBlB,UCDZgW,GAAoC,SAAC9U,EAAS0U,GACvD,OAAQA,EAAOzwD,MACX,IAAK,UACD,OCGmC,SAAC+7C,EAASjF,GAErD,IAAM+D,EAAOkB,EAAQlB,KAAKxvC,QAAO,SAAC8mC,GAAD,OANf,SAACA,EAAc2E,GAAf,OAClB3E,EAAIl1B,KAAKk2B,QAAU2D,EAAQ75B,KAAKk2B,OAChChB,EAAIl1B,KAAKm2B,KAAKpS,MAAK,SAACjjB,GAAD,OAAQ+4B,EAAQ75B,KAAKm2B,KAAKG,SAASx1B,MAIX+yC,CAAc3e,EAAK2E,MAExDia,EAAUhV,EAAQlB,KAAKz5C,KAAI,SAAC+wC,GAAD,OAASA,EAAIp0B,MACxCo0B,EAAG,6BAAQ2E,GAAR,IAAiB/4B,GAAIw7B,GAAYwX,KAE1C,OADAlW,EAAK3hD,KAAKi5C,GACH,6BAAK4J,GAAZ,IAAqBlB,SDVNmW,CAAOjV,EAAS0U,EAAO3Z,SAClC,IAAK,aACD,OAAO8Z,GAAU7U,EAAS0U,EAAO3Z,SACrC,IAAK,uBACD,ODFuC,SAACiF,EAASjF,GACzD,IAAIn/C,EAAOokD,EAIX,OAHAjF,EAAQf,IAAI/0C,SAAQ,SAAC+c,GACjBpmB,EAAOi5D,GAAUj5D,EAAM,CAAEomB,UAEtBpmB,ECHQs5D,CAAmBlV,EAAS0U,EAAO3Z,SAC9C,QACI,OAAOiF,IEbbmV,GAAgB,SAACpa,EAAkBpyB,GAAnB,OAClBA,EAAKyuB,QAAU2D,EAAQ0B,SAAW9zB,EAAK0uB,KAAKG,SAASuD,EAAQ8B,QAWpDhF,GAAqC,SAACmI,EAASjF,GACxD,IAAMjC,EAASkH,EAAQlH,OAAOzzC,IAPd,SAAC01C,GAAD,OAAsB,SAAC3D,GACvC,GAAIA,EAAMp1B,KAAO+4B,EAAQ0B,QAAS,OAAOrF,EACzC,IAAMC,EAAOD,EAAM17C,MAAM27C,KAAK/nC,QAAO,SAACgoC,GAAD,OAASA,EAAIt1B,KAAO+4B,EAAQ8B,SACjE,OAAO,6BAAKzF,GAAZ,IAAmB17C,MAAM,6BAAM07C,EAAM17C,OAAb,IAAoB27C,YAIVgd,CAAYtZ,IAC1C+D,EAAOkB,EAAQlB,KAAKxvC,QAAO,SAAC8mC,GAAD,OAXjB,SAAC2E,EAAkB3E,GAAnB,OACd+e,GAAcpa,EAAS3E,EAAIl1B,OAASi0C,GAAcpa,EAAS3E,EAAI0E,IAUtBsa,CAAUra,EAAS3E,MAE5D,OADI0I,EAAKhkD,SAAWklD,EAAQlB,KAAKhkD,SAAQgkD,EAAOkB,EAAQlB,MACjD,6BAAKkB,GAAZ,IAAqBlH,SAAQgG,UCP3BuV,GAAc,SAACtZ,GAAD,OAAsB,SAAC3D,GACvC,GAAIA,EAAMp1B,KAAO+4B,EAAQ0B,QAAS,OAAOrF,EACzC,IAAMC,EAAOD,EAAM17C,MAAM27C,KAAKhyC,IATZ,SAAC01C,GAAD,OAAsB,SAACzD,GACzC,GAAIA,EAAIt1B,KAAO+4B,EAAQ8B,MAAO,OAAOvF,EACrC,IAAM57C,EAAK,gBAAQ47C,EAAI57C,OAEvB,OADAA,EAAMq/C,EAAQzW,UAAYyW,EAAQr/C,MAC3B,6BAAK47C,GAAZ,IAAiB57C,WAKiB25D,CAActa,IAChD,OAAO,6BAAK3D,GAAZ,IAAmB17C,MAAM,6BAAM07C,EAAM17C,OAAb,IAAoB27C,aAYnCie,GAAqC,SAACtV,EAASjF,GACxD,GAVW,SAACiF,EAAsBjF,GAA+B,IAAD,EACxD0B,EAA+C1B,EAA/C0B,QAASI,EAAsC9B,EAAtC8B,MAAiB0Y,EAAqBxa,EAA/BzW,SAAqB5oC,EAAUq/C,EAAVr/C,MACvC47C,EAAG,UAAG0I,EAAQlH,OACfE,MAAK,SAAC5B,GAAD,OAAWA,EAAMp1B,KAAOy6B,YADzB,aAAG,EAEN/gD,MAAM27C,KAAK2B,MAAK,SAAC1B,GAAD,OAASA,EAAIt1B,KAAO66B,KAC1C,IAAKvF,EAAK,MAAM/oC,MAAM,QAAD,OAASkuC,EAAT,YAAoBI,EAApB,gBACrB,OAAOvF,EAAI57C,MAAM65D,KAAe75D,EAI5B85D,CAAOxV,EAASjF,GAAU,OAAOiF,EACrC,IAAMlH,EAASkH,EAAQlH,OAAOzzC,IAAIgvD,GAAYtZ,IAC9C,OAAO,6BAAKiF,GAAZ,IAAqBlH,YCpBZ2c,GAAuC,SAACzV,EAASjF,GAC1D,IAAMjC,EAASkH,EAAQlH,OAAOxpC,QAAO,SAAC8nC,GAAD,OAAWA,EAAMp1B,KAAO+4B,EAAQ/4B,MAC/D88B,EAAOkB,EAAQlB,KAAKxvC,QAAO,SAAC8mC,GAAD,OALnB,SAAC2E,EAAkB3E,GAAnB,OACdA,EAAIl1B,KAAKk2B,QAAU2D,EAAQ/4B,IAAMo0B,EAAI0E,GAAG1D,QAAU2D,EAAQ/4B,GAIfozC,CAAUra,EAAS3E,MAC9D,OAAO,6BAAK4J,GAAZ,IAAqBlH,SAAQgG,UCLpB4W,GAA2C,SAAC1V,EAASjF,GAC9D,IAAMjC,EAASkH,EAAQlH,OAAOzzC,IANf,SAAC01C,GAAD,OAAsB,SAAC3D,GACtC,OAAIA,EAAMp1B,KAAO+4B,EAAQ/4B,GAAWo1B,EAC7B,6BAAKA,GAAZ,IAAmB17C,MAAM,6BAAM07C,EAAM17C,OAAb,IAAoBiS,KAAMotC,EAAQptC,UAIxBgoD,CAAW5a,IAC7C,OAAO,6BAAKiF,GAAZ,IAAqBlH,YCCZ8c,GAAsC,SAAC5V,EAAS0U,GACzD,OAAQA,EAAOzwD,MACX,IAAK,YACD,OVQqC,SAAC+7C,EAASjF,GAAa,IAAD,EAE7D8a,EAAW7V,EAAQlH,OAAOzzC,KAAI,SAAC+xC,GAAD,OAAWA,EAAM17C,MAAMsmB,MACrDrU,EAAO4vC,EAAYsY,EAAU,SAC7Bve,EAAMwc,GAAc9T,EAAQpB,QAAS,IAErCxH,EAAwB,CAC1Bp1B,GAAE,UAAE+4B,EAAQ/4B,UAAV,QAAgBw7B,GAAYwC,EAAQlH,OAAOzzC,KAAI,SAAC+xC,GAAD,OAAWA,EAAMp1B,OAClEtmB,MAAO,CAAEiS,OAAMqU,GAAIrU,EAAM6wC,OAAQ,MAAOnH,KAAM,CAACC,IAC/CxwB,SAAUytC,GAAoBvU,EAAQlH,QACtCwP,cAAc,GAElB,OAAO,6BACAtI,GADP,IAEIlH,OAAQkH,EAAQlH,OAAOx1C,OAAO8zC,GAC9B11B,KAAM8yC,GAAWxU,EAAQt+B,KAAM01B,EAAMtwB,YUvB1BgvC,CAAS9V,EAAS0U,EAAO3Z,SACpC,IAAK,eACD,OAAO0a,GAAYzV,EAAS0U,EAAO3Z,SACvC,IAAK,yBACD,OFDyC,SAACiF,EAASjF,GAC3D,IAAIn/C,EAAOokD,EAIX,OAHAjF,EAAQf,IAAI/0C,SAAQ,SAAC+c,GACjBpmB,EAAO65D,GAAY75D,EAAM,CAAEomB,UAExBpmB,EEJQm6D,CAAqB/V,EAAS0U,EAAO3Z,SAChD,IAAK,oBACD,OAAO2a,GAAgB1V,EAAS0U,EAAO3Z,SAC3C,IAAK,qBACD,OCnB6B,SAACiF,EAASjF,GAAV,oBAAC,gBACnCiF,GADkC,IAErClH,OAAQkH,EAAQlH,OAAOzzC,KAAI,SAAC+xC,GACxB,OAAIA,EAAMp1B,KAAO+4B,EAAQ/4B,GAAWo1B,EAC7B,6BAAKA,GAAZ,IAAmBtwB,SAAUi0B,EAAQj0B,gBDe1BkvC,CAAiBhW,EAAS0U,EAAO3Z,SAC5C,IAAK,wBACD,OErB+B,SAACiF,EAASjF,GACjD,IAAMjC,EAASkH,EAAQlH,OAAOzzC,KAAI,SAAC+xC,GAC/B,OAAIA,EAAMp1B,KAAO+4B,EAAQ/4B,GAAWo1B,EAC7B,6BAAKA,GAAZ,IAAmBkR,aAAcvN,EAAQyW,cAE7C,OAAO,6BAAKxR,GAAZ,IAAqBlH,WFgBNmd,CAAmBjW,EAAS0U,EAAO3Z,SAC9C,IAAK,6BACD,OEdsC,SAACiF,EAASjF,GACxD,IAAMjC,EAASkH,EAAQlH,OAAOzzC,KAAI,SAAC+xC,GAC/B,OAAO,6BAAKA,GAAZ,IAAmBkR,aAAcvN,OAErC,OAAO,6BAAKiF,GAAZ,IAAqBlH,WFUNod,CAAuBlW,EAAS0U,EAAO3Z,SAClD,IAAK,kBACD,OGxB2C,SAACiF,EAASjF,GAC7D,IAAMh3C,EAAOi8C,EAAQlH,OAAOE,MAAK,SAACv+C,GAAD,OAAOA,EAAEunB,KAAO+4B,EAAQ/4B,MACzD,QAAazc,IAATxB,EAAoB,MAAMwK,MAAM,UAAD,OAAWwsC,EAAQ/4B,GAAnB,gBACnC,IAAM+xC,EAAc/T,EAAQlH,OAAOzzC,KAAI,SAAC5K,GAAD,OAAOA,EAAEiB,MAAMsmB,MAChDpmB,EAAuB,CACzBomB,GAAIw7B,GAAYwC,EAAQlH,OAAOzzC,KAAI,SAAC5K,GAAD,OAAOA,EAAEunB,OAC5CtmB,MAAO,CACH27C,KAAMtzC,EAAKrI,MAAM27C,KACjBmH,OAAQz6C,EAAKrI,MAAM8iD,OACnB7wC,KAAK,GAAD,OAAK5J,EAAKrI,MAAMiS,KAAhB,MACJqU,GAAIu7B,EAAYwW,EAAa,UAEjCjtC,SAAU,CACNrpB,IAAKsG,EAAK+iB,SAASrpB,IACnBD,KAAMuG,EAAK+iB,SAAStpB,KxChBEusD,KwCkB1BzB,cAAc,GAGlB,OAAO,6BAAKtI,GAAZ,IAAqBlH,OAAQkH,EAAQlH,OAAOx1C,OAAO1H,KHKpCu6D,CAAenW,EAAS0U,EAAO3Z,SAC1C,QACI,OAAOiF,II9BboW,GAAeza,EAAc,qBAC7B0a,GAAiB1a,EAAc,uBAC/B2a,GAAiB3a,EAAc,uBCoBxB4a,GAAyB,SAACpgB,GAAkB,IAC7CmN,EAA2BnN,EAA3BmN,KAAME,EAAqBrN,EAArBqN,OAAQL,EAAahN,EAAbgN,SACtBtJ,aAAgB,WACZ,IAAMgY,EAvBO,SAAC1b,GAAD,OAAkB,SAACuB,GACpC,KAAIA,EAAMrT,kBAAkBmyB,qBACxB9e,EAAMrT,kBAAkBoyB,uBACvB/e,EAAMqa,SAAYra,EAAMoa,SAA7B,CAEA,GACkB,MAAdpa,EAAMjzB,KACS,MAAdizB,EAAMjzB,KAAeizB,EAAMgf,UACd,MAAdhf,EAAMjzB,IACR,CACE,GAA4B,IAAxB0xB,EAAMqN,OAAO1oD,OAAc,OAC/B,OAAOq7C,EAAMgN,SAAS,CAAEl/C,KAAM,SAGlC,GAAkB,MAAdyzC,EAAMjzB,IAAa,CACnB,GAA0B,IAAtB0xB,EAAMmN,KAAKxoD,OAAc,OAC7B,OAAOq7C,EAAMgN,SAAS,CAAEl/C,KAAM,YAOb0yD,CAAa,CAAErT,OAAME,SAAQL,aAE9C,OADApkC,SAAS8G,iBAAiB,UAAWgsC,GAC9B,kBAAM9yC,SAASizC,oBAAoB,UAAWH,MACtD,CAACvO,EAAME,EAAQL,K,UCvBhByT,IjBQF/C,GkBD0C,SAAC9vD,EAAM2wD,GACjD,IAAI94D,EAAOmI,EAMX,OAJAnI,ECZ6C,SAACokD,EAAS0U,GACvD,OAAQA,EAAOzwD,MACX,IAAK,UACD,OAAOkwD,GAAOnU,EAAS0U,EAAO3Z,SAClC,IAAK,aACD,OAAOlD,GAAUmI,EAAS0U,EAAO3Z,SACrC,IAAK,aACD,OAAOua,GAAUtV,EAAS0U,EAAO3Z,SACrC,QACI,OAAOiF,GDGR6W,CADPj7D,EAAOg6D,GAAoBh6D,EAAM84D,GACFA,GAC/B94D,EAAOk5D,GAAkBl5D,EAAM84D,GAE/B94D,EEbgD,SAACokD,EAAS0U,GAC1D,OAAQA,EAAOzwD,MACX,IAAK,aACD,OAAQywD,EAAO3Z,QAAQ92C,MACnB,IAAK,OACD,OAAOgoD,GAAgBjM,GAC3B,QACI,OAAOA,EAEnB,QACI,OAAOA,GFGR8W,CADPl7D,EAAO64D,GAAqB74D,EAAM84D,GACAA,IlBJjC,SAAC3wD,EAAoB2wD,GACtB,OAAQA,EAAOzwD,MACX,IAAK,OAAS,IAAD,eACkBF,EAAKu/C,MAAzByT,EADE,KAGT,MAAO,CAAEzT,KAHA,WAGMyT,UAASvT,OADZ,CAAIz/C,EAAKgzD,SAAT,mBAAqBhzD,EAAKy/C,UAG1C,IAAK,OAAS,IAAD,eACoBz/C,EAAKy/C,QAA3BuT,EADE,KACUvT,EADV,WAGT,MAAO,CAAEF,KADC,CAAIv/C,EAAKgzD,SAAT,mBAAqBhzD,EAAKu/C,OACrByT,UAASvT,UAE5B,QAEI,IAAMuT,EAAUlD,GAAW9vD,EAAKgzD,QAASrC,GACrCpR,EAAI,CAAIv/C,EAAKgzD,SAAT,mBAAqBhzD,EAAKu/C,OAElC,MAAO,CAAEA,KADTA,EAAOA,EAAKxoD,OAAS,GAAKwoD,EAAOA,EAAKhkD,MAAM,EAAG,IAChCy3D,UAASvT,OAAQ,OiBxB/BwT,GAAa,SAACjb,GAAwC,IFF/DiE,EACAhF,EEC8D,EAClCnB,IAAMod,WAAWL,QAAarxD,GAAW,WACjE,OjBLyB,SAAIw2C,GAAJ,MAAkC,CAC/DuH,KAAM,GACNyT,QAAShb,EACTyH,OAAQ,IiBEG0T,CAAuBnb,MAF4B,mBACvDob,EADuD,KAC9ChU,EAD8C,KAItDG,EAA0B6T,EAA1B7T,KAAMyT,EAAoBI,EAApBJ,QAASvT,EAAW2T,EAAX3T,OAGvB,OFTAxD,EEOmB+W,EFNnB/b,EEM4BmI,EFJ5BtJ,IAAM+X,WAAU,WAGZ,IAAM5E,EAAgB,SAACrJ,GAEnB3I,EAAgB,CAAE/2C,KAAM,SAAU82C,QADH,CAAE4I,SAAQC,UAAU,MAGvDwS,GAAapJ,GACbqJ,GAAerJ,GACfsJ,GAAetJ,KAChB,CAAChS,IAEJnB,IAAM+X,WAAU,WACZ,IAAMwF,EAAQrX,GAAcsX,KAAK,KAAMrX,GACvCvE,EAAoB,qBAAqB,WACrC,OAAO2b,EAAM,CAAEnzD,KAAM,OAAQi8C,MAAO,OAAQvkC,OAAQ,YAExD8/B,EAAoB,qBAAqB,WACrC,OAAO2b,EAAM,CAAEnzD,KAAM,OAAQi8C,MAAO,OAAQvkC,OAAQ,cAEzD,CAACqkC,IEfJuW,GAAuB,CAAEjT,OAAME,SAAQL,aAChC,CAAEgU,UAAShU,aIdTmU,GAAmB,SAACnhB,GAAD,OAAkB,WAC9CA,EAAM0H,aAAa,CAAC,CAAE55C,KAAM,MAAOvI,MAAOy6C,EAAMohB,W,oBCkB9CC,GAAmB,SACrBC,EACAC,GACa,IACAC,EAA8BD,EAAnCj6D,IAAqBm6D,EAAcF,EAApBl6D,KACjB45C,EAAQsF,EAAgB+a,EAAKrgB,OACnC,OAAOqgB,EAAKpgB,KAAKhyC,KAAI,SAACw3C,GAClB,IAAMvF,ErFpBe,SACzBmF,EACAI,GAEA,IAAM/mB,EAAU/W,SAAS06B,eAAemD,EAAgBH,EAASI,IACjE,OAAI/mB,aAAmB6mB,eAAuB7mB,EACvC,KqFcS+hC,CAAcJ,EAAKrgB,MAAOyF,GACtC,GAAY,OAARvF,EAAc,OAnBH,SAACjT,EAAqB/I,GAAwB,IAC5D79B,EAAuB,EAAlBD,EAAqB,EAAfs4B,EAAkBuO,EAClC,EAAG,CAAC,IAAD,EACe,CAAC5mC,EAAMq4B,EAAQ4X,UAAWlwC,EAAOs4B,EAAQgiC,YAAtDr6D,EADF,KACOD,EADP,KAEC,IAAMyR,EAAS6mB,EAAQiiC,aACvB,KAAM9oD,aAAkBguC,aAAc,MACtCnnB,EAAU7mB,QACL6mB,IAAYwF,GACrB,MAAO,CAAE79B,MAAKD,QAaiCw6D,CAAe1gB,EAAKF,GAA9C6gB,EAFC,EAENx6D,IAAmBy6D,EAFb,EAEO16D,KACfC,EAAMw6D,EAASN,EAAWrgB,EAAI7B,aAAe,EAC7Cj4C,EAAO06D,EAAUN,EACvB,MAAO,CAAEn6D,MAAKD,OAAM4tD,MAAO5tD,EAAO85C,EAAIhC,aAGtC,MAAO,CACH73C,IAAKk6D,EAAWvgB,EAAM3B,aAAe,EACrCj4C,KAAMo6D,EACNxM,MAAOwM,EAAYxgB,EAAM9B,iBC7BnC6iB,GAAe,CACjB7hB,YAAY,EACZ8hB,gBAAiB,CAAC,oBCNTC,GAAiB,SAACC,EAAeC,GAAhB,MAA0C,CACpEl7D,EAAGi7D,EAAOj7D,EAAIk7D,EAAOl7D,EACrBhB,EAAGi8D,EAAOj8D,EAAIk8D,EAAOl8D,IAIZm8D,GAAY,SAACF,EAAeC,GAAhB,MAA0C,CAC/Dl7D,EAAGi7D,EAAOj7D,EAAIk7D,EAAOl7D,EACrBhB,EAAGi8D,EAAOj8D,EAAIk8D,EAAOl8D,IAIZo8D,GAAgB,SAAC9mB,EAAch3C,GAAf,MAAqC,CAC9D0C,EAAGs0C,EAAMt0C,EAAI1C,EACb0B,EAAGs1C,EAAMt1C,EAAI1B,IAIX+9D,GAAe,SAACJ,EAAeC,GACjC,OAAOD,EAAOj7D,EAAIk7D,EAAOl8D,EAAIi8D,EAAOj8D,EAAIk8D,EAAOl7D,GAOtCs7D,GAAyB,SAClCpgC,EACAC,EACAogC,EACAC,GAEA,IAAMhpD,EAAIwoD,GAAe7/B,EAAID,GACvB79B,EAAI29D,GAAeQ,EAAID,GAEvBE,EAAaJ,GAAaL,GAAeO,EAAIrgC,GAAK1oB,GAClDkpD,EAAcL,GAAa7oD,EAAGnV,GAKpC,GAAmB,IAAfo+D,GAAoC,IAAhBC,EAAmB,OAAO,KAGlD,GAAoB,IAAhBA,EAAmB,OAAO,KAE9B,IAAMC,EAAIF,EAAaC,EACjBt+D,EAAIi+D,GAAaL,GAAeO,EAAIrgC,GAAK79B,GAAKq+D,EAGpD,GAAIt+D,EAAI,GAAKA,EAAI,GAAKu+D,EAAI,GAAKA,EAAI,EAAG,OAAO,KAE7C,IAAMC,EAASR,GAAc5oD,EAAGpV,GAEhC,OADqB+9D,GAAUjgC,EAAI0gC,IC1D1BC,GAAmB,SAACC,EAAUC,GACvC,OAAOt2D,KAAK8a,KAAK9a,KAAKwE,IAAI6xD,EAAE97D,EAAI+7D,EAAE/7D,EAAG,GAAKyF,KAAKwE,IAAI6xD,EAAE98D,EAAI+8D,EAAE/8D,EAAG,KAOrDg9D,GAAe,SACxBF,EACAC,EACAj3D,GAEA,IAAMm3D,EAAMJ,GAAiBC,EAAGC,GAE1BvpD,EAAIwoD,GAAee,EAAGD,GAEtBI,EAAMp3D,EAMZ,MAAO,CAJGq2D,GAAUW,EAAGV,GAAc5oD,EAD3B,EAAI0pD,EAAMD,IAIVd,GAAUW,EAAGV,GAAc5oD,EAD3B,EAAI0pD,EAAMD,MCpBXE,GAAS,SAACL,EAAUC,GAC7B,IAAMK,EAASP,GAAiBC,EAAGC,GAAK,EACxC,MAAM,KAAN,OAAYK,EAAZ,YAAsBA,EAAtB,kBAAsCL,EAAE/7D,EAAxC,YAA6C+7D,EAAE/8D,ICoCtCq9D,GAA0B,SACnCC,EACAC,EACAT,EACAC,GAKA,IAHA,IAAIh+D,EAAe+9D,EACbU,EAAQ,YAAOF,EAAYr0C,QAC3B+gB,EAAiB,GACd1rC,EAAI,EAAGA,EAAIk/D,EAAS/+D,OAAQH,IAAK,CACtC,IAAMqnB,EAAK63C,EAASl/D,GACpB,GAAIqnB,IAAO43C,EAEP,MAGJ,IADA,IAAME,EAASH,EAAY75D,IAAIkiB,GACtB+3C,EAAI,EAAGA,EAAID,EAAOh/D,OAAS,EAAGi/D,IAAK,OAEzB,CAACD,EAAOC,GAAID,EAAOC,EAAI,IAChCC,EAAIrB,GAAuBv9D,EAAGg+D,EAHI,WAIxC,GAAU,OAANY,MAEAd,GAAiB99D,EAAG4+D,GA9BR3R,MA+BZ6Q,GAAiBE,EAAGY,GA/BR3R,IA+BhB,CAPwC,MASzBgR,GAAaj+D,EAAG4+D,EAjCf3R,GAwBwB,mBASjC4R,EATiC,KAS9BC,EAT8B,KAUxC7zB,EAAKlpC,KAAL,YAAe88D,EAAE58D,EAAjB,YAAsB48D,EAAE59D,IACxBgqC,EAAKlpC,KAAKq8D,GAAOS,EAAGC,IAEpB9+D,EAAI8+D,IAIZ,OADA7zB,EAAKlpC,KAAL,YAAei8D,EAAE/7D,EAAjB,YAAsB+7D,EAAE/8D,IACjBgqC,EAAK72B,KAAK,MCjEf2qD,GAAgB,SAAChB,EAAUC,EAAU30C,GAAsB,IAAD,EAC7C,CAAC00C,EAAE10C,GAAM20C,EAAE30C,IAAnB/gB,EADqD,KAClDhK,EADkD,KAEtDmW,EAAI/M,KAAK+I,IAJJw8C,EAIgBvlD,KAAKqa,IAAIzZ,EAAIhK,GAAK,GAC7C,OAAIgK,IAAMhK,EAAUgK,EACbhK,EAAImW,GAAKnM,EAAIhK,EAAI,GAAK,IAG3B0gE,GAAY,SAACjB,EAAUC,GAAX,MAAgC,CAC9C/7D,EAAG88D,GAAchB,EAAGC,EAAG,KACvB/8D,EAAG89D,GAAchB,EAAGC,EAAG,OAGrBiB,GAAa,SAAClB,EAAUC,GAAX,OAAiCA,EAAE/7D,IAAM87D,EAAE97D,GAAK+7D,EAAE/8D,IAAM88D,EAAE98D,GAEvEi+D,GAAY,SACdnkB,EACA2jB,EACAzzB,EACA1rC,GACO,MAEW,CAACm/D,EAAOn/D,EAAI,GAAIm/D,EAAOn/D,GAAIm/D,EAAOn/D,EAAI,IAAjDw+D,EAFA,KAEGC,EAFH,KAEMmB,EAFN,KAIP,GAAIF,GAAWlB,EAAGC,IAAMiB,GAAWjB,EAAGmB,GAClC,GAA0B,OAAtBpkB,EAAMwjB,YACNtzB,EAAKlpC,KAAL,YAAei8D,EAAE/7D,EAAjB,YAAsB+7D,EAAE/8D,QACrB,CACH,IAAMm+D,EAAKrkB,EAAMwjB,YACX/mC,EAAO8mC,GAAwBc,EAAIrkB,EAAMshB,KAAKz1C,GAAIm3C,EAAGC,GAC3D/yB,EAAKlpC,KAAKy1B,OAEX,OAEY,CAACwnC,GAAUjB,EAAGC,GAAIgB,GAAUG,EAAGnB,IAAvCqB,EAFJ,KAEOC,EAFP,KAIH,GAA0B,OAAtBvkB,EAAMwjB,YACNtzB,EAAKlpC,KAAL,YAAes9D,EAAEp9D,EAAjB,YAAsBo9D,EAAEp+D,QACrB,CACH,IAAMm+D,EAAKrkB,EAAMwjB,YACX/mC,EAAO8mC,GAAwBc,EAAIrkB,EAAMshB,KAAKz1C,GAAIm3C,EAAGsB,GAC3Dp0B,EAAKlpC,KAAKy1B,GAEdyT,EAAKlpC,KAAL,YAAei8D,EAAE/7D,EAAjB,YAAsB+7D,EAAE/8D,EAAxB,YAA6Bq+D,EAAEr9D,EAA/B,YAAoCq9D,EAAEr+D,IACtCy9D,EAAOn/D,GAAK+/D,IA0CPC,GAAc,SAACxkB,GAA4B,IAzBjC2jB,EA0BXrC,EAAkCthB,EAAlCshB,KAAMmD,EAA4BzkB,EAA5BykB,WAAYjB,EAAgBxjB,EAAhBwjB,YAClBz4C,EAAkB05C,EAAlB15C,KAAM25C,EAAYD,EAAZC,IAAK/f,EAAO8f,EAAP9f,GAenB,MAAO,CAAExJ,MAbepwB,EAAK45C,OAAOz1D,KAAI,SAAC9I,EAAGoC,GACxC,IAAMm7D,EAtBI,SAACz0D,EAAiB1G,GAA4B,IACpDuiB,EAAqB7b,EAArB6b,KAAWq5C,EAAUl1D,EAAfw1D,IAAQ/f,EAAOz1C,EAAPy1C,GADqC,EAI5C,CAAC55B,EAAK45C,OAAOn8D,GAAQm8C,EAAGggB,OAAOn8D,IAAvCw6D,EAJoD,KAIjDa,EAJiD,OAK5C,CAAC94C,EAAK65C,MAAOjgB,EAAGigB,OAAxB3B,EALoD,KAKjD4B,EALiD,KAQ3D,OADiB7B,EAAE97D,IAAM+7D,EAAE/7D,GAAK29D,EAAE39D,IAAM28D,EAAE38D,EAC3B,CAAI87D,GAAJ,mBAAUoB,GAAV,CAAaP,IAAb,CAAmBb,EAAGC,GAAtB,mBAA4BmB,GAA5B,CAA+BS,EAAGhB,IAc9BiB,CAAUL,EAAYj8D,GAC/B0nC,EA5CG,SAAC8P,EAAc+kB,GAC5B,GAAyB,IAArBA,EAAUpgE,OAAc,MAAO,GACnC,GAAyB,IAArBogE,EAAUpgE,OAAc,MAAMyT,MAAM,iCAIxC,IAHA,IAAMurD,EAAM,YAAOoB,GACb70B,EAAO,CAAC,KAAD,OAAMyzB,EAAO,GAAGz8D,EAAhB,YAAqBy8D,EAAO,GAAGz9D,IACtC8f,EAAO29C,EAAOh/D,OAAS,EACpBH,EAAI,EAAGA,EAAIwhB,EAAMxhB,IACtB2/D,GAAUnkB,EAAO2jB,EAAQzzB,EAAM1rC,GAGnC,OADA0rC,EAAKlpC,KAAL,YAAe28D,EAAO39C,GAAM9e,EAA5B,YAAiCy8D,EAAO39C,GAAM9f,IACvCgqC,EAAK72B,KAAK,KAkCA2rD,CAAShlB,EAAO2jB,GAE7B,OADW,OAAXH,QAAW,IAAXA,KAAatc,IAAIoa,EAAKz1C,GAAI83C,GACnBzzB,KASKvrC,QA1CGg/D,EAoCkB,CACjC54C,EAAK45C,OAAO,IADoB,mBAE7BD,GAF6B,CAGhC/f,EAAGggB,OAAO,MAtCP/8C,QAAO,SAACha,EAAM4tC,EAAOhzC,GACxB,GAAc,IAAVA,EAAa,OAAO,EADU,IAEvByzC,EAAcT,EAAjBt0C,EAAUi1C,EAAOX,EAAVt1C,EAFmB,EAGTy9D,EAAOn7D,EAAQ,GAA7B+0D,EAHuB,EAG1Br2D,EAAUs2D,EAHgB,EAGnBt3D,EACf,OAAO0H,EAAOjB,KAAK8a,KAAK9a,KAAKwE,IAAI8qC,EAAKshB,EAAI,GAAK5wD,KAAKwE,IAAIgrC,EAAKqhB,EAAI,MAClE,KClCDyH,GAAU,SAACzyC,GAAD,OAAgB,SAACsnB,GAAD,MAA8B,CAC1D5yC,EAAY,SAATsrB,EAAkBsnB,EAAIzyC,KAAOyyC,EAAImb,MACpC/uD,EAAG4zC,EAAIxyC,OAGL49D,GAAgB,SAACP,EAAqBnyC,GAAtB,MAAiD,CACnEtrB,EAAGy9D,EAAO,GAAGz9D,EvDlDQ,IuDkDM,UAATsrB,EAAmB,GAAK,GAC1CtsB,EAAGy+D,EAAO/8C,QAAO,SAACwsC,EAAK5Y,GAAN,OAAgB4Y,EAAM5Y,EAAMt1C,IAAG,GAAKy+D,EAAOhgE,SAO1DwgE,GAAe,SAACnlB,GAIU,IACpBolB,EAAyBplB,EAAzBolB,QAAS9D,EAAgBthB,EAAhBshB,KAAM+D,EAAUrlB,EAAVqlB,MADI,EAKR,CAACA,EAAMt6C,KAAK,GAAIs6C,EAAM1gB,GAAG,IAArC55B,EALoB,KAKd45B,EALc,KAMtB2gB,EAA6B,QAAnBC,EAA4B,QACvCx6C,EAAKkqC,OAAStQ,EAAGt9C,KvDhEU6qD,IuDiE1BoT,EAAqB,QAAXC,EAAoB,QACxBx6C,EAAK1jB,MAAQs9C,EAAGsQ,MvDlEI/C,KuDmE1BoT,EAAqB,OAAXC,EAAmB,SAElC,IAAMC,EAAaH,EAAMt6C,KAAK7b,IAAI+1D,GAAQK,IACpCG,EAAYP,GAAcM,EAAYF,GACxCI,EAAWL,EAAM1gB,GAAGz1C,IAAI+1D,GAAQM,IAWpC,OATgB,OAAZH,IACAM,EAAWA,EAASx2D,KAAI,SAACssC,EAAOhzC,GAC5B,ICrDiBy4C,EAAeE,EDqD1BwkB,GCrDW1kB,EDqDWqgB,EAAK3c,GAAG1D,MCrDJE,EDqDWmgB,EAAK3c,GAAGzD,KAAK14C,GCrDxC,UACrBy4C,EADqB,YACZE,IDqDEsiB,EAASnC,EAAKz1C,GACd3lB,ECrBS,SAAC85C,GAAyB,IAEzC2lB,EAAoB3lB,EAApB2lB,OAAQP,EAAYplB,EAAZolB,aACYh2D,IAAxBg2D,EAAQz7D,IAAIg8D,IAAuBP,EAAQle,IAAIye,EAAQ,IAAI9c,KAC/D,IAAM+c,EAAqBR,EAAQz7D,IAAIg8D,GAEjC/3D,EAAOg4D,EAASj8D,IAAIq2C,EAAMyjB,QAC1Bh+D,EAAOu6C,EAAM95C,EAGnB,GAAIT,IAASmI,EAAM,OAAOnI,OAIb2J,IAATxB,GAAoBg4D,EAAQ,OAAQ5lB,EAAMyjB,QAG9C,IACMoC,EAlCU,SAAC3e,EAAkBj+C,GAEnC,IAF8D,IACzDzE,EAAc,EAAXoB,EAAcqD,EACfi+C,EAAIj5B,IAAIroB,IACXA,EAASqD,ExDlDS,GwDkDAzE,EAAkB,EACpCA,EAAIA,EAAIA,EAAI,GAAKA,EAAS,EAAJA,EAE1B,OAAOoB,EA4BMkgE,CADA,IAAI3e,IAAIye,EAAS3uD,UACCxR,GAE/B,OADAmgE,EAAS1e,IAAIlH,EAAMyjB,OAAQoC,GACpBA,EDCWE,CAAY,CAAEX,UAASO,SAAQlC,SAAQv9D,EAAGs1C,EAAMt1C,IAC1D,MAAO,CAAEgB,EAAGs0C,EAAMt0C,EAAGhB,SAItB,CACH6kB,KAAM,CAAE45C,OAAQa,EAAYhzC,KAAM8yC,EAAUV,MAAOa,GACnD9gB,GAAI,CAAEggB,OAAQe,EAAUlzC,KAAM+yC,EAAQX,MAH1BM,GAAcQ,EAAUH,MAgE/BS,GAAgB,SAAChmB,GAA8B,IAChDimB,EAAoCjmB,EAApCimB,UAAW3E,EAAyBthB,EAAzBshB,KAAM+D,EAAmBrlB,EAAnBqlB,MAAOD,EAAYplB,EAAZolB,QADuB,EAGlCD,GAAa,CAAEE,QAAOD,UAAS9D,SAA5Cv2C,EAH+C,EAG/CA,KAAM45B,EAHyC,EAGzCA,GACV+f,EAzDa,SAACf,GAAkD,IAC5D54C,EAAa44C,EAAb54C,KAAM45B,EAAOgf,EAAPhf,GAOd,GAAI55B,EAAKyH,OAASmyB,EAAGnyB,KAAM,CAEvB,IAAM5L,GAAWmE,EAAK65C,MAAM19D,EAAIy9C,EAAGigB,MAAM19D,GAAK,EAIxCg/D,EAAYvhB,EAAGigB,MAAM19D,EAAI6jB,EAAK65C,MAAM19D,EAAI,MAAQ,MAChDi/D,EAAOxhB,EAAGigB,MAAM19D,EAFP+rD,IAE0B,QAAdiT,GAAuB,EAAI,GAChDzpB,EACY,QAAdypB,EACMv5D,KAAK8N,IAAI0rD,EAAMv/C,GACfja,KAAK+I,IAAIywD,EAAMv/C,GACzB,MAAO,CACH,CAAE1f,EAAGu1C,EAAMv2C,EAAG6kB,EAAK65C,MAAM1+D,GACzB,CAAEgB,EAAGu1C,EAAMv2C,EAAGy+C,EAAGigB,MAAM1+D,IAc/B,GAAI6kB,EAAKyH,OAASmyB,EAAGnyB,KAAM,CACvB,IAAMiqB,EAAO9vC,KAAK8N,IAAIsQ,EAAK65C,MAAM19D,EAAGy9C,EAAGigB,MAAM19D,GAC7C,MAAO,CACH,CAAEA,EAAGu1C,EAAMv2C,EAAG6kB,EAAK65C,MAAM1+D,GACzB,CAAEgB,EAAGu1C,EAAMv2C,EAAGy+C,EAAGigB,MAAM1+D,IAG/B,MAAMkS,MAAM,SAcFguD,CAAa,CAAEr7C,OAAM45B,OAK/B,OAHkB,OAAdshB,IACAvB,EExFyB,SAAC1kB,GAAwC,IAAD,IACtCA,EAAMimB,UAA7BI,EAD6D,EAC7DA,SAAUC,EADmD,EACnDA,SACZ7gE,EAAOu6C,EAAMumB,UAAU,GAAGr/D,EAC1B0G,EAAI,UAAGy4D,EAAS18D,IAAIq2C,EAAMshB,KAAKz1C,WAA3B,aAAG,EAA6B64C,IAG1C,GAAI92D,IAASnI,EAAM,OAAOu6C,EAAMumB,UAIhC,IAAMrf,EAAMof,EAKZ,QAFal3D,IAATxB,GAAoBs5C,EAAG,OAAQt5C,GAE/Bs5C,EAAIj5B,IAAIxoB,GAAO,CAEf,IAAMyB,EA3Bc,SAACggD,EAAkBj+C,GAG3C,IAFA,IAAIrD,EAASqD,EACTzE,EAAI,EACD0iD,EAAIj5B,IAAIroB,IACXA,EAASqD,EzD/DQ,GyD+DAzE,EAAgB,EACjCA,EAAIA,EAAI,GAAKA,EAAS,EAAJA,EAEtB,OAAOoB,EAoBO4gE,CAAoBtf,EAAKzhD,GAGnC,OAFA4gE,EAASnf,IAAIlH,EAAMshB,KAAKz1C,GAAI,CAAE46C,OAAQzmB,EAAMshB,KAAMoD,IAAKx9D,IACvDggD,EAAIz/C,IAAIP,GACD84C,EAAMumB,UAAUr3D,KAAI,SAACssC,GAAD,oBAAC,gBAAgBA,GAAjB,IAAwBt0C,SAKnD,OAFAm/D,EAASnf,IAAIlH,EAAMshB,KAAKz1C,GAAI,CAAE46C,OAAQzmB,EAAMshB,KAAMoD,IAAKj/D,IACvDyhD,EAAIz/C,IAAIhC,GACDu6C,EAAMumB,UF+DPG,CAAkB,CAAET,YAAW3E,OAAMiF,UAAW7B,KAEnD,CAAE35C,OAAM25C,MAAK/f,OGvIXgiB,GAAe,SACxB3mB,GACY,IAAD,YAELqlB,EV2BkB,SAACrlB,GAAD,MAA8B,CACtDj1B,KAAMs2C,GAAiBrhB,EAAMshB,KAAKv2C,KAAMi1B,EAAMiD,UAAUtyB,UACxDg0B,GAAI0c,GAAiBrhB,EAAMshB,KAAK3c,GAAI3E,EAAMiE,QAAQtzB,WU7BpCi2C,CAAa5mB,GAErBimB,EAAS,oBAAGjmB,EAAMimB,iBAAT,aAAG,EAAiBv4D,eAApB,QAA+B,KACxC03D,EAAO,oBAAGplB,EAAMolB,eAAT,aAAG,EAAe13D,eAAlB,QAA6B,KACpC81D,EAAW,oBAAGxjB,EAAMwjB,mBAAT,aAAG,EAAmB91D,eAAtB,QAAiC,KAE1C4zD,EAASthB,EAATshB,KACFmD,EAAauB,GAAc,CAAEC,YAAW3E,OAAM+D,QAAOD,YAE3D,OADaZ,GAAY,CAAElD,OAAMkC,cAAaiB,gBAIrCoC,GAAe,SAAC7mB,GAAmC,IACpDshB,EAA8DthB,EAA9DshB,KAAMre,EAAwDjD,EAAxDiD,UAAWgB,EAA6CjE,EAA7CiE,QAASgiB,EAAoCjmB,EAApCimB,UAAWzC,EAAyBxjB,EAAzBwjB,YAAa4B,EAAYplB,EAAZolB,QAEpD0B,ETxBoB,SAACxF,GAA2B,MAExB5d,WAAe,IAFS,mBAE/CojB,EAF+C,KAEtCC,EAFsC,KAqBtD,OAlBArjB,mBAAsB,WAClB,IAAM34B,EAAOw7B,EAAgB+a,EAAKv2C,KAAKk2B,OACjC0D,EAAK4B,EAAgB+a,EAAK3c,GAAG1D,OAC7BiG,EAAM,kBAAM6f,EAAW,KAEvBC,EAAS,IAAIh8C,OAAOi8C,eAjBjB,SAACF,GAAD,OAAoD,WACjEA,KAgB6CG,CAAShgB,IAClD8f,EAAOG,QAAQp8C,GACfi8C,EAAOG,QAAQxiB,GAEf,IAAMyiB,EAAW,IAAIC,iBA7BV,SAACN,GAAD,OAA8C,SAACO,GAC9DA,EAAQx4D,SAAQ,SAACy4D,GACO,eAAhBA,EAAOz5D,MACkB,oBAAzBy5D,EAAOC,eACXT,QAyBsCU,CAAWvgB,IAGjD,OAFAkgB,EAASD,QAAQp8C,EAAMi3C,IACvBoF,EAASD,QAAQxiB,EAAIqd,IACd,WACHoF,EAASM,aACTV,EAAOU,gBAEZ,CAACpG,IAEGwF,ESGSa,CAAerG,GAH4B,EAOjC5d,WAAgC,MAPC,mBAOpD8N,EAPoD,KAO7CoW,EAP6C,KAQrDh6D,EAAO81C,SAAa,GA2B1B,OA1BAA,mBAAsB,WAelB,OAdA14B,OAAO68C,aAAaj6D,EAAKF,SAGzBE,EAAKF,QAAUsd,OAAOiE,YAAW,WAC7B,IAAM64C,EAAWnB,GAAa,CAC1BrF,OACAre,YACAgB,UACAgiB,YACAb,UACA5B,gBAEJoE,EAASE,KACV,GACI,kBAAM98C,OAAO68C,aAAaj6D,EAAKF,YACvC,CACC4zD,EACAre,EACAgB,EACAgiB,EACAzC,EACAsD,EACA1B,EACAplB,EAAM+nB,kBAEHvW,GC7EEwW,GAAmB,SAACvE,GAAD,uBAA8BA,IAWjDwE,GAAkC,SAACxE,EAAQ31D,EAAMtF,GAAf,uBACjCi7D,EADiC,cACrB31D,EADqB,qBACXtF,QADW,IACXA,IAAS,IAEhC0/D,GAAoC,SAACzE,EAAQ31D,EAAMtF,GAC5D,IAAMqjB,EAAKo8C,GAAoBxE,EAAQ31D,EAAMtF,GACvCm3B,EAAU/W,SAAS06B,eAAez3B,GACxC,GAAI8T,aAAmBwoC,WAAY,OAAOxoC,EAC1C,MAAMvnB,MAAM,8BCPHgwD,GAAgB,SAACpoB,GAAD,OACzB,0BAAQ5Z,UAAW7hC,KAAE8jE,IAAK3uD,EAAE,KACxB,iCACI4uD,IAAG,UAAKtoB,EAAM9P,KAAKvrC,OAAS,IAAzB,KACH4jE,YAAY,aACZ18C,GAAIo8C,GAAoBjoB,EAAMshB,KAAKz1C,GAAI,aACvCqkB,KAAM8P,EAAM9P,KAAKiL,MAAM,OCgB7BqtB,GAAe,SAACxoB,GAClB,IAAMyoB,EAAQ,CAAClkE,KAAE4gC,WAEjB,OADI6a,EAAM0oB,YAAYD,EAAMzhE,KAAKzC,KAAE2qD,UAC5BuZ,EAAMpvD,KAAK,MAGTsvD,GAAO,SAAC3oB,GACAA,EAAMshB,KAAKv2C,KAAKm2B,KAAMlB,EAAMshB,KAAK3c,GAAGzD,KAErD,IAAMhR,EAAO22B,GAAa,CACtBvF,KAAMthB,EAAMshB,KACZre,UAAWjD,EAAMiD,UACjBgB,QAASjE,EAAMiE,QAEfgiB,UAAWjmB,EAAMimB,UACjBzC,YAAaxjB,EAAMwjB,YACnB4B,QAASplB,EAAMolB,QACf2C,gBAAiB/nB,EAAM+nB,kBAE3B,OAAa,OAAT73B,EAAsB,KAGtB,uBAAGrkB,GAAIm8C,GAAiBhoB,EAAMshB,KAAKz1C,IAAKua,UAAWoiC,GAAaxoB,IAC3D9P,EAAKiL,MAAMjsC,KAAI,SAAC5L,EAAGkF,GAAJ,OACZ,0BACI8lB,IAAK9lB,EACLqjB,GAAIo8C,GAAoBjoB,EAAMshB,KAAKz1C,GAAI,YAAarjB,GACpD49B,UAAW7hC,KAAE2rC,KACb5sC,EAAGA,OAIV08C,EAAM0oB,YAAc1oB,EAAM0a,eACvB,kBAAC,GAAD,CAAe4G,KAAMthB,EAAMshB,KAAMpxB,KAAMA,IAE3C,0BACI9J,UAAW7hC,KAAEqkE,QACbtlE,EAAG4sC,EAAKiL,MAAM,GACdkH,QAAS8e,GAAiB,CACtBC,MAAOphB,EAAMshB,KAAKz1C,GAClB67B,aAAc1H,EAAM0H,mB,0CCtElCmhB,GAAO,kBACT,0BACIh9C,GAAG,YACHi9C,QAAQ,YACRC,KAAK,IACLC,KAAK,IACLC,YAAY,KACZC,aAAa,KACbC,YAAY,kBAEZ,0BAAQ/iC,UAAW7hC,KAAE4gC,UAAWrd,GAAG,IAAIC,GAAG,IAAIrO,EAAE,QAIlD0vD,GAAK,kBACP,0BACIv9C,GAAG,UACHi9C,QAAQ,YACRC,KAAK,KACLC,KAAK,IACLC,YAAY,KACZC,aAAa,KACbC,YAAY,iBACZE,OAAO,sBAEP,2BAASjjC,UAAW7hC,KAAE4gC,UAAWw+B,OAAO,kBAInC2F,GAAc,kBACvB,4BACI,gBAAC,GAAD,MACA,gBAAC,GAAD,QCfKC,GAAc,SAACvpB,GACxB,IAAM4C,EAAW,SAACpwB,GACd,IAAMyuB,EAAQjB,EAAMwpB,UAAU7/D,IAAI6oB,EAAKyuB,OACvC,QAAc7xC,IAAV6xC,EAAqB,OAAOA,EAChC,MAAM7oC,MAAM,uBAGV6tD,ENIkB,SAACjmB,GACzB,IAAMimB,EAAYviB,SAAwB,CACtC2iB,SAAU,IAAIxd,IAEdyd,SAAU,IAAInf,MAiBlB,OAbAzD,aAAgB,WACZ,IAAMG,EAAM,IAAIsD,IAAInH,EAAMypB,MAAMv6D,KAAI,SAACoyD,GAAD,OAAUA,EAAKz1C,OACnDo6C,EAAUv4D,QAAQ24D,SAASv3D,SAAQ,SAACwyD,EAAMz1C,GAClCg4B,EAAI51B,IAAIpC,KAKZo6C,EAAUv4D,QAAQ44D,SAAlB,OAAkChF,EAAKoD,KACvCuB,EAAUv4D,QAAQ24D,SAAlB,OAAkCx6C,SAEvC,CAACm0B,EAAMypB,QAEHxD,EMzBWyD,CAAa,CAAED,MAAOzpB,EAAM6J,QAAQlB,OAChDyc,EPKgB,SAACqE,GACvB,IAAMv6D,EAAMw0C,SAAsB,IAAImF,KAUtC,OARAnF,aAAgB,WACZ,IAAMimB,EAAuB,IAAIxiB,IAAIsiB,EAAMv6D,KAAI,SAACoyD,GAAD,OAAUA,EAAKz1C,OAC9D,YAAI3c,EAAIxB,QAAQuJ,UAAUnI,SAAQ,SAAC82D,GAC/B,YAAIA,EAASz2C,QAAQrgB,SAAQ,SAAC+c,IACF,IAApB89C,EAAQ17C,IAAIpC,IAAe+5C,EAAQ,OAAQ/5C,WAGxD,CAAC49C,IACGv6D,EOhBS06D,CAAW5pB,EAAM6J,QAAQlB,MACnC6a,EVLoB,SAACiG,GAC3B,IAAMxpB,EAAWyD,SAA0B,IAAImF,KAU/C,OAPAnF,aAAgB,WACZ,IAAMmmB,EAAW,IAAI1iB,IAAIsiB,EAAMv6D,KAAI,SAACxJ,GAAD,OAAOA,EAAEmmB,OAC5Co0B,EAAIvyC,QAAQoB,SAAQ,SAAC4D,EAAQ4b,IACC,IAAtBu7C,EAAS57C,IAAIK,IAAgB2xB,EAAIvyC,QAAJ,OAAmB4gB,QAEzD,CAACm7C,IAEGxpB,EUNa6pB,CAAe9pB,EAAM6J,QAAQlB,MAEjD,OACI,uBACIviB,UAAW7hC,KAAE4gC,UACb59B,MAAOy4C,EAAM6J,QAAQt+B,KAAKhkB,MAC1BC,OAAQw4C,EAAM6J,QAAQt+B,KAAK/jB,QAE3B,gBAAC,GAAD,MACCw4C,EAAM6J,QAAQlB,KAAKz5C,KAAI,SAACoyD,GAAD,OACpB,gBAAC,GAAD,CACIhzC,IAAKgzC,EAAKz1C,GACVy1C,KAAMA,EAENoH,WAAY1oB,EAAM+pB,aAAa97C,IAAIqzC,EAAKz1C,IACxC67B,aAAc1H,EAAM0H,aAEpBzE,UAAWL,EAAS0e,EAAKv2C,MACzBk5B,QAASrB,EAAS0e,EAAK3c,IAEvBE,gBAAiB7E,EAAM6E,gBAEvB6V,cAAe1a,EAAM0a,cAErB8I,YAAaA,EACbyC,UAAWA,EACXb,QAASA,EACT2C,gBAAiB/nB,EAAM6J,e,0CCnB9BmgB,GAAkB,SAAChqB,GAC5B,OAAO,SAACiqB,EAAQvgE,GAIZ,GAAe,IAAXA,EAAKxC,GAAsB,IAAXwC,EAAKxD,EAAzB,CACA,IAAMyqB,EAAqB,CACvBtpB,KAAM24C,EAAMiB,MAAMtwB,SAAStpB,KAAOqC,EAAKxC,EACvCI,IAAK04C,EAAMiB,MAAMtwB,SAASrpB,IAAMoC,EAAKxD,GAEnC+6C,EAAK,6BAAQjB,EAAMiB,OAAd,IAAqBtwB,aAChCqvB,EAAMkqB,cAAcp7D,QApCD,SAACmyC,GAAD,OAAsB,SAACkpB,GAA2B,IAAD,cAClDA,EADkD,GACjE7I,EADiE,KAC3D8I,EAD2D,KAElE/K,EAASiC,EAAKv2C,KAAKk2B,QAAUqgB,EAAK3c,GAAG1D,MACrCopB,EAAO/I,EAAK3c,GAAG1D,QAAUA,EAAMp1B,GACxB86C,GAAa,CACtBrF,OACAre,UAAWoc,EAASpe,EAAQopB,EAAOD,EAAQnpB,EAC3CgD,QAASob,GAAiBgL,EAARppB,EAAuBmpB,EACzChF,QAAS,KACTa,UAAW,KACXzC,YAAa,OAGZroB,MAAMrsC,SAAQ,SAACxL,EAAGkF,GACnB0/D,GAAkB5G,EAAKz1C,GAAI,YAAarjB,GAAOmlC,aAAa,IAAKrqC,MAGrE,IACsB4kE,GAAkB5G,EAAKz1C,GAAI,aACnC8hB,aAAa,OAAQ,IACjC,MAAOjoC,MAgBuB4kE,CAAmBrpB,OC3CjD1mC,GAAQ,SAACmyC,GAAD,OAAwC,GAAvB//C,KAAK4N,MAAMmyC,EAAM,KAOnC6d,GAAkB,SAACvqB,GAC5B,OAAO,SAACiqB,EAAQvgE,GACZ,GAAe,IAAXA,EAAKxC,GAAsB,IAAXwC,EAAKxD,EAAzB,CACA,IAAMyqB,EAAqB,CACvBtpB,KAAMkT,GAAMylC,EAAMiB,MAAMtwB,SAAStpB,KAAOqC,EAAKxC,GAC7CI,IAAKiT,GAAMylC,EAAMiB,MAAMtwB,SAASrpB,IAAMoC,EAAKxD,IAE/C85C,EAAM6E,gBAAgB,CAClB/2C,KAAM,qBACN82C,QAAS,CAAE/4B,GAAIm0B,EAAMiB,MAAMp1B,GAAI8E,iBCFrC65C,GAAW,SAAC3mB,EAAiB/1C,GAAlB,OACb+1C,EAAI1qC,QAAO,SAAC0S,GAAD,OAAQA,EAAG/d,OAASA,KAAMoB,KAAI,SAAC2c,GAAD,OAAQA,EAAGtmB,UAE3CklE,GAAgB,SAAC5mB,GAAD,MAAsB,CAC/ClB,OAAQ,IAAIwE,IAAIqjB,GAAS3mB,EAAK,UAC9B8E,KAAM,IAAIxB,IAAIqjB,GAAS3mB,EAAK,U,qBCZ1Bma,GAAS,SAAChe,GAAD,OAAkB,WAC7B,IAAM4E,EAAyB,CAAE0B,QAAStG,EAAMsG,SAChDtG,EAAM6E,gBAAgB,CAAE/2C,KAAM,UAAW82C,cAGhC8lB,GAAe,SAAC1qB,GAAD,OACxB,yBAAK5Z,UAAW7hC,KAAE4gC,WACd,kBAAC,IAAD,CACIkd,QAAS2b,GAAOhe,GAChBsC,KAAMC,IAAM96C,IACZ8jB,KAAMk1B,IAAOl1B,KAAK42B,MAClBn4B,MAAOy2B,IAAOz2B,MAAMo4B,KACpBuoB,aAAa,GALjB,S,qBCQFC,GAAa,SACfjrC,EACAumC,GAFe,MAID,OAAdA,EACMvmC,EAAQkrC,uBACRlrC,EAAQmrC,oBAMLC,GAAiB,SAC1BprC,EACAumC,GAEA,IAAM8E,EAAUrrC,EAAQhY,QAAQyqC,IAChC,GAAgB,OAAZ4Y,EAAkB,MAAM5yD,MAAM,eAElC,IADA,IAAI6yD,EAA4BL,GAAWI,EAAS9E,GAC/B,OAAd+E,GAAoB,CAEvB,GAAIA,EAAUC,UAAU9tC,SpErCD,aoEsCnB,OAAO6tC,EACXA,EAAYL,GAAWK,EAAW/E,GAEtC,OAAO,MAOEiF,GAAmB,SAAChqB,EAAc34C,GAC3C,IAAMgvD,EAAMrW,EAAIiqB,iBAAiBhZ,IAG3BxL,EAAS4Q,EADD,UAAVhvD,EAAoB,EAAc,SAAVA,EAAmBgvD,EAAI7yD,OAAS,EAAI6D,GAEhE,GAAIo+C,aAAkBykB,QAAS,OAAOzkB,EACtC,MAAMxuC,MAAM,yCA6BHkzD,GAAoB,SAC7B3rC,EACAumC,GAEA,IAAMqF,EA1BoB,SAC1B5rC,EACAumC,GAEA,IAAMtf,EAASjnB,EAAQhY,QAAQyqC,IAC/B,GAAe,OAAXxL,EAAiB,MAAMxuC,MAAM,kBACjC,IAAM+oC,EAAMyF,EAAOj/B,QAAQyqC,IAC3B,GAAY,OAARjR,EAAc,MAAM/oC,MAAM,eAC9B,IAAMo/C,EAAG,YAAOrW,EAAIiqB,iBAAiBhZ,KAC/B5pD,EAAQgvD,EAAI7pD,QAAQi5C,GAC1B,MAAkB,SAAdsf,EACiB,IAAV19D,EAAc,KAAOgvD,EAAIhvD,EAAQ,GAEjCA,IAAUgvD,EAAI7yD,OAAS,EAAI,KAAO6yD,EAAIhvD,EAAQ,GAanCgjE,CAAsB7rC,EAASumC,GACrD,GAAIqF,aAAyBF,QAAS,OAAOE,EAE7C,IAAME,EAAuB,SAAdvF,EACTwF,EAAcX,GAAeprC,EAAS8rC,EAAS,KAAO,QAC5D,OAAoB,OAAhBC,EAA6B,KAC1BP,GAAiBO,EAAaD,EAAS,OAAS,UAmB9CE,GAAgB,SACzBhsC,EACAumC,GAEA,IAAMwF,EAAcX,GAAeprC,EAASumC,GAC5C,GAAoB,OAAhBwF,EAAsB,OAAO,KACjC,IAAMljE,EAnBa,SAACm3B,GACpB,IAAMwhB,EAAMxhB,EAAQhY,QAAQyqC,IAC5B,GAAY,OAARjR,EAAc,MAAM/oC,MAAM,eAC9B,IAAMwuC,EAASjnB,EAAQhY,QAAQyqC,IAC/B,GAAe,OAAXxL,EAAiB,MAAMxuC,MAAM,kBACjC,IAAMo/C,EAAMrW,EAAIiqB,iBAAiBhZ,IACjC,OAAO,YAAIoF,GAAK7pD,QAAQi5C,GAaVglB,CAAejsC,GAC7B,OAAOwrC,GAAiBO,EAAaljE,IC/G5BqjE,GAAsB,SAACtqB,GAChC,OAAQA,EAAMjzB,KACV,IAAK,UACL,IAAK,aACL,IAAK,YACL,IAAK,YAAL,IACY4f,EAAWqT,EAAXrT,OACR,KAAMA,aAAkB4Y,aAAc,OACtC,GAAI5Y,aAAkBmyB,iBAAkB,OAExC9e,EAAMmD,iBACN,IAAMj/C,EA1BI,SAACk6B,EAAkBrR,GACrC,OAAQA,GACJ,IAAK,aACD,OAAOg9C,GAAkB3rC,EAAS,SACtC,IAAK,YACD,OAAO2rC,GAAkB3rC,EAAS,QACtC,IAAK,UACD,OAAOgsC,GAAchsC,EAAS,MAClC,IAAK,YACD,OAAOgsC,GAAchsC,EAAS,QAGtC,OAAO,KAccmsC,CAAc59B,EAAQqT,EAAMjzB,KACzC,GAAa,OAAT7oB,EAAe,OACnBkhD,EAAWlhD,K,oBClBjB2gC,GAAY,CACd2W,IAAWgE,UACXX,IAAY2rB,KACZxnE,KAAE4gC,UACFhF,IAAK6rC,OACP3yD,KAAK,KAED4yD,GAAe,SAACrlB,EAAoBp+C,GAArB,OACjB,yBACI8lB,IAAKs4B,EAAO/6B,GACZua,UAAW,CAAC7hC,KAAEu5D,MAAiB,IAAVt1D,EAAcjE,KAAE2nE,WAAa,IAAI7yD,KAAK,KAC3D2Q,MAAO,CAAEziB,MAAO4kE,KAChBtrB,SAAU+F,EAAOrhD,MAAMiS,QAOlB40D,GAAkB,SAACpsB,GAAD,OAC3B,yBAAK5Z,UAAWA,IACZ,kBAAC,IAAD,CAAO7a,KAAM,IAGb,yBAAK6a,UAAWqa,IAAOl1B,KAAK42B,MAAM2X,MAC9B,kBAAC,IAAD,CAAM5pB,KAAMqS,IAAM8pB,MAAO9gD,KAAMk1B,IAAOl1B,KAAK42B,MAAMmqB,YAIpDtsB,EAAMyI,QACFt/C,MAAM,EAAG62C,EAAMqb,cAAWjsD,EAAY,GACtCF,IAAI+8D,IAGT,kBAAC,IAAD,CACI5pB,QAAS,kBAAMrC,EAAMsb,aAAY,SAAC/3D,GAAD,OAAQA,MACzCymB,MAAOy2B,IAAOz2B,MAAMo4B,KACpB72B,KAAMk1B,IAAOl1B,KAAK42B,MAClBG,MAtBW+Y,EAsBSrb,EAAMqb,SArBlCA,EAAW9Y,IAAMgqB,kBAAoBhqB,IAAMiqB,sBAwBvC,kBAAC,IAAD,CAAOjhD,KAAM,KAzBC,IAAC8vC,G,kDCcVoR,GAAgB,SAACzsB,GAC1B,IAAMid,EAAavZ,IAAMqZ,OAA0B,MAE3CrW,EAAmB1G,EAAnB0G,MAAOJ,EAAYtG,EAAZsG,QAH4B,EAIOomB,aAAQ,CACtDt+B,KAAM,CAAEtgC,KAAM,MAAO44C,QAAOJ,UAAS2W,cACrC0P,MAAO,kBA7BG,SAAC3sB,GACf,GAAmB,OAAfA,EAAMshB,KAAV,CACA,IAAM1c,EAA4B,CAAE/4B,GAAIm0B,EAAMshB,KAAKz1C,IACnDm0B,EAAM6E,gBAAgB,CAAE/2C,KAAM,aAAc82C,aA0B3BgoB,CAAU5sB,IACvB92C,IAAK,SAAC2jE,EAAOzQ,GAAR,OAjBG,SAACpc,EAAcoc,GAC3B,IAAMx2D,EAASw2D,EAAQ0Q,gBACvB,GAAe,OAAXlnE,EAAJ,CACA,IAAMg/C,EAAyB,CAC3B75B,KAAM,CAAEk2B,MAAOjB,EAAMsG,QAASpF,KAAM,CAAClB,EAAM0G,QAC3C/B,GAAI,CAAE1D,MAAOr7C,EAAO0gD,QAASpF,KAAM,CAACt7C,EAAO8gD,SAE/C1G,EAAM6E,gBAAgB,CAAE/2C,KAAM,UAAW82C,aAUZmoB,CAAQ/sB,EAAOoc,IACxCD,QAAS,SAACC,GAAD,OAzBG,SAACpc,EAAcoc,GAC/B,IAA6B,IAAzBA,EAAQC,aAAwB,OAAO,EAC3C,GAA8B,QAA1BD,EAAQE,cAAyB,OAAO,EAFkB,MAGnCF,EAAQhF,UAA3B9Q,EAHsD,EAGtDA,QAASI,EAH6C,EAG7CA,MACjB,OAAO1G,EAAMsG,UAAYA,GAAWtG,EAAM0G,QAAUA,EAqB1BsmB,CAAYhtB,EAAOoc,MARF,mBAIpCC,EAJoC,KAIxB4Q,EAJwB,KAIPC,EAJO,KAW3CxpB,IAAM+X,WAAU,WACZyR,EAAWC,kBACZ,CAACD,IAEJxpB,IAAM+X,WAAU,WACZwR,EAAgBhQ,KACjB,CAACgQ,IAjBuC,MAmBbvpB,IAAM6L,UAAS,GAnBF,mBAmBpC6d,EAnBoC,KAmB3BC,EAnB2B,KAqBrCC,EAAWjR,GAAc+Q,GAA0B,OAAfptB,EAAMshB,KAC1CiM,EACF,kBAAC,IAAD,CACIr9B,KAAMo9B,EAAW/qB,IAAMirB,UAAYjrB,IAAMkrB,OACzCliD,KAAMk1B,IAAOl1B,KAAK42B,MAAMmqB,WAIhC,OACI,4BACIrsB,IAAKgd,EACL72B,UAAW,CAAC7hC,KAAE4gC,UAAWuoC,IAAQC,QAAQt0D,KAAK,KAC9Cu0D,SAAU,EACVvrB,QAAS,WACL,IAAM1iB,EAAUs9B,EAAWvvD,QAC3B,GAAgB,OAAZiyB,EAAkB,MAAMvnB,MAAM,mBAClC4nC,EAAM6tB,eAAe7tB,EAAMsG,QAAS,CAACtG,EAAM0G,OAAQ/mB,IAEvDmuC,aAAc,kBAAMT,GAAW,IAC/BU,aAAc,kBAAMV,GAAW,IAC/B5qB,MAAM,qCAEN,yBACIrc,UAAW,CACP7hC,KAAEqjD,OACFyU,EAAa93D,KAAEq4D,SAAW,GAC1Bnc,IAAOz2B,MAAMo4B,KAAK0X,KAClBrZ,IAAOl1B,KAAK42B,MAAM2X,KAClB,0BACFzgD,KAAK,KACPwnC,SAAU0sB,M,qBCtFpBS,GAAc,CAAC,IAAK,IAAK,IAAK,IAAK,KAK5BC,GAAkB,SAACjuB,GAAD,OAC3B,uBAAK5Z,UAAW,CAAC7hC,KAAE4gC,WAAW9rB,KAAK,MAC/B,gBAAC,IAAD,CACI9T,OANO46B,EAMU6f,EAAMz6C,QAL/ByoE,GAAY3sB,SAASlhB,EAAK+tC,OAAO,KAMzBnsB,SAAU,SAACmO,GACPlQ,EAAM+B,SAASmO,EAAO,OAAS,UAEnC1hD,QAAS,CACL,CAAEjJ,OAAO,EAAMc,MAAO,QACtB,CAAEd,OAAO,EAAOc,MAAO,UAE3B2jB,MAAOmkD,IAAOnkD,MAAMo4B,KACpB72B,KAAM4iD,IAAO5iD,KAAK42B,SAfZ,IAAChiB,GCHb8f,GAAM,CAAEvyC,SAAS,EAAOmiB,QAAS,GAI1Bu+C,GAAkB,WAC3BpjD,OAAO68C,aAAa5nB,GAAIpwB,SACxBowB,GAAIvyC,SAAU,EACduyC,GAAIpwB,QAAU7E,OAAOiE,YAAW,WAC5BgxB,GAAIvyC,SAAU,IACf,M,oBCKD6oD,GAAO,SAACvW,GAAD,OACT,uBAAK5Z,UAAW7hC,KAAEgkD,MACd,gBAAC,IAAD,CACIj6B,IAAK0xB,EAAMz6C,MACX8oE,aAAcruB,EAAMz6C,MACpBykB,MAAOk4B,IAAMl4B,MAAMo4B,KACnB72B,KAAM22B,IAAM32B,KAAK42B,MACjBa,WAAS,EACTsrB,OAAQ,SAAC/sB,GACLvB,EAAM+B,SAASR,EAAMwY,cAAcx0D,OACnCy6C,EAAMuuB,WAAU,IAEpBC,UAAW,SAACjtB,GACU,QAAdA,EAAMjzB,KACV8/C,MAEJte,QAAS,SAACvO,GACY,UAAdA,EAAMjzB,MACV0xB,EAAM+B,SAASR,EAAMwY,cAAcx0D,OACnCy6C,EAAMuuB,WAAU,GAzBd,SAACvuB,GACf,IAAMh3C,EAAOg3C,EAAMyuB,QAAQ/gE,QAC3B,GAAa,OAAT1E,EAAe,MAAMoP,MAAM,gBAC/BpP,EAAK+9C,QAuBO2nB,CAAU1uB,SAMpB2uB,GAAY,CACdpqE,KAAEyE,KACF0kE,IAAQkB,OACR1sB,IAAM32B,KAAK42B,MAAM2X,KACjB,yBACA,yBACFzgD,KAAK,KAEDw1D,GAAY,SAAC,GAAkC,IAAhCtpE,EAA+B,EAA/BA,MACjB,OAAqB,IAAjBA,EAAMZ,OAAqB,4BAAOY,GAC/B,wBAAM6gC,UAAW7hC,KAAEuqE,OAAnB,YAGLC,GAAO,SAAC/uB,GAAD,OACT,uBACI4tB,SAAU,EACV/sB,SAAU,gBAAC,GAAD,CAAWt7C,MAAOy6C,EAAMz6C,QAClC6gC,UAAWuoC,GACXK,cAAe,WACXhvB,EAAMuuB,WAAU,IAEpBU,QAAS,WD3D4BhvB,GAAIvyC,SC4DfsyC,EAAMuuB,WAAU,IAE1Cze,QAAS,SAACvO,GACY,UAAdA,EAAMjzB,KACV0xB,EAAMuuB,WAAU,IAEpBtuB,IAAKD,EAAMyuB,WAINS,GAAiB,SAAClvB,GAAkB,IAAD,EAChB0D,YAAe,GADC,mBACrCyrB,EADqC,KAC7BZ,EAD6B,KAEtCE,EAAU/qB,SAA6B,MACvC0rB,EAAuB,6BAAQpvB,GAAR,IAAemvB,SAAQZ,YAAWE,YAE/D,OACI,uBAAKroC,UAAW,CAAC7hC,KAAE4gC,WAAW9rB,KAAK,MAC/B,gBAAC,GAAS+1D,GACTD,GAAU,gBAAC,GAASC,KC1E3BC,GAAiB,SAACrvB,GAAD,OAAkB,SAACz6C,GAAmB,IACjD+gD,EAAyBtG,EAAzBsG,QAASnF,EAAgBnB,EAAhBmB,IADuC,EAE9B,CADOnB,EAAX4G,OACYrhD,MAAMiS,KAAM2pC,EAAIt1B,IAA3CsiB,EAFiD,KAEvCuY,EAFuC,KAGxD,GAAInhD,IAAU47C,EAAI57C,MAAM4oC,GAAxB,CACA,IAAMyW,EAA4B,CAAE0B,UAASI,QAAOvY,WAAU5oC,SAC9Dy6C,EAAM6E,gBAAgB,CAAE/2C,KAAM,aAAc82C,eAsBnC0qB,GAAgB,SAACtvB,GAAD,aAZZ,SAACA,GAAqC,IAC3ClyC,EAASkyC,EAAM4G,OAAOrhD,MAAtBuI,KACR,OAAQA,GACJ,IAAK,UACD,OAAOmgE,GACX,IAAK,SACD,OAAOiB,GACX,QACI,MAAM92D,MAAM,wBAAD,OAAyBtK,EAAzB,OAKnByhE,CAASvvB,EAATuvB,CAAgB,CACZhqE,MAAK,UAAEy6C,EAAMmB,IAAI57C,MAAMy6C,EAAM4G,OAAOrhD,MAAMiS,aAArC,QAA8C,GACnDuqC,SAAUstB,GAAervB,M,qBC7B3B0B,GAAY,SAAC1B,GAAkB,IAE3B4E,EAA4B,CAAE0B,QADTtG,EAAnBsG,QACqCI,MADlB1G,EAAV0G,OAEjB1G,EAAM6E,gBAAgB,CAAE/2C,KAAM,aAAc82C,aAqBnC4qB,GAAkB,SAACxvB,GAAD,OAC3B,yBAAK5Z,UAAW,CAAC7hC,KAAE4gC,WAAW9rB,KAAK,MAC/B,kBAAC,IAAD,CACIgpC,QAAS,WAAWX,GAAU1B,IAC9Bh2B,MAAOy2B,IAAOz2B,MAAMo4B,KACpB72B,KAAMk1B,IAAOl1B,KAAK42B,MAClBG,KAAMC,IAAMktB,W,oBCdlBC,GAAc,SAAC1vB,EAAclyC,GAAf,OAAmC,SAAC84C,GACpD,IAAM+oB,EACW,SAAT7hE,EAAwBvJ,KAAEu5D,MACjB,UAAThwD,EAAyBvJ,KAAEqrE,SACxB,CAACrrE,KAAEsrE,SAAU1vC,IAAK6rC,OAAO3yD,KAAK,KAEnC9R,EAAiB,SAATuG,EAAkBskD,SAAiChjD,EACjE,OACI,yBACIg3B,UAAW,CAACgsB,GAA8Bud,GAAUt2D,KAAK,KACzD2Q,MAAO,CAAEziB,SACT+mB,IAAKs4B,EAAO/6B,IAEZ,kBAACyjD,GAAD,CACIhpB,QAAStG,EAAMsG,QACfnF,IAAKnB,EAAMmB,IACXyF,OAAQA,EACR/B,gBAAiB7E,EAAM6E,qBAyE1BirB,GAAMpsB,IAAM+Y,MAnET,SAACzc,GACKA,EAAMsG,QAAgBtG,EAAMmB,IAAIt1B,GAAIm0B,EAAMmB,IAAI57C,MAAMsmB,GADxC,IC9CD0pC,ED8CC,GC9CDA,EDiDc,CACvCjP,QAAStG,EAAMsG,QACfI,MAAO1G,EAAMmB,IAAIt1B,IClDrBkkD,aAAQ,CACJC,OAAQ,MACRC,KAAM,WAGF,MAD8B,CAAE3pB,QADLiP,EAAnBjP,QACiCI,MADd6O,EAAV7O,QAIrByV,QAAS,SAACC,GAAD,OAAaA,EAAQ8T,aDsCJ,mBAGvBA,EAHuB,KAGfC,EAHe,KAQ9B,OACI,yBACI/pC,UAAS,UAAK7hC,KAAE4gC,UAAP,YAAoB+qC,EAAS3rE,KAAE6rE,KAAO,IAC/CnwB,IAAKkwB,EACLnmD,MAAO,CAAExiB,OAAQ6qD,GAAarS,EAAMsS,mBACpCkc,UAAW,SAACjtB,ID9CU,SAACvB,GAAD,OAAkB,SAChDuB,GACQ,IACAjzB,EAAgBizB,EAAhBjzB,IAAK4f,EAAWqT,EAAXrT,OACb,OAAQ5f,GACJ,IAAK,YACL,IAAK,SACD,GAAI4f,aAAkBmyB,iBAAkB,OACxC,KAAMnyB,aAAkBm9B,SAAU,OAClC9pB,EAAMI,kBAEN,IAAMl8C,EAAOkmE,GAAcz9B,EAAQ,QAEnC,GADAwT,GAAU1B,GACG,OAATv6C,EAAe,OACnBulB,OAAOiE,YAAW,WAAW03B,EAAWlhD,KAAO,KCiC3C4qE,CAAmB,CACf/pB,QAAStG,EAAMsG,QACfI,MAAO1G,EAAMmB,IAAIt1B,GACjBg5B,gBAAiB7E,EAAM6E,iBAH3BwrB,CAIG9uB,KAGP,kBAAC,IAAD,CAAOh2B,KAAM,IAGZy0B,EAAMswB,aACH,yBAAKlqC,UAAWgsB,IACZ,kBAAC,GAAD,CACI9L,QAAStG,EAAMsG,QACfI,MAAO1G,EAAMmB,IAAIt1B,GACjBg5B,gBAAiB7E,EAAM6E,mBAOnC,yBACIze,UAAW7hC,KAAEgsE,OACbvmD,MAAO,CAAEziB,M7EvFOqsD,M6EyFf8b,GAAY1vB,EAAO,QAAnB0vB,CAA4B1vB,EAAMyI,QAAQ,IAC1CinB,GAAY1vB,EAAO,SAAnB0vB,CAA6B1vB,EAAMyI,QAAQ,KAI/CzI,EAAMwwB,sBACH,yBAAKpqC,UAAW7hC,KAAEgsE,QACbvwB,EAAMyI,QAAQt/C,MAAM,GAAG+F,IAAIwgE,GAAY1vB,EAAO,UAKtDA,EAAMswB,aACH,kBAAC,GAAD,CACIhqB,QAAStG,EAAMsG,QACfI,MAAO1G,EAAMmB,IAAIt1B,GACjBg5B,gBAAiB7E,EAAM6E,gBACvByc,KAAMthB,EAAMywB,aACZ5C,eAAgB7tB,EAAM6tB,iBAI9B,kBAAC,IAAD,CAAOtiD,KAAM,QE9FnBmlD,GAAO,SAAC1wB,GACV,GAAKr8C,MAAMwI,QAAQ6zC,EAAM5R,MAMrB,OAAiC,IAA7B4R,EAAMiB,MAAMkR,aACLnS,EAAM2wB,cAAc3wB,EAAM5R,MAG7B,gBAAC,WAAD,KACK4R,EAAM5R,KAAKl/B,KAAI,SAACiyC,GAAS,IAAD,EACfsoB,EAAK,UAAGzpB,EAAM4wB,mBAAT,aAAG,EAAmBjnE,IAAIw3C,EAAIt1B,IACzC,OAAOm0B,EAAM6wB,OAAO1vB,EAAKsoB,OAbZ,IAAD,EAEtBtoB,EAAMnB,EAAM5R,KAClB,OAAO4R,EAAM6wB,OAAO1vB,EAAb,UAAkBnB,EAAM4wB,mBAAxB,aAAkB,EAAmBjnE,IAAIw3C,EAAIt1B,MAkB/CilD,GAAoB,SAAC9wB,GAAkB,IACxCkB,EAASlB,EAAMiB,MAAM17C,MAArB27C,KACFwH,ECxCoB,SAC1BxH,EACA6vB,GAEA,IAAMH,EAAW,OAAGG,QAAH,IAAGA,IAAkB,IAAIloB,IAEtCmoB,EhFXsB,GgFWOJ,EAAYrlD,KAEvCm9B,EAAyB,GAC3BuoB,EAAuB,GAc3B,OAZA/vB,EAAKpyC,SAAQ,SAACqyC,GACN6vB,EAAY,GAAKJ,EAAY3iD,IAAIkzB,EAAIt1B,KACZ,IAArBolD,EAAUtsE,QAAc+jD,EAAM1hD,KAAKiqE,GACvCA,EAAY,GACZvoB,EAAM1hD,KAAKm6C,GACX6vB,GAAwB,GAExBC,EAAUjqE,KAAKm6C,MAGE,IAArB8vB,EAAUtsE,QAAc+jD,EAAM1hD,KAAKiqE,GAEhCvoB,EDiBOwoB,CAAehwB,EAAMlB,EAAM4wB,aACzC,OACI,gCACKloB,EAAMx5C,KAAI,SAACk/B,GAAD,OACP,gBAAC,GAAD,iBACQ4R,EADR,CAEI1xB,IAAK3qB,MAAMwI,QAAQiiC,GAAQA,EAAK,GAAGviB,GAAKuiB,EAAKviB,GAC7C+kD,YAAa5wB,EAAM4wB,YACnBxiC,KAAMA,QAGb4R,EAAMiB,MAAMkR,cACTzJ,EAAM/jD,SAAWu8C,EAAKv8C,QACtBq7C,EAAMmxB,sBEjDTC,GAAkB,SAACpxB,GAAD,OAC3B,gBAAC,IAAD,CAAYzmC,MAAM,aACd,gBAAC,IAAD,CAAQA,MAAM,SACd,uBAAKyQ,MAAO,CAAE2O,WAAY,KAC1B,gBAAC,IAAD,CACI3O,MAAOy2B,IAAOz2B,MAAMo4B,KACpB72B,KAAMk1B,IAAOl1B,KAAK42B,MAClBwoB,aAAW,EACXtoB,QAAS,WACLrC,EAAM6E,gBAAgB,CAClB/2C,KAAM,wBACN82C,QAAS,CAAE/4B,GAAIm0B,EAAMsG,QAAS+U,UAAU,MAGhDxa,SAAQ,UAAKb,EAAM1xC,MAAX,qBAEZ,uBAAK0b,MAAO,CAAE2O,WAAY,KAC1B,gBAAC,IAAD,CAAQpf,MAAM,WAST83D,GAAsB,SAACrxB,GAAD,OAC/B,gBAAC,IAAD,CACIh2B,MAAOy2B,IAAOz2B,MAAMo4B,KACpB72B,KAAMk1B,IAAOl1B,KAAK42B,MAClBwoB,aAAW,EACXtoB,QAAS,WACLrC,EAAM6E,gBAAgB,CAClB/2C,KAAM,wBACN82C,QAAS,CAAE/4B,GAAIm0B,EAAMsG,QAAS+U,UAAU,MAGhDxa,SAAS,kBCdXywB,GAAe,SAACtxB,GAAD,mBACjB,uBACI5Z,UlFxBuB,YkFyBvBva,GAAI46B,EAAgBzG,EAAMiB,MAAMp1B,GAAIm0B,EAAMmB,IAAIt1B,KAE9C,gBAAC,GAAD,CAEIs1B,IAAKnB,EAAMmB,IACXsvB,aAAY,oBAAEzwB,EAAMuxB,gBAAR,aAAE,EAAgBxmD,YAAlB,QAA0B,KACtCunC,iBAAgB,oBAAEtS,EAAMuxB,gBAAR,aAAE,EAAgB5sB,GAAGp5B,YAArB,QAA6B,EAE7C+6B,QAAStG,EAAMiB,MAAMp1B,GACrBykD,YAAatwB,EAAMmvB,OACnBqB,qBAAsBxwB,EAAMwxB,gBAE5B/oB,QAASzI,EAAMyI,QACf5D,gBAAiB7E,EAAM6E,gBACvBgpB,eAAgB7tB,EAAM6tB,mBAKrB4D,GAAgB,SAACzxB,GAAD,OACzB,gBAAC,GAAD,CAEIiB,MAAOjB,EAAMiB,MACb2vB,YAAa5wB,EAAM4wB,YAEnBO,kBAAmB,kBACf,gBAAC,GAAD,CACI7qB,QAAStG,EAAMiB,MAAMp1B,GACrBg5B,gBAAiB7E,EAAM6E,mBAG/B8rB,cAAe,SAACviC,GAAD,OACX,gBAAC,GAAD,CACI9/B,MAAO8/B,EAAKzpC,OACZ2hD,QAAStG,EAAMiB,MAAMp1B,GACrBg5B,gBAAiB7E,EAAM6E,mBAG/BgsB,OAAQ,SAAC1vB,EAAKowB,GAAN,OACJ,gBAAC,GAAD,iBAAkBvxB,EAAlB,CAAyBmB,IAAKA,EAAKowB,SAAUA,SCpC5CG,GAAiB,SAAC1xB,GAC3B,OAAO,SAACuB,GACJ,OAAQA,EAAMjzB,KACV,IAAK,OA9BF,SAAC0xB,EAAcuB,GAC1B,IAAMrT,EAASqT,EAAMrT,OACrB,GAAMA,aAAkBmyB,iBAAxB,CAGA,IAAMzZ,EAAS1Y,EAAOvmB,QAAQqqC,IAC9B,GAAe,OAAXpL,EAAiB,MAAMxuC,MAAM,kBACjC,GAAkC,OAA9BwuC,EAAOkkB,mBAAX,CAEA,IAAM3pB,EAAMjT,EAAOvmB,QAAQmqC,IAC3B,GAAY,OAAR3Q,EAAc,MAAM/oC,MAAM,eAC9B,GAA+B,OAA3B+oC,EAAI2pB,mBAAR,CAEA,IAAMlmB,EAAyB,CAAE0B,QAAStG,EAAMsG,SAChDtG,EAAM6E,gBAAgB,CAAE/2C,KAAM,UAAW82C,YAIzC55B,OAAOiE,YAAW,WACd,IAAM0iD,EAAUxwB,EAAI2pB,mBACpB,GAAgB,OAAZ6G,EAAkB,MAAMv5D,MAAM,mBAClC,IAAMw5D,EAAazG,GAAiBwG,EAAS,GAC7CvD,KACAznB,EAAWirB,KACZ,MAOSrT,CAAOve,EAAOuB,MCjBxB0tB,GAAU,SAACjvB,GAAD,OAAkB,SAACuB,GAC/B,IAAM4oB,EAAU5oB,EAAMswB,cAClBtwB,EAAMwY,cAAc38B,SAAS+sC,IAC7B5oB,EAAMrT,kBAAkB4jC,mBAC5B9xB,EAAMuuB,WAAU,KAGPwD,GAAY,SAAC/xB,GAAkB,IAAD,EACP0D,IAAM6L,UAAS,GADR,mBAChC8L,EADgC,KACtBC,EADsB,KAOvC,OAJA5X,IAAM+X,WAAU,WACPzb,EAAMmvB,QAAQ7T,GAAY,KAChC,CAACtb,EAAMmvB,SAGN,yBAAK/oC,UAAW7hC,KAAE4gC,UAAW8pC,QAASA,GAAQjvB,IAC1C,kBAAC,IAAD,CAAOz0B,KAAM,IAGZy0B,EAAMmvB,QACH,yBAAK/oC,UAAW7hC,KAAEytE,QACd,kBAAC,GAAD,CACIvpB,QAASzI,EAAMyI,QACf4S,SAAUA,EACVC,YAAaA,KAMzB,yBACIkT,UAAW,SAACjtB,GACRsqB,GAAoBtqB,GACpBmwB,GAAe,CACX7sB,gBAAiB7E,EAAM6E,gBACvByB,QAAStG,EAAMiB,MAAMp1B,IAFzB6lD,CAGGnwB,KAGP,kBAAC,GAAD,CAEIN,MAAOjB,EAAMiB,MACb2vB,YAAa5wB,EAAM4wB,YACnBzB,OAAQnvB,EAAMmvB,OACdqC,gBAAiBnW,EAEjB5S,QAASzI,EAAMyI,QACf5D,gBAAiB7E,EAAM6E,gBACvBgpB,eAAgB7tB,EAAM6tB,mBAK5B7tB,EAAMmvB,QAA4C,IAAlCnvB,EAAMiB,MAAM17C,MAAM27C,KAAKv8C,SACrC,kBAAC,GAAD,CACI2hD,QAAStG,EAAMiB,MAAMp1B,GACrBg5B,gBAAiB7E,EAAM6E,kBAI/B,kBAAC,IAAD,CAAOt5B,KAAM,M,yCC9DZ0mD,GAAa,SAACjyB,GAGvB,IAAMpf,EAAS8iB,IAAMqZ,OAAO,CAAE71D,EAAG,EAAGhB,EAAG,IAHC,EAQZw9C,IAAM6L,UAAS,GARH,mBAQjC4f,EARiC,KAQzBZ,EARyB,KASxC,OACI,yBACInoC,UAAW7hC,KAAE4gC,UACbnb,MAAO,CACHziB,MAAOqsD,MAGVub,EACG,kBAAC,IAAD,CACI7gD,IAAK0xB,EAAMiB,MAAM17C,MAAMiS,KACvB62D,aAAcruB,EAAMiB,MAAM17C,MAAMiS,KAChC82D,OAAQ,SAAC/sB,IA3BL,SAACvB,EAAcuB,GAAuB,IAClDh8C,EAAUg8C,EAAMwY,cAAhBx0D,MACR,GAAIA,IAAUy6C,EAAMiB,MAAM17C,MAAMiS,KAAhC,CACA,IAAMotC,EAAkC,CAAE/4B,GAAIm0B,EAAMiB,MAAMp1B,GAAIrU,KAAMjS,GACpEy6C,EAAM6E,gBAAgB,CAAE/2C,KAAM,oBAAqB82C,aAwB/B2a,CAAgBvf,EAAOuB,GACvBgtB,GAAU,IAEdU,QAAS,WACLjvB,EAAMuuB,WAAU,IAEpBvkD,MAAOk4B,IAAMl4B,MAAMo4B,KACnB72B,KAAM22B,IAAM32B,KAAK42B,MACjBa,WAAS,IAGb,yBACI5c,UAAW,CAAC7hC,KAAEyE,KAAMk5C,IAAM32B,KAAK42B,MAAM2X,MAAMzgD,KAAK,KAChD64D,YAAa,SAAC3wB,GACV3gB,EAAOlzB,QAAQxG,EAAIq6C,EAAM4wB,QACzBvxC,EAAOlzB,QAAQxH,EAAIq7C,EAAM6wB,SAE7B/vB,QAAS,SAACd,GAAW,IAAD,EACS3gB,EAAOlzB,QAArBuuC,EADK,EACR/0C,EAAUi1C,EADF,EACDj2C,EACEq3D,EAAoBhc,EAA7B4wB,QAAsB3U,EAAOjc,EAAhB6wB,QAEjBn2B,IAAOshB,GAAMphB,IAAOqhB,GAAI+Q,GAAU,KAGzCvuB,EAAMiB,MAAM17C,MAAMiS,Q,qBC7CjC66D,GAAmC,CACrCvkE,KAAM,OACNi8C,MAAO,OACPvkC,OAAQ,QAGN8sD,GAAI,yCAAG,WAAOtyB,GAAP,kBAAAzyC,EAAA,6DACHs8C,EADG,6BAEFiN,IAFE,IAGLrO,QAASzI,EAAMyI,QACf9F,OAAQ,CAAC3C,EAAMiB,SAEb9gB,EAAOypB,GAAcC,EAASwoB,IAAe9sE,MAN1C,SAOH0mD,GAAgB9rB,GAPb,uBAQH2kB,YAAU,CACZ,oCACA,oCAVK,2CAAH,sDAmBGytB,GAAkB,SAACvyB,GAAD,OAC3B,yBAAK5Z,UAAW,CAAC7hC,KAAE4gC,UAAW4X,IAAWuD,SAASjnC,KAAK,MACnD,kBAAC,IAAD,CACIqvC,MAAO,CACH,CAAEriD,MAAO,oBAAqBk/C,GAAI,kBAAM+sB,GAAKtyB,KAC7C,CAAE35C,MAAO,kBAAmBk/C,GAAI,kBAV9B,SAACvF,GACf,IAAM4E,EAAiC,CAAE/4B,GAAIm0B,EAAMiB,MAAMp1B,IACzDm0B,EAAM6E,gBAAgB,CAAE/2C,KAAM,kBAAmB82C,YAQC4tB,CAAUxyB,KAChD,UACA,CAAE35C,MAAO,eAAgBk/C,GAAI,kBArC9B,SAACvF,GACZ,IAAM4E,EAA8B,CAAE/4B,GAAIm0B,EAAMiB,MAAMp1B,IACtDm0B,EAAM6E,gBAAgB,CAAE/2C,KAAM,eAAgB82C,YAmCC6qB,CAAOzvB,MAE9C4H,OAAQ,CACJ59B,MAAOy2B,IAAOz2B,MAAMo4B,KACpB72B,KAAMk1B,IAAOl1B,KAAK42B,MAClBG,KAAMC,IAAMkwB,UC9CfC,GAA+B,SAAC1yB,GAAD,OACxC,yBAAK5Z,UAAS,UAAK7hC,KAAE4gC,UAAP,YAAoB6a,EAAMmvB,OAAS5qE,KAAEgkD,KAAO,KACtD,yBAAKniB,UAAW7hC,KAAEu1D,MACd,kBAAC,GAAD,CACI7Y,MAAOjB,EAAMiB,MACbstB,UAAWvuB,EAAMuuB,UACjB1pB,gBAAiB7E,EAAM6E,kBAE3B,yBAAKze,UAAW7hC,KAAEi/C,MACd,kBAAC,GAAD,CACIvC,MAAOjB,EAAMiB,MACbwH,QAASzI,EAAMyI,QACf5D,gBAAiB7E,EAAM6E,sBC1B9B8tB,GAAc,SACvBC,EACArE,GAEA,IAAIqE,EACJ,OAAO,SAACrxB,GACJ,IAAMrT,EAASqT,EAAMswB,cAErB,IAAItwB,EAAMwY,cAAc38B,SAAS8Q,GAAjC,CAEA,IAAM2kC,EAAajqD,SAAS06B,eAAe,qBACxB,OAAfuvB,GAAuBA,EAAWz1C,SAAS8Q,IAE/CqgC,GAAU,M,oBCcZuE,GAAS,SAAC9yB,EAAcmvB,GAC1B,IAAMve,EAAM,CACRrsD,KAAE4gC,UACF4X,IAAWuD,QACXF,IAAYC,OACZhiB,IAAUgiB,QAId,OAFIL,EAAM0oB,YAAY9X,EAAI5pD,KAAKzC,KAAE2qD,UAC7BigB,GAAQve,EAAI5pD,KAAKzC,KAAEgkD,MAChBqI,EAAIv3C,KAAK,MAWd05D,GAAW,SAAC5I,GAAD,MAA6C,CAC1Dr8D,KAAM,MACNvI,MAAO4kE,EAAQ,GAAGt+C,KAGhBojD,GAAU,SAACjvB,GAAD,OAAkB,WAC9BA,EAAM0H,cAAa,SAAC95C,GAAU,IAAD,IAEnBnI,GADO,oBAAGu6C,EAAMgzB,sBAAT,aAAG,EAAsB9I,qBAAzB,QAA0C,IACfh7D,IAAI6jE,IAE5C,OADAttE,EAAKuB,KAAK,CAAE8G,KAAM,QAASvI,MAAOy6C,EAAMiB,MAAMp1B,KvB9BvB,SAACte,EAAehK,GAC3C,GAAIgK,EAAE5I,SAAWpB,EAAEoB,OAAQ,OAAO,EADoC,MAE7C8lE,GAAcl9D,GAA/Bo1C,EAF8D,EAE9DA,OAAQgG,EAFsD,EAEtDA,KAChB,OAAOplD,EAAE0vE,OAAM,SAACpnD,GACZ,QAAgB,UAAZA,EAAG/d,OAAoB60C,EAAO10B,IAAIpC,EAAGtmB,WACzB,QAAZsmB,EAAG/d,OAAkB66C,EAAK16B,IAAIpC,EAAGtmB,WuB0B9B4oE,CAAuBvgE,EAAMnI,GAAQmI,EAAOnI,OA0C9CytE,GAAYxvB,IAAM+Y,MAtCQ,SAACzc,GAAW,IAAD,EACxBA,EAAMiB,MAAMp1B,GAAIm0B,EAAMiB,MAAM17C,MAAMsmB,GADV,MAElB63B,IAAM6L,UAAS,GAFG,mBAEvC4f,EAFuC,KAE/BZ,EAF+B,KAGxCqE,EAAyB/V,aAzBnB,SAAC7c,GAAD,OAAkB,SAACoc,GAC/B,IAAMhuB,EAAOguB,EAAQhF,UACrB,OAAa,OAAThpB,IACc,QAAdA,EAAKtgC,MACOsgC,EACDkY,UAAYtG,EAAMiB,MAAMp1B,KAoBKsnD,CAAQnzB,IACpD,OACI,yBACI5Z,UAAW0sC,GAAO9yB,EAAOmvB,GACzBb,OAAQqE,GAAYC,EAAerE,GACnCX,SAAU,EACVqB,QAASA,GAAQjvB,IAEjB,kBAAC,GAAD,CAEIiB,MAAOjB,EAAMiB,MACbkuB,OAAQA,EACRZ,UAAWA,EAEX9lB,QAASzI,EAAMyI,QACf5D,gBAAiB7E,EAAM6E,kBAE3B,kBAAC,IAAD,CAAQtrC,MAAM,SACd,yBAAKyQ,MAAO,CAAE2O,WAAY,KAC1B,kBAAC,GAAD,CAEIsoB,MAAOjB,EAAMiB,MACb2vB,YAAW,UAAE5wB,EAAMgzB,sBAAR,aAAE,EAAsBpC,YAEnCzB,OAAQA,EACRZ,UAAWA,EAEX1pB,gBAAiB7E,EAAM6E,gBACvB4D,QAASzI,EAAMyI,QACfolB,eAAgB7tB,EAAM6tB,qBCnEzBuF,GAAc,SAACpzB,GAAkB,IAAD,IAEnCqzB,EAAU3vB,IAAMqZ,OAAuB,MACrC9b,EAA2BjB,EAA3BiB,MAAO4D,EAAoB7E,EAApB6E,gBACTqlB,EAAa,oBAAGlqB,EAAMgzB,sBAAT,aAAG,EAAsB9I,qBAAzB,QAA0C,GAC7D,OACI,kBAAC,KAAD,CACIv5C,SAAU,CAAEzpB,EAAG,EAAGhB,EAAG,GACrBotE,OAAQtJ,GAAgB,CAAE/oB,QAAOipB,kBACjCqJ,OAAQhJ,GAAgB,CAAEtpB,QAAO4D,oBACjC2uB,QAASH,EACTz7B,MAAOoI,EAAMuQ,KACb4J,OAAO,kDAEP,yBAAKla,IAAKozB,EAASjtC,UAAW7hC,KAAE4gC,WAC5B,kBAAC+tC,GAAD,CACIjyB,MAAOjB,EAAMiB,MACb+xB,eAAgBhzB,EAAMgzB,eAEtBtK,WAAY1oB,EAAM0oB,WAClBhhB,aAAc1H,EAAMyzB,YAEpBhrB,QAASzI,EAAMyI,QACf5D,gBAAiB7E,EAAM6E,gBACvBgpB,eAAgB7tB,EAAM6tB,oB,UCzCpCjd,GAAM,C,QAACrsD,EAAE4gC,UAAW4X,IAAWuD,QAASF,IAAYC,QAAQhnC,KAAK,KAE1Dq6D,GAAa,SAAC1zB,GAAD,OACtB,uBAAK5Z,UAAWwqB,GAAK5mC,MAAOioC,GAAsBjS,EAAMiB,UCUtD0yB,GAAQ,SAAC3zB,GAAD,aACV,uBACIh2B,MAAO,CACH2lC,KAAsB,IAAhB3P,EAAMx3C,MAAc,UAAY,WACtCwwB,SAAU,SACV46C,aAAc,WACdC,WAAY,SACZ/5C,UAA2B,IAAhBkmB,EAAMx3C,MAAc,aAAU4G,GAE7Cg3B,UAA2B,IAAhB4Z,EAAMx3C,MAAc23B,IAAK6rC,MAAQ,IARhD,UAUKhsB,EAAMmB,IAAI57C,MAAMy6C,EAAMyI,QAAQzI,EAAMx3C,OAAOjD,MAAMiS,aAVtD,QAU+D,YAI7Ds8D,GAAc,SAAC9zB,GAA0C,IAAD,IAE1D,MAAO,CAAE91B,QAAS,OAAQ6pD,WAAY,SAAU38B,QAAS,SAAU5vC,OADpD6qD,GAAY,oBAACrS,EAAMuxB,gBAAP,aAAC,EAAgB5sB,GAAGp5B,YAApB,QAA4B,KAIrDukD,GAAM,SAAC9vB,GAAD,OACR,uBACIh2B,MAAO8pD,GAAY9zB,GACnBn0B,GAAI46B,EAAgBzG,EAAMiB,MAAMp1B,GAAIm0B,EAAMmB,IAAIt1B,KAE9C,gBAAC,GAAD,iBAAWm0B,EAAX,CAAkBx3C,MAAO,KACzB,uBAAKwhB,MAAO,CAAEziB,MAAO,KACrB,gBAAC,GAAD,iBAAWy4C,EAAX,CAAkBx3C,MAAO,OAI3BwrE,GAAuD,CACzD5tC,UAAW,CAAC2W,IAAWuD,QAASF,IAAYC,QAAQhnC,KAAK,KACzD2Q,MAAO,CACH6K,WAAY,OACZo/C,YAAa,QACbC,YAAa,EACb3sE,MAAOqsD,IACPzc,QAAS,IAIXg9B,GAAmC,CACrC/8B,QAAS,EACTta,WAAY,IACZhD,UAAW,UAGTs6C,GAAa,SAACp0B,GAAD,OACf,uBAAKh2B,MAAO,CAAE8P,UAAW,WAAakmB,EAAM1xC,MAA5C,oBAGS+lE,GAAgB,SAACr0B,GAAD,OACzB,sBAASg0B,GACL,uBAAKhqD,MAAOmqD,IAAcn0B,EAAMiB,MAAM17C,MAAMiS,MAC5C,gBAAC,IAAD,CAAQ+B,MAAM,SACd,uBAAKyQ,MAAO,CAAE2O,WAAY,KAC1B,uBAAK3O,MAAO,CAAEotB,QAAS,UACnB,gBAAC,GAAD,CACI6J,MAAOjB,EAAMiB,MACb2vB,YAAa5wB,EAAM4wB,YACnBC,OAAQ,SAAC1vB,EAAKowB,GAAN,OACJ,gBAAC,GAAD,iBAASvxB,EAAT,CAAgBmB,IAAKA,EAAKowB,SAAUA,MAExCZ,cAAe,SAACviC,GAAD,OAAU,gBAAC,GAAD,CAAY9/B,MAAO8/B,EAAKzpC,UACjDwsE,kBAAmB,kBAAM,WCqB5BmD,GAAQ5wB,IAAM+Y,MApCT,SAACzc,GACf,IAAMC,EAAMyD,IAAMqZ,OAAuB,MADT,EAEIrZ,IAAM6L,UAAS,GAFnB,mBAEzBzwB,EAFyB,KAEdy1C,EAFc,KAehC,OAXA7wB,IAAM+X,WAAU,WACZ,IAjDJ+Y,EAiDUC,GAjDVD,EAiDsCD,EAhDrC,SAACG,GACFA,EAAQ5lE,SAAQ,SAAC83B,GACb4tC,EAAa5tC,EAAM+tC,qBA+CbC,EAAW,IAAIC,qBAAqBJ,EAAU,CAChDK,UAAW,EACXzvC,KAAM2a,EAAMkd,YAAYxvD,UAE5B,GAAoB,OAAhBuyC,EAAIvyC,QAAkB,MAAM0K,MAAM,eAEtC,OADAw8D,EAASzN,QAAQlnB,EAAIvyC,SACd,kBAAMknE,EAASlN,gBACvB,CAAC1nB,EAAMkd,cAGN,yBACIrxC,GAAIw6B,EAAkBrG,EAAMiB,MAAMp1B,IAClC7B,MAAO,CACH2G,SAAU,WACVrpB,IAAK04C,EAAMiB,MAAMtwB,SAASrpB,IAC1BD,KAAM24C,EAAMiB,MAAMtwB,SAAStpB,KAE3B80B,OAAQ6jB,EAAM0oB,WAAa,EAAI,GAEnCzoB,IAAKA,EAEL80B,YAAW/0B,EAAMiB,MAAM17C,MAAMiS,KAE7Bw9D,kBAAiBl2C,GAxDP,SAACkhB,EAAclhB,GAAwB,IAAD,EACxD,OAAIkhB,EAAMi1B,UAEF,kBAAC,GAAD,CACIh0B,MAAOjB,EAAMiB,MACbwH,QAASzI,EAAMyI,QACfmoB,YAAW,UAAE5wB,EAAMgzB,sBAAR,aAAE,EAAsBpC,cAG1C9xC,EAED,kBAAC,GAAD,CACImiB,MAAOjB,EAAMiB,MACb+xB,eAAgBhzB,EAAMgzB,eAEtBvqB,QAASzI,EAAMyI,QACf5D,gBAAiB7E,EAAM6E,gBACvBgpB,eAAgB7tB,EAAM6tB,eAEtBnF,WAAY1oB,EAAM0oB,WAClB+K,YAAazzB,EAAMyzB,YAEnBljB,KAAMvQ,EAAMuQ,OAbG,kBAAC,GAAD,CAAYtP,MAAOjB,EAAMiB,QAiDvCi0B,CAAcl1B,EAAOlhB,OCtGrBq2C,GAAa,SACtBC,EACA7zB,GAEA,IAAMt4C,EAAQmsE,EAAS1nE,QACvB,GAAc,OAAVzE,EAAgB,MAAMmP,MAAM,iBAChC,IAAM1K,EAAU,CACZrG,KAAMk6C,EAAMK,YAAYpnB,QACxBlzB,IAAKi6C,EAAMK,YAAYnnB,SAErBnzB,EAAMqF,KAAK+I,IAAIzM,EAAM3B,IAAKoG,EAAQpG,KAClC2tD,EAAQtoD,KAAK8N,IAAIxR,EAAM5B,KAAMqG,EAAQrG,MACrC6tD,EAASvoD,KAAK8N,IAAIxR,EAAM3B,IAAKoG,EAAQpG,KACrCD,EAAOsF,KAAK+I,IAAIzM,EAAM5B,KAAMqG,EAAQrG,MAE1C,MAAO,CAAEC,MAAKD,OAAME,MADK0tD,EAAQ5tD,EACNG,OADY0tD,EAAS5tD,IAIvC+tE,GAAa,SAAC11C,EAAyBrD,GAChDqD,EAAQ3V,MAAMsS,QAAUA,GAGtBg5C,GAAsB,CAAEhuE,IAAK,EAAGD,KAAM,EAAGE,MAAO,EAAGC,OAAQ,GAEpD+tE,GAAU,SAAC51C,EAAyBma,GAC7Cna,EAAQ3V,MAAMziB,MAAd,UAAyBuyC,EAAIvyC,MAA7B,MACAo4B,EAAQ3V,MAAMxiB,OAAd,UAA0BsyC,EAAItyC,OAA9B,MACAm4B,EAAQ3V,MAAMgR,UAAd,oBAAuC8e,EAAIzyC,KAA3C,eAAsDyyC,EAAIxyC,IAA1D,QAGSkuE,GAAmB,SAC5BC,EACA37B,GACQ,IACSna,EAAY81C,EAArB/nE,QACR,GAAgB,OAAZiyB,EAAkB,MAAMvnB,MAAM,kBACtB,UAAR0hC,GACAy7B,GAAQ51C,EAAS21C,IACjBD,GAAW11C,EAAS,MACL,SAARma,EACPu7B,GAAW11C,EAAS,KAEpB41C,GAAQ51C,EAASma,I,oBC3BZ47B,GAAiB,SAAC11B,GAK3B,GAAwC,SAApCA,EAAMrgB,QAAQ2zB,QAAQx0B,UAAsB,OAAO,EADrD,IAfgBvxB,EAAchK,EAe9B,EAGmDy8C,EAAMrgB,QAAtCp4B,EAHnB,EAGM43C,YAAkC33C,EAHxC,EAG0B83C,aAH1B,EAIoBU,EAAMrvB,SACtBjjB,EAAqB,CAAEnG,QAAOC,SAAQF,IAL1C,EAIMA,IACyCD,KAL/C,EAIWA,MAGb,OAtBkBkG,EAsBEyyC,EAAM9R,OAtBM3qC,EAsBEmK,IApB9BH,EAAElG,KAAO9D,EAAE8D,KAAO9D,EAAEgE,UACpBhE,EAAE8D,KAAOkG,EAAElG,KAAOkG,EAAEhG,UAEpBgG,EAAEjG,IAAM/D,EAAE+D,IAAM/D,EAAEiE,WAClBjE,EAAE+D,IAAMiG,EAAEjG,IAAMiG,EAAE/F,SA2CpBmuE,GAAS,SAAC9xB,EAAe/1C,GAAhB,OACX+1C,EAAI30C,KAAI,SAAC3J,GAAD,MAAY,CAAEuI,OAAMvI,aAEnBqwE,GAAgB,SAAC51B,EAAclG,GACxC,IAAM6I,EAxBe,SAAC3C,EAAc9R,GACpC,OAAO8R,EAAM6J,QAAQlH,OAChBxpC,QAAO,SAAC8nC,GAAD,OACJy0B,GAAe,CACXxnC,SACAvd,SAAUswB,EAAMtwB,SAChBgP,QAAS4mB,EAAgBtF,EAAMp1B,SAGtC3c,KAAI,SAAC+xC,GAAD,OAAWA,EAAMp1B,MAeXgqD,CAAiB71B,EAAOlG,GACjC6O,EAba,SAAC3I,EAAc2C,GAClC,IAAMuE,EAAM,IAAIC,IAAIxE,GAIpB,OAAO3C,EAAM6J,QAAQlB,KAAKxvC,QAHR,SAAC8mC,GACf,OAAOiH,EAAIj5B,IAAIgyB,EAAIl1B,KAAKk2B,QAAUiG,EAAIj5B,IAAIgyB,EAAI0E,GAAG1D,UAET/xC,KAAI,SAAC+wC,GAAD,OAASA,EAAIp0B,MAQhDiqD,CAAe91B,EAAO2C,GACnC,MAAM,GAAN,mBAAWgzB,GAAOhzB,EAAQ,UAA1B,YAAuCgzB,GAAOhtB,EAAM,UCrDlDotB,GAAW,SAACp2C,EAAkBq2C,GAC5BA,EACAr2C,EAAQurC,UAAUzjE,IAJO,iBAMzBk4B,EAAQurC,UAAUuE,OANO,kBAUpBwG,GAAgB,SAAC/nC,EAAmB2b,GAC7C,IAAMqF,EAAW,IAAI/H,IACrB0C,EAAQlH,OAAO7zC,SAAQ,SAACmyC,GACpB,IAAMthB,EAAU4mB,EAAgBtF,EAAMp1B,IAC9B8E,EAAaswB,EAAbtwB,SACFqlD,EAAYN,GAAe,CAAExnC,SAAQvO,UAAShP,aAChDqlD,GAAW9mB,EAASznD,IAAIw5C,EAAMp1B,IAClCkqD,GAASp2C,EAASq2C,MAEtBnsB,EAAQlB,KAAK75C,SAAQ,SAACmxC,GAClB,IAAM+1B,EACF9mB,EAASjhC,IAAIgyB,EAAIl1B,KAAKk2B,QAAUiO,EAASjhC,IAAIgyB,EAAI0E,GAAG1D,OAClDthB,ErC1BgB,SAAC8jC,GAC3B,IAAM9jC,EAAU/W,SAAS06B,eAAe0kB,GAAiBvE,IACzD,GAAI9jC,aAAmBu2C,YAAa,OAAOv2C,EAC3C,MAAMvnB,MAAM,8BqCuBQ+9D,CAAel2B,EAAIp0B,IACnCkqD,GAASp2C,EAASq2C,OCFpBI,GAAqB,SAACn2B,EAAmBoc,GAA+B,IACzD18B,EAAYsgB,EAArBvyC,QACR,GAAgB,OAAZiyB,EAAkB,MAAMvnB,MAAM,wBAElCunB,EAAQ3V,MAAMmS,OAASkgC,EAAa,IAAM,KAIxCga,GAAuB,GA8DhBC,GAAkB5yB,IAAM+Y,MA5DT,SAACzc,GAEzB,IAAM/2C,EAAQy6C,IAAMqZ,OAA8B,MAC5CwZ,EAAgB7yB,IAAMqZ,QAAO,GAC7B0Y,EAAS/xB,IAAMqZ,OAAuB,MACtCyZ,EAAe9yB,IAAMqZ,OAAuB,MAC5C0Z,EAAe/yB,IAAMqZ,QAAgB,GAC3C,OACI,yBACI32B,UAAW7hC,KAAE4gC,UACbyoC,SAAU,EACVY,UAAW,SAACjtB,GACU,MAAdA,EAAMjzB,MAAamoD,EAAa/oE,SAAU,IAElDoiD,QAAS,SAACvO,GACY,MAAdA,EAAMjzB,MAAamoD,EAAa/oE,SAAU,IAElDwkE,YAAa,SAAC3wB,GACV,IAA6B,IAAzBk1B,EAAa/oE,QAAjB,CADsC,MAET6zC,EAAMK,YAA3BpnB,EAF8B,EAE9BA,QAASC,EAFqB,EAErBA,QACjBxxB,EAAMyE,QAAU,CAAErG,KAAMmzB,EAASlzB,IAAKmzB,GACtC87C,EAAc7oE,SAAU,EAExB0oE,GAAmBI,GAAc,GACjChB,GAAiBC,EAAQ,SAEzBz1B,EAAM0H,aAAa2uB,MAEvBK,YAAa,SAACn1B,GACV,IAA8B,IAA1Bg1B,EAAc7oE,QAAlB,CACA,IAAMosC,EAAMq7B,GAAWlsE,EAAOs4C,GAE9Bi0B,GAAiBC,EAAQ37B,GAGzBm8B,GAAcn8B,EAAKkG,EAAM6J,WAE7B8sB,UAAW,SAACp1B,GACR,IAA8B,IAA1Bg1B,EAAc7oE,QAAlB,CACA6oE,EAAc7oE,SAAU,ED1CpCkb,SAASwiD,iBAAT,WA5B6B,kBA4BsBt8D,SAAQ,SAAC6wB,GACxDA,EAAQurC,UAAUuE,OA7BO,oBCyEjB2G,GAAmBI,GAAc,GACjChB,GAAiBC,EAAQ,QAEzB,IAAM37B,EAAMq7B,GAAWlsE,EAAOs4C,GACxBsC,EAAM+xB,GAAc,CAAE/rB,QAAS7J,EAAM6J,SAAW/P,GACtDkG,EAAM0H,aAAa7D,GAEnB56C,EAAMyE,QAAU,OAEpBuyC,IAAKu2B,GAEL,yBAAKv2B,IAAKw1B,EAAQrvC,UAAW7hC,KAAEu1C,KAC3B,yBAAK1T,UAAW7hC,KAAEqyE,a,qBCrE5BC,GAAU,iBAAuB,CACnCjG,YAAa,IAAI/nB,IACjBqhB,cAAe,KA+CN4M,GAAuB,SAChCnhB,EACA8T,GAEA,IAAMv6D,EAAyB,IAAI25C,IAKnC,OAJA4gB,EAAM36D,SAAQ,SAACwyD,IAjDI,SACnBpyD,EACAymD,EACA2L,GACQ,IAAD,EACDl1C,EAAoB,UAAGld,EAAIvF,IAAI23D,EAAKv2C,KAAKk2B,cAArB,QAA+B41B,KAGnDjG,EAAc,IAAI/nB,IAAIz8B,EAAKwkD,aACjCtP,EAAKv2C,KAAKm2B,KAAKpyC,SAAQ,SAAC43C,GAAW,IAAD,IACxB/B,EAAE,oBAAGisB,EAAYjnE,IAAI+8C,UAAnB,aAAG,EAAwB/B,UAA3B,QAAiC,IAAIwC,IAC7CypB,EAAY1pB,IAAIR,EAAO,CAAE37B,KAAMu2C,EAAM3c,UAIzC,IAAMoyB,EAAW,YAAO3qD,EAAK89C,eAC7B6M,EAAY/vE,KAAK,CAACs6D,EAAM3L,EAAShsD,IAAI23D,EAAK3c,GAAG1D,SAE7C/xC,EAAIg4C,IAAIoa,EAAKv2C,KAAKk2B,MAAO,CAAE2vB,cAAa1G,cAAe6M,IAgCnDC,CAAe9nE,EAAKymD,EAAU2L,GA7BjB,SACjBpyD,EACAymD,EACA2L,GACQ,IAAD,EACDl1C,EAAoB,UAAGld,EAAIvF,IAAI23D,EAAK3c,GAAG1D,cAAnB,QAA6B41B,KAGjDjG,EAAc,IAAI/nB,IAAIz8B,EAAKwkD,aACjCtP,EAAK3c,GAAGzD,KAAKpyC,SAAQ,SAAC43C,GAAW,IAAD,MACtB37B,EAAI,oBAAG6lD,EAAYjnE,IAAI+8C,UAAnB,aAAG,EAAwB37B,YAA3B,QAAmC,KACvC45B,EAAK,IAAIwC,IAAJ,UAAQypB,EAAYjnE,IAAI+8C,UAAxB,aAAQ,EAAwB/B,IAC3CA,EAAGl9C,IAAI65D,GACPsP,EAAY1pB,IAAIR,EAAO,CAAE37B,OAAM45B,UAInC,IAAMoyB,EAAW,YAAO3qD,EAAK89C,eAC7B6M,EAAY/vE,KAAK,CAACs6D,EAAM3L,EAAShsD,IAAI23D,EAAKv2C,KAAKk2B,SAE/C/xC,EAAIg4C,IAAIoa,EAAK3c,GAAG1D,MAAO,CAAE2vB,cAAa1G,cAAe6M,IAUjDE,CAAa/nE,EAAKymD,EAAU2L,MAEzBpyD,GClDLgoE,GAAoB,SACtBl3B,EACA8F,GACuB,IAAD,EACgB,CAAC9F,EAAM8O,MAAO9O,EAAM6J,QAAQt+B,MAAzDglC,EADa,KACbA,KADa,OACHhpD,EADG,EACHA,MAAOC,EADJ,EACIA,OACpB2vE,GAAc5mB,EAAO,GAAK,EAC1BpZ,EAAM,UAAM3vC,EAAS2vE,EAAf,cAA+B5vE,EAAQ4vE,EAAvC,MAGZ,MAAO,CAAE5vE,QAAOC,SAAQwzB,UAFG,IAATu1B,EAAA,gBAAsBA,EAAtB,KAAgC,GAEfpZ,SAAQta,SADb,QAAbipB,EAAqB,QAAK12C,IAMzCgoE,GAAc,SAACloE,EAAgB+xC,GAEjC,OADA/xC,EAAIg4C,IAAIjG,EAAMp1B,GAAIo1B,GACX/xC,GAGEmoE,GAAS,SAACr3B,GAAiB,MAGXA,EAAM6J,QAAvBlB,EAH4B,EAG5BA,KAAMhG,EAHsB,EAGtBA,OACRgT,EAAWjS,IAAM4L,SAAQ,WAC3B,OAAO3M,EAAO/6B,OAAOwvD,GAAa,IAAIvuB,OACvC,CAAClG,IACE20B,EAAoB5zB,IAAM4L,SAAQ,WACpC,OAAOwnB,GAAqBnhB,EAAUhN,KACvC,CAACA,EAAMgN,IACJ7P,EAAWG,IAEjB,OACI,yBACIp6B,GAAG,SACHua,UAAW,CAAC7hC,KAAE4gC,UAAW4X,IAAWgE,WAAW1nC,KAAK,KACpD2Q,MAAOktD,GAAkBl3B,EAAO8F,IAIhC,yBAAK1f,UAAW7hC,KAAEgzE,QAChBv3B,EAAMi1B,WACJ,kBAACqB,GAAD,CACIzsB,QAAS7J,EAAM6J,QACfnC,aAAc1H,EAAM0H,eAG5B,kBAAC,GAAD,CACImC,QAAS7J,EAAM6J,QACfhF,gBAAiB7E,EAAM6E,gBACvB6C,aAAc1H,EAAM0H,aACpBqiB,aAAc/pB,EAAM+pB,aACpBP,UAAW7T,EACX+E,cAAe1a,EAAM8O,MAAM4L,gBAE9B1a,EAAM6J,QAAQlH,OAAOzzC,KAAI,SAAC+xC,GAAD,OACtB,kBAACqzB,GAAD,CACIhmD,IAAK2yB,EAAMp1B,GAEXo1B,MAAOA,EACP+xB,eAAgBsE,EAAkB3tE,IAAIs3C,EAAMp1B,IAE5C68C,WAAY1oB,EAAMw3B,eAAevpD,IAAIgzB,EAAMp1B,IAC3C4nD,YAAazzB,EAAM0H,aAEnBe,QAASzI,EAAM6J,QAAQpB,QACvB5D,gBAAiB7E,EAAM6E,gBACvBgpB,eAAgB7tB,EAAM6tB,eAEtB3Q,YAAald,EAAMkd,YACnB3M,KAAMvQ,EAAM8O,MAAMyB,KAClB0kB,UAAWj1B,EAAMi1B,iB,qBC9E/BzG,I,OAAY,SAAChd,GAAD,OAAkB,SAACjQ,GAC7BA,EAAMrT,kBAAkBmyB,kBACV,MAAd9e,EAAMjzB,MACVizB,EAAMmD,iBACF8M,EAAMimB,OAEVjmB,EAAMkmB,SAAQ,GACdlmB,EAAM7xB,QAAQurC,UAAUzjE,IAAI,cAC5BkwE,KAAW95C,QACX2zB,EAAM7xB,QAAQjQ,iBAAiB,QAnBnB,SAAC8hC,GAOb,OANW,SAALomB,IACFpmB,EAAMkmB,SAAQ,GACdlmB,EAAM7xB,QAAQurC,UAAUuE,OAAO,cAC/BkI,KAAW95C,QACX2zB,EAAM7xB,QAAQk8B,oBAAoB,QAAS+b,IAcP9nB,CAAQ0B,SCrBvCqmB,GAAgB,SAAC73B,GAAD,OACzB,gBAAC,IAAD,CACIqC,QAAS,WACLkV,GAAqBT,GAAc9W,EAAM+Y,YACzC,IACMnU,EAAyB,CAAE6I,UAAU,EAAOD,OADnCsJ,IAEf9W,EAAM6E,gBAAgB,CAAE/2C,KAAM,SAAU82C,aAE5C/D,SAAS,UACTyB,KAAMC,IAAMC,Q,oBCZd6vB,GAAmC,CACrCvkE,KAAM,OACN0X,OAAQ,OACRukC,MAAO,QAGE+tB,GAAiB,yCAAG,WAC7BtgE,EACAsuC,EACA5X,GAH6B,kBAAA3gC,EAAA,yDAMb,QADVs8C,EAAUoN,GAAkBz/C,IALL,sBAMDY,MAAM,YAAD,OAAaZ,EAAb,cANJ,OAOvB2oB,EAAOypB,GAAcC,EAASwoB,IAAe9sE,MAPtB,KAQrB2oC,EARqB,OASpB,cAToB,OAgBpB,SAhBoB,wCAUf+d,GAAgB9rB,GAVD,cAWrB2kB,YAAU,CAAC,YAAD,OACMttC,EADN,oFAXW,oCAiBrBi0C,GAAS,CACL3F,SAAUA,EACVtgC,OAAQ,UACRhO,KAAK,GAAD,OAAKA,EAAL,YACJ6lB,QAAS8C,IArBQ,iEAAH,0DCNjB43C,GAAiB,yCAAG,WAC7B/3B,GAD6B,oBAAAzyC,EAAA,sEAGV6qD,YAAY,CAAC,oCAAD,OACSpY,EAAMxoC,KADf,MAE3B,mCALyB,WAOhB,IAPgB,2DAQ7BwgE,GAA6Bh4B,EAAMxoC,KAAMwoC,EAAM+Y,YAC3C/Y,EAAM8Y,QAAQprD,UAAYsyC,EAAMxoC,KATP,sDAahBpI,KAFP3J,EAAOu6C,EAAM8Y,QAAQtB,IAAI3U,MAAK,SAACp+C,GAAD,OAAOA,IAAMu7C,EAAMxoC,SAInDg2C,EAASwqB,GAA2BvyE,EAAMu6C,EAAM+Y,aAGhDif,GAA6BlhB,GAAc9W,EAAM+Y,YACjDvL,EAASsJ,IAEPlS,EAAyB,CAAE4I,SAAQC,UAAU,GACnDzN,EAAM6E,gBAAgB,CAAE/2C,KAAM,SAAU82C,YAtBX,4CAAH,sDCExB4tB,GAAY,SAACxyB,I9FiDoB,SACnCj1B,EACAktD,EACAjrB,GAEA,IAAMnD,EAAUoN,GAAkBlsC,GAClC,GAAgB,OAAZ8+B,EAAkB,MAAMzxC,MAAM,YAAD,OAAa2S,EAAb,cACjC,IAAM45B,EAAKyC,EAAY6wB,EAASltD,GAC1BmtD,EAAYD,EAAQtqE,QAAQod,GAClC,IAAmB,IAAfmtD,EAAkB,MAAM9/D,MAAM,YAAD,OAAa2S,EAAb,gBACjC,IAAMotD,EAAO,YAAOF,GACpBE,EAAQxiE,OAAOuiE,EAAY,EAAG,EAAGvzB,GACjC0S,GAAkBxN,EAASlF,GAC3BqI,GAAS,SAACp/C,GAAD,oBAAC,gBAAeA,GAAhB,IAAsB4pD,IAAK2gB,O8F7DpCC,CAAwBp4B,EAAMxoC,KAAMwoC,EAAM8Y,QAAQtB,IAAKxX,EAAM+Y,aAGpDsf,GAAkB,SAACr4B,GAC5B,IAAM8F,EAAWG,IACXqyB,EAAaR,GAAkB5W,KAAK,KAAMlhB,EAAMxoC,KAAMsuC,GACtD4C,EAA0B,CAC5B,CAAEriD,MAAO,eAAgBk/C,GAAI,kBAAM+yB,EAAW,UAC9C,CAAEjyE,MAAO,oBAAqBk/C,GAAI,kBAAM+yB,EAAW,eACnD,CAAEjyE,MAAO,oBAAqBk/C,GAAI,kBAAMitB,GAAUxyB,KAClD,UACA,CAAE35C,MAAO,iBAAkBk/C,GAAI,kBAAMwyB,GAAkB/3B,MAE3D,OACI,gBAAC,IAAD,CACI4H,OAAQ,CACJtF,KAAMC,IAAMkwB,KACZzoD,MAAOy2B,IAAOz2B,MAAMo4B,KACpBK,MAAO,gBAEXiG,MAAOA,K,qBCXb6vB,GAAM,yCAAG,WAAOv4B,EAAc2E,GAArB,UAAAp3C,EAAA,yDACPo3C,IAAO3E,EAAMxoC,KADN,iEAELwgE,GAA6Bh4B,EAAM+Y,WAAY/Y,EAAMxoC,KAAMmtC,GAFtD,2CAAH,wDAKC6zB,GAAkB,SAACx4B,GAC5B,GAAIA,EAAMmvB,OACN,OACI,gBAAC,IAAD,CACInlD,MAAOk4B,IAAMl4B,MAAMo4B,KACnBisB,aAAcruB,EAAMxoC,KAGpBs4C,QAAO,yCAAE,WAAOvO,GAAP,UAAAh0C,EAAA,yDACa,UAAdg0C,EAAMjzB,IADL,iEAECiqD,GAAOv4B,EAAOuB,EAAMwY,cAAcx0D,OAFnC,OAGLy6C,EAAMuuB,WAAU,GAHX,2CAAF,sDAKPD,OAAM,yCAAE,WAAO/sB,GAAP,UAAAh0C,EAAA,sEACEgrE,GAAOv4B,EAAOuB,EAAMwY,cAAcx0D,OADpC,OAEJy6C,EAAMuuB,WAAU,GAFZ,2CAAF,sDAINvrB,WAAS,IAIjB,IAAM5c,EAAY,CACd7hC,KAAEqjD,OACFnH,IAAOz2B,MAAMo4B,KAAK0X,KAClBrZ,IAAOl1B,KAAKm1B,OAAOoZ,KACnB9Z,EAAM8Y,QAAQprD,UAAYsyC,EAAMxoC,KAAOjT,KAAEmJ,QAAU,IACrD2L,KAAK,KACP,OACI,0BACI+sB,UAAWA,EACXic,QAAS,YAzCZ,SAACrC,GACV,IACM4E,EAAyB,CAAE4I,OADlBwqB,GAA2Bh4B,EAAMxoC,KAAMwoC,EAAM+Y,YACnBtL,UAAU,GACnDzN,EAAM6E,gBAAgB,CAAE/2C,KAAM,SAAU82C,YAsCR/3B,CAAKmzB,IACzBgvB,cAAe,WAAWhvB,EAAMuuB,WAAU,IAC1C1tB,SAAUb,EAAMxoC,KAChBirC,MAAM,6CC7CTg2B,GAAc,SAACz4B,GAA6B,IAAD,EACxB0D,YAAwB,GADA,mBAC7CyrB,EAD6C,KACrCZ,EADqC,KAE9CmK,EAAY14B,EAAMxoC,OAASwoC,EAAM8Y,QAAQprD,QAC/C,OACI,uBACI04B,UAAW,CACP7hC,KAAE4gC,UACFuzC,EAAY37B,IAAWgE,UAAY,IACrC1nC,KAAK,MAEP,uBAAK+sB,UAAW7hC,KAAE+7C,SACd,gBAAC,GAAD,iBACQN,EADR,CAEImvB,OAAQA,EACRZ,UAAWA,MAGnB,uBAAKnoC,UAAW,CAAC7hC,KAAEw8C,UAAW5gB,IAAK6rC,OAAO3yD,KAAK,MAC3C,gBAAC,IAAD,CAGIgpC,QAAS,WAAWksB,GAAU,IAC9BjsB,KAAMC,IAAMgG,KACZv+B,MAAOy2B,IAAOz2B,MAAMo4B,KACpBK,MAAM,iBACNyM,SAAUigB,IAEd,gBAAC,GAAoBnvB,M,oBCzBxB24B,GAAc,SAAC34B,GAAD,OACvB,uBAAK5Z,UAAW7hC,KAAE4gC,WACd,uBAAKiB,UAAW7hC,KAAEytE,QACd,sBAAI5rC,UAAW7hC,KAAEk+C,OAAjB,YACA,gBAAC,IAAD,MACA,gBAAC,GAAkBzC,IAEvB,gBAAC,IAAD,CAAQzmC,MAAM,SACbymC,EAAM8Y,QAAQtB,IAAItoD,KAAI,SAACsI,GAAD,OACnB,gBAAC,WAAD,CAAgB8W,IAAK9W,GACjB,gBAAC,GAAD,iBAAiBwoC,EAAjB,CAAwBxoC,KAAMA,KAC9B,gBAAC,IAAD,CAAQ+B,MAAM,e,qBClBxB4sC,GAAmBX,EAAc,wBAE1BozB,GAAe,WAAO,IAAD,EACEl1B,IAAM6L,UAAmB,GAD3B,mBACvBspB,EADuB,KACbC,EADa,OAENp1B,IAAM6L,cAA6BngD,GAF7B,mBAEvB+wB,EAFuB,KAEjBmxB,EAFiB,KAY9B,OARA5N,IAAM+X,WAAU,WAKZtV,IAJW,SAAC0yB,EAAoB14C,GAC5B24C,EAAYD,GACZvnB,EAAQnxB,QAGb,KAEc,IAAb04C,EAA2B,KAE3B,yBAAKzyC,UAAW,CAAC7hC,KAAE4gC,UAAW4X,IAAWgE,WAAW1nC,KAAK,MACrD,yBAAK+sB,UAAW7hC,KAAEyB,MACd,kBAAC,IAAD,CACIulB,KAAM,GACNhmB,OAAoB,IAAbszE,EAAoB,KAAOA,SAE5BzpE,IAAT+wB,GACG,oCACI,kBAAC,IAAD,CAAO5U,KAAM,KACb,6BAAM4U,O,oBC7BxBkF,GAAOzc,SAASub,gBAeT40C,GAAY,SAAC/4B,GAAkB,IAAD,EACH0D,IAAM6L,UAAS,GADZ,mBAChC8M,EADgC,KACpB2c,EADoB,KAGjCC,EAAW,SAAC13B,GACd,IAAIh6C,EAAQg6C,EAAM4wB,QAGlB,OAFA5qE,EAAQoF,KAAK+I,IAAInO,EAAOy4C,EAAMvlC,MAC9BlT,EAAQoF,KAAK8N,IAAIlT,EAAOy4C,EAAMtqC,MACf,GAGbwjE,EAAY,SAAC33B,GACfvB,EAAMm5B,SAASF,EAAS13B,KAGtB63B,EAAW,SAAXA,EAAY73B,GACdlc,GAAK6lC,UAAUuE,OAAOlrE,KAAE80E,SACxBh0C,GAAKw2B,oBAAoB,YAAaqd,GACtC7zC,GAAKw2B,oBAAoB,UAAWud,GACpCp5B,EAAMuzB,OAAO0F,EAAS13B,IACtBy3B,GAAc,IAGlB,OACI,yBACI5yC,UAAS,UAAK7hC,KAAE4gC,UAAP,YAAoBk3B,EAAa93D,KAAEkzE,KAAOlzE,KAAE+0E,QACrDpH,YAAa,WACT7sC,GAAK6lC,UAAUzjE,IAAIlD,KAAE80E,SACrBh0C,GAAK3V,iBAAiB,YAAawpD,GACnC7zC,GAAK3V,iBAAiB,UAAW0pD,GACjCJ,GAAc,IAElBhK,cAAe,WACPhvB,EAAM/Y,UAAU+Y,EAAMuzB,OAAOvzB,EAAM/Y,WAE3C4Z,SAAU,yBAAKza,UAAW7hC,KAAEk4B,U,qBCrC3B88C,GAAc,SAACv5B,GAAD,OACvB,uBAAK5Z,UAAW7hC,KAAE4gC,WACd,gBAAC,GAAD,CACI8B,SAAU,IACVvxB,IAAK,IACL+E,IAAK,IACL0+D,SAAU,SAAC5xE,GACP,IAAMo4B,EAAUqgB,EAAMw5B,WAAW9rE,QACjC,GAAgB,OAAZiyB,EAAkB,MAAMvnB,MAAM,sBAClCunB,EAAQ3V,MAAMziB,MAAd,UAAyBA,EAAzB,OAEJgsE,OAAQ,SAAChsE,GACLy4C,EAAMiP,SAjBE,SAAC1nD,GAAD,OAAmB,SAACqG,GAAD,oBAAC,gBACrCA,GADoC,IAEvC6rE,aAAclyE,KAeamyE,CAAgBnyE,SCYlCoyE,GAAqB,SAAC35B,GAAkB,IACzC6D,EAAiB7D,EAAjB6D,IAAKgG,EAAY7J,EAAZ6J,QACbnG,aAAgB,WACZ,IAAMgY,EAAW,SAACna,GACd,OAjCM,SAACvB,EAAcuB,GAA2B,IAAD,EACvD,KAAIA,EAAMrT,kBAAkBmyB,qBACxB9e,EAAMrT,kBAAkBoyB,sBACH,IAArBtgB,EAAM6D,IAAIl/C,OAAd,CAHuD,IAIvCuqD,EAAaub,GAAczqB,EAAM6D,KAAzClB,OACR,GAAsB,IAAlBuM,EAAS3jC,KAAb,CACA,IAAMg9B,EAAoB,CACtBz6C,KAAM,OACN06C,QAAS,EACTC,QAASzI,EAAM6J,QAAQpB,QACvB9F,OAAQ3C,EAAM6J,QAAQlH,OAAOxpC,QAAO,SAAC8nC,GACjC,OAAOiO,EAASjhC,IAAIgzB,EAAMp1B,OAE9B88B,KAAM3I,EAAM6J,QAAQlB,KAAKxvC,QAAO,SAAC8mC,GAC7B,OAAOiP,EAASjhC,IAAIgyB,EAAIl1B,KAAKk2B,QAAUiO,EAASjhC,IAAIgyB,EAAI0E,GAAG1D,UAE/D11B,KAAM,CAAEhkB,MAAO,EAAGC,OAAQ,GAC1B6gD,OAAQrI,EAAM6J,QAAQxB,QAEpBziD,EAASgkD,GAAcrB,EAAM,CAC/Bz6C,KAAM,OACN0X,OAAQ,OACRukC,MAAO,SAEX,UAAAxI,EAAMq4B,qBAAN,SAAqBC,QAAQ,aAAcj0E,EAAOL,OAClDg8C,EAAMmD,mBAQSo1B,CAAU,CAAEj2B,MAAKgG,WAAWtI,IAGvC,OADA34B,SAAS8G,iBAAiB,OAAQgsC,GAC3B,kBAAM9yC,SAASizC,oBAAoB,OAAQH,MACnD,CAAC7X,EAAKgG,KC3CPkwB,GAAY,SAACl2B,EAAiB/1C,GAAlB,OACd+1C,EAAI1qC,QAAO,SAAC0S,GAAD,OAAQA,EAAG/d,OAASA,KAAMoB,KAAI,SAAC2c,GAAD,OAAQA,EAAGtmB,UCW3Cy0E,GAAsB,SAACh6B,GAAkB,IAC1CgN,EAAahN,EAAbgN,SACRtJ,aAAgB,WACZ,IAAMgY,EAAW,SAACna,GACd,OAZO,SAACvB,EAAcuB,GAA2B,IAAD,IACxD,KAAIA,EAAMrT,kBAAkBmyB,qBACxB9e,EAAMrT,kBAAkBoyB,qBAA5B,CACA,IACM1b,EAAyB,CAAE4I,OADrB,oBAAGjM,EAAMq4B,qBAAT,aAAG,EAAqBK,QAAQ,qBAAhC,QAAiD,GACpBxsB,UAAU,GACnDzN,EAAMgN,SAAS,CAAEl/C,KAAM,SAAU82C,aAOlBs1B,CAAW,CAAEltB,YAAYzL,IAGpC,OADA34B,SAAS8G,iBAAiB,QAASgsC,GAC5B,kBAAM9yC,SAASizC,oBAAoB,QAASH,MACpD,CAAC1O,K,oBCGFmtB,GAAiB,WACnB,IAAMr0B,EAAWG,IAEXm0B,EAAexhB,KACfphD,EAAO4iE,EAAathB,QAAQprD,QAG5Bk4C,EAAUlC,IAAM4L,SAAQ,WAC1B,OxGiHgC,SACpCxJ,EACAj6B,GAGA,GAAiB,QAAbi6B,EAAoB,OAAOgR,GAC/B,IAAMI,EAASD,GAAkBprC,GACjC,GAAe,OAAXqrC,EAAiB,OAAOA,EAE5B,IAAMmjB,EAASrvD,OAAOmsC,aAAaC,QAAQ,WAC3C,OAAe,OAAXijB,EAAwBxjB,GAAcwjB,GAEnCtjB,GwG7HIihB,CAAiClyB,EAAUtuC,KACnD,CAACsuC,EAAUtuC,IAER8iE,EAAezZ,GAAWjb,GAC1BiE,EAAUywB,EAAatZ,QAAQJ,QAOrC,OAJAld,IAAM+X,WAAU,WACZuc,GAA0BnuB,EAASryC,KACpC,CAACqyC,EAASryC,IAEN,CAAEqyC,QAASywB,EAAcxhB,QAASshB,IAGhCrL,GAAO,SAAC/uB,GAAkB,IAAD,EACLm6B,KAArBrhB,EAD0B,EAC1BA,QAASjP,EADiB,EACjBA,QACXqT,EAAcxZ,IAAMqZ,OAAuB,MAC3Cyc,EAAa91B,IAAMqZ,OAAuB,MAC1CtM,EhDhBe,WAAoB,IAAD,EAClB/M,WAA2B,IADT,mBACjCG,EADiC,KAC5B02B,EAD4B,OAEf72B,WAAc,kBAAM+mB,GAAc5mB,KAAM,CAACA,IAA1DlB,EAFgC,EAEhCA,OAAQgG,EAFwB,EAExBA,KAChB,MAAO,CAAE9E,MAAK02B,SAAQ53B,SAAQgG,QgDaf6xB,GAJmB,EAKA92B,IAAM6L,UAAS,GALf,mBAK3B0lB,EAL2B,KAKhBroB,EALgB,KAM5BimB,EC/BmB,WAAwB,IAAD,EAClBnvB,YAAwB,GADN,mBACzC+2B,EADyC,KAChCx1B,EADgC,OAGpBvB,WAAmC,MAHf,mBAGzCxV,EAHyC,KAGjCwsC,EAHiC,OAItBh3B,WAAmC,MAJb,mBAIzCW,EAJyC,KAIlCC,EAJkC,OAKtBZ,WAAmC,MALb,mBAKzCwB,EALyC,KAKlChF,EALkC,OAMjBy6B,YAAUzsC,EAAQmW,EAAO,CACpDu2B,UAAW,QACXC,UAAW,CACP,CAAErjE,KAAM,QAAShJ,QAAS,CAAEmxB,QAASulB,IACrC,CAAE1tC,KAAM,WAJRooB,EANwC,EAMxCA,OAAQugB,EANgC,EAMhCA,WANgC,EAcduD,WAAuB,GAdT,mBAczCT,EAdyC,KAc9BW,EAd8B,OAehBF,WAAyB,IAfT,mBAezCI,EAfyC,KAe/BE,EAf+B,KAkB1C82B,EAAiCp3B,WAAc,WACjD,OAAO,SAACzC,EAAOC,EAAMvhB,GACjB+6C,EAAU/6C,GACVikB,EAAa3C,GACb+C,EAAY9C,GACZ+D,GAAW,MAEhB,IA4BH,OAzBAvB,aAAgB,WACZ,IAAgB,IAAZ+2B,GACU,OAAVp2B,EAAJ,CACA,IAAMqX,EAAW,SAACna,GACd,GAAMA,EAAMrT,kBAAkBlI,OAC1Bqe,EAAMjnB,SAASmkB,EAAMrT,QAAzB,CACA,GAAe,OAAXA,EAAiB,MAAM91B,MAAM,kBACjC81B,EAAO6Y,QACP9B,GAAW,KAGf,OADAr8B,SAAS8G,iBAAiB,QAASgsC,GAC5B,kBAAM9yC,SAASizC,oBAAoB,QAASH,OACpD,CAAC+e,EAASp2B,EAAOnW,IAab,CAAE4sC,YAAW96B,MAXNy6B,EACR,CACI76C,SACAugB,aACA8C,YACAa,WACA5D,WACAoE,WACAW,cAEJ,MDrBa81B,GAEnBpB,GAAmB,CAAE9vB,QAASA,EAAQmX,QAAQJ,QAAS/c,IAAK4M,EAAO5M,MACnEm2B,GAAoB,CAAEhtB,SAAUnD,EAAQmD,WdxBb,SAAC/M,GAA0C,IAAD,EAC7CyD,IAAM6L,UAAS,GAD8B,mBAC9DkoB,EAD8D,KACxDC,EADwD,KAGrEh0B,IAAM+X,WAAU,WACZ,IAAM97B,EAAUsgB,EAAIvyC,QACpB,GAAgB,OAAZiyB,EAAJ,CACA,IAAM6xB,EAAQ,CAAEimB,OAAMC,UAAS/3C,WAE/BA,EAAQiuC,SAAW,EACnB,IAAMlS,EAAW8S,GAAUhd,GAE3B,OADA7xB,EAAQjQ,iBAAiB,UAAWgsC,GAC7B,kBAAM/7B,EAAQk8B,oBAAoB,UAAWH,OACrD,CAAC+b,EAAMx3B,IceV+6B,CAAgB9d,GAEhB,IAAM8U,EACF,kBAAC5W,GAAD,CAEIvR,QAASA,EAAQmX,QAAQJ,QACzB3P,YAAapH,EAAQmX,QAAQ7T,KAC7B+D,cAAerH,EAAQmX,QAAQ3T,OAC/BxI,gBAAiBgF,EAAQmD,SAEzB8B,MAAO9O,EAAM8O,MACbG,SAAUjP,EAAMiP,SAEhBrC,aAAcA,EACdlF,aAAc+I,EAAO8pB,OAErBzhB,QAASA,EAAQA,QACjBC,WAAYD,EAAQC,aAItBtuC,EACF,yBACI2b,UAAW,CAAC2W,IAAWgE,UAAWx8C,KAAEkmB,QAAQpR,KAAK,KACjDu0D,SAAU,EACV3tB,IAAKid,EACLsR,UAAW,SAACjtB,IF1EG,SAAC,GAA4C,IAA1CsC,EAAyC,EAAzCA,IAAKtC,EAAoC,EAApCA,MAAOsD,EAA6B,EAA7BA,iBACc,IAAhD,CAAC,YAAa,UAAUxD,SAASE,EAAMjzB,OACvCizB,EAAMrT,kBAAkBmyB,kBACxB9e,EAAMrT,kBAAkBoyB,sBAC5Bzb,EAAgB,CACZ/2C,KAAM,uBACN82C,QAAS,CAAEf,IAAKk2B,GAAUl2B,EAAK,UAEnCgB,EAAgB,CACZ/2C,KAAM,yBACN82C,QAAS,CAAEf,IAAKk2B,GAAUl2B,EAAK,YAEnCtC,EAAMI,oBE+DMs5B,CAAY,CACRp3B,IAAK4M,EAAO5M,IACZgB,gBAAiBgF,EAAQmD,SACzBzL,YAIR,kBAAC,GAAD,CAEIsI,QAASA,EAAQmX,QAAQJ,QACzB/b,gBAAiBgF,EAAQmD,SACzB6gB,eAAgBgF,EAAWiI,UAE3B5d,YAAaA,EACb+X,UAAWA,EAEXlL,aAActZ,EAAO9H,KACrB6uB,eAAgB/mB,EAAO9N,OACvB+E,aAAc+I,EAAO8pB,OAErBzrB,MAAO9O,EAAM8O,SAKnBosB,EAAcl7B,EAAM8O,MAAMC,gBAC5B,oCACI,yBACI3oB,UAAW7hC,KAAEu0D,QACb7Y,IAAKu5B,EACLxvD,MAAO,CAAEziB,MAAOy4C,EAAM8O,MAAM2qB,eAE5B,kBAAC,GAAD,CACI3gB,QAASA,EAAQA,QACjBC,WAAYD,EAAQC,WACpBlP,QAASA,EAAQmX,QAAQJ,QACzB/b,gBAAiBgF,EAAQmD,YAGjC,kBAAC,GAAD,CAAawsB,WAAYA,EAAYvqB,SAAUjP,EAAMiP,YAI7D,OACI,yBAAK7oB,UAAW7hC,KAAE4gC,WACd,yBAAKiB,UAAW7hC,KAAEytE,OAAQnxB,SAAUmxB,IACpC,yBAAK5rC,UAAW7hC,KAAEyB,MACbk1E,EACAzwD,GAEL,kBAAC,GAAD,MACA,kBAACkyC,GAAD,CAAcO,YAAaA,IAC1B2V,EAAW7yB,OACR,kBAAC,EAAD,eACI2C,OAAQkH,EAAQmX,QAAQJ,QAAQje,OAChCvB,MAAOyI,EAAQmX,QAAQJ,QAAQnY,QAAQ,GAAGljD,MAAMiS,KAChDqtC,gBAAiBgF,EAAQmD,UACrB6lB,EAAW7yB,UE3I7Bm7B,GAAkB,CAAC,QAAS,OAAQ,QAIpCC,GAAa,SAAClgB,GAAwB,IAAD,EACjCmgB,EAAeF,GAAOjsE,KAAI,SAACsI,GAAD,sBAAmBA,OACnD,EAAAoR,SAASub,gBAAgB+mC,WAAUuE,OAAnC,oBAA6C4L,IAC7CzyD,SAASub,gBAAgB+mC,UAAUzjE,IAAnC,gBAAgDyzD,KAG9CogB,GAAW,SAACpgB,GACd,GATY,SAACA,GAAD,OAAgCigB,GAAO95B,SAAS6Z,GASxDqgB,CAAQrgB,GAAQ,OAAOA,EAC3B,MAAM9iD,MAAM,qBAAD,OAAsB8iD,KAGxBsgB,GAET,CACA9tE,QAAS,MAGb43C,EAAoB,YAAY,SAACnlB,GAC7B,IAAM+6B,EAAQogB,GAASn7C,GACvBi7C,GAAWlgB,GACXsgB,GAAa9tE,QAAUwtD,KAGpB,ICrBDugB,GAAsB,CACxBvgB,MAAO,OACP3K,KAAM,EACNqK,eAAe,EACf7L,gBAAgB,EAChB2L,eAAe,EACf+e,aAAc,KAKZroB,GAAa,WAAc,IAAD,EACtB8J,EAAK,UAAGsgB,GAAa9tE,eAAhB,QAA2B+tE,GAAavgB,MAC7ChE,EAASlsC,OAAOmsC,aAAaC,QAJnB,YAKhB,GAAe,OAAXF,EAAiB,OAAO,6BAAKukB,IAAZ,IAA0BvgB,UAC/C,IAAMpM,EAAQ7E,KAAK/kC,MAAMgyC,GACzB,OAAO,0CAAKukB,IAAiB3sB,GAA7B,IAAoCoM,W,6DCxBlCwgB,GAAS,kBACX,8BACI,4CACA,uBACIxtC,OAAO,SACPytC,IAAI,sBACJxuD,KAAK,wBACL0zB,SAAS,qBAKR+6B,GAAc,kBACvB,kBAAC,IAAD,KACI,yBAAKx1C,UAAW7hC,KAAE4gC,WACd,kBAAC,IAAD,KACI,uBAAGhY,KAAK,6BAAR,YACA,kBAAC,IAAD,MACA,uBACIwuD,IAAI,sBACJztC,OAAO,SACP/gB,KAAK,8CACL0zB,SAAS,kBAEb,0BAAMza,UAAW7hC,KAAEs3E,OACf,kBAAC,IAAD,MACA,kBAAC,GAAD,QAGR,kBAAC,IAAD,KACI,0BAAMz1C,UAAW7hC,KAAEu3E,SAAnB,gCACA,mCACA,0BAAM11C,UAAW7hC,KAAEu3E,SAAnB,sBACA,mCACA,0BAAM11C,UAAW7hC,KAAEu3E,SAAnB,2B,qBC7BHC,GAAiC,SAAC,GAAD,IAAGC,EAAH,EAAGA,SAAH,OAC1C,yBAAK51C,UAAW7hC,KAAE4gC,WACd,kBAAC,IAAD,KACI,kBAAC,IAAD,kCACA,iDACqB62C,EADrB,iE,qBCJNC,GAAc,SAACruE,GAAD,oBAAC,gBAA6BA,GAA9B,IAAoCgtD,eAAe,KAE1DshB,GAAc,SAACl8B,GAAD,OACvB,gBAAC,IAAD,CACIh2B,MAAOy2B,IAAOz2B,MAAMo4B,KACpBC,QAAS,kBAAMrC,EAAMiP,SAASgtB,KAC9B35B,KAAMC,IAAM45B,YACZ15B,MAAM,sBCPR25B,GAAO,kBACT,uBACIh2C,UAAW7hC,KAAE83E,KACblvD,KAAK,wBACL+gB,OAAO,SACPytC,IAAI,uBAEJ,yBAAKW,IAAI,iBAAiB/yD,IAAK8yD,KAAM90E,MAAM,OAAOC,OAAQ,OAQrD0yD,GAAS,SAACla,GAAD,OAClB,yBAAK5Z,UAAW7hC,KAAE4gC,WACd,kBAAC,IAAD,CAAO5Z,KAAM,KACb,kBAAC,GAAD,CAAa0jC,SAAUjP,EAAMiP,WAC7B,kBAAC,IAAD,CAAO1jC,KAAM,KACb,kBAAC,GAAD,CAAeywD,SAAS,YACxB,kBAAC,IAAD,MACA,kBAAC,GAAD,MACA,kBAAC,IAAD,CAAOzwD,KAAM,KACb,kBAAC,GAAD,MACA,kBAAC,IAAD,CAAOA,KAAM,O,wCCpBf0uC,GAAc,kBAChB,gCACI,gBAAC,IAAD,oGAIA,gBAAC,IAAD,CAAO1uC,KAAM,IACb,gBAAC,IAAD,sGAIA,gBAAC,IAAD,CAAOA,KAAM,MAIf2uC,GAAS,WAEX,GAAiB,QADAjU,IACO,OAAO,KAE/B,OAAO,gBAAC,IAAD,CAAQ5D,QADA,kBAAMr3B,OAAO0C,SAAS6uD,UACL17B,SAAS,YAGhC27B,GAAb,oDACI,WAAYx8B,GAAe,IAAD,+BACtB,cAAMA,IACDwR,MAAQ,CAAEirB,UAAU,EAAOhwD,MAAO,MAFjB,EAD9B,sDAWQ,OAAIzoB,KAAKwtD,MAAMirB,SAEP,gBAAC,GAAD,CACI3uE,KAAK,WACL20C,MAAM,gCACNiX,YAAa,gBAAC,GAAD,MACbC,OAAQ,gBAAC,GAAD,MACRltC,MAAOzoB,KAAKwtD,MAAM/kC,QAGvBzoB,KAAKg8C,MAAMa,YArB1B,gDAMoCp0B,GAC5B,MAAO,CAAEgwD,UAAU,EAAMhwD,aAPjC,GAAmCi3B,aC1BtBg5B,GAAM,WACf,IAAM52B,EAAWG,IADI,ENqBD,WAAmB,IAAD,EACZvC,WAAe0N,IADH,mBAC/BtC,EAD+B,KACxBG,EADwB,KAKtC,OAHAvL,aAAgB,WACZ14B,OAAOmsC,aAAaG,QAbR,WAa6BrN,KAAKC,UAAU4E,MACzD,CAACA,IACG,CAAEA,QAAOG,YMxBY0tB,GAApB7tB,EAFa,EAEbA,MAAOG,EAFM,EAENA,SAGf,OPkBoB,SAACjP,GAAuB,IACpCkb,EAAUlb,EAAM8O,MAAhBoM,MACAjM,EAAajP,EAAbiP,SAERvL,IAAM+X,WAAU,WACZ2f,GAAWlgB,KACZ,CAACA,IAEJxX,IAAM+X,WAAU,WACZnW,EAAoB,YAAY,SAACnlB,GAC7B8uB,GAAS,SAACrhD,GAAD,oBAAC,gBAAeA,GAAhB,IAAsBstD,MAAOogB,GAASn7C,aAEpD,CAAC8uB,IOhCJ2tB,CAAS,CAAE9tB,QAAOG,aAGd,kBAAC,GAAD,KACI,yBAAK7oB,UAAW,CAAC7hC,KAAE4gC,UAAW03C,IAAUC,QAAQzjE,KAAK,MACjD,yBAAK+sB,UAAW7hC,KAAEyB,MACd,kBAAC,GAAD,CAAM8oD,MAAOA,EAAOG,SAAUA,KAEpB,QAAbnJ,GAAsBgJ,EAAM8L,eACzB,oCACI,kBAAC,IAAD,CAAQrhD,MAAM,WACd,yBAAK6sB,UAAW7hC,KAAEo1D,QACd,kBAAC,GAAD,CAAQ1K,SAAUA,S,6B9GzBrB,MAMRjkC,OAAOmsC,aAAaC,QAAQ,aAEzCpsC,OAAOmsC,aAAa4lB,QACpB/xD,OAAOmsC,aAAaG,QAAQ,UATP,MrDwCpBtsC,OAAegyD,QAAU53B,EACzBp6B,OAAeY,OAASy5B,EoK3B7B,IAAM43B,GAAO,WACT,IAAMn3B,EnKayB,WAAiB,IAAD,EACfpC,IAAM6L,SAAmB3J,GADV,mBACxCE,EADwC,KAC9Bo3B,EAD8B,KAM/C,OAJAx5B,IAAM+X,WAAU,WAEZtV,GADiB,SAAChmB,GAA8B+8C,EAAY/8C,QAE7D,IACI2lB,EmKnBUq3B,GACjB,OACI,kBAAC,IAAMC,WAAP,KACI,kBAACr3B,EAAgBs3B,SAAjB,CAA0B93E,MAAOugD,GAC7B,kBAAC,KAAD,CAAat3C,QAAS8uE,MAClB,kBAAC,GAAD,UAOpBn4B,IAASlL,OAAO,kBAAC,GAAD,MAAUrxB,SAAS06B,eAAe,U,mBC1BlDngD,EAAOC,QAAU,CAAC,UAAY,yBAAyB,QAAU,yB,mBCAjED,EAAOC,QAAU,CAAC,MAAQ,qBAAqB,KAAO,oBAAoB,UAAY,2B,mBCAtFD,EAAOC,QAAU,CAAC,MAAQ,oBAAoB,IAAM,kBAAkB,KAAO,qB,mBCA7ED,EAAOC,QAAU,CAAC,UAAY,0BAA0B,SAAW,yBAAyB,KAAO,qBAAqB,KAAO,uB,mBCA/HD,EAAOC,QAAU,CAAC,UAAY,yBAAyB,IAAM,mBAAmB,KAAO,oBAAoB,KAAO,sB,mBCAlHD,EAAOC,QAAU,CAAC,UAAY,0BAA0B,KAAO,qBAAqB,KAAO,qBAAqB,KAAO,qBAAqB,MAAQ,wB,mBCApJD,EAAOC,QAAU,CAAC,UAAY,0BAA0B,KAAO,qBAAqB,KAAO,qBAAqB,KAAO,qBAAqB,MAAQ,wB,mBCApJD,EAAOC,QAAU,CAAC,UAAY,wBAAwB,MAAQ,oBAAoB,MAAQ,sB,wCCA1FD,EAAOC,QAAU,CAAC,UAAY,0BAA0B,WAAW,yBAAyB,MAAQ,sBAAsB,WAAa,6B,mBCAvID,EAAOC,QAAU,CAAC,UAAY,0BAA0B,WAAW,yBAAyB,SAAW,yBAAyB,OAAS,yB,mBCAzID,EAAOC,QAAU,CAAC,UAAY,wBAAwB,SAAW,uBAAuB,KAAO,qB,mBCA/FD,EAAOC,QAAU,CAAC,UAAY,wBAAwB,IAAM,kBAAkB,MAAQ,sB,mBCAtFD,EAAOC,QAAU,CAAC,UAAY,wBAAwB,QAAU,sBAAsB,UAAY,0B,mBCAlGD,EAAOC,QAAU,CAAC,OAAS,wBAAwB,MAAQ,yB,mBCA3DD,EAAOC,QAAU,CAAC,UAAY,uBAAuB,KAAO,kBAAkB,OAAS,uB","file":"static/js/main.772f0b90.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"create_container__HobXV\",\"row\":\"create_row__3ZYOt\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"footer_container__1Ccjg\",\"help\":\"footer_help__38OWu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"rows_row__mdwZp\",\"input\":\"rows_input__3ZHYJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"footer\":\"form_footer__rcZkL\",\"title\":\"form_title__2yshb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"marker_container__1M8sa\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"body_container__3oC6s\",\"header\":\"body_header__jV-GI\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"name_container__1o8SY\",\"view\":\"name_view__15GrF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"canvas_container__3Y18v\",\"grid\":\"canvas_grid__nkChd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"name_button__aCppb\",\"current\":\"name_current__MP9fR\",\"weak\":\"name_weak__3mEco\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"progress_container__1kfqj\",\"body\":\"progress_body__2EtDz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"footer_container__3MvUg\",\"logo\":\"footer_logo__3qLuS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"header_container__2aGWu\"};","// @ts-nocheck\r\n/* eslint-disable */\r\n/*!\r\n * html2canvas 1.0.0-rc.7 <https://html2canvas.hertzen.com>\r\n * Copyright (c) 2020 Niklas von Hertzen <https://hertzen.com>\r\n * Released under MIT License\r\n */\r\n(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    (global = global || self, global.html2canvas = factory());\r\n}(this, function () { 'use strict';\r\n\r\n    const HACK = (style, target) => {\r\n        [\r\n            \"fill\",\r\n            \"stroke\",\r\n            \"stroke-width\",\r\n            \"stroke-linejoin\",\r\n            \"marker-end\",\r\n            \"marker-start\",\r\n        ].forEach((key) => {\r\n            target.style.setProperty(key, style.getPropertyValue(key));\r\n        });\r\n    }\r\n\r\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation. All rights reserved.\r\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\n    this file except in compliance with the License. You may obtain a copy of the\r\n    License at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\n    MERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\n    See the Apache Version 2.0 License for specific language governing permissions\r\n    and limitations under the License.\r\n    ***************************************************************************** */\r\n    /* global Reflect, Promise */\r\n\r\n    var extendStatics = function(d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n\r\n    function __extends(d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    }\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\r\n\r\n    function __awaiter(thisArg, _arguments, P, generator) {\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    }\r\n\r\n    function __generator(thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    }\r\n\r\n    var Bounds = /** @class */ (function () {\r\n        function Bounds(x, y, w, h) {\r\n            this.left = x;\r\n            this.top = y;\r\n            this.width = w;\r\n            this.height = h;\r\n        }\r\n        Bounds.prototype.add = function (x, y, w, h) {\r\n            return new Bounds(this.left + x, this.top + y, this.width + w, this.height + h);\r\n        };\r\n        Bounds.fromClientRect = function (clientRect) {\r\n            return new Bounds(clientRect.left, clientRect.top, clientRect.width, clientRect.height);\r\n        };\r\n        return Bounds;\r\n    }());\r\n    var parseBounds = function (node) {\r\n        return Bounds.fromClientRect(node.getBoundingClientRect());\r\n    };\r\n    var parseDocumentSize = function (document) {\r\n        var body = document.body;\r\n        var documentElement = document.documentElement;\r\n        if (!body || !documentElement) {\r\n            throw new Error(\"Unable to get document size\");\r\n        }\r\n        var width = Math.max(Math.max(body.scrollWidth, documentElement.scrollWidth), Math.max(body.offsetWidth, documentElement.offsetWidth), Math.max(body.clientWidth, documentElement.clientWidth));\r\n        var height = Math.max(Math.max(body.scrollHeight, documentElement.scrollHeight), Math.max(body.offsetHeight, documentElement.offsetHeight), Math.max(body.clientHeight, documentElement.clientHeight));\r\n        return new Bounds(0, 0, width, height);\r\n    };\r\n\r\n    /*\r\n     * css-line-break 1.1.1 <https://github.com/niklasvh/css-line-break#readme>\r\n     * Copyright (c) 2019 Niklas von Hertzen <https://hertzen.com>\r\n     * Released under MIT License\r\n     */\r\n    var toCodePoints = function (str) {\r\n        var codePoints = [];\r\n        var i = 0;\r\n        var length = str.length;\r\n        while (i < length) {\r\n            var value = str.charCodeAt(i++);\r\n            if (value >= 0xd800 && value <= 0xdbff && i < length) {\r\n                var extra = str.charCodeAt(i++);\r\n                if ((extra & 0xfc00) === 0xdc00) {\r\n                    codePoints.push(((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000);\r\n                }\r\n                else {\r\n                    codePoints.push(value);\r\n                    i--;\r\n                }\r\n            }\r\n            else {\r\n                codePoints.push(value);\r\n            }\r\n        }\r\n        return codePoints;\r\n    };\r\n    var fromCodePoint = function () {\r\n        var codePoints = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            codePoints[_i] = arguments[_i];\r\n        }\r\n        if (String.fromCodePoint) {\r\n            return String.fromCodePoint.apply(String, codePoints);\r\n        }\r\n        var length = codePoints.length;\r\n        if (!length) {\r\n            return '';\r\n        }\r\n        var codeUnits = [];\r\n        var index = -1;\r\n        var result = '';\r\n        while (++index < length) {\r\n            var codePoint = codePoints[index];\r\n            if (codePoint <= 0xffff) {\r\n                codeUnits.push(codePoint);\r\n            }\r\n            else {\r\n                codePoint -= 0x10000;\r\n                codeUnits.push((codePoint >> 10) + 0xd800, codePoint % 0x400 + 0xdc00);\r\n            }\r\n            if (index + 1 === length || codeUnits.length > 0x4000) {\r\n                result += String.fromCharCode.apply(String, codeUnits);\r\n                codeUnits.length = 0;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\n    // Use a lookup table to find the index.\r\n    var lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\r\n    for (var i = 0; i < chars.length; i++) {\r\n        lookup[chars.charCodeAt(i)] = i;\r\n    }\r\n    var decode = function (base64) {\r\n        var bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\r\n        if (base64[base64.length - 1] === '=') {\r\n            bufferLength--;\r\n            if (base64[base64.length - 2] === '=') {\r\n                bufferLength--;\r\n            }\r\n        }\r\n        var buffer = typeof ArrayBuffer !== 'undefined' &&\r\n            typeof Uint8Array !== 'undefined' &&\r\n            typeof Uint8Array.prototype.slice !== 'undefined'\r\n            ? new ArrayBuffer(bufferLength)\r\n            : new Array(bufferLength);\r\n        var bytes = Array.isArray(buffer) ? buffer : new Uint8Array(buffer);\r\n        for (i = 0; i < len; i += 4) {\r\n            encoded1 = lookup[base64.charCodeAt(i)];\r\n            encoded2 = lookup[base64.charCodeAt(i + 1)];\r\n            encoded3 = lookup[base64.charCodeAt(i + 2)];\r\n            encoded4 = lookup[base64.charCodeAt(i + 3)];\r\n            bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\r\n            bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\r\n            bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\r\n        }\r\n        return buffer;\r\n    };\r\n    var polyUint16Array = function (buffer) {\r\n        var length = buffer.length;\r\n        var bytes = [];\r\n        for (var i = 0; i < length; i += 2) {\r\n            bytes.push((buffer[i + 1] << 8) | buffer[i]);\r\n        }\r\n        return bytes;\r\n    };\r\n    var polyUint32Array = function (buffer) {\r\n        var length = buffer.length;\r\n        var bytes = [];\r\n        for (var i = 0; i < length; i += 4) {\r\n            bytes.push((buffer[i + 3] << 24) | (buffer[i + 2] << 16) | (buffer[i + 1] << 8) | buffer[i]);\r\n        }\r\n        return bytes;\r\n    };\r\n\r\n    /** Shift size for getting the index-2 table offset. */\r\n    var UTRIE2_SHIFT_2 = 5;\r\n    /** Shift size for getting the index-1 table offset. */\r\n    var UTRIE2_SHIFT_1 = 6 + 5;\r\n    /**\r\n     * Shift size for shifting left the index array values.\r\n     * Increases possible data size with 16-bit index values at the cost\r\n     * of compactability.\r\n     * This requires data blocks to be aligned by UTRIE2_DATA_GRANULARITY.\r\n     */\r\n    var UTRIE2_INDEX_SHIFT = 2;\r\n    /**\r\n     * Difference between the two shift sizes,\r\n     * for getting an index-1 offset from an index-2 offset. 6=11-5\r\n     */\r\n    var UTRIE2_SHIFT_1_2 = UTRIE2_SHIFT_1 - UTRIE2_SHIFT_2;\r\n    /**\r\n     * The part of the index-2 table for U+D800..U+DBFF stores values for\r\n     * lead surrogate code _units_ not code _points_.\r\n     * Values for lead surrogate code _points_ are indexed with this portion of the table.\r\n     * Length=32=0x20=0x400>>UTRIE2_SHIFT_2. (There are 1024=0x400 lead surrogates.)\r\n     */\r\n    var UTRIE2_LSCP_INDEX_2_OFFSET = 0x10000 >> UTRIE2_SHIFT_2;\r\n    /** Number of entries in a data block. 32=0x20 */\r\n    var UTRIE2_DATA_BLOCK_LENGTH = 1 << UTRIE2_SHIFT_2;\r\n    /** Mask for getting the lower bits for the in-data-block offset. */\r\n    var UTRIE2_DATA_MASK = UTRIE2_DATA_BLOCK_LENGTH - 1;\r\n    var UTRIE2_LSCP_INDEX_2_LENGTH = 0x400 >> UTRIE2_SHIFT_2;\r\n    /** Count the lengths of both BMP pieces. 2080=0x820 */\r\n    var UTRIE2_INDEX_2_BMP_LENGTH = UTRIE2_LSCP_INDEX_2_OFFSET + UTRIE2_LSCP_INDEX_2_LENGTH;\r\n    /**\r\n     * The 2-byte UTF-8 version of the index-2 table follows at offset 2080=0x820.\r\n     * Length 32=0x20 for lead bytes C0..DF, regardless of UTRIE2_SHIFT_2.\r\n     */\r\n    var UTRIE2_UTF8_2B_INDEX_2_OFFSET = UTRIE2_INDEX_2_BMP_LENGTH;\r\n    var UTRIE2_UTF8_2B_INDEX_2_LENGTH = 0x800 >> 6; /* U+0800 is the first code point after 2-byte UTF-8 */\r\n    /**\r\n     * The index-1 table, only used for supplementary code points, at offset 2112=0x840.\r\n     * Variable length, for code points up to highStart, where the last single-value range starts.\r\n     * Maximum length 512=0x200=0x100000>>UTRIE2_SHIFT_1.\r\n     * (For 0x100000 supplementary code points U+10000..U+10ffff.)\r\n     *\r\n     * The part of the index-2 table for supplementary code points starts\r\n     * after this index-1 table.\r\n     *\r\n     * Both the index-1 table and the following part of the index-2 table\r\n     * are omitted completely if there is only BMP data.\r\n     */\r\n    var UTRIE2_INDEX_1_OFFSET = UTRIE2_UTF8_2B_INDEX_2_OFFSET + UTRIE2_UTF8_2B_INDEX_2_LENGTH;\r\n    /**\r\n     * Number of index-1 entries for the BMP. 32=0x20\r\n     * This part of the index-1 table is omitted from the serialized form.\r\n     */\r\n    var UTRIE2_OMITTED_BMP_INDEX_1_LENGTH = 0x10000 >> UTRIE2_SHIFT_1;\r\n    /** Number of entries in an index-2 block. 64=0x40 */\r\n    var UTRIE2_INDEX_2_BLOCK_LENGTH = 1 << UTRIE2_SHIFT_1_2;\r\n    /** Mask for getting the lower bits for the in-index-2-block offset. */\r\n    var UTRIE2_INDEX_2_MASK = UTRIE2_INDEX_2_BLOCK_LENGTH - 1;\r\n    var slice16 = function (view, start, end) {\r\n        if (view.slice) {\r\n            return view.slice(start, end);\r\n        }\r\n        return new Uint16Array(Array.prototype.slice.call(view, start, end));\r\n    };\r\n    var slice32 = function (view, start, end) {\r\n        if (view.slice) {\r\n            return view.slice(start, end);\r\n        }\r\n        return new Uint32Array(Array.prototype.slice.call(view, start, end));\r\n    };\r\n    var createTrieFromBase64 = function (base64) {\r\n        var buffer = decode(base64);\r\n        var view32 = Array.isArray(buffer) ? polyUint32Array(buffer) : new Uint32Array(buffer);\r\n        var view16 = Array.isArray(buffer) ? polyUint16Array(buffer) : new Uint16Array(buffer);\r\n        var headerLength = 24;\r\n        var index = slice16(view16, headerLength / 2, view32[4] / 2);\r\n        var data = view32[5] === 2\r\n            ? slice16(view16, (headerLength + view32[4]) / 2)\r\n            : slice32(view32, Math.ceil((headerLength + view32[4]) / 4));\r\n        return new Trie(view32[0], view32[1], view32[2], view32[3], index, data);\r\n    };\r\n    var Trie = /** @class */ (function () {\r\n        function Trie(initialValue, errorValue, highStart, highValueIndex, index, data) {\r\n            this.initialValue = initialValue;\r\n            this.errorValue = errorValue;\r\n            this.highStart = highStart;\r\n            this.highValueIndex = highValueIndex;\r\n            this.index = index;\r\n            this.data = data;\r\n        }\r\n        /**\r\n         * Get the value for a code point as stored in the Trie.\r\n         *\r\n         * @param codePoint the code point\r\n         * @return the value\r\n         */\r\n        Trie.prototype.get = function (codePoint) {\r\n            var ix;\r\n            if (codePoint >= 0) {\r\n                if (codePoint < 0x0d800 || (codePoint > 0x0dbff && codePoint <= 0x0ffff)) {\r\n                    // Ordinary BMP code point, excluding leading surrogates.\r\n                    // BMP uses a single level lookup.  BMP index starts at offset 0 in the Trie2 index.\r\n                    // 16 bit data is stored in the index array itself.\r\n                    ix = this.index[codePoint >> UTRIE2_SHIFT_2];\r\n                    ix = (ix << UTRIE2_INDEX_SHIFT) + (codePoint & UTRIE2_DATA_MASK);\r\n                    return this.data[ix];\r\n                }\r\n                if (codePoint <= 0xffff) {\r\n                    // Lead Surrogate Code Point.  A Separate index section is stored for\r\n                    // lead surrogate code units and code points.\r\n                    //   The main index has the code unit data.\r\n                    //   For this function, we need the code point data.\r\n                    // Note: this expression could be refactored for slightly improved efficiency, but\r\n                    //       surrogate code points will be so rare in practice that it's not worth it.\r\n                    ix = this.index[UTRIE2_LSCP_INDEX_2_OFFSET + ((codePoint - 0xd800) >> UTRIE2_SHIFT_2)];\r\n                    ix = (ix << UTRIE2_INDEX_SHIFT) + (codePoint & UTRIE2_DATA_MASK);\r\n                    return this.data[ix];\r\n                }\r\n                if (codePoint < this.highStart) {\r\n                    // Supplemental code point, use two-level lookup.\r\n                    ix = UTRIE2_INDEX_1_OFFSET - UTRIE2_OMITTED_BMP_INDEX_1_LENGTH + (codePoint >> UTRIE2_SHIFT_1);\r\n                    ix = this.index[ix];\r\n                    ix += (codePoint >> UTRIE2_SHIFT_2) & UTRIE2_INDEX_2_MASK;\r\n                    ix = this.index[ix];\r\n                    ix = (ix << UTRIE2_INDEX_SHIFT) + (codePoint & UTRIE2_DATA_MASK);\r\n                    return this.data[ix];\r\n                }\r\n                if (codePoint <= 0x10ffff) {\r\n                    return this.data[this.highValueIndex];\r\n                }\r\n            }\r\n            // Fall through.  The code point is outside of the legal range of 0..0x10ffff.\r\n            return this.errorValue;\r\n        };\r\n        return Trie;\r\n    }());\r\n\r\n    var base64 = 'KwAAAAAAAAAACA4AIDoAAPAfAAACAAAAAAAIABAAGABAAEgAUABYAF4AZgBeAGYAYABoAHAAeABeAGYAfACEAIAAiACQAJgAoACoAK0AtQC9AMUAXgBmAF4AZgBeAGYAzQDVAF4AZgDRANkA3gDmAOwA9AD8AAQBDAEUARoBIgGAAIgAJwEvATcBPwFFAU0BTAFUAVwBZAFsAXMBewGDATAAiwGTAZsBogGkAawBtAG8AcIBygHSAdoB4AHoAfAB+AH+AQYCDgIWAv4BHgImAi4CNgI+AkUCTQJTAlsCYwJrAnECeQKBAk0CiQKRApkCoQKoArACuALAAsQCzAIwANQC3ALkAjAA7AL0AvwCAQMJAxADGAMwACADJgMuAzYDPgOAAEYDSgNSA1IDUgNaA1oDYANiA2IDgACAAGoDgAByA3YDfgOAAIQDgACKA5IDmgOAAIAAogOqA4AAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAK8DtwOAAIAAvwPHA88D1wPfAyAD5wPsA/QD/AOAAIAABAQMBBIEgAAWBB4EJgQuBDMEIAM7BEEEXgBJBCADUQRZBGEEaQQwADAAcQQ+AXkEgQSJBJEEgACYBIAAoASoBK8EtwQwAL8ExQSAAIAAgACAAIAAgACgAM0EXgBeAF4AXgBeAF4AXgBeANUEXgDZBOEEXgDpBPEE+QQBBQkFEQUZBSEFKQUxBTUFPQVFBUwFVAVcBV4AYwVeAGsFcwV7BYMFiwWSBV4AmgWgBacFXgBeAF4AXgBeAKsFXgCyBbEFugW7BcIFwgXIBcIFwgXQBdQF3AXkBesF8wX7BQMGCwYTBhsGIwYrBjMGOwZeAD8GRwZNBl4AVAZbBl4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAGMGXgBqBnEGXgBeAF4AXgBeAF4AXgBeAF4AXgB5BoAG4wSGBo4GkwaAAIADHgR5AF4AXgBeAJsGgABGA4AAowarBrMGswagALsGwwbLBjAA0wbaBtoG3QbaBtoG2gbaBtoG2gblBusG8wb7BgMHCwcTBxsHCwcjBysHMAc1BzUHOgdCB9oGSgdSB1oHYAfaBloHaAfaBlIH2gbaBtoG2gbaBtoG2gbaBjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHbQdeAF4ANQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQd1B30HNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B4MH2gaKB68EgACAAIAAgACAAIAAgACAAI8HlwdeAJ8HpweAAIAArwe3B14AXgC/B8UHygcwANAH2AfgB4AA6AfwBz4B+AcACFwBCAgPCBcIogEYAR8IJwiAAC8INwg/CCADRwhPCFcIXwhnCEoDGgSAAIAAgABvCHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIhAiLCI4IMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAANQc1BzUHNQc1BzUHNQc1BzUHNQc1B54INQc1B6II2gaqCLIIugiAAIAAvgjGCIAAgACAAIAAgACAAIAAgACAAIAAywiHAYAA0wiAANkI3QjlCO0I9Aj8CIAAgACAAAIJCgkSCRoJIgknCTYHLwk3CZYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiAAIAAAAFAAXgBeAGAAcABeAHwAQACQAKAArQC9AJ4AXgBeAE0A3gBRAN4A7AD8AMwBGgEAAKcBNwEFAUwBXAF4QkhCmEKnArcCgAHHAsABz4LAAcABwAHAAd+C6ABoAG+C/4LAAcABwAHAAc+DF4MAAcAB54M3gweDV4Nng3eDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEeDqABVg6WDqABoQ6gAaABoAHXDvcONw/3DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DncPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB7cPPwlGCU4JMACAAIAAgABWCV4JYQmAAGkJcAl4CXwJgAkwADAAMAAwAIgJgACLCZMJgACZCZ8JowmrCYAAswkwAF4AXgB8AIAAuwkABMMJyQmAAM4JgADVCTAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAqwYWBNkIMAAwADAAMADdCeAJ6AnuCR4E9gkwAP4JBQoNCjAAMACAABUK0wiAAB0KJAosCjQKgAAwADwKQwqAAEsKvQmdCVMKWwowADAAgACAALcEMACAAGMKgABrCjAAMAAwADAAMAAwADAAMAAwADAAMAAeBDAAMAAwADAAMAAwADAAMAAwADAAMAAwAIkEPQFzCnoKiQSCCooKkAqJBJgKoAqkCokEGAGsCrQKvArBCjAAMADJCtEKFQHZCuEK/gHpCvEKMAAwADAAMACAAIwE+QowAIAAPwEBCzAAMAAwADAAMACAAAkLEQswAIAAPwEZCyELgAAOCCkLMAAxCzkLMAAwADAAMAAwADAAXgBeAEELMAAwADAAMAAwADAAMAAwAEkLTQtVC4AAXAtkC4AAiQkwADAAMAAwADAAMAAwADAAbAtxC3kLgAuFC4sLMAAwAJMLlwufCzAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAApwswADAAMACAAIAAgACvC4AAgACAAIAAgACAALcLMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAvwuAAMcLgACAAIAAgACAAIAAyguAAIAAgACAAIAA0QswADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAANkLgACAAIAA4AswADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACJCR4E6AswADAAhwHwC4AA+AsADAgMEAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMACAAIAAGAwdDCUMMAAwAC0MNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQw1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHPQwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADUHNQc1BzUHNQc1BzUHNQc2BzAAMAA5DDUHNQc1BzUHNQc1BzUHNQc1BzUHNQdFDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAATQxSDFoMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAF4AXgBeAF4AXgBeAF4AYgxeAGoMXgBxDHkMfwxeAIUMXgBeAI0MMAAwADAAMAAwAF4AXgCVDJ0MMAAwADAAMABeAF4ApQxeAKsMswy7DF4Awgy9DMoMXgBeAF4AXgBeAF4AXgBeAF4AXgDRDNkMeQBqCeAM3Ax8AOYM7Az0DPgMXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgCgAAANoAAHDQ4NFg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAeDSYNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAC4NMABeAF4ANg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAD4NRg1ODVYNXg1mDTAAbQ0wADAAMAAwADAAMAAwADAA2gbaBtoG2gbaBtoG2gbaBnUNeg3CBYANwgWFDdoGjA3aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gaUDZwNpA2oDdoG2gawDbcNvw3HDdoG2gbPDdYN3A3fDeYN2gbsDfMN2gbaBvoN/g3aBgYODg7aBl4AXgBeABYOXgBeACUG2gYeDl4AJA5eACwO2w3aBtoGMQ45DtoG2gbaBtoGQQ7aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B1EO2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQdZDjUHNQc1BzUHNQc1B2EONQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHaA41BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B3AO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B2EO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBkkOeA6gAKAAoAAwADAAMAAwAKAAoACgAKAAoACgAKAAgA4wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAD//wQABAAEAAQABAAEAAQABAAEAA0AAwABAAEAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAKABMAFwAeABsAGgAeABcAFgASAB4AGwAYAA8AGAAcAEsASwBLAEsASwBLAEsASwBLAEsAGAAYAB4AHgAeABMAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAFgAbABIAHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYADQARAB4ABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkAFgAaABsAGwAbAB4AHQAdAB4ATwAXAB4ADQAeAB4AGgAbAE8ATwAOAFAAHQAdAB0ATwBPABcATwBPAE8AFgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwArAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAAQABAANAA0ASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAUAArACsAKwArACsAKwArACsABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAGgAaAFAAUABQAFAAUABMAB4AGwBQAB4AKwArACsABAAEAAQAKwBQAFAAUABQAFAAUAArACsAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUAArAFAAUAArACsABAArAAQABAAEAAQABAArACsAKwArAAQABAArACsABAAEAAQAKwArACsABAArACsAKwArACsAKwArAFAAUABQAFAAKwBQACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwAEAAQAUABQAFAABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQAKwArAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeABsAKwArACsAKwArACsAKwBQAAQABAAEAAQABAAEACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAKwArACsAKwArACsAKwArAAQABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwAEAFAAKwBQAFAAUABQAFAAUAArACsAKwBQAFAAUAArAFAAUABQAFAAKwArACsAUABQACsAUAArAFAAUAArACsAKwBQAFAAKwArACsAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQAKwArACsABAAEAAQAKwAEAAQABAAEACsAKwBQACsAKwArACsAKwArAAQAKwArACsAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAB4AHgAeAB4AHgAeABsAHgArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArAFAAUABQACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAB4AUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArACsAKwArACsAKwArAFAAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwArAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAKwBcAFwAKwBcACsAKwBcACsAKwArACsAKwArAFwAXABcAFwAKwBcAFwAXABcAFwAXABcACsAXABcAFwAKwBcACsAXAArACsAXABcACsAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgArACoAKgBcACsAKwBcAFwAXABcAFwAKwBcACsAKgAqACoAKgAqACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAFwAXABcAFwAUAAOAA4ADgAOAB4ADgAOAAkADgAOAA0ACQATABMAEwATABMACQAeABMAHgAeAB4ABAAEAB4AHgAeAB4AHgAeAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUAANAAQAHgAEAB4ABAAWABEAFgARAAQABABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAAQABAAEAAQABAANAAQABABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsADQANAB4AHgAeAB4AHgAeAAQAHgAeAB4AHgAeAB4AKwAeAB4ADgAOAA0ADgAeAB4AHgAeAB4ACQAJACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgAeAB4AHgBcAFwAXABcAFwAXAAqACoAKgAqAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAKgAqACoAKgAqACoAKgBcAFwAXAAqACoAKgAqAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAXAAqAEsASwBLAEsASwBLAEsASwBLAEsAKgAqACoAKgAqACoAUABQAFAAUABQAFAAKwBQACsAKwArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQACsAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwAEAAQABAAeAA0AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAEQArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAADQANAA0AUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAA0ADQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoADQANABUAXAANAB4ADQAbAFwAKgArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAB4AHgATABMADQANAA4AHgATABMAHgAEAAQABAAJACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAUABQAFAAUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwAeACsAKwArABMAEwBLAEsASwBLAEsASwBLAEsASwBLAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwBcAFwAXABcAFwAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcACsAKwArACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwAeAB4AXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsABABLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKgAqACoAKgAqACoAKgBcACoAKgAqACoAKgAqACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAUABQAFAAUABQAFAAUAArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4ADQANAA0ADQAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAHgAeAB4AHgBQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwANAA0ADQANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwBQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsABAAEAAQAHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAABABQAFAAUABQAAQABAAEAFAAUAAEAAQABAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAKwBQACsAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAKwArAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAKwAeAB4AHgAeAB4AHgAeAA4AHgArAA0ADQANAA0ADQANAA0ACQANAA0ADQAIAAQACwAEAAQADQAJAA0ADQAMAB0AHQAeABcAFwAWABcAFwAXABYAFwAdAB0AHgAeABQAFAAUAA0AAQABAAQABAAEAAQABAAJABoAGgAaABoAGgAaABoAGgAeABcAFwAdABUAFQAeAB4AHgAeAB4AHgAYABYAEQAVABUAFQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgANAB4ADQANAA0ADQAeAA0ADQANAAcAHgAeAB4AHgArAAQABAAEAAQABAAEAAQABAAEAAQAUABQACsAKwBPAFAAUABQAFAAUAAeAB4AHgAWABEATwBQAE8ATwBPAE8AUABQAFAAUABQAB4AHgAeABYAEQArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGgAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgBQABoAHgAdAB4AUAAeABoAHgAeAB4AHgAeAB4AHgAeAB4ATwAeAFAAGwAeAB4AUABQAFAAUABQAB4AHgAeAB0AHQAeAFAAHgBQAB4AUAAeAFAATwBQAFAAHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AUABQAFAAUABPAE8AUABQAFAAUABQAE8AUABQAE8AUABPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAE8ATwBPAE8ATwBPAE8ATwBPAE8AUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAATwAeAB4AKwArACsAKwAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB0AHQAeAB4AHgAdAB0AHgAeAB0AHgAeAB4AHQAeAB0AGwAbAB4AHQAeAB4AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB0AHgAdAB4AHQAdAB0AHQAdAB0AHgAdAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAdAB0AHQAdAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAlACUAHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB0AHQAeAB4AHgAeAB0AHQAdAB4AHgAdAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB0AHQAeAB4AHQAeAB4AHgAeAB0AHQAeAB4AHgAeACUAJQAdAB0AJQAeACUAJQAlACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHQAdAB0AHgAdACUAHQAdAB4AHQAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHQAdAB0AHQAlAB4AJQAlACUAHQAlACUAHQAdAB0AJQAlAB0AHQAlAB0AHQAlACUAJQAeAB0AHgAeAB4AHgAdAB0AJQAdAB0AHQAdAB0AHQAlACUAJQAlACUAHQAlACUAIAAlAB0AHQAlACUAJQAlACUAJQAlACUAHgAeAB4AJQAlACAAIAAgACAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeABcAFwAXABcAFwAXAB4AEwATACUAHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACUAJQBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwArACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAE8ATwBPAE8ATwBPAE8ATwAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeACsAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUAArACsAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQBQAFAAUABQACsAKwArACsAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAABAAEAAQAKwAEAAQAKwArACsAKwArAAQABAAEAAQAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsABAAEAAQAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsADQANAA0ADQANAA0ADQANAB4AKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAUABQAFAAUABQAA0ADQANAA0ADQANABQAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwANAA0ADQANAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAeAAQABAAEAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLACsADQArAB4AKwArAAQABAAEAAQAUABQAB4AUAArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwAEAAQABAAEAAQABAAEAAQABAAOAA0ADQATABMAHgAeAB4ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0AUABQAFAAUAAEAAQAKwArAAQADQANAB4AUAArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXABcAA0ADQANACoASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUAArACsAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANACsADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEcARwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwAeAAQABAANAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAEAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUAArACsAUAArACsAUABQACsAKwBQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAeAB4ADQANAA0ADQAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAArAAQABAArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAEAAQABAAEAAQABAAEACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAFgAWAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAKwBQACsAKwArACsAKwArAFAAKwArACsAKwBQACsAUAArAFAAKwBQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQACsAUAArAFAAKwBQACsAUABQACsAUAArACsAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAUABQAFAAUAArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUAArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAlACUAJQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeACUAJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeACUAJQAlACUAJQAeACUAJQAlACUAJQAgACAAIAAlACUAIAAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIQAhACEAIQAhACUAJQAgACAAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAIAAlACUAJQAlACAAJQAgACAAIAAgACAAIAAgACAAIAAlACUAJQAgACUAJQAlACUAIAAgACAAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeACUAHgAlAB4AJQAlACUAJQAlACAAJQAlACUAJQAeACUAHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAIAAgACAAIAAgAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFwAXABcAFQAVABUAHgAeAB4AHgAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAlACAAIAAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsA';\r\n\r\n    /* @flow */\r\n    var LETTER_NUMBER_MODIFIER = 50;\r\n    // Non-tailorable Line Breaking Classes\r\n    var BK = 1; //  Cause a line break (after)\r\n    var CR = 2; //  Cause a line break (after), except between CR and LF\r\n    var LF = 3; //  Cause a line break (after)\r\n    var CM = 4; //  Prohibit a line break between the character and the preceding character\r\n    var NL = 5; //  Cause a line break (after)\r\n    var WJ = 7; //  Prohibit line breaks before and after\r\n    var ZW = 8; //  Provide a break opportunity\r\n    var GL = 9; //  Prohibit line breaks before and after\r\n    var SP = 10; // Enable indirect line breaks\r\n    var ZWJ = 11; // Prohibit line breaks within joiner sequences\r\n    // Break Opportunities\r\n    var B2 = 12; //  Provide a line break opportunity before and after the character\r\n    var BA = 13; //  Generally provide a line break opportunity after the character\r\n    var BB = 14; //  Generally provide a line break opportunity before the character\r\n    var HY = 15; //  Provide a line break opportunity after the character, except in numeric context\r\n    var CB = 16; //   Provide a line break opportunity contingent on additional information\r\n    // Characters Prohibiting Certain Breaks\r\n    var CL = 17; //  Prohibit line breaks before\r\n    var CP = 18; //  Prohibit line breaks before\r\n    var EX = 19; //  Prohibit line breaks before\r\n    var IN = 20; //  Allow only indirect line breaks between pairs\r\n    var NS = 21; //  Allow only indirect line breaks before\r\n    var OP = 22; //  Prohibit line breaks after\r\n    var QU = 23; //  Act like they are both opening and closing\r\n    // Numeric Context\r\n    var IS = 24; //  Prevent breaks after any and before numeric\r\n    var NU = 25; //  Form numeric expressions for line breaking purposes\r\n    var PO = 26; //  Do not break following a numeric expression\r\n    var PR = 27; //  Do not break in front of a numeric expression\r\n    var SY = 28; //  Prevent a break before; and allow a break after\r\n    // Other Characters\r\n    var AI = 29; //  Act like AL when the resolvedEAW is N; otherwise; act as ID\r\n    var AL = 30; //  Are alphabetic characters or symbols that are used with alphabetic characters\r\n    var CJ = 31; //  Treat as NS or ID for strict or normal breaking.\r\n    var EB = 32; //  Do not break from following Emoji Modifier\r\n    var EM = 33; //  Do not break from preceding Emoji Base\r\n    var H2 = 34; //  Form Korean syllable blocks\r\n    var H3 = 35; //  Form Korean syllable blocks\r\n    var HL = 36; //  Do not break around a following hyphen; otherwise act as Alphabetic\r\n    var ID = 37; //  Break before or after; except in some numeric context\r\n    var JL = 38; //  Form Korean syllable blocks\r\n    var JV = 39; //  Form Korean syllable blocks\r\n    var JT = 40; //  Form Korean syllable blocks\r\n    var RI = 41; //  Keep pairs together. For pairs; break before and after other classes\r\n    var SA = 42; //  Provide a line break opportunity contingent on additional, language-specific context analysis\r\n    var XX = 43; //  Have as yet unknown line breaking behavior or unassigned code positions\r\n    var BREAK_MANDATORY = '!';\r\n    var BREAK_NOT_ALLOWED = '';\r\n    var BREAK_ALLOWED = '';\r\n    var UnicodeTrie = createTrieFromBase64(base64);\r\n    var ALPHABETICS = [AL, HL];\r\n    var HARD_LINE_BREAKS = [BK, CR, LF, NL];\r\n    var SPACE = [SP, ZW];\r\n    var PREFIX_POSTFIX = [PR, PO];\r\n    var LINE_BREAKS = HARD_LINE_BREAKS.concat(SPACE);\r\n    var KOREAN_SYLLABLE_BLOCK = [JL, JV, JT, H2, H3];\r\n    var HYPHEN = [HY, BA];\r\n    var codePointsToCharacterClasses = function (codePoints, lineBreak) {\r\n        if (lineBreak === void 0) { lineBreak = 'strict'; }\r\n        var types = [];\r\n        var indicies = [];\r\n        var categories = [];\r\n        codePoints.forEach(function (codePoint, index) {\r\n            var classType = UnicodeTrie.get(codePoint);\r\n            if (classType > LETTER_NUMBER_MODIFIER) {\r\n                categories.push(true);\r\n                classType -= LETTER_NUMBER_MODIFIER;\r\n            }\r\n            else {\r\n                categories.push(false);\r\n            }\r\n            if (['normal', 'auto', 'loose'].indexOf(lineBreak) !== -1) {\r\n                // U+2010,  U+2013,  U+301C,  U+30A0\r\n                if ([0x2010, 0x2013, 0x301c, 0x30a0].indexOf(codePoint) !== -1) {\r\n                    indicies.push(index);\r\n                    return types.push(CB);\r\n                }\r\n            }\r\n            if (classType === CM || classType === ZWJ) {\r\n                // LB10 Treat any remaining combining mark or ZWJ as AL.\r\n                if (index === 0) {\r\n                    indicies.push(index);\r\n                    return types.push(AL);\r\n                }\r\n                // LB9 Do not break a combining character sequence; treat it as if it has the line breaking class of\r\n                // the base character in all of the following rules. Treat ZWJ as if it were CM.\r\n                var prev = types[index - 1];\r\n                if (LINE_BREAKS.indexOf(prev) === -1) {\r\n                    indicies.push(indicies[index - 1]);\r\n                    return types.push(prev);\r\n                }\r\n                indicies.push(index);\r\n                return types.push(AL);\r\n            }\r\n            indicies.push(index);\r\n            if (classType === CJ) {\r\n                return types.push(lineBreak === 'strict' ? NS : ID);\r\n            }\r\n            if (classType === SA) {\r\n                return types.push(AL);\r\n            }\r\n            if (classType === AI) {\r\n                return types.push(AL);\r\n            }\r\n            // For supplementary characters, a useful default is to treat characters in the range 10000..1FFFD as AL\r\n            // and characters in the ranges 20000..2FFFD and 30000..3FFFD as ID, until the implementation can be revised\r\n            // to take into account the actual line breaking properties for these characters.\r\n            if (classType === XX) {\r\n                if ((codePoint >= 0x20000 && codePoint <= 0x2fffd) || (codePoint >= 0x30000 && codePoint <= 0x3fffd)) {\r\n                    return types.push(ID);\r\n                }\r\n                else {\r\n                    return types.push(AL);\r\n                }\r\n            }\r\n            types.push(classType);\r\n        });\r\n        return [indicies, types, categories];\r\n    };\r\n    var isAdjacentWithSpaceIgnored = function (a, b, currentIndex, classTypes) {\r\n        var current = classTypes[currentIndex];\r\n        if (Array.isArray(a) ? a.indexOf(current) !== -1 : a === current) {\r\n            var i = currentIndex;\r\n            while (i <= classTypes.length) {\r\n                i++;\r\n                var next = classTypes[i];\r\n                if (next === b) {\r\n                    return true;\r\n                }\r\n                if (next !== SP) {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (current === SP) {\r\n            var i = currentIndex;\r\n            while (i > 0) {\r\n                i--;\r\n                var prev = classTypes[i];\r\n                if (Array.isArray(a) ? a.indexOf(prev) !== -1 : a === prev) {\r\n                    var n = currentIndex;\r\n                    while (n <= classTypes.length) {\r\n                        n++;\r\n                        var next = classTypes[n];\r\n                        if (next === b) {\r\n                            return true;\r\n                        }\r\n                        if (next !== SP) {\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                if (prev !== SP) {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    var previousNonSpaceClassType = function (currentIndex, classTypes) {\r\n        var i = currentIndex;\r\n        while (i >= 0) {\r\n            var type = classTypes[i];\r\n            if (type === SP) {\r\n                i--;\r\n            }\r\n            else {\r\n                return type;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    var _lineBreakAtIndex = function (codePoints, classTypes, indicies, index, forbiddenBreaks) {\r\n        if (indicies[index] === 0) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        var currentIndex = index - 1;\r\n        if (Array.isArray(forbiddenBreaks) && forbiddenBreaks[currentIndex] === true) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        var beforeIndex = currentIndex - 1;\r\n        var afterIndex = currentIndex + 1;\r\n        var current = classTypes[currentIndex];\r\n        // LB4 Always break after hard line breaks.\r\n        // LB5 Treat CR followed by LF, as well as CR, LF, and NL as hard line breaks.\r\n        var before = beforeIndex >= 0 ? classTypes[beforeIndex] : 0;\r\n        var next = classTypes[afterIndex];\r\n        if (current === CR && next === LF) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        if (HARD_LINE_BREAKS.indexOf(current) !== -1) {\r\n            return BREAK_MANDATORY;\r\n        }\r\n        // LB6 Do not break before hard line breaks.\r\n        if (HARD_LINE_BREAKS.indexOf(next) !== -1) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB7 Do not break before spaces or zero width space.\r\n        if (SPACE.indexOf(next) !== -1) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB8 Break before any character following a zero-width space, even if one or more spaces intervene.\r\n        if (previousNonSpaceClassType(currentIndex, classTypes) === ZW) {\r\n            return BREAK_ALLOWED;\r\n        }\r\n        // LB8a Do not break between a zero width joiner and an ideograph, emoji base or emoji modifier.\r\n        if (UnicodeTrie.get(codePoints[currentIndex]) === ZWJ && (next === ID || next === EB || next === EM)) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB11 Do not break before or after Word joiner and related characters.\r\n        if (current === WJ || next === WJ) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB12 Do not break after NBSP and related characters.\r\n        if (current === GL) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB12a Do not break before NBSP and related characters, except after spaces and hyphens.\r\n        if ([SP, BA, HY].indexOf(current) === -1 && next === GL) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB13 Do not break before ] or ! or ; or /, even after spaces.\r\n        if ([CL, CP, EX, IS, SY].indexOf(next) !== -1) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB14 Do not break after [, even after spaces.\r\n        if (previousNonSpaceClassType(currentIndex, classTypes) === OP) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB15 Do not break within [, even with intervening spaces.\r\n        if (isAdjacentWithSpaceIgnored(QU, OP, currentIndex, classTypes)) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB16 Do not break between closing punctuation and a nonstarter (lb=NS), even with intervening spaces.\r\n        if (isAdjacentWithSpaceIgnored([CL, CP], NS, currentIndex, classTypes)) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB17 Do not break within , even with intervening spaces.\r\n        if (isAdjacentWithSpaceIgnored(B2, B2, currentIndex, classTypes)) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB18 Break after spaces.\r\n        if (current === SP) {\r\n            return BREAK_ALLOWED;\r\n        }\r\n        // LB19 Do not break before or after quotation marks, such as   .\r\n        if (current === QU || next === QU) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB20 Break before and after unresolved CB.\r\n        if (next === CB || current === CB) {\r\n            return BREAK_ALLOWED;\r\n        }\r\n        // LB21 Do not break before hyphen-minus, other hyphens, fixed-width spaces, small kana, and other non-starters, or after acute accents.\r\n        if ([BA, HY, NS].indexOf(next) !== -1 || current === BB) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB21a Don't break after Hebrew + Hyphen.\r\n        if (before === HL && HYPHEN.indexOf(current) !== -1) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB21b Dont break between Solidus and Hebrew letters.\r\n        if (current === SY && next === HL) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB22 Do not break between two ellipses, or between letters, numbers or exclamations and ellipsis.\r\n        if (next === IN && ALPHABETICS.concat(IN, EX, NU, ID, EB, EM).indexOf(current) !== -1) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB23 Do not break between digits and letters.\r\n        if ((ALPHABETICS.indexOf(next) !== -1 && current === NU) || (ALPHABETICS.indexOf(current) !== -1 && next === NU)) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB23a Do not break between numeric prefixes and ideographs, or between ideographs and numeric postfixes.\r\n        if ((current === PR && [ID, EB, EM].indexOf(next) !== -1) ||\r\n            ([ID, EB, EM].indexOf(current) !== -1 && next === PO)) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB24 Do not break between numeric prefix/postfix and letters, or between letters and prefix/postfix.\r\n        if ((ALPHABETICS.indexOf(current) !== -1 && PREFIX_POSTFIX.indexOf(next) !== -1) ||\r\n            (PREFIX_POSTFIX.indexOf(current) !== -1 && ALPHABETICS.indexOf(next) !== -1)) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB25 Do not break between the following pairs of classes relevant to numbers:\r\n        if (\r\n        // (PR | PO)  ( OP | HY )? NU\r\n        ([PR, PO].indexOf(current) !== -1 &&\r\n            (next === NU || ([OP, HY].indexOf(next) !== -1 && classTypes[afterIndex + 1] === NU))) ||\r\n            // ( OP | HY )  NU\r\n            ([OP, HY].indexOf(current) !== -1 && next === NU) ||\r\n            // NU \t(NU | SY | IS)\r\n            (current === NU && [NU, SY, IS].indexOf(next) !== -1)) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // NU (NU | SY | IS)*  (NU | SY | IS | CL | CP)\r\n        if ([NU, SY, IS, CL, CP].indexOf(next) !== -1) {\r\n            var prevIndex = currentIndex;\r\n            while (prevIndex >= 0) {\r\n                var type = classTypes[prevIndex];\r\n                if (type === NU) {\r\n                    return BREAK_NOT_ALLOWED;\r\n                }\r\n                else if ([SY, IS].indexOf(type) !== -1) {\r\n                    prevIndex--;\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // NU (NU | SY | IS)* (CL | CP)?  (PO | PR))\r\n        if ([PR, PO].indexOf(next) !== -1) {\r\n            var prevIndex = [CL, CP].indexOf(current) !== -1 ? beforeIndex : currentIndex;\r\n            while (prevIndex >= 0) {\r\n                var type = classTypes[prevIndex];\r\n                if (type === NU) {\r\n                    return BREAK_NOT_ALLOWED;\r\n                }\r\n                else if ([SY, IS].indexOf(type) !== -1) {\r\n                    prevIndex--;\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // LB26 Do not break a Korean syllable.\r\n        if ((JL === current && [JL, JV, H2, H3].indexOf(next) !== -1) ||\r\n            ([JV, H2].indexOf(current) !== -1 && [JV, JT].indexOf(next) !== -1) ||\r\n            ([JT, H3].indexOf(current) !== -1 && next === JT)) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB27 Treat a Korean Syllable Block the same as ID.\r\n        if ((KOREAN_SYLLABLE_BLOCK.indexOf(current) !== -1 && [IN, PO].indexOf(next) !== -1) ||\r\n            (KOREAN_SYLLABLE_BLOCK.indexOf(next) !== -1 && current === PR)) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB28 Do not break between alphabetics (at).\r\n        if (ALPHABETICS.indexOf(current) !== -1 && ALPHABETICS.indexOf(next) !== -1) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB29 Do not break between numeric punctuation and alphabetics (e.g.).\r\n        if (current === IS && ALPHABETICS.indexOf(next) !== -1) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB30 Do not break between letters, numbers, or ordinary symbols and opening or closing parentheses.\r\n        if ((ALPHABETICS.concat(NU).indexOf(current) !== -1 && next === OP) ||\r\n            (ALPHABETICS.concat(NU).indexOf(next) !== -1 && current === CP)) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        // LB30a Break between two regional indicator symbols if and only if there are an even number of regional\r\n        // indicators preceding the position of the break.\r\n        if (current === RI && next === RI) {\r\n            var i = indicies[currentIndex];\r\n            var count = 1;\r\n            while (i > 0) {\r\n                i--;\r\n                if (classTypes[i] === RI) {\r\n                    count++;\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n            if (count % 2 !== 0) {\r\n                return BREAK_NOT_ALLOWED;\r\n            }\r\n        }\r\n        // LB30b Do not break between an emoji base and an emoji modifier.\r\n        if (current === EB && next === EM) {\r\n            return BREAK_NOT_ALLOWED;\r\n        }\r\n        return BREAK_ALLOWED;\r\n    };\r\n    var cssFormattedClasses = function (codePoints, options) {\r\n        if (!options) {\r\n            options = { lineBreak: 'normal', wordBreak: 'normal' };\r\n        }\r\n        var _a = codePointsToCharacterClasses(codePoints, options.lineBreak), indicies = _a[0], classTypes = _a[1], isLetterNumber = _a[2];\r\n        if (options.wordBreak === 'break-all' || options.wordBreak === 'break-word') {\r\n            classTypes = classTypes.map(function (type) { return ([NU, AL, SA].indexOf(type) !== -1 ? ID : type); });\r\n        }\r\n        var forbiddenBreakpoints = options.wordBreak === 'keep-all'\r\n            ? isLetterNumber.map(function (letterNumber, i) {\r\n                return letterNumber && codePoints[i] >= 0x4e00 && codePoints[i] <= 0x9fff;\r\n            })\r\n            : undefined;\r\n        return [indicies, classTypes, forbiddenBreakpoints];\r\n    };\r\n    var Break = /** @class */ (function () {\r\n        function Break(codePoints, lineBreak, start, end) {\r\n            this.codePoints = codePoints;\r\n            this.required = lineBreak === BREAK_MANDATORY;\r\n            this.start = start;\r\n            this.end = end;\r\n        }\r\n        Break.prototype.slice = function () {\r\n            return fromCodePoint.apply(void 0, this.codePoints.slice(this.start, this.end));\r\n        };\r\n        return Break;\r\n    }());\r\n    var LineBreaker = function (str, options) {\r\n        var codePoints = toCodePoints(str);\r\n        var _a = cssFormattedClasses(codePoints, options), indicies = _a[0], classTypes = _a[1], forbiddenBreakpoints = _a[2];\r\n        var length = codePoints.length;\r\n        var lastEnd = 0;\r\n        var nextIndex = 0;\r\n        return {\r\n            next: function () {\r\n                if (nextIndex >= length) {\r\n                    return { done: true, value: null };\r\n                }\r\n                var lineBreak = BREAK_NOT_ALLOWED;\r\n                while (nextIndex < length &&\r\n                    (lineBreak = _lineBreakAtIndex(codePoints, classTypes, indicies, ++nextIndex, forbiddenBreakpoints)) ===\r\n                        BREAK_NOT_ALLOWED) { }\r\n                if (lineBreak !== BREAK_NOT_ALLOWED || nextIndex === length) {\r\n                    var value = new Break(codePoints, lineBreak, lastEnd, nextIndex);\r\n                    lastEnd = nextIndex;\r\n                    return { value: value, done: false };\r\n                }\r\n                return { done: true, value: null };\r\n            },\r\n        };\r\n    };\r\n\r\n    // https://www.w3.org/TR/css-syntax-3\r\n    var TokenType;\r\n    (function (TokenType) {\r\n        TokenType[TokenType[\"STRING_TOKEN\"] = 0] = \"STRING_TOKEN\";\r\n        TokenType[TokenType[\"BAD_STRING_TOKEN\"] = 1] = \"BAD_STRING_TOKEN\";\r\n        TokenType[TokenType[\"LEFT_PARENTHESIS_TOKEN\"] = 2] = \"LEFT_PARENTHESIS_TOKEN\";\r\n        TokenType[TokenType[\"RIGHT_PARENTHESIS_TOKEN\"] = 3] = \"RIGHT_PARENTHESIS_TOKEN\";\r\n        TokenType[TokenType[\"COMMA_TOKEN\"] = 4] = \"COMMA_TOKEN\";\r\n        TokenType[TokenType[\"HASH_TOKEN\"] = 5] = \"HASH_TOKEN\";\r\n        TokenType[TokenType[\"DELIM_TOKEN\"] = 6] = \"DELIM_TOKEN\";\r\n        TokenType[TokenType[\"AT_KEYWORD_TOKEN\"] = 7] = \"AT_KEYWORD_TOKEN\";\r\n        TokenType[TokenType[\"PREFIX_MATCH_TOKEN\"] = 8] = \"PREFIX_MATCH_TOKEN\";\r\n        TokenType[TokenType[\"DASH_MATCH_TOKEN\"] = 9] = \"DASH_MATCH_TOKEN\";\r\n        TokenType[TokenType[\"INCLUDE_MATCH_TOKEN\"] = 10] = \"INCLUDE_MATCH_TOKEN\";\r\n        TokenType[TokenType[\"LEFT_CURLY_BRACKET_TOKEN\"] = 11] = \"LEFT_CURLY_BRACKET_TOKEN\";\r\n        TokenType[TokenType[\"RIGHT_CURLY_BRACKET_TOKEN\"] = 12] = \"RIGHT_CURLY_BRACKET_TOKEN\";\r\n        TokenType[TokenType[\"SUFFIX_MATCH_TOKEN\"] = 13] = \"SUFFIX_MATCH_TOKEN\";\r\n        TokenType[TokenType[\"SUBSTRING_MATCH_TOKEN\"] = 14] = \"SUBSTRING_MATCH_TOKEN\";\r\n        TokenType[TokenType[\"DIMENSION_TOKEN\"] = 15] = \"DIMENSION_TOKEN\";\r\n        TokenType[TokenType[\"PERCENTAGE_TOKEN\"] = 16] = \"PERCENTAGE_TOKEN\";\r\n        TokenType[TokenType[\"NUMBER_TOKEN\"] = 17] = \"NUMBER_TOKEN\";\r\n        TokenType[TokenType[\"FUNCTION\"] = 18] = \"FUNCTION\";\r\n        TokenType[TokenType[\"FUNCTION_TOKEN\"] = 19] = \"FUNCTION_TOKEN\";\r\n        TokenType[TokenType[\"IDENT_TOKEN\"] = 20] = \"IDENT_TOKEN\";\r\n        TokenType[TokenType[\"COLUMN_TOKEN\"] = 21] = \"COLUMN_TOKEN\";\r\n        TokenType[TokenType[\"URL_TOKEN\"] = 22] = \"URL_TOKEN\";\r\n        TokenType[TokenType[\"BAD_URL_TOKEN\"] = 23] = \"BAD_URL_TOKEN\";\r\n        TokenType[TokenType[\"CDC_TOKEN\"] = 24] = \"CDC_TOKEN\";\r\n        TokenType[TokenType[\"CDO_TOKEN\"] = 25] = \"CDO_TOKEN\";\r\n        TokenType[TokenType[\"COLON_TOKEN\"] = 26] = \"COLON_TOKEN\";\r\n        TokenType[TokenType[\"SEMICOLON_TOKEN\"] = 27] = \"SEMICOLON_TOKEN\";\r\n        TokenType[TokenType[\"LEFT_SQUARE_BRACKET_TOKEN\"] = 28] = \"LEFT_SQUARE_BRACKET_TOKEN\";\r\n        TokenType[TokenType[\"RIGHT_SQUARE_BRACKET_TOKEN\"] = 29] = \"RIGHT_SQUARE_BRACKET_TOKEN\";\r\n        TokenType[TokenType[\"UNICODE_RANGE_TOKEN\"] = 30] = \"UNICODE_RANGE_TOKEN\";\r\n        TokenType[TokenType[\"WHITESPACE_TOKEN\"] = 31] = \"WHITESPACE_TOKEN\";\r\n        TokenType[TokenType[\"EOF_TOKEN\"] = 32] = \"EOF_TOKEN\";\r\n    })(TokenType || (TokenType = {}));\r\n    var FLAG_UNRESTRICTED = 1 << 0;\r\n    var FLAG_ID = 1 << 1;\r\n    var FLAG_INTEGER = 1 << 2;\r\n    var FLAG_NUMBER = 1 << 3;\r\n    var LINE_FEED = 0x000a;\r\n    var SOLIDUS = 0x002f;\r\n    var REVERSE_SOLIDUS = 0x005c;\r\n    var CHARACTER_TABULATION = 0x0009;\r\n    var SPACE$1 = 0x0020;\r\n    var QUOTATION_MARK = 0x0022;\r\n    var EQUALS_SIGN = 0x003d;\r\n    var NUMBER_SIGN = 0x0023;\r\n    var DOLLAR_SIGN = 0x0024;\r\n    var PERCENTAGE_SIGN = 0x0025;\r\n    var APOSTROPHE = 0x0027;\r\n    var LEFT_PARENTHESIS = 0x0028;\r\n    var RIGHT_PARENTHESIS = 0x0029;\r\n    var LOW_LINE = 0x005f;\r\n    var HYPHEN_MINUS = 0x002d;\r\n    var EXCLAMATION_MARK = 0x0021;\r\n    var LESS_THAN_SIGN = 0x003c;\r\n    var GREATER_THAN_SIGN = 0x003e;\r\n    var COMMERCIAL_AT = 0x0040;\r\n    var LEFT_SQUARE_BRACKET = 0x005b;\r\n    var RIGHT_SQUARE_BRACKET = 0x005d;\r\n    var CIRCUMFLEX_ACCENT = 0x003d;\r\n    var LEFT_CURLY_BRACKET = 0x007b;\r\n    var QUESTION_MARK = 0x003f;\r\n    var RIGHT_CURLY_BRACKET = 0x007d;\r\n    var VERTICAL_LINE = 0x007c;\r\n    var TILDE = 0x007e;\r\n    var CONTROL = 0x0080;\r\n    var REPLACEMENT_CHARACTER = 0xfffd;\r\n    var ASTERISK = 0x002a;\r\n    var PLUS_SIGN = 0x002b;\r\n    var COMMA = 0x002c;\r\n    var COLON = 0x003a;\r\n    var SEMICOLON = 0x003b;\r\n    var FULL_STOP = 0x002e;\r\n    var NULL = 0x0000;\r\n    var BACKSPACE = 0x0008;\r\n    var LINE_TABULATION = 0x000b;\r\n    var SHIFT_OUT = 0x000e;\r\n    var INFORMATION_SEPARATOR_ONE = 0x001f;\r\n    var DELETE = 0x007f;\r\n    var EOF = -1;\r\n    var ZERO = 0x0030;\r\n    var a = 0x0061;\r\n    var e = 0x0065;\r\n    var f = 0x0066;\r\n    var u = 0x0075;\r\n    var z = 0x007a;\r\n    var A = 0x0041;\r\n    var E = 0x0045;\r\n    var F = 0x0046;\r\n    var U = 0x0055;\r\n    var Z = 0x005a;\r\n    var isDigit = function (codePoint) { return codePoint >= ZERO && codePoint <= 0x0039; };\r\n    var isSurrogateCodePoint = function (codePoint) { return codePoint >= 0xd800 && codePoint <= 0xdfff; };\r\n    var isHex = function (codePoint) {\r\n        return isDigit(codePoint) || (codePoint >= A && codePoint <= F) || (codePoint >= a && codePoint <= f);\r\n    };\r\n    var isLowerCaseLetter = function (codePoint) { return codePoint >= a && codePoint <= z; };\r\n    var isUpperCaseLetter = function (codePoint) { return codePoint >= A && codePoint <= Z; };\r\n    var isLetter = function (codePoint) { return isLowerCaseLetter(codePoint) || isUpperCaseLetter(codePoint); };\r\n    var isNonASCIICodePoint = function (codePoint) { return codePoint >= CONTROL; };\r\n    var isWhiteSpace = function (codePoint) {\r\n        return codePoint === LINE_FEED || codePoint === CHARACTER_TABULATION || codePoint === SPACE$1;\r\n    };\r\n    var isNameStartCodePoint = function (codePoint) {\r\n        return isLetter(codePoint) || isNonASCIICodePoint(codePoint) || codePoint === LOW_LINE;\r\n    };\r\n    var isNameCodePoint = function (codePoint) {\r\n        return isNameStartCodePoint(codePoint) || isDigit(codePoint) || codePoint === HYPHEN_MINUS;\r\n    };\r\n    var isNonPrintableCodePoint = function (codePoint) {\r\n        return ((codePoint >= NULL && codePoint <= BACKSPACE) ||\r\n            codePoint === LINE_TABULATION ||\r\n            (codePoint >= SHIFT_OUT && codePoint <= INFORMATION_SEPARATOR_ONE) ||\r\n            codePoint === DELETE);\r\n    };\r\n    var isValidEscape = function (c1, c2) {\r\n        if (c1 !== REVERSE_SOLIDUS) {\r\n            return false;\r\n        }\r\n        return c2 !== LINE_FEED;\r\n    };\r\n    var isIdentifierStart = function (c1, c2, c3) {\r\n        if (c1 === HYPHEN_MINUS) {\r\n            return isNameStartCodePoint(c2) || isValidEscape(c2, c3);\r\n        }\r\n        else if (isNameStartCodePoint(c1)) {\r\n            return true;\r\n        }\r\n        else if (c1 === REVERSE_SOLIDUS && isValidEscape(c1, c2)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    var isNumberStart = function (c1, c2, c3) {\r\n        if (c1 === PLUS_SIGN || c1 === HYPHEN_MINUS) {\r\n            if (isDigit(c2)) {\r\n                return true;\r\n            }\r\n            return c2 === FULL_STOP && isDigit(c3);\r\n        }\r\n        if (c1 === FULL_STOP) {\r\n            return isDigit(c2);\r\n        }\r\n        return isDigit(c1);\r\n    };\r\n    var stringToNumber = function (codePoints) {\r\n        var c = 0;\r\n        var sign = 1;\r\n        if (codePoints[c] === PLUS_SIGN || codePoints[c] === HYPHEN_MINUS) {\r\n            if (codePoints[c] === HYPHEN_MINUS) {\r\n                sign = -1;\r\n            }\r\n            c++;\r\n        }\r\n        var integers = [];\r\n        while (isDigit(codePoints[c])) {\r\n            integers.push(codePoints[c++]);\r\n        }\r\n        var int = integers.length ? parseInt(fromCodePoint.apply(void 0, integers), 10) : 0;\r\n        if (codePoints[c] === FULL_STOP) {\r\n            c++;\r\n        }\r\n        var fraction = [];\r\n        while (isDigit(codePoints[c])) {\r\n            fraction.push(codePoints[c++]);\r\n        }\r\n        var fracd = fraction.length;\r\n        var frac = fracd ? parseInt(fromCodePoint.apply(void 0, fraction), 10) : 0;\r\n        if (codePoints[c] === E || codePoints[c] === e) {\r\n            c++;\r\n        }\r\n        var expsign = 1;\r\n        if (codePoints[c] === PLUS_SIGN || codePoints[c] === HYPHEN_MINUS) {\r\n            if (codePoints[c] === HYPHEN_MINUS) {\r\n                expsign = -1;\r\n            }\r\n            c++;\r\n        }\r\n        var exponent = [];\r\n        while (isDigit(codePoints[c])) {\r\n            exponent.push(codePoints[c++]);\r\n        }\r\n        var exp = exponent.length ? parseInt(fromCodePoint.apply(void 0, exponent), 10) : 0;\r\n        return sign * (int + frac * Math.pow(10, -fracd)) * Math.pow(10, expsign * exp);\r\n    };\r\n    var LEFT_PARENTHESIS_TOKEN = {\r\n        type: TokenType.LEFT_PARENTHESIS_TOKEN\r\n    };\r\n    var RIGHT_PARENTHESIS_TOKEN = {\r\n        type: TokenType.RIGHT_PARENTHESIS_TOKEN\r\n    };\r\n    var COMMA_TOKEN = { type: TokenType.COMMA_TOKEN };\r\n    var SUFFIX_MATCH_TOKEN = { type: TokenType.SUFFIX_MATCH_TOKEN };\r\n    var PREFIX_MATCH_TOKEN = { type: TokenType.PREFIX_MATCH_TOKEN };\r\n    var COLUMN_TOKEN = { type: TokenType.COLUMN_TOKEN };\r\n    var DASH_MATCH_TOKEN = { type: TokenType.DASH_MATCH_TOKEN };\r\n    var INCLUDE_MATCH_TOKEN = { type: TokenType.INCLUDE_MATCH_TOKEN };\r\n    var LEFT_CURLY_BRACKET_TOKEN = {\r\n        type: TokenType.LEFT_CURLY_BRACKET_TOKEN\r\n    };\r\n    var RIGHT_CURLY_BRACKET_TOKEN = {\r\n        type: TokenType.RIGHT_CURLY_BRACKET_TOKEN\r\n    };\r\n    var SUBSTRING_MATCH_TOKEN = { type: TokenType.SUBSTRING_MATCH_TOKEN };\r\n    var BAD_URL_TOKEN = { type: TokenType.BAD_URL_TOKEN };\r\n    var BAD_STRING_TOKEN = { type: TokenType.BAD_STRING_TOKEN };\r\n    var CDO_TOKEN = { type: TokenType.CDO_TOKEN };\r\n    var CDC_TOKEN = { type: TokenType.CDC_TOKEN };\r\n    var COLON_TOKEN = { type: TokenType.COLON_TOKEN };\r\n    var SEMICOLON_TOKEN = { type: TokenType.SEMICOLON_TOKEN };\r\n    var LEFT_SQUARE_BRACKET_TOKEN = {\r\n        type: TokenType.LEFT_SQUARE_BRACKET_TOKEN\r\n    };\r\n    var RIGHT_SQUARE_BRACKET_TOKEN = {\r\n        type: TokenType.RIGHT_SQUARE_BRACKET_TOKEN\r\n    };\r\n    var WHITESPACE_TOKEN = { type: TokenType.WHITESPACE_TOKEN };\r\n    var EOF_TOKEN = { type: TokenType.EOF_TOKEN };\r\n    var Tokenizer = /** @class */ (function () {\r\n        function Tokenizer() {\r\n            this._value = [];\r\n        }\r\n        Tokenizer.prototype.write = function (chunk) {\r\n            this._value = this._value.concat(toCodePoints(chunk));\r\n        };\r\n        Tokenizer.prototype.read = function () {\r\n            var tokens = [];\r\n            var token = this.consumeToken();\r\n            while (token !== EOF_TOKEN) {\r\n                tokens.push(token);\r\n                token = this.consumeToken();\r\n            }\r\n            return tokens;\r\n        };\r\n        Tokenizer.prototype.consumeToken = function () {\r\n            var codePoint = this.consumeCodePoint();\r\n            switch (codePoint) {\r\n                case QUOTATION_MARK:\r\n                    return this.consumeStringToken(QUOTATION_MARK);\r\n                case NUMBER_SIGN:\r\n                    var c1 = this.peekCodePoint(0);\r\n                    var c2 = this.peekCodePoint(1);\r\n                    var c3 = this.peekCodePoint(2);\r\n                    if (isNameCodePoint(c1) || isValidEscape(c2, c3)) {\r\n                        var flags = isIdentifierStart(c1, c2, c3) ? FLAG_ID : FLAG_UNRESTRICTED;\r\n                        var value = this.consumeName();\r\n                        return { type: TokenType.HASH_TOKEN, value: value, flags: flags };\r\n                    }\r\n                    break;\r\n                case DOLLAR_SIGN:\r\n                    if (this.peekCodePoint(0) === EQUALS_SIGN) {\r\n                        this.consumeCodePoint();\r\n                        return SUFFIX_MATCH_TOKEN;\r\n                    }\r\n                    break;\r\n                case APOSTROPHE:\r\n                    return this.consumeStringToken(APOSTROPHE);\r\n                case LEFT_PARENTHESIS:\r\n                    return LEFT_PARENTHESIS_TOKEN;\r\n                case RIGHT_PARENTHESIS:\r\n                    return RIGHT_PARENTHESIS_TOKEN;\r\n                case ASTERISK:\r\n                    if (this.peekCodePoint(0) === EQUALS_SIGN) {\r\n                        this.consumeCodePoint();\r\n                        return SUBSTRING_MATCH_TOKEN;\r\n                    }\r\n                    break;\r\n                case PLUS_SIGN:\r\n                    if (isNumberStart(codePoint, this.peekCodePoint(0), this.peekCodePoint(1))) {\r\n                        this.reconsumeCodePoint(codePoint);\r\n                        return this.consumeNumericToken();\r\n                    }\r\n                    break;\r\n                case COMMA:\r\n                    return COMMA_TOKEN;\r\n                case HYPHEN_MINUS:\r\n                    var e1 = codePoint;\r\n                    var e2 = this.peekCodePoint(0);\r\n                    var e3 = this.peekCodePoint(1);\r\n                    if (isNumberStart(e1, e2, e3)) {\r\n                        this.reconsumeCodePoint(codePoint);\r\n                        return this.consumeNumericToken();\r\n                    }\r\n                    if (isIdentifierStart(e1, e2, e3)) {\r\n                        this.reconsumeCodePoint(codePoint);\r\n                        return this.consumeIdentLikeToken();\r\n                    }\r\n                    if (e2 === HYPHEN_MINUS && e3 === GREATER_THAN_SIGN) {\r\n                        this.consumeCodePoint();\r\n                        this.consumeCodePoint();\r\n                        return CDC_TOKEN;\r\n                    }\r\n                    break;\r\n                case FULL_STOP:\r\n                    if (isNumberStart(codePoint, this.peekCodePoint(0), this.peekCodePoint(1))) {\r\n                        this.reconsumeCodePoint(codePoint);\r\n                        return this.consumeNumericToken();\r\n                    }\r\n                    break;\r\n                case SOLIDUS:\r\n                    if (this.peekCodePoint(0) === ASTERISK) {\r\n                        this.consumeCodePoint();\r\n                        while (true) {\r\n                            var c = this.consumeCodePoint();\r\n                            if (c === ASTERISK) {\r\n                                c = this.consumeCodePoint();\r\n                                if (c === SOLIDUS) {\r\n                                    return this.consumeToken();\r\n                                }\r\n                            }\r\n                            if (c === EOF) {\r\n                                return this.consumeToken();\r\n                            }\r\n                        }\r\n                    }\r\n                    break;\r\n                case COLON:\r\n                    return COLON_TOKEN;\r\n                case SEMICOLON:\r\n                    return SEMICOLON_TOKEN;\r\n                case LESS_THAN_SIGN:\r\n                    if (this.peekCodePoint(0) === EXCLAMATION_MARK &&\r\n                        this.peekCodePoint(1) === HYPHEN_MINUS &&\r\n                        this.peekCodePoint(2) === HYPHEN_MINUS) {\r\n                        this.consumeCodePoint();\r\n                        this.consumeCodePoint();\r\n                        return CDO_TOKEN;\r\n                    }\r\n                    break;\r\n                case COMMERCIAL_AT:\r\n                    var a1 = this.peekCodePoint(0);\r\n                    var a2 = this.peekCodePoint(1);\r\n                    var a3 = this.peekCodePoint(2);\r\n                    if (isIdentifierStart(a1, a2, a3)) {\r\n                        var value = this.consumeName();\r\n                        return { type: TokenType.AT_KEYWORD_TOKEN, value: value };\r\n                    }\r\n                    break;\r\n                case LEFT_SQUARE_BRACKET:\r\n                    return LEFT_SQUARE_BRACKET_TOKEN;\r\n                case REVERSE_SOLIDUS:\r\n                    if (isValidEscape(codePoint, this.peekCodePoint(0))) {\r\n                        this.reconsumeCodePoint(codePoint);\r\n                        return this.consumeIdentLikeToken();\r\n                    }\r\n                    break;\r\n                case RIGHT_SQUARE_BRACKET:\r\n                    return RIGHT_SQUARE_BRACKET_TOKEN;\r\n                case CIRCUMFLEX_ACCENT:\r\n                    if (this.peekCodePoint(0) === EQUALS_SIGN) {\r\n                        this.consumeCodePoint();\r\n                        return PREFIX_MATCH_TOKEN;\r\n                    }\r\n                    break;\r\n                case LEFT_CURLY_BRACKET:\r\n                    return LEFT_CURLY_BRACKET_TOKEN;\r\n                case RIGHT_CURLY_BRACKET:\r\n                    return RIGHT_CURLY_BRACKET_TOKEN;\r\n                case u:\r\n                case U:\r\n                    var u1 = this.peekCodePoint(0);\r\n                    var u2 = this.peekCodePoint(1);\r\n                    if (u1 === PLUS_SIGN && (isHex(u2) || u2 === QUESTION_MARK)) {\r\n                        this.consumeCodePoint();\r\n                        this.consumeUnicodeRangeToken();\r\n                    }\r\n                    this.reconsumeCodePoint(codePoint);\r\n                    return this.consumeIdentLikeToken();\r\n                case VERTICAL_LINE:\r\n                    if (this.peekCodePoint(0) === EQUALS_SIGN) {\r\n                        this.consumeCodePoint();\r\n                        return DASH_MATCH_TOKEN;\r\n                    }\r\n                    if (this.peekCodePoint(0) === VERTICAL_LINE) {\r\n                        this.consumeCodePoint();\r\n                        return COLUMN_TOKEN;\r\n                    }\r\n                    break;\r\n                case TILDE:\r\n                    if (this.peekCodePoint(0) === EQUALS_SIGN) {\r\n                        this.consumeCodePoint();\r\n                        return INCLUDE_MATCH_TOKEN;\r\n                    }\r\n                    break;\r\n                case EOF:\r\n                    return EOF_TOKEN;\r\n            }\r\n            if (isWhiteSpace(codePoint)) {\r\n                this.consumeWhiteSpace();\r\n                return WHITESPACE_TOKEN;\r\n            }\r\n            if (isDigit(codePoint)) {\r\n                this.reconsumeCodePoint(codePoint);\r\n                return this.consumeNumericToken();\r\n            }\r\n            if (isNameStartCodePoint(codePoint)) {\r\n                this.reconsumeCodePoint(codePoint);\r\n                return this.consumeIdentLikeToken();\r\n            }\r\n            return { type: TokenType.DELIM_TOKEN, value: fromCodePoint(codePoint) };\r\n        };\r\n        Tokenizer.prototype.consumeCodePoint = function () {\r\n            var value = this._value.shift();\r\n            return typeof value === 'undefined' ? -1 : value;\r\n        };\r\n        Tokenizer.prototype.reconsumeCodePoint = function (codePoint) {\r\n            this._value.unshift(codePoint);\r\n        };\r\n        Tokenizer.prototype.peekCodePoint = function (delta) {\r\n            if (delta >= this._value.length) {\r\n                return -1;\r\n            }\r\n            return this._value[delta];\r\n        };\r\n        Tokenizer.prototype.consumeUnicodeRangeToken = function () {\r\n            var digits = [];\r\n            var codePoint = this.consumeCodePoint();\r\n            while (isHex(codePoint) && digits.length < 6) {\r\n                digits.push(codePoint);\r\n                codePoint = this.consumeCodePoint();\r\n            }\r\n            var questionMarks = false;\r\n            while (codePoint === QUESTION_MARK && digits.length < 6) {\r\n                digits.push(codePoint);\r\n                codePoint = this.consumeCodePoint();\r\n                questionMarks = true;\r\n            }\r\n            if (questionMarks) {\r\n                var start_1 = parseInt(fromCodePoint.apply(void 0, digits.map(function (digit) { return (digit === QUESTION_MARK ? ZERO : digit); })), 16);\r\n                var end = parseInt(fromCodePoint.apply(void 0, digits.map(function (digit) { return (digit === QUESTION_MARK ? F : digit); })), 16);\r\n                return { type: TokenType.UNICODE_RANGE_TOKEN, start: start_1, end: end };\r\n            }\r\n            var start = parseInt(fromCodePoint.apply(void 0, digits), 16);\r\n            if (this.peekCodePoint(0) === HYPHEN_MINUS && isHex(this.peekCodePoint(1))) {\r\n                this.consumeCodePoint();\r\n                codePoint = this.consumeCodePoint();\r\n                var endDigits = [];\r\n                while (isHex(codePoint) && endDigits.length < 6) {\r\n                    endDigits.push(codePoint);\r\n                    codePoint = this.consumeCodePoint();\r\n                }\r\n                var end = parseInt(fromCodePoint.apply(void 0, endDigits), 16);\r\n                return { type: TokenType.UNICODE_RANGE_TOKEN, start: start, end: end };\r\n            }\r\n            else {\r\n                return { type: TokenType.UNICODE_RANGE_TOKEN, start: start, end: start };\r\n            }\r\n        };\r\n        Tokenizer.prototype.consumeIdentLikeToken = function () {\r\n            var value = this.consumeName();\r\n            if (value.toLowerCase() === 'url' && this.peekCodePoint(0) === LEFT_PARENTHESIS) {\r\n                this.consumeCodePoint();\r\n                return this.consumeUrlToken();\r\n            }\r\n            else if (this.peekCodePoint(0) === LEFT_PARENTHESIS) {\r\n                this.consumeCodePoint();\r\n                return { type: TokenType.FUNCTION_TOKEN, value: value };\r\n            }\r\n            return { type: TokenType.IDENT_TOKEN, value: value };\r\n        };\r\n        Tokenizer.prototype.consumeUrlToken = function () {\r\n            var value = [];\r\n            this.consumeWhiteSpace();\r\n            if (this.peekCodePoint(0) === EOF) {\r\n                return { type: TokenType.URL_TOKEN, value: '' };\r\n            }\r\n            var next = this.peekCodePoint(0);\r\n            if (next === APOSTROPHE || next === QUOTATION_MARK) {\r\n                var stringToken = this.consumeStringToken(this.consumeCodePoint());\r\n                if (stringToken.type === TokenType.STRING_TOKEN) {\r\n                    this.consumeWhiteSpace();\r\n                    if (this.peekCodePoint(0) === EOF || this.peekCodePoint(0) === RIGHT_PARENTHESIS) {\r\n                        this.consumeCodePoint();\r\n                        return { type: TokenType.URL_TOKEN, value: stringToken.value };\r\n                    }\r\n                }\r\n                this.consumeBadUrlRemnants();\r\n                return BAD_URL_TOKEN;\r\n            }\r\n            while (true) {\r\n                var codePoint = this.consumeCodePoint();\r\n                if (codePoint === EOF || codePoint === RIGHT_PARENTHESIS) {\r\n                    return { type: TokenType.URL_TOKEN, value: fromCodePoint.apply(void 0, value) };\r\n                }\r\n                else if (isWhiteSpace(codePoint)) {\r\n                    this.consumeWhiteSpace();\r\n                    if (this.peekCodePoint(0) === EOF || this.peekCodePoint(0) === RIGHT_PARENTHESIS) {\r\n                        this.consumeCodePoint();\r\n                        return { type: TokenType.URL_TOKEN, value: fromCodePoint.apply(void 0, value) };\r\n                    }\r\n                    this.consumeBadUrlRemnants();\r\n                    return BAD_URL_TOKEN;\r\n                }\r\n                else if (codePoint === QUOTATION_MARK ||\r\n                    codePoint === APOSTROPHE ||\r\n                    codePoint === LEFT_PARENTHESIS ||\r\n                    isNonPrintableCodePoint(codePoint)) {\r\n                    this.consumeBadUrlRemnants();\r\n                    return BAD_URL_TOKEN;\r\n                }\r\n                else if (codePoint === REVERSE_SOLIDUS) {\r\n                    if (isValidEscape(codePoint, this.peekCodePoint(0))) {\r\n                        value.push(this.consumeEscapedCodePoint());\r\n                    }\r\n                    else {\r\n                        this.consumeBadUrlRemnants();\r\n                        return BAD_URL_TOKEN;\r\n                    }\r\n                }\r\n                else {\r\n                    value.push(codePoint);\r\n                }\r\n            }\r\n        };\r\n        Tokenizer.prototype.consumeWhiteSpace = function () {\r\n            while (isWhiteSpace(this.peekCodePoint(0))) {\r\n                this.consumeCodePoint();\r\n            }\r\n        };\r\n        Tokenizer.prototype.consumeBadUrlRemnants = function () {\r\n            while (true) {\r\n                var codePoint = this.consumeCodePoint();\r\n                if (codePoint === RIGHT_PARENTHESIS || codePoint === EOF) {\r\n                    return;\r\n                }\r\n                if (isValidEscape(codePoint, this.peekCodePoint(0))) {\r\n                    this.consumeEscapedCodePoint();\r\n                }\r\n            }\r\n        };\r\n        Tokenizer.prototype.consumeStringSlice = function (count) {\r\n            var SLICE_STACK_SIZE = 60000;\r\n            var value = '';\r\n            while (count > 0) {\r\n                var amount = Math.min(SLICE_STACK_SIZE, count);\r\n                value += fromCodePoint.apply(void 0, this._value.splice(0, amount));\r\n                count -= amount;\r\n            }\r\n            this._value.shift();\r\n            return value;\r\n        };\r\n        Tokenizer.prototype.consumeStringToken = function (endingCodePoint) {\r\n            var value = '';\r\n            var i = 0;\r\n            do {\r\n                var codePoint = this._value[i];\r\n                if (codePoint === EOF || codePoint === undefined || codePoint === endingCodePoint) {\r\n                    value += this.consumeStringSlice(i);\r\n                    return { type: TokenType.STRING_TOKEN, value: value };\r\n                }\r\n                if (codePoint === LINE_FEED) {\r\n                    this._value.splice(0, i);\r\n                    return BAD_STRING_TOKEN;\r\n                }\r\n                if (codePoint === REVERSE_SOLIDUS) {\r\n                    var next = this._value[i + 1];\r\n                    if (next !== EOF && next !== undefined) {\r\n                        if (next === LINE_FEED) {\r\n                            value += this.consumeStringSlice(i);\r\n                            i = -1;\r\n                            this._value.shift();\r\n                        }\r\n                        else if (isValidEscape(codePoint, next)) {\r\n                            value += this.consumeStringSlice(i);\r\n                            value += fromCodePoint(this.consumeEscapedCodePoint());\r\n                            i = -1;\r\n                        }\r\n                    }\r\n                }\r\n                i++;\r\n            } while (true);\r\n        };\r\n        Tokenizer.prototype.consumeNumber = function () {\r\n            var repr = [];\r\n            var type = FLAG_INTEGER;\r\n            var c1 = this.peekCodePoint(0);\r\n            if (c1 === PLUS_SIGN || c1 === HYPHEN_MINUS) {\r\n                repr.push(this.consumeCodePoint());\r\n            }\r\n            while (isDigit(this.peekCodePoint(0))) {\r\n                repr.push(this.consumeCodePoint());\r\n            }\r\n            c1 = this.peekCodePoint(0);\r\n            var c2 = this.peekCodePoint(1);\r\n            if (c1 === FULL_STOP && isDigit(c2)) {\r\n                repr.push(this.consumeCodePoint(), this.consumeCodePoint());\r\n                type = FLAG_NUMBER;\r\n                while (isDigit(this.peekCodePoint(0))) {\r\n                    repr.push(this.consumeCodePoint());\r\n                }\r\n            }\r\n            c1 = this.peekCodePoint(0);\r\n            c2 = this.peekCodePoint(1);\r\n            var c3 = this.peekCodePoint(2);\r\n            if ((c1 === E || c1 === e) && (((c2 === PLUS_SIGN || c2 === HYPHEN_MINUS) && isDigit(c3)) || isDigit(c2))) {\r\n                repr.push(this.consumeCodePoint(), this.consumeCodePoint());\r\n                type = FLAG_NUMBER;\r\n                while (isDigit(this.peekCodePoint(0))) {\r\n                    repr.push(this.consumeCodePoint());\r\n                }\r\n            }\r\n            return [stringToNumber(repr), type];\r\n        };\r\n        Tokenizer.prototype.consumeNumericToken = function () {\r\n            var _a = this.consumeNumber(), number = _a[0], flags = _a[1];\r\n            var c1 = this.peekCodePoint(0);\r\n            var c2 = this.peekCodePoint(1);\r\n            var c3 = this.peekCodePoint(2);\r\n            if (isIdentifierStart(c1, c2, c3)) {\r\n                var unit = this.consumeName();\r\n                return { type: TokenType.DIMENSION_TOKEN, number: number, flags: flags, unit: unit };\r\n            }\r\n            if (c1 === PERCENTAGE_SIGN) {\r\n                this.consumeCodePoint();\r\n                return { type: TokenType.PERCENTAGE_TOKEN, number: number, flags: flags };\r\n            }\r\n            return { type: TokenType.NUMBER_TOKEN, number: number, flags: flags };\r\n        };\r\n        Tokenizer.prototype.consumeEscapedCodePoint = function () {\r\n            var codePoint = this.consumeCodePoint();\r\n            if (isHex(codePoint)) {\r\n                var hex = fromCodePoint(codePoint);\r\n                while (isHex(this.peekCodePoint(0)) && hex.length < 6) {\r\n                    hex += fromCodePoint(this.consumeCodePoint());\r\n                }\r\n                if (isWhiteSpace(this.peekCodePoint(0))) {\r\n                    this.consumeCodePoint();\r\n                }\r\n                var hexCodePoint = parseInt(hex, 16);\r\n                if (hexCodePoint === 0 || isSurrogateCodePoint(hexCodePoint) || hexCodePoint > 0x10ffff) {\r\n                    return REPLACEMENT_CHARACTER;\r\n                }\r\n                return hexCodePoint;\r\n            }\r\n            if (codePoint === EOF) {\r\n                return REPLACEMENT_CHARACTER;\r\n            }\r\n            return codePoint;\r\n        };\r\n        Tokenizer.prototype.consumeName = function () {\r\n            var result = '';\r\n            while (true) {\r\n                var codePoint = this.consumeCodePoint();\r\n                if (isNameCodePoint(codePoint)) {\r\n                    result += fromCodePoint(codePoint);\r\n                }\r\n                else if (isValidEscape(codePoint, this.peekCodePoint(0))) {\r\n                    result += fromCodePoint(this.consumeEscapedCodePoint());\r\n                }\r\n                else {\r\n                    this.reconsumeCodePoint(codePoint);\r\n                    return result;\r\n                }\r\n            }\r\n        };\r\n        return Tokenizer;\r\n    }());\r\n\r\n    var Parser = /** @class */ (function () {\r\n        function Parser(tokens) {\r\n            this._tokens = tokens;\r\n        }\r\n        Parser.create = function (value) {\r\n            var tokenizer = new Tokenizer();\r\n            tokenizer.write(value);\r\n            return new Parser(tokenizer.read());\r\n        };\r\n        Parser.parseValue = function (value) {\r\n            return Parser.create(value).parseComponentValue();\r\n        };\r\n        Parser.parseValues = function (value) {\r\n            return Parser.create(value).parseComponentValues();\r\n        };\r\n        Parser.prototype.parseComponentValue = function () {\r\n            var token = this.consumeToken();\r\n            while (token.type === TokenType.WHITESPACE_TOKEN) {\r\n                token = this.consumeToken();\r\n            }\r\n            if (token.type === TokenType.EOF_TOKEN) {\r\n                throw new SyntaxError(\"Error parsing CSS component value, unexpected EOF\");\r\n            }\r\n            this.reconsumeToken(token);\r\n            var value = this.consumeComponentValue();\r\n            do {\r\n                token = this.consumeToken();\r\n            } while (token.type === TokenType.WHITESPACE_TOKEN);\r\n            if (token.type === TokenType.EOF_TOKEN) {\r\n                return value;\r\n            }\r\n            throw new SyntaxError(\"Error parsing CSS component value, multiple values found when expecting only one\");\r\n        };\r\n        Parser.prototype.parseComponentValues = function () {\r\n            var values = [];\r\n            while (true) {\r\n                var value = this.consumeComponentValue();\r\n                if (value.type === TokenType.EOF_TOKEN) {\r\n                    return values;\r\n                }\r\n                values.push(value);\r\n                values.push();\r\n            }\r\n        };\r\n        Parser.prototype.consumeComponentValue = function () {\r\n            var token = this.consumeToken();\r\n            switch (token.type) {\r\n                case TokenType.LEFT_CURLY_BRACKET_TOKEN:\r\n                case TokenType.LEFT_SQUARE_BRACKET_TOKEN:\r\n                case TokenType.LEFT_PARENTHESIS_TOKEN:\r\n                    return this.consumeSimpleBlock(token.type);\r\n                case TokenType.FUNCTION_TOKEN:\r\n                    return this.consumeFunction(token);\r\n            }\r\n            return token;\r\n        };\r\n        Parser.prototype.consumeSimpleBlock = function (type) {\r\n            var block = { type: type, values: [] };\r\n            var token = this.consumeToken();\r\n            while (true) {\r\n                if (token.type === TokenType.EOF_TOKEN || isEndingTokenFor(token, type)) {\r\n                    return block;\r\n                }\r\n                this.reconsumeToken(token);\r\n                block.values.push(this.consumeComponentValue());\r\n                token = this.consumeToken();\r\n            }\r\n        };\r\n        Parser.prototype.consumeFunction = function (functionToken) {\r\n            var cssFunction = {\r\n                name: functionToken.value,\r\n                values: [],\r\n                type: TokenType.FUNCTION\r\n            };\r\n            while (true) {\r\n                var token = this.consumeToken();\r\n                if (token.type === TokenType.EOF_TOKEN || token.type === TokenType.RIGHT_PARENTHESIS_TOKEN) {\r\n                    return cssFunction;\r\n                }\r\n                this.reconsumeToken(token);\r\n                cssFunction.values.push(this.consumeComponentValue());\r\n            }\r\n        };\r\n        Parser.prototype.consumeToken = function () {\r\n            var token = this._tokens.shift();\r\n            return typeof token === 'undefined' ? EOF_TOKEN : token;\r\n        };\r\n        Parser.prototype.reconsumeToken = function (token) {\r\n            this._tokens.unshift(token);\r\n        };\r\n        return Parser;\r\n    }());\r\n    var isDimensionToken = function (token) { return token.type === TokenType.DIMENSION_TOKEN; };\r\n    var isNumberToken = function (token) { return token.type === TokenType.NUMBER_TOKEN; };\r\n    var isIdentToken = function (token) { return token.type === TokenType.IDENT_TOKEN; };\r\n    var isStringToken = function (token) { return token.type === TokenType.STRING_TOKEN; };\r\n    var isIdentWithValue = function (token, value) {\r\n        return isIdentToken(token) && token.value === value;\r\n    };\r\n    var nonWhiteSpace = function (token) { return token.type !== TokenType.WHITESPACE_TOKEN; };\r\n    var nonFunctionArgSeparator = function (token) {\r\n        return token.type !== TokenType.WHITESPACE_TOKEN && token.type !== TokenType.COMMA_TOKEN;\r\n    };\r\n    var parseFunctionArgs = function (tokens) {\r\n        var args = [];\r\n        var arg = [];\r\n        tokens.forEach(function (token) {\r\n            if (token.type === TokenType.COMMA_TOKEN) {\r\n                if (arg.length === 0) {\r\n                    throw new Error(\"Error parsing function args, zero tokens for arg\");\r\n                }\r\n                args.push(arg);\r\n                arg = [];\r\n                return;\r\n            }\r\n            if (token.type !== TokenType.WHITESPACE_TOKEN) {\r\n                arg.push(token);\r\n            }\r\n        });\r\n        if (arg.length) {\r\n            args.push(arg);\r\n        }\r\n        return args;\r\n    };\r\n    var isEndingTokenFor = function (token, type) {\r\n        if (type === TokenType.LEFT_CURLY_BRACKET_TOKEN && token.type === TokenType.RIGHT_CURLY_BRACKET_TOKEN) {\r\n            return true;\r\n        }\r\n        if (type === TokenType.LEFT_SQUARE_BRACKET_TOKEN && token.type === TokenType.RIGHT_SQUARE_BRACKET_TOKEN) {\r\n            return true;\r\n        }\r\n        return type === TokenType.LEFT_PARENTHESIS_TOKEN && token.type === TokenType.RIGHT_PARENTHESIS_TOKEN;\r\n    };\r\n\r\n    var isLength = function (token) {\r\n        return token.type === TokenType.NUMBER_TOKEN || token.type === TokenType.DIMENSION_TOKEN;\r\n    };\r\n\r\n    var isLengthPercentage = function (token) {\r\n        return token.type === TokenType.PERCENTAGE_TOKEN || isLength(token);\r\n    };\r\n    var parseLengthPercentageTuple = function (tokens) {\r\n        return tokens.length > 1 ? [tokens[0], tokens[1]] : [tokens[0]];\r\n    };\r\n    var ZERO_LENGTH = {\r\n        type: TokenType.NUMBER_TOKEN,\r\n        number: 0,\r\n        flags: FLAG_INTEGER\r\n    };\r\n    var FIFTY_PERCENT = {\r\n        type: TokenType.PERCENTAGE_TOKEN,\r\n        number: 50,\r\n        flags: FLAG_INTEGER\r\n    };\r\n    var HUNDRED_PERCENT = {\r\n        type: TokenType.PERCENTAGE_TOKEN,\r\n        number: 100,\r\n        flags: FLAG_INTEGER\r\n    };\r\n    var getAbsoluteValueForTuple = function (tuple, width, height) {\r\n        var x = tuple[0], y = tuple[1];\r\n        return [getAbsoluteValue(x, width), getAbsoluteValue(typeof y !== 'undefined' ? y : x, height)];\r\n    };\r\n    var getAbsoluteValue = function (token, parent) {\r\n        if (token.type === TokenType.PERCENTAGE_TOKEN) {\r\n            return (token.number / 100) * parent;\r\n        }\r\n        if (isDimensionToken(token)) {\r\n            switch (token.unit) {\r\n                case 'rem':\r\n                case 'em':\r\n                    return 16 * token.number; // TODO use correct font-size\r\n                case 'px':\r\n                default:\r\n                    return token.number;\r\n            }\r\n        }\r\n        return token.number;\r\n    };\r\n\r\n    var DEG = 'deg';\r\n    var GRAD = 'grad';\r\n    var RAD = 'rad';\r\n    var TURN = 'turn';\r\n    var angle = {\r\n        name: 'angle',\r\n        parse: function (value) {\r\n            if (value.type === TokenType.DIMENSION_TOKEN) {\r\n                switch (value.unit) {\r\n                    case DEG:\r\n                        return (Math.PI * value.number) / 180;\r\n                    case GRAD:\r\n                        return (Math.PI / 200) * value.number;\r\n                    case RAD:\r\n                        return value.number;\r\n                    case TURN:\r\n                        return Math.PI * 2 * value.number;\r\n                }\r\n            }\r\n            throw new Error(\"Unsupported angle type\");\r\n        }\r\n    };\r\n    var isAngle = function (value) {\r\n        if (value.type === TokenType.DIMENSION_TOKEN) {\r\n            if (value.unit === DEG || value.unit === GRAD || value.unit === RAD || value.unit === TURN) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    var parseNamedSide = function (tokens) {\r\n        var sideOrCorner = tokens\r\n            .filter(isIdentToken)\r\n            .map(function (ident) { return ident.value; })\r\n            .join(' ');\r\n        switch (sideOrCorner) {\r\n            case 'to bottom right':\r\n            case 'to right bottom':\r\n            case 'left top':\r\n            case 'top left':\r\n                return [ZERO_LENGTH, ZERO_LENGTH];\r\n            case 'to top':\r\n            case 'bottom':\r\n                return deg(0);\r\n            case 'to bottom left':\r\n            case 'to left bottom':\r\n            case 'right top':\r\n            case 'top right':\r\n                return [ZERO_LENGTH, HUNDRED_PERCENT];\r\n            case 'to right':\r\n            case 'left':\r\n                return deg(90);\r\n            case 'to top left':\r\n            case 'to left top':\r\n            case 'right bottom':\r\n            case 'bottom right':\r\n                return [HUNDRED_PERCENT, HUNDRED_PERCENT];\r\n            case 'to bottom':\r\n            case 'top':\r\n                return deg(180);\r\n            case 'to top right':\r\n            case 'to right top':\r\n            case 'left bottom':\r\n            case 'bottom left':\r\n                return [HUNDRED_PERCENT, ZERO_LENGTH];\r\n            case 'to left':\r\n            case 'right':\r\n                return deg(270);\r\n        }\r\n        return 0;\r\n    };\r\n    var deg = function (deg) { return (Math.PI * deg) / 180; };\r\n\r\n    var color = {\r\n        name: 'color',\r\n        parse: function (value) {\r\n            if (value.type === TokenType.FUNCTION) {\r\n                var colorFunction = SUPPORTED_COLOR_FUNCTIONS[value.name];\r\n                if (typeof colorFunction === 'undefined') {\r\n                    throw new Error(\"Attempting to parse an unsupported color function \\\"\" + value.name + \"\\\"\");\r\n                }\r\n                return colorFunction(value.values);\r\n            }\r\n            if (value.type === TokenType.HASH_TOKEN) {\r\n                if (value.value.length === 3) {\r\n                    var r = value.value.substring(0, 1);\r\n                    var g = value.value.substring(1, 2);\r\n                    var b = value.value.substring(2, 3);\r\n                    return pack(parseInt(r + r, 16), parseInt(g + g, 16), parseInt(b + b, 16), 1);\r\n                }\r\n                if (value.value.length === 4) {\r\n                    var r = value.value.substring(0, 1);\r\n                    var g = value.value.substring(1, 2);\r\n                    var b = value.value.substring(2, 3);\r\n                    var a = value.value.substring(3, 4);\r\n                    return pack(parseInt(r + r, 16), parseInt(g + g, 16), parseInt(b + b, 16), parseInt(a + a, 16) / 255);\r\n                }\r\n                if (value.value.length === 6) {\r\n                    var r = value.value.substring(0, 2);\r\n                    var g = value.value.substring(2, 4);\r\n                    var b = value.value.substring(4, 6);\r\n                    return pack(parseInt(r, 16), parseInt(g, 16), parseInt(b, 16), 1);\r\n                }\r\n                if (value.value.length === 8) {\r\n                    var r = value.value.substring(0, 2);\r\n                    var g = value.value.substring(2, 4);\r\n                    var b = value.value.substring(4, 6);\r\n                    var a = value.value.substring(6, 8);\r\n                    return pack(parseInt(r, 16), parseInt(g, 16), parseInt(b, 16), parseInt(a, 16) / 255);\r\n                }\r\n            }\r\n            if (value.type === TokenType.IDENT_TOKEN) {\r\n                var namedColor = COLORS[value.value.toUpperCase()];\r\n                if (typeof namedColor !== 'undefined') {\r\n                    return namedColor;\r\n                }\r\n            }\r\n            return COLORS.TRANSPARENT;\r\n        }\r\n    };\r\n    var isTransparent = function (color) { return (0xff & color) === 0; };\r\n    var asString = function (color) {\r\n        var alpha = 0xff & color;\r\n        var blue = 0xff & (color >> 8);\r\n        var green = 0xff & (color >> 16);\r\n        var red = 0xff & (color >> 24);\r\n        return alpha < 255 ? \"rgba(\" + red + \",\" + green + \",\" + blue + \",\" + alpha / 255 + \")\" : \"rgb(\" + red + \",\" + green + \",\" + blue + \")\";\r\n    };\r\n    var pack = function (r, g, b, a) {\r\n        return ((r << 24) | (g << 16) | (b << 8) | (Math.round(a * 255) << 0)) >>> 0;\r\n    };\r\n    var getTokenColorValue = function (token, i) {\r\n        if (token.type === TokenType.NUMBER_TOKEN) {\r\n            return token.number;\r\n        }\r\n        if (token.type === TokenType.PERCENTAGE_TOKEN) {\r\n            var max = i === 3 ? 1 : 255;\r\n            return i === 3 ? (token.number / 100) * max : Math.round((token.number / 100) * max);\r\n        }\r\n        return 0;\r\n    };\r\n    var rgb = function (args) {\r\n        var tokens = args.filter(nonFunctionArgSeparator);\r\n        if (tokens.length === 3) {\r\n            var _a = tokens.map(getTokenColorValue), r = _a[0], g = _a[1], b = _a[2];\r\n            return pack(r, g, b, 1);\r\n        }\r\n        if (tokens.length === 4) {\r\n            var _b = tokens.map(getTokenColorValue), r = _b[0], g = _b[1], b = _b[2], a = _b[3];\r\n            return pack(r, g, b, a);\r\n        }\r\n        return 0;\r\n    };\r\n    function hue2rgb(t1, t2, hue) {\r\n        if (hue < 0) {\r\n            hue += 1;\r\n        }\r\n        if (hue >= 1) {\r\n            hue -= 1;\r\n        }\r\n        if (hue < 1 / 6) {\r\n            return (t2 - t1) * hue * 6 + t1;\r\n        }\r\n        else if (hue < 1 / 2) {\r\n            return t2;\r\n        }\r\n        else if (hue < 2 / 3) {\r\n            return (t2 - t1) * 6 * (2 / 3 - hue) + t1;\r\n        }\r\n        else {\r\n            return t1;\r\n        }\r\n    }\r\n    var hsl = function (args) {\r\n        var tokens = args.filter(nonFunctionArgSeparator);\r\n        var hue = tokens[0], saturation = tokens[1], lightness = tokens[2], alpha = tokens[3];\r\n        var h = (hue.type === TokenType.NUMBER_TOKEN ? deg(hue.number) : angle.parse(hue)) / (Math.PI * 2);\r\n        var s = isLengthPercentage(saturation) ? saturation.number / 100 : 0;\r\n        var l = isLengthPercentage(lightness) ? lightness.number / 100 : 0;\r\n        var a = typeof alpha !== 'undefined' && isLengthPercentage(alpha) ? getAbsoluteValue(alpha, 1) : 1;\r\n        if (s === 0) {\r\n            return pack(l * 255, l * 255, l * 255, 1);\r\n        }\r\n        var t2 = l <= 0.5 ? l * (s + 1) : l + s - l * s;\r\n        var t1 = l * 2 - t2;\r\n        var r = hue2rgb(t1, t2, h + 1 / 3);\r\n        var g = hue2rgb(t1, t2, h);\r\n        var b = hue2rgb(t1, t2, h - 1 / 3);\r\n        return pack(r * 255, g * 255, b * 255, a);\r\n    };\r\n    var SUPPORTED_COLOR_FUNCTIONS = {\r\n        hsl: hsl,\r\n        hsla: hsl,\r\n        rgb: rgb,\r\n        rgba: rgb\r\n    };\r\n    var COLORS = {\r\n        ALICEBLUE: 0xf0f8ffff,\r\n        ANTIQUEWHITE: 0xfaebd7ff,\r\n        AQUA: 0x00ffffff,\r\n        AQUAMARINE: 0x7fffd4ff,\r\n        AZURE: 0xf0ffffff,\r\n        BEIGE: 0xf5f5dcff,\r\n        BISQUE: 0xffe4c4ff,\r\n        BLACK: 0x000000ff,\r\n        BLANCHEDALMOND: 0xffebcdff,\r\n        BLUE: 0x0000ffff,\r\n        BLUEVIOLET: 0x8a2be2ff,\r\n        BROWN: 0xa52a2aff,\r\n        BURLYWOOD: 0xdeb887ff,\r\n        CADETBLUE: 0x5f9ea0ff,\r\n        CHARTREUSE: 0x7fff00ff,\r\n        CHOCOLATE: 0xd2691eff,\r\n        CORAL: 0xff7f50ff,\r\n        CORNFLOWERBLUE: 0x6495edff,\r\n        CORNSILK: 0xfff8dcff,\r\n        CRIMSON: 0xdc143cff,\r\n        CYAN: 0x00ffffff,\r\n        DARKBLUE: 0x00008bff,\r\n        DARKCYAN: 0x008b8bff,\r\n        DARKGOLDENROD: 0xb886bbff,\r\n        DARKGRAY: 0xa9a9a9ff,\r\n        DARKGREEN: 0x006400ff,\r\n        DARKGREY: 0xa9a9a9ff,\r\n        DARKKHAKI: 0xbdb76bff,\r\n        DARKMAGENTA: 0x8b008bff,\r\n        DARKOLIVEGREEN: 0x556b2fff,\r\n        DARKORANGE: 0xff8c00ff,\r\n        DARKORCHID: 0x9932ccff,\r\n        DARKRED: 0x8b0000ff,\r\n        DARKSALMON: 0xe9967aff,\r\n        DARKSEAGREEN: 0x8fbc8fff,\r\n        DARKSLATEBLUE: 0x483d8bff,\r\n        DARKSLATEGRAY: 0x2f4f4fff,\r\n        DARKSLATEGREY: 0x2f4f4fff,\r\n        DARKTURQUOISE: 0x00ced1ff,\r\n        DARKVIOLET: 0x9400d3ff,\r\n        DEEPPINK: 0xff1493ff,\r\n        DEEPSKYBLUE: 0x00bfffff,\r\n        DIMGRAY: 0x696969ff,\r\n        DIMGREY: 0x696969ff,\r\n        DODGERBLUE: 0x1e90ffff,\r\n        FIREBRICK: 0xb22222ff,\r\n        FLORALWHITE: 0xfffaf0ff,\r\n        FORESTGREEN: 0x228b22ff,\r\n        FUCHSIA: 0xff00ffff,\r\n        GAINSBORO: 0xdcdcdcff,\r\n        GHOSTWHITE: 0xf8f8ffff,\r\n        GOLD: 0xffd700ff,\r\n        GOLDENROD: 0xdaa520ff,\r\n        GRAY: 0x808080ff,\r\n        GREEN: 0x008000ff,\r\n        GREENYELLOW: 0xadff2fff,\r\n        GREY: 0x808080ff,\r\n        HONEYDEW: 0xf0fff0ff,\r\n        HOTPINK: 0xff69b4ff,\r\n        INDIANRED: 0xcd5c5cff,\r\n        INDIGO: 0x4b0082ff,\r\n        IVORY: 0xfffff0ff,\r\n        KHAKI: 0xf0e68cff,\r\n        LAVENDER: 0xe6e6faff,\r\n        LAVENDERBLUSH: 0xfff0f5ff,\r\n        LAWNGREEN: 0x7cfc00ff,\r\n        LEMONCHIFFON: 0xfffacdff,\r\n        LIGHTBLUE: 0xadd8e6ff,\r\n        LIGHTCORAL: 0xf08080ff,\r\n        LIGHTCYAN: 0xe0ffffff,\r\n        LIGHTGOLDENRODYELLOW: 0xfafad2ff,\r\n        LIGHTGRAY: 0xd3d3d3ff,\r\n        LIGHTGREEN: 0x90ee90ff,\r\n        LIGHTGREY: 0xd3d3d3ff,\r\n        LIGHTPINK: 0xffb6c1ff,\r\n        LIGHTSALMON: 0xffa07aff,\r\n        LIGHTSEAGREEN: 0x20b2aaff,\r\n        LIGHTSKYBLUE: 0x87cefaff,\r\n        LIGHTSLATEGRAY: 0x778899ff,\r\n        LIGHTSLATEGREY: 0x778899ff,\r\n        LIGHTSTEELBLUE: 0xb0c4deff,\r\n        LIGHTYELLOW: 0xffffe0ff,\r\n        LIME: 0x00ff00ff,\r\n        LIMEGREEN: 0x32cd32ff,\r\n        LINEN: 0xfaf0e6ff,\r\n        MAGENTA: 0xff00ffff,\r\n        MAROON: 0x800000ff,\r\n        MEDIUMAQUAMARINE: 0x66cdaaff,\r\n        MEDIUMBLUE: 0x0000cdff,\r\n        MEDIUMORCHID: 0xba55d3ff,\r\n        MEDIUMPURPLE: 0x9370dbff,\r\n        MEDIUMSEAGREEN: 0x3cb371ff,\r\n        MEDIUMSLATEBLUE: 0x7b68eeff,\r\n        MEDIUMSPRINGGREEN: 0x00fa9aff,\r\n        MEDIUMTURQUOISE: 0x48d1ccff,\r\n        MEDIUMVIOLETRED: 0xc71585ff,\r\n        MIDNIGHTBLUE: 0x191970ff,\r\n        MINTCREAM: 0xf5fffaff,\r\n        MISTYROSE: 0xffe4e1ff,\r\n        MOCCASIN: 0xffe4b5ff,\r\n        NAVAJOWHITE: 0xffdeadff,\r\n        NAVY: 0x000080ff,\r\n        OLDLACE: 0xfdf5e6ff,\r\n        OLIVE: 0x808000ff,\r\n        OLIVEDRAB: 0x6b8e23ff,\r\n        ORANGE: 0xffa500ff,\r\n        ORANGERED: 0xff4500ff,\r\n        ORCHID: 0xda70d6ff,\r\n        PALEGOLDENROD: 0xeee8aaff,\r\n        PALEGREEN: 0x98fb98ff,\r\n        PALETURQUOISE: 0xafeeeeff,\r\n        PALEVIOLETRED: 0xdb7093ff,\r\n        PAPAYAWHIP: 0xffefd5ff,\r\n        PEACHPUFF: 0xffdab9ff,\r\n        PERU: 0xcd853fff,\r\n        PINK: 0xffc0cbff,\r\n        PLUM: 0xdda0ddff,\r\n        POWDERBLUE: 0xb0e0e6ff,\r\n        PURPLE: 0x800080ff,\r\n        REBECCAPURPLE: 0x663399ff,\r\n        RED: 0xff0000ff,\r\n        ROSYBROWN: 0xbc8f8fff,\r\n        ROYALBLUE: 0x4169e1ff,\r\n        SADDLEBROWN: 0x8b4513ff,\r\n        SALMON: 0xfa8072ff,\r\n        SANDYBROWN: 0xf4a460ff,\r\n        SEAGREEN: 0x2e8b57ff,\r\n        SEASHELL: 0xfff5eeff,\r\n        SIENNA: 0xa0522dff,\r\n        SILVER: 0xc0c0c0ff,\r\n        SKYBLUE: 0x87ceebff,\r\n        SLATEBLUE: 0x6a5acdff,\r\n        SLATEGRAY: 0x708090ff,\r\n        SLATEGREY: 0x708090ff,\r\n        SNOW: 0xfffafaff,\r\n        SPRINGGREEN: 0x00ff7fff,\r\n        STEELBLUE: 0x4682b4ff,\r\n        TAN: 0xd2b48cff,\r\n        TEAL: 0x008080ff,\r\n        THISTLE: 0xd8bfd8ff,\r\n        TOMATO: 0xff6347ff,\r\n        TRANSPARENT: 0x00000000,\r\n        TURQUOISE: 0x40e0d0ff,\r\n        VIOLET: 0xee82eeff,\r\n        WHEAT: 0xf5deb3ff,\r\n        WHITE: 0xffffffff,\r\n        WHITESMOKE: 0xf5f5f5ff,\r\n        YELLOW: 0xffff00ff,\r\n        YELLOWGREEN: 0x9acd32ff\r\n    };\r\n\r\n    var PropertyDescriptorParsingType;\r\n    (function (PropertyDescriptorParsingType) {\r\n        PropertyDescriptorParsingType[PropertyDescriptorParsingType[\"VALUE\"] = 0] = \"VALUE\";\r\n        PropertyDescriptorParsingType[PropertyDescriptorParsingType[\"LIST\"] = 1] = \"LIST\";\r\n        PropertyDescriptorParsingType[PropertyDescriptorParsingType[\"IDENT_VALUE\"] = 2] = \"IDENT_VALUE\";\r\n        PropertyDescriptorParsingType[PropertyDescriptorParsingType[\"TYPE_VALUE\"] = 3] = \"TYPE_VALUE\";\r\n        PropertyDescriptorParsingType[PropertyDescriptorParsingType[\"TOKEN_VALUE\"] = 4] = \"TOKEN_VALUE\";\r\n    })(PropertyDescriptorParsingType || (PropertyDescriptorParsingType = {}));\r\n\r\n    var BACKGROUND_CLIP;\r\n    (function (BACKGROUND_CLIP) {\r\n        BACKGROUND_CLIP[BACKGROUND_CLIP[\"BORDER_BOX\"] = 0] = \"BORDER_BOX\";\r\n        BACKGROUND_CLIP[BACKGROUND_CLIP[\"PADDING_BOX\"] = 1] = \"PADDING_BOX\";\r\n        BACKGROUND_CLIP[BACKGROUND_CLIP[\"CONTENT_BOX\"] = 2] = \"CONTENT_BOX\";\r\n    })(BACKGROUND_CLIP || (BACKGROUND_CLIP = {}));\r\n    var backgroundClip = {\r\n        name: 'background-clip',\r\n        initialValue: 'border-box',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            return tokens.map(function (token) {\r\n                if (isIdentToken(token)) {\r\n                    switch (token.value) {\r\n                        case 'padding-box':\r\n                            return BACKGROUND_CLIP.PADDING_BOX;\r\n                        case 'content-box':\r\n                            return BACKGROUND_CLIP.CONTENT_BOX;\r\n                    }\r\n                }\r\n                return BACKGROUND_CLIP.BORDER_BOX;\r\n            });\r\n        }\r\n    };\r\n\r\n    var backgroundColor = {\r\n        name: \"background-color\",\r\n        initialValue: 'transparent',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.TYPE_VALUE,\r\n        format: 'color'\r\n    };\r\n\r\n    var parseColorStop = function (args) {\r\n        var color$1 = color.parse(args[0]);\r\n        var stop = args[1];\r\n        return stop && isLengthPercentage(stop) ? { color: color$1, stop: stop } : { color: color$1, stop: null };\r\n    };\r\n    var processColorStops = function (stops, lineLength) {\r\n        var first = stops[0];\r\n        var last = stops[stops.length - 1];\r\n        if (first.stop === null) {\r\n            first.stop = ZERO_LENGTH;\r\n        }\r\n        if (last.stop === null) {\r\n            last.stop = HUNDRED_PERCENT;\r\n        }\r\n        var processStops = [];\r\n        var previous = 0;\r\n        for (var i = 0; i < stops.length; i++) {\r\n            var stop_1 = stops[i].stop;\r\n            if (stop_1 !== null) {\r\n                var absoluteValue = getAbsoluteValue(stop_1, lineLength);\r\n                if (absoluteValue > previous) {\r\n                    processStops.push(absoluteValue);\r\n                }\r\n                else {\r\n                    processStops.push(previous);\r\n                }\r\n                previous = absoluteValue;\r\n            }\r\n            else {\r\n                processStops.push(null);\r\n            }\r\n        }\r\n        var gapBegin = null;\r\n        for (var i = 0; i < processStops.length; i++) {\r\n            var stop_2 = processStops[i];\r\n            if (stop_2 === null) {\r\n                if (gapBegin === null) {\r\n                    gapBegin = i;\r\n                }\r\n            }\r\n            else if (gapBegin !== null) {\r\n                var gapLength = i - gapBegin;\r\n                var beforeGap = processStops[gapBegin - 1];\r\n                var gapValue = (stop_2 - beforeGap) / (gapLength + 1);\r\n                for (var g = 1; g <= gapLength; g++) {\r\n                    processStops[gapBegin + g - 1] = gapValue * g;\r\n                }\r\n                gapBegin = null;\r\n            }\r\n        }\r\n        return stops.map(function (_a, i) {\r\n            var color = _a.color;\r\n            return { color: color, stop: Math.max(Math.min(1, processStops[i] / lineLength), 0) };\r\n        });\r\n    };\r\n    var getAngleFromCorner = function (corner, width, height) {\r\n        var centerX = width / 2;\r\n        var centerY = height / 2;\r\n        var x = getAbsoluteValue(corner[0], width) - centerX;\r\n        var y = centerY - getAbsoluteValue(corner[1], height);\r\n        return (Math.atan2(y, x) + Math.PI * 2) % (Math.PI * 2);\r\n    };\r\n    var calculateGradientDirection = function (angle, width, height) {\r\n        var radian = typeof angle === 'number' ? angle : getAngleFromCorner(angle, width, height);\r\n        var lineLength = Math.abs(width * Math.sin(radian)) + Math.abs(height * Math.cos(radian));\r\n        var halfWidth = width / 2;\r\n        var halfHeight = height / 2;\r\n        var halfLineLength = lineLength / 2;\r\n        var yDiff = Math.sin(radian - Math.PI / 2) * halfLineLength;\r\n        var xDiff = Math.cos(radian - Math.PI / 2) * halfLineLength;\r\n        return [lineLength, halfWidth - xDiff, halfWidth + xDiff, halfHeight - yDiff, halfHeight + yDiff];\r\n    };\r\n    var distance = function (a, b) { return Math.sqrt(a * a + b * b); };\r\n    var findCorner = function (width, height, x, y, closest) {\r\n        var corners = [[0, 0], [0, height], [width, 0], [width, height]];\r\n        return corners.reduce(function (stat, corner) {\r\n            var cx = corner[0], cy = corner[1];\r\n            var d = distance(x - cx, y - cy);\r\n            if (closest ? d < stat.optimumDistance : d > stat.optimumDistance) {\r\n                return {\r\n                    optimumCorner: corner,\r\n                    optimumDistance: d\r\n                };\r\n            }\r\n            return stat;\r\n        }, {\r\n            optimumDistance: closest ? Infinity : -Infinity,\r\n            optimumCorner: null\r\n        }).optimumCorner;\r\n    };\r\n    var calculateRadius = function (gradient, x, y, width, height) {\r\n        var rx = 0;\r\n        var ry = 0;\r\n        switch (gradient.size) {\r\n            case CSSRadialExtent.CLOSEST_SIDE:\r\n                // The ending shape is sized so that that it exactly meets the side of the gradient box closest to the gradients center.\r\n                // If the shape is an ellipse, it exactly meets the closest side in each dimension.\r\n                if (gradient.shape === CSSRadialShape.CIRCLE) {\r\n                    rx = ry = Math.min(Math.abs(x), Math.abs(x - width), Math.abs(y), Math.abs(y - height));\r\n                }\r\n                else if (gradient.shape === CSSRadialShape.ELLIPSE) {\r\n                    rx = Math.min(Math.abs(x), Math.abs(x - width));\r\n                    ry = Math.min(Math.abs(y), Math.abs(y - height));\r\n                }\r\n                break;\r\n            case CSSRadialExtent.CLOSEST_CORNER:\r\n                // The ending shape is sized so that that it passes through the corner of the gradient box closest to the gradients center.\r\n                // If the shape is an ellipse, the ending shape is given the same aspect-ratio it would have if closest-side were specified.\r\n                if (gradient.shape === CSSRadialShape.CIRCLE) {\r\n                    rx = ry = Math.min(distance(x, y), distance(x, y - height), distance(x - width, y), distance(x - width, y - height));\r\n                }\r\n                else if (gradient.shape === CSSRadialShape.ELLIPSE) {\r\n                    // Compute the ratio ry/rx (which is to be the same as for \"closest-side\")\r\n                    var c = Math.min(Math.abs(y), Math.abs(y - height)) / Math.min(Math.abs(x), Math.abs(x - width));\r\n                    var _a = findCorner(width, height, x, y, true), cx = _a[0], cy = _a[1];\r\n                    rx = distance(cx - x, (cy - y) / c);\r\n                    ry = c * rx;\r\n                }\r\n                break;\r\n            case CSSRadialExtent.FARTHEST_SIDE:\r\n                // Same as closest-side, except the ending shape is sized based on the farthest side(s)\r\n                if (gradient.shape === CSSRadialShape.CIRCLE) {\r\n                    rx = ry = Math.max(Math.abs(x), Math.abs(x - width), Math.abs(y), Math.abs(y - height));\r\n                }\r\n                else if (gradient.shape === CSSRadialShape.ELLIPSE) {\r\n                    rx = Math.max(Math.abs(x), Math.abs(x - width));\r\n                    ry = Math.max(Math.abs(y), Math.abs(y - height));\r\n                }\r\n                break;\r\n            case CSSRadialExtent.FARTHEST_CORNER:\r\n                // Same as closest-corner, except the ending shape is sized based on the farthest corner.\r\n                // If the shape is an ellipse, the ending shape is given the same aspect ratio it would have if farthest-side were specified.\r\n                if (gradient.shape === CSSRadialShape.CIRCLE) {\r\n                    rx = ry = Math.max(distance(x, y), distance(x, y - height), distance(x - width, y), distance(x - width, y - height));\r\n                }\r\n                else if (gradient.shape === CSSRadialShape.ELLIPSE) {\r\n                    // Compute the ratio ry/rx (which is to be the same as for \"farthest-side\")\r\n                    var c = Math.max(Math.abs(y), Math.abs(y - height)) / Math.max(Math.abs(x), Math.abs(x - width));\r\n                    var _b = findCorner(width, height, x, y, false), cx = _b[0], cy = _b[1];\r\n                    rx = distance(cx - x, (cy - y) / c);\r\n                    ry = c * rx;\r\n                }\r\n                break;\r\n        }\r\n        if (Array.isArray(gradient.size)) {\r\n            rx = getAbsoluteValue(gradient.size[0], width);\r\n            ry = gradient.size.length === 2 ? getAbsoluteValue(gradient.size[1], height) : rx;\r\n        }\r\n        return [rx, ry];\r\n    };\r\n\r\n    var linearGradient = function (tokens) {\r\n        var angle$1 = deg(180);\r\n        var stops = [];\r\n        parseFunctionArgs(tokens).forEach(function (arg, i) {\r\n            if (i === 0) {\r\n                var firstToken = arg[0];\r\n                if (firstToken.type === TokenType.IDENT_TOKEN && firstToken.value === 'to') {\r\n                    angle$1 = parseNamedSide(arg);\r\n                    return;\r\n                }\r\n                else if (isAngle(firstToken)) {\r\n                    angle$1 = angle.parse(firstToken);\r\n                    return;\r\n                }\r\n            }\r\n            var colorStop = parseColorStop(arg);\r\n            stops.push(colorStop);\r\n        });\r\n        return { angle: angle$1, stops: stops, type: CSSImageType.LINEAR_GRADIENT };\r\n    };\r\n\r\n    var prefixLinearGradient = function (tokens) {\r\n        var angle$1 = deg(180);\r\n        var stops = [];\r\n        parseFunctionArgs(tokens).forEach(function (arg, i) {\r\n            if (i === 0) {\r\n                var firstToken = arg[0];\r\n                if (firstToken.type === TokenType.IDENT_TOKEN &&\r\n                    ['top', 'left', 'right', 'bottom'].indexOf(firstToken.value) !== -1) {\r\n                    angle$1 = parseNamedSide(arg);\r\n                    return;\r\n                }\r\n                else if (isAngle(firstToken)) {\r\n                    angle$1 = (angle.parse(firstToken) + deg(270)) % deg(360);\r\n                    return;\r\n                }\r\n            }\r\n            var colorStop = parseColorStop(arg);\r\n            stops.push(colorStop);\r\n        });\r\n        return {\r\n            angle: angle$1,\r\n            stops: stops,\r\n            type: CSSImageType.LINEAR_GRADIENT\r\n        };\r\n    };\r\n\r\n    var testRangeBounds = function (document) {\r\n        var TEST_HEIGHT = 123;\r\n        if (document.createRange) {\r\n            var range = document.createRange();\r\n            if (range.getBoundingClientRect) {\r\n                var testElement = document.createElement('boundtest');\r\n                testElement.style.height = TEST_HEIGHT + \"px\";\r\n                testElement.style.display = 'block';\r\n                document.body.appendChild(testElement);\r\n                range.selectNode(testElement);\r\n                var rangeBounds = range.getBoundingClientRect();\r\n                var rangeHeight = Math.round(rangeBounds.height);\r\n                document.body.removeChild(testElement);\r\n                if (rangeHeight === TEST_HEIGHT) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    var testCORS = function () { return typeof new Image().crossOrigin !== 'undefined'; };\r\n    var testResponseType = function () { return typeof new XMLHttpRequest().responseType === 'string'; };\r\n    var testSVG = function (document) {\r\n        var img = new Image();\r\n        var canvas = document.createElement('canvas');\r\n        var ctx = canvas.getContext('2d');\r\n        if (!ctx) {\r\n            return false;\r\n        }\r\n        img.src = \"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>\";\r\n        try {\r\n            ctx.drawImage(img, 0, 0);\r\n            canvas.toDataURL();\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    var isGreenPixel = function (data) {\r\n        return data[0] === 0 && data[1] === 255 && data[2] === 0 && data[3] === 255;\r\n    };\r\n    var testForeignObject = function (document) {\r\n        var canvas = document.createElement('canvas');\r\n        var size = 100;\r\n        canvas.width = size;\r\n        canvas.height = size;\r\n        var ctx = canvas.getContext('2d');\r\n        if (!ctx) {\r\n            return Promise.reject(false);\r\n        }\r\n        ctx.fillStyle = 'rgb(0, 255, 0)';\r\n        ctx.fillRect(0, 0, size, size);\r\n        var img = new Image();\r\n        var greenImageSrc = canvas.toDataURL();\r\n        img.src = greenImageSrc;\r\n        var svg = createForeignObjectSVG(size, size, 0, 0, img);\r\n        ctx.fillStyle = 'red';\r\n        ctx.fillRect(0, 0, size, size);\r\n        return loadSerializedSVG(svg)\r\n            .then(function (img) {\r\n            ctx.drawImage(img, 0, 0);\r\n            var data = ctx.getImageData(0, 0, size, size).data;\r\n            ctx.fillStyle = 'red';\r\n            ctx.fillRect(0, 0, size, size);\r\n            var node = document.createElement('div');\r\n            node.style.backgroundImage = \"url(\" + greenImageSrc + \")\";\r\n            node.style.height = size + \"px\";\r\n            // Firefox 55 does not render inline <img /> tags\r\n            return isGreenPixel(data)\r\n                ? loadSerializedSVG(createForeignObjectSVG(size, size, 0, 0, node))\r\n                : Promise.reject(false);\r\n        })\r\n            .then(function (img) {\r\n            ctx.drawImage(img, 0, 0);\r\n            // Edge does not render background-images\r\n            return isGreenPixel(ctx.getImageData(0, 0, size, size).data);\r\n        })\r\n            .catch(function () { return false; });\r\n    };\r\n    var createForeignObjectSVG = function (width, height, x, y, node) {\r\n        var xmlns = 'http://www.w3.org/2000/svg';\r\n        var svg = document.createElementNS(xmlns, 'svg');\r\n        var foreignObject = document.createElementNS(xmlns, 'foreignObject');\r\n        svg.setAttributeNS(null, 'width', width.toString());\r\n        svg.setAttributeNS(null, 'height', height.toString());\r\n        foreignObject.setAttributeNS(null, 'width', '100%');\r\n        foreignObject.setAttributeNS(null, 'height', '100%');\r\n        foreignObject.setAttributeNS(null, 'x', x.toString());\r\n        foreignObject.setAttributeNS(null, 'y', y.toString());\r\n        foreignObject.setAttributeNS(null, 'externalResourcesRequired', 'true');\r\n        svg.appendChild(foreignObject);\r\n        foreignObject.appendChild(node);\r\n        return svg;\r\n    };\r\n    var loadSerializedSVG = function (svg) {\r\n        return new Promise(function (resolve, reject) {\r\n            var img = new Image();\r\n            img.onload = function () { return resolve(img); };\r\n            img.onerror = reject;\r\n            img.src = \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(new XMLSerializer().serializeToString(svg));\r\n        });\r\n    };\r\n    var FEATURES = {\r\n        get SUPPORT_RANGE_BOUNDS() {\r\n            var value = testRangeBounds(document);\r\n            Object.defineProperty(FEATURES, 'SUPPORT_RANGE_BOUNDS', { value: value });\r\n            return value;\r\n        },\r\n        get SUPPORT_SVG_DRAWING() {\r\n            var value = testSVG(document);\r\n            Object.defineProperty(FEATURES, 'SUPPORT_SVG_DRAWING', { value: value });\r\n            return value;\r\n        },\r\n        get SUPPORT_FOREIGNOBJECT_DRAWING() {\r\n            var value = typeof Array.from === 'function' && typeof window.fetch === 'function'\r\n                ? testForeignObject(document)\r\n                : Promise.resolve(false);\r\n            Object.defineProperty(FEATURES, 'SUPPORT_FOREIGNOBJECT_DRAWING', { value: value });\r\n            return value;\r\n        },\r\n        get SUPPORT_CORS_IMAGES() {\r\n            var value = testCORS();\r\n            Object.defineProperty(FEATURES, 'SUPPORT_CORS_IMAGES', { value: value });\r\n            return value;\r\n        },\r\n        get SUPPORT_RESPONSE_TYPE() {\r\n            var value = testResponseType();\r\n            Object.defineProperty(FEATURES, 'SUPPORT_RESPONSE_TYPE', { value: value });\r\n            return value;\r\n        },\r\n        get SUPPORT_CORS_XHR() {\r\n            var value = 'withCredentials' in new XMLHttpRequest();\r\n            Object.defineProperty(FEATURES, 'SUPPORT_CORS_XHR', { value: value });\r\n            return value;\r\n        }\r\n    };\r\n\r\n    var Logger = /** @class */ (function () {\r\n        function Logger(_a) {\r\n            var id = _a.id, enabled = _a.enabled;\r\n            this.id = id;\r\n            this.enabled = enabled;\r\n            this.start = Date.now();\r\n        }\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        Logger.prototype.debug = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            if (this.enabled) {\r\n                // eslint-disable-next-line no-console\r\n                if (typeof window !== 'undefined' && window.console && typeof console.debug === 'function') {\r\n                    // eslint-disable-next-line no-console\r\n                    console.debug.apply(console, [this.id, this.getTime() + \"ms\"].concat(args));\r\n                }\r\n                else {\r\n                    this.info.apply(this, args);\r\n                }\r\n            }\r\n        };\r\n        Logger.prototype.getTime = function () {\r\n            return Date.now() - this.start;\r\n        };\r\n        Logger.create = function (options) {\r\n            Logger.instances[options.id] = new Logger(options);\r\n        };\r\n        Logger.destroy = function (id) {\r\n            delete Logger.instances[id];\r\n        };\r\n        Logger.getInstance = function (id) {\r\n            var instance = Logger.instances[id];\r\n            if (typeof instance === 'undefined') {\r\n                throw new Error(\"No logger instance found with id \" + id);\r\n            }\r\n            return instance;\r\n        };\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        Logger.prototype.info = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            if (this.enabled) {\r\n                // eslint-disable-next-line no-console\r\n                if (typeof window !== 'undefined' && window.console && typeof console.info === 'function') {\r\n                    // eslint-disable-next-line no-console\r\n                    console.info.apply(console, [this.id, this.getTime() + \"ms\"].concat(args));\r\n                }\r\n            }\r\n        };\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        Logger.prototype.error = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            if (this.enabled) {\r\n                // eslint-disable-next-line no-console\r\n                if (typeof window !== 'undefined' && window.console && typeof console.error === 'function') {\r\n                    // eslint-disable-next-line no-console\r\n                    console.error.apply(console, [this.id, this.getTime() + \"ms\"].concat(args));\r\n                }\r\n                else {\r\n                    this.info.apply(this, args);\r\n                }\r\n            }\r\n        };\r\n        Logger.instances = {};\r\n        return Logger;\r\n    }());\r\n\r\n    var CacheStorage = /** @class */ (function () {\r\n        function CacheStorage() {\r\n        }\r\n        CacheStorage.create = function (name, options) {\r\n            return (CacheStorage._caches[name] = new Cache(name, options));\r\n        };\r\n        CacheStorage.destroy = function (name) {\r\n            delete CacheStorage._caches[name];\r\n        };\r\n        CacheStorage.open = function (name) {\r\n            var cache = CacheStorage._caches[name];\r\n            if (typeof cache !== 'undefined') {\r\n                return cache;\r\n            }\r\n            throw new Error(\"Cache with key \\\"\" + name + \"\\\" not found\");\r\n        };\r\n        CacheStorage.getOrigin = function (url) {\r\n            var link = CacheStorage._link;\r\n            if (!link) {\r\n                return 'about:blank';\r\n            }\r\n            link.href = url;\r\n            link.href = link.href; // IE9, LOL! - http://jsfiddle.net/niklasvh/2e48b/\r\n            return link.protocol + link.hostname + link.port;\r\n        };\r\n        CacheStorage.isSameOrigin = function (src) {\r\n            return CacheStorage.getOrigin(src) === CacheStorage._origin;\r\n        };\r\n        CacheStorage.setContext = function (window) {\r\n            CacheStorage._link = window.document.createElement('a');\r\n            CacheStorage._origin = CacheStorage.getOrigin(window.location.href);\r\n        };\r\n        CacheStorage.getInstance = function () {\r\n            var current = CacheStorage._current;\r\n            if (current === null) {\r\n                throw new Error(\"No cache instance attached\");\r\n            }\r\n            return current;\r\n        };\r\n        CacheStorage.attachInstance = function (cache) {\r\n            CacheStorage._current = cache;\r\n        };\r\n        CacheStorage.detachInstance = function () {\r\n            CacheStorage._current = null;\r\n        };\r\n        CacheStorage._caches = {};\r\n        CacheStorage._origin = 'about:blank';\r\n        CacheStorage._current = null;\r\n        return CacheStorage;\r\n    }());\r\n    var Cache = /** @class */ (function () {\r\n        function Cache(id, options) {\r\n            this.id = id;\r\n            this._options = options;\r\n            this._cache = {};\r\n        }\r\n        Cache.prototype.addImage = function (src) {\r\n            var result = Promise.resolve();\r\n            if (this.has(src)) {\r\n                return result;\r\n            }\r\n            if (isBlobImage(src) || isRenderable(src)) {\r\n                this._cache[src] = this.loadImage(src);\r\n                return result;\r\n            }\r\n            return result;\r\n        };\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        Cache.prototype.match = function (src) {\r\n            return this._cache[src];\r\n        };\r\n        Cache.prototype.loadImage = function (key) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var isSameOrigin, useCORS, useProxy, src;\r\n                var _this = this;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            isSameOrigin = CacheStorage.isSameOrigin(key);\r\n                            useCORS = !isInlineImage(key) && this._options.useCORS === true && FEATURES.SUPPORT_CORS_IMAGES && !isSameOrigin;\r\n                            useProxy = !isInlineImage(key) &&\r\n                                !isSameOrigin &&\r\n                                typeof this._options.proxy === 'string' &&\r\n                                FEATURES.SUPPORT_CORS_XHR &&\r\n                                !useCORS;\r\n                            if (!isSameOrigin && this._options.allowTaint === false && !isInlineImage(key) && !useProxy && !useCORS) {\r\n                                return [2 /*return*/];\r\n                            }\r\n                            src = key;\r\n                            if (!useProxy) return [3 /*break*/, 2];\r\n                            return [4 /*yield*/, this.proxy(src)];\r\n                        case 1:\r\n                            src = _a.sent();\r\n                            _a.label = 2;\r\n                        case 2:\r\n                            Logger.getInstance(this.id).debug(\"Added image \" + key.substring(0, 256));\r\n                            return [4 /*yield*/, new Promise(function (resolve, reject) {\r\n                                    var img = new Image();\r\n                                    img.onload = function () { return resolve(img); };\r\n                                    img.onerror = reject;\r\n                                    //ios safari 10.3 taints canvas with data urls unless crossOrigin is set to anonymous\r\n                                    if (isInlineBase64Image(src) || useCORS) {\r\n                                        img.crossOrigin = 'anonymous';\r\n                                    }\r\n                                    img.src = src;\r\n                                    if (img.complete === true) {\r\n                                        // Inline XML images may fail to parse, throwing an Error later on\r\n                                        setTimeout(function () { return resolve(img); }, 500);\r\n                                    }\r\n                                    if (_this._options.imageTimeout > 0) {\r\n                                        setTimeout(function () { return reject(\"Timed out (\" + _this._options.imageTimeout + \"ms) loading image\"); }, _this._options.imageTimeout);\r\n                                    }\r\n                                })];\r\n                        case 3: return [2 /*return*/, _a.sent()];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        Cache.prototype.has = function (key) {\r\n            return typeof this._cache[key] !== 'undefined';\r\n        };\r\n        Cache.prototype.keys = function () {\r\n            return Promise.resolve(Object.keys(this._cache));\r\n        };\r\n        Cache.prototype.proxy = function (src) {\r\n            var _this = this;\r\n            var proxy = this._options.proxy;\r\n            if (!proxy) {\r\n                throw new Error('No proxy defined');\r\n            }\r\n            var key = src.substring(0, 256);\r\n            return new Promise(function (resolve, reject) {\r\n                var responseType = FEATURES.SUPPORT_RESPONSE_TYPE ? 'blob' : 'text';\r\n                var xhr = new XMLHttpRequest();\r\n                xhr.onload = function () {\r\n                    if (xhr.status === 200) {\r\n                        if (responseType === 'text') {\r\n                            resolve(xhr.response);\r\n                        }\r\n                        else {\r\n                            var reader_1 = new FileReader();\r\n                            reader_1.addEventListener('load', function () { return resolve(reader_1.result); }, false);\r\n                            reader_1.addEventListener('error', function (e) { return reject(e); }, false);\r\n                            reader_1.readAsDataURL(xhr.response);\r\n                        }\r\n                    }\r\n                    else {\r\n                        reject(\"Failed to proxy resource \" + key + \" with status code \" + xhr.status);\r\n                    }\r\n                };\r\n                xhr.onerror = reject;\r\n                xhr.open('GET', proxy + \"?url=\" + encodeURIComponent(src) + \"&responseType=\" + responseType);\r\n                if (responseType !== 'text' && xhr instanceof XMLHttpRequest) {\r\n                    xhr.responseType = responseType;\r\n                }\r\n                if (_this._options.imageTimeout) {\r\n                    var timeout_1 = _this._options.imageTimeout;\r\n                    xhr.timeout = timeout_1;\r\n                    xhr.ontimeout = function () { return reject(\"Timed out (\" + timeout_1 + \"ms) proxying \" + key); };\r\n                }\r\n                xhr.send();\r\n            });\r\n        };\r\n        return Cache;\r\n    }());\r\n    var INLINE_SVG = /^data:image\\/svg\\+xml/i;\r\n    var INLINE_BASE64 = /^data:image\\/.*;base64,/i;\r\n    var INLINE_IMG = /^data:image\\/.*/i;\r\n    var isRenderable = function (src) { return FEATURES.SUPPORT_SVG_DRAWING || !isSVG(src); };\r\n    var isInlineImage = function (src) { return INLINE_IMG.test(src); };\r\n    var isInlineBase64Image = function (src) { return INLINE_BASE64.test(src); };\r\n    var isBlobImage = function (src) { return src.substr(0, 4) === 'blob'; };\r\n    var isSVG = function (src) { return src.substr(-3).toLowerCase() === 'svg' || INLINE_SVG.test(src); };\r\n\r\n    var webkitGradient = function (tokens) {\r\n        var angle = deg(180);\r\n        var stops = [];\r\n        var type = CSSImageType.LINEAR_GRADIENT;\r\n        var shape = CSSRadialShape.CIRCLE;\r\n        var size = CSSRadialExtent.FARTHEST_CORNER;\r\n        var position = [];\r\n        parseFunctionArgs(tokens).forEach(function (arg, i) {\r\n            var firstToken = arg[0];\r\n            if (i === 0) {\r\n                if (isIdentToken(firstToken) && firstToken.value === 'linear') {\r\n                    type = CSSImageType.LINEAR_GRADIENT;\r\n                    return;\r\n                }\r\n                else if (isIdentToken(firstToken) && firstToken.value === 'radial') {\r\n                    type = CSSImageType.RADIAL_GRADIENT;\r\n                    return;\r\n                }\r\n            }\r\n            if (firstToken.type === TokenType.FUNCTION) {\r\n                if (firstToken.name === 'from') {\r\n                    var color$1 = color.parse(firstToken.values[0]);\r\n                    stops.push({ stop: ZERO_LENGTH, color: color$1 });\r\n                }\r\n                else if (firstToken.name === 'to') {\r\n                    var color$1 = color.parse(firstToken.values[0]);\r\n                    stops.push({ stop: HUNDRED_PERCENT, color: color$1 });\r\n                }\r\n                else if (firstToken.name === 'color-stop') {\r\n                    var values = firstToken.values.filter(nonFunctionArgSeparator);\r\n                    if (values.length === 2) {\r\n                        var color$1 = color.parse(values[1]);\r\n                        var stop_1 = values[0];\r\n                        if (isNumberToken(stop_1)) {\r\n                            stops.push({\r\n                                stop: { type: TokenType.PERCENTAGE_TOKEN, number: stop_1.number * 100, flags: stop_1.flags },\r\n                                color: color$1\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return type === CSSImageType.LINEAR_GRADIENT\r\n            ? {\r\n                angle: (angle + deg(180)) % deg(360),\r\n                stops: stops,\r\n                type: type\r\n            }\r\n            : { size: size, shape: shape, stops: stops, position: position, type: type };\r\n    };\r\n\r\n    var CLOSEST_SIDE = 'closest-side';\r\n    var FARTHEST_SIDE = 'farthest-side';\r\n    var CLOSEST_CORNER = 'closest-corner';\r\n    var FARTHEST_CORNER = 'farthest-corner';\r\n    var CIRCLE = 'circle';\r\n    var ELLIPSE = 'ellipse';\r\n    var COVER = 'cover';\r\n    var CONTAIN = 'contain';\r\n    var radialGradient = function (tokens) {\r\n        var shape = CSSRadialShape.CIRCLE;\r\n        var size = CSSRadialExtent.FARTHEST_CORNER;\r\n        var stops = [];\r\n        var position = [];\r\n        parseFunctionArgs(tokens).forEach(function (arg, i) {\r\n            var isColorStop = true;\r\n            if (i === 0) {\r\n                var isAtPosition_1 = false;\r\n                isColorStop = arg.reduce(function (acc, token) {\r\n                    if (isAtPosition_1) {\r\n                        if (isIdentToken(token)) {\r\n                            switch (token.value) {\r\n                                case 'center':\r\n                                    position.push(FIFTY_PERCENT);\r\n                                    return acc;\r\n                                case 'top':\r\n                                case 'left':\r\n                                    position.push(ZERO_LENGTH);\r\n                                    return acc;\r\n                                case 'right':\r\n                                case 'bottom':\r\n                                    position.push(HUNDRED_PERCENT);\r\n                                    return acc;\r\n                            }\r\n                        }\r\n                        else if (isLengthPercentage(token) || isLength(token)) {\r\n                            position.push(token);\r\n                        }\r\n                    }\r\n                    else if (isIdentToken(token)) {\r\n                        switch (token.value) {\r\n                            case CIRCLE:\r\n                                shape = CSSRadialShape.CIRCLE;\r\n                                return false;\r\n                            case ELLIPSE:\r\n                                shape = CSSRadialShape.ELLIPSE;\r\n                                return false;\r\n                            case 'at':\r\n                                isAtPosition_1 = true;\r\n                                return false;\r\n                            case CLOSEST_SIDE:\r\n                                size = CSSRadialExtent.CLOSEST_SIDE;\r\n                                return false;\r\n                            case COVER:\r\n                            case FARTHEST_SIDE:\r\n                                size = CSSRadialExtent.FARTHEST_SIDE;\r\n                                return false;\r\n                            case CONTAIN:\r\n                            case CLOSEST_CORNER:\r\n                                size = CSSRadialExtent.CLOSEST_CORNER;\r\n                                return false;\r\n                            case FARTHEST_CORNER:\r\n                                size = CSSRadialExtent.FARTHEST_CORNER;\r\n                                return false;\r\n                        }\r\n                    }\r\n                    else if (isLength(token) || isLengthPercentage(token)) {\r\n                        if (!Array.isArray(size)) {\r\n                            size = [];\r\n                        }\r\n                        size.push(token);\r\n                        return false;\r\n                    }\r\n                    return acc;\r\n                }, isColorStop);\r\n            }\r\n            if (isColorStop) {\r\n                var colorStop = parseColorStop(arg);\r\n                stops.push(colorStop);\r\n            }\r\n        });\r\n        return { size: size, shape: shape, stops: stops, position: position, type: CSSImageType.RADIAL_GRADIENT };\r\n    };\r\n\r\n    var prefixRadialGradient = function (tokens) {\r\n        var shape = CSSRadialShape.CIRCLE;\r\n        var size = CSSRadialExtent.FARTHEST_CORNER;\r\n        var stops = [];\r\n        var position = [];\r\n        parseFunctionArgs(tokens).forEach(function (arg, i) {\r\n            var isColorStop = true;\r\n            if (i === 0) {\r\n                isColorStop = arg.reduce(function (acc, token) {\r\n                    if (isIdentToken(token)) {\r\n                        switch (token.value) {\r\n                            case 'center':\r\n                                position.push(FIFTY_PERCENT);\r\n                                return false;\r\n                            case 'top':\r\n                            case 'left':\r\n                                position.push(ZERO_LENGTH);\r\n                                return false;\r\n                            case 'right':\r\n                            case 'bottom':\r\n                                position.push(HUNDRED_PERCENT);\r\n                                return false;\r\n                        }\r\n                    }\r\n                    else if (isLengthPercentage(token) || isLength(token)) {\r\n                        position.push(token);\r\n                        return false;\r\n                    }\r\n                    return acc;\r\n                }, isColorStop);\r\n            }\r\n            else if (i === 1) {\r\n                isColorStop = arg.reduce(function (acc, token) {\r\n                    if (isIdentToken(token)) {\r\n                        switch (token.value) {\r\n                            case CIRCLE:\r\n                                shape = CSSRadialShape.CIRCLE;\r\n                                return false;\r\n                            case ELLIPSE:\r\n                                shape = CSSRadialShape.ELLIPSE;\r\n                                return false;\r\n                            case CONTAIN:\r\n                            case CLOSEST_SIDE:\r\n                                size = CSSRadialExtent.CLOSEST_SIDE;\r\n                                return false;\r\n                            case FARTHEST_SIDE:\r\n                                size = CSSRadialExtent.FARTHEST_SIDE;\r\n                                return false;\r\n                            case CLOSEST_CORNER:\r\n                                size = CSSRadialExtent.CLOSEST_CORNER;\r\n                                return false;\r\n                            case COVER:\r\n                            case FARTHEST_CORNER:\r\n                                size = CSSRadialExtent.FARTHEST_CORNER;\r\n                                return false;\r\n                        }\r\n                    }\r\n                    else if (isLength(token) || isLengthPercentage(token)) {\r\n                        if (!Array.isArray(size)) {\r\n                            size = [];\r\n                        }\r\n                        size.push(token);\r\n                        return false;\r\n                    }\r\n                    return acc;\r\n                }, isColorStop);\r\n            }\r\n            if (isColorStop) {\r\n                var colorStop = parseColorStop(arg);\r\n                stops.push(colorStop);\r\n            }\r\n        });\r\n        return { size: size, shape: shape, stops: stops, position: position, type: CSSImageType.RADIAL_GRADIENT };\r\n    };\r\n\r\n    var CSSImageType;\r\n    (function (CSSImageType) {\r\n        CSSImageType[CSSImageType[\"URL\"] = 0] = \"URL\";\r\n        CSSImageType[CSSImageType[\"LINEAR_GRADIENT\"] = 1] = \"LINEAR_GRADIENT\";\r\n        CSSImageType[CSSImageType[\"RADIAL_GRADIENT\"] = 2] = \"RADIAL_GRADIENT\";\r\n    })(CSSImageType || (CSSImageType = {}));\r\n    var isLinearGradient = function (background) {\r\n        return background.type === CSSImageType.LINEAR_GRADIENT;\r\n    };\r\n    var isRadialGradient = function (background) {\r\n        return background.type === CSSImageType.RADIAL_GRADIENT;\r\n    };\r\n    var CSSRadialShape;\r\n    (function (CSSRadialShape) {\r\n        CSSRadialShape[CSSRadialShape[\"CIRCLE\"] = 0] = \"CIRCLE\";\r\n        CSSRadialShape[CSSRadialShape[\"ELLIPSE\"] = 1] = \"ELLIPSE\";\r\n    })(CSSRadialShape || (CSSRadialShape = {}));\r\n    var CSSRadialExtent;\r\n    (function (CSSRadialExtent) {\r\n        CSSRadialExtent[CSSRadialExtent[\"CLOSEST_SIDE\"] = 0] = \"CLOSEST_SIDE\";\r\n        CSSRadialExtent[CSSRadialExtent[\"FARTHEST_SIDE\"] = 1] = \"FARTHEST_SIDE\";\r\n        CSSRadialExtent[CSSRadialExtent[\"CLOSEST_CORNER\"] = 2] = \"CLOSEST_CORNER\";\r\n        CSSRadialExtent[CSSRadialExtent[\"FARTHEST_CORNER\"] = 3] = \"FARTHEST_CORNER\";\r\n    })(CSSRadialExtent || (CSSRadialExtent = {}));\r\n    var image = {\r\n        name: 'image',\r\n        parse: function (value) {\r\n            if (value.type === TokenType.URL_TOKEN) {\r\n                var image_1 = { url: value.value, type: CSSImageType.URL };\r\n                CacheStorage.getInstance().addImage(value.value);\r\n                return image_1;\r\n            }\r\n            if (value.type === TokenType.FUNCTION) {\r\n                var imageFunction = SUPPORTED_IMAGE_FUNCTIONS[value.name];\r\n                if (typeof imageFunction === 'undefined') {\r\n                    throw new Error(\"Attempting to parse an unsupported image function \\\"\" + value.name + \"\\\"\");\r\n                }\r\n                return imageFunction(value.values);\r\n            }\r\n            throw new Error(\"Unsupported image type\");\r\n        }\r\n    };\r\n    function isSupportedImage(value) {\r\n        return value.type !== TokenType.FUNCTION || SUPPORTED_IMAGE_FUNCTIONS[value.name];\r\n    }\r\n    var SUPPORTED_IMAGE_FUNCTIONS = {\r\n        'linear-gradient': linearGradient,\r\n        '-moz-linear-gradient': prefixLinearGradient,\r\n        '-ms-linear-gradient': prefixLinearGradient,\r\n        '-o-linear-gradient': prefixLinearGradient,\r\n        '-webkit-linear-gradient': prefixLinearGradient,\r\n        'radial-gradient': radialGradient,\r\n        '-moz-radial-gradient': prefixRadialGradient,\r\n        '-ms-radial-gradient': prefixRadialGradient,\r\n        '-o-radial-gradient': prefixRadialGradient,\r\n        '-webkit-radial-gradient': prefixRadialGradient,\r\n        '-webkit-gradient': webkitGradient\r\n    };\r\n\r\n    var backgroundImage = {\r\n        name: 'background-image',\r\n        initialValue: 'none',\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        prefix: false,\r\n        parse: function (tokens) {\r\n            if (tokens.length === 0) {\r\n                return [];\r\n            }\r\n            var first = tokens[0];\r\n            if (first.type === TokenType.IDENT_TOKEN && first.value === 'none') {\r\n                return [];\r\n            }\r\n            return tokens.filter(function (value) { return nonFunctionArgSeparator(value) && isSupportedImage(value); }).map(image.parse);\r\n        }\r\n    };\r\n\r\n    var backgroundOrigin = {\r\n        name: 'background-origin',\r\n        initialValue: 'border-box',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            return tokens.map(function (token) {\r\n                if (isIdentToken(token)) {\r\n                    switch (token.value) {\r\n                        case 'padding-box':\r\n                            return 1 /* PADDING_BOX */;\r\n                        case 'content-box':\r\n                            return 2 /* CONTENT_BOX */;\r\n                    }\r\n                }\r\n                return 0 /* BORDER_BOX */;\r\n            });\r\n        }\r\n    };\r\n\r\n    var backgroundPosition = {\r\n        name: 'background-position',\r\n        initialValue: '0% 0%',\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        prefix: false,\r\n        parse: function (tokens) {\r\n            return parseFunctionArgs(tokens)\r\n                .map(function (values) { return values.filter(isLengthPercentage); })\r\n                .map(parseLengthPercentageTuple);\r\n        }\r\n    };\r\n\r\n    var BACKGROUND_REPEAT;\r\n    (function (BACKGROUND_REPEAT) {\r\n        BACKGROUND_REPEAT[BACKGROUND_REPEAT[\"REPEAT\"] = 0] = \"REPEAT\";\r\n        BACKGROUND_REPEAT[BACKGROUND_REPEAT[\"NO_REPEAT\"] = 1] = \"NO_REPEAT\";\r\n        BACKGROUND_REPEAT[BACKGROUND_REPEAT[\"REPEAT_X\"] = 2] = \"REPEAT_X\";\r\n        BACKGROUND_REPEAT[BACKGROUND_REPEAT[\"REPEAT_Y\"] = 3] = \"REPEAT_Y\";\r\n    })(BACKGROUND_REPEAT || (BACKGROUND_REPEAT = {}));\r\n    var backgroundRepeat = {\r\n        name: 'background-repeat',\r\n        initialValue: 'repeat',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            return parseFunctionArgs(tokens)\r\n                .map(function (values) {\r\n                return values\r\n                    .filter(isIdentToken)\r\n                    .map(function (token) { return token.value; })\r\n                    .join(' ');\r\n            })\r\n                .map(parseBackgroundRepeat);\r\n        }\r\n    };\r\n    var parseBackgroundRepeat = function (value) {\r\n        switch (value) {\r\n            case 'no-repeat':\r\n                return BACKGROUND_REPEAT.NO_REPEAT;\r\n            case 'repeat-x':\r\n            case 'repeat no-repeat':\r\n                return BACKGROUND_REPEAT.REPEAT_X;\r\n            case 'repeat-y':\r\n            case 'no-repeat repeat':\r\n                return BACKGROUND_REPEAT.REPEAT_Y;\r\n            case 'repeat':\r\n            default:\r\n                return BACKGROUND_REPEAT.REPEAT;\r\n        }\r\n    };\r\n\r\n    var BACKGROUND_SIZE;\r\n    (function (BACKGROUND_SIZE) {\r\n        BACKGROUND_SIZE[\"AUTO\"] = \"auto\";\r\n        BACKGROUND_SIZE[\"CONTAIN\"] = \"contain\";\r\n        BACKGROUND_SIZE[\"COVER\"] = \"cover\";\r\n    })(BACKGROUND_SIZE || (BACKGROUND_SIZE = {}));\r\n    var backgroundSize = {\r\n        name: 'background-size',\r\n        initialValue: '0',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            return parseFunctionArgs(tokens).map(function (values) { return values.filter(isBackgroundSizeInfoToken); });\r\n        }\r\n    };\r\n    var isBackgroundSizeInfoToken = function (value) {\r\n        return isIdentToken(value) || isLengthPercentage(value);\r\n    };\r\n\r\n    var borderColorForSide = function (side) { return ({\r\n        name: \"border-\" + side + \"-color\",\r\n        initialValue: 'transparent',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.TYPE_VALUE,\r\n        format: 'color'\r\n    }); };\r\n    var borderTopColor = borderColorForSide('top');\r\n    var borderRightColor = borderColorForSide('right');\r\n    var borderBottomColor = borderColorForSide('bottom');\r\n    var borderLeftColor = borderColorForSide('left');\r\n\r\n    var borderRadiusForSide = function (side) { return ({\r\n        name: \"border-radius-\" + side,\r\n        initialValue: '0 0',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) { return parseLengthPercentageTuple(tokens.filter(isLengthPercentage)); }\r\n    }); };\r\n    var borderTopLeftRadius = borderRadiusForSide('top-left');\r\n    var borderTopRightRadius = borderRadiusForSide('top-right');\r\n    var borderBottomRightRadius = borderRadiusForSide('bottom-right');\r\n    var borderBottomLeftRadius = borderRadiusForSide('bottom-left');\r\n\r\n    var BORDER_STYLE;\r\n    (function (BORDER_STYLE) {\r\n        BORDER_STYLE[BORDER_STYLE[\"NONE\"] = 0] = \"NONE\";\r\n        BORDER_STYLE[BORDER_STYLE[\"SOLID\"] = 1] = \"SOLID\";\r\n    })(BORDER_STYLE || (BORDER_STYLE = {}));\r\n    var borderStyleForSide = function (side) { return ({\r\n        name: \"border-\" + side + \"-style\",\r\n        initialValue: 'solid',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (style) {\r\n            switch (style) {\r\n                case 'none':\r\n                    return BORDER_STYLE.NONE;\r\n            }\r\n            return BORDER_STYLE.SOLID;\r\n        }\r\n    }); };\r\n    var borderTopStyle = borderStyleForSide('top');\r\n    var borderRightStyle = borderStyleForSide('right');\r\n    var borderBottomStyle = borderStyleForSide('bottom');\r\n    var borderLeftStyle = borderStyleForSide('left');\r\n\r\n    var borderWidthForSide = function (side) { return ({\r\n        name: \"border-\" + side + \"-width\",\r\n        initialValue: '0',\r\n        type: PropertyDescriptorParsingType.VALUE,\r\n        prefix: false,\r\n        parse: function (token) {\r\n            if (isDimensionToken(token)) {\r\n                return token.number;\r\n            }\r\n            return 0;\r\n        }\r\n    }); };\r\n    var borderTopWidth = borderWidthForSide('top');\r\n    var borderRightWidth = borderWidthForSide('right');\r\n    var borderBottomWidth = borderWidthForSide('bottom');\r\n    var borderLeftWidth = borderWidthForSide('left');\r\n\r\n    var color$1 = {\r\n        name: \"color\",\r\n        initialValue: 'transparent',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.TYPE_VALUE,\r\n        format: 'color'\r\n    };\r\n\r\n    var display = {\r\n        name: 'display',\r\n        initialValue: 'inline-block',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            return tokens.filter(isIdentToken).reduce(function (bit, token) {\r\n                return bit | parseDisplayValue(token.value);\r\n            }, 0 /* NONE */);\r\n        }\r\n    };\r\n    var parseDisplayValue = function (display) {\r\n        switch (display) {\r\n            case 'block':\r\n                return 2 /* BLOCK */;\r\n            case 'inline':\r\n                return 4 /* INLINE */;\r\n            case 'run-in':\r\n                return 8 /* RUN_IN */;\r\n            case 'flow':\r\n                return 16 /* FLOW */;\r\n            case 'flow-root':\r\n                return 32 /* FLOW_ROOT */;\r\n            case 'table':\r\n                return 64 /* TABLE */;\r\n            case 'flex':\r\n            case '-webkit-flex':\r\n                return 128 /* FLEX */;\r\n            case 'grid':\r\n            case '-ms-grid':\r\n                return 256 /* GRID */;\r\n            case 'ruby':\r\n                return 512 /* RUBY */;\r\n            case 'subgrid':\r\n                return 1024 /* SUBGRID */;\r\n            case 'list-item':\r\n                return 2048 /* LIST_ITEM */;\r\n            case 'table-row-group':\r\n                return 4096 /* TABLE_ROW_GROUP */;\r\n            case 'table-header-group':\r\n                return 8192 /* TABLE_HEADER_GROUP */;\r\n            case 'table-footer-group':\r\n                return 16384 /* TABLE_FOOTER_GROUP */;\r\n            case 'table-row':\r\n                return 32768 /* TABLE_ROW */;\r\n            case 'table-cell':\r\n                return 65536 /* TABLE_CELL */;\r\n            case 'table-column-group':\r\n                return 131072 /* TABLE_COLUMN_GROUP */;\r\n            case 'table-column':\r\n                return 262144 /* TABLE_COLUMN */;\r\n            case 'table-caption':\r\n                return 524288 /* TABLE_CAPTION */;\r\n            case 'ruby-base':\r\n                return 1048576 /* RUBY_BASE */;\r\n            case 'ruby-text':\r\n                return 2097152 /* RUBY_TEXT */;\r\n            case 'ruby-base-container':\r\n                return 4194304 /* RUBY_BASE_CONTAINER */;\r\n            case 'ruby-text-container':\r\n                return 8388608 /* RUBY_TEXT_CONTAINER */;\r\n            case 'contents':\r\n                return 16777216 /* CONTENTS */;\r\n            case 'inline-block':\r\n                return 33554432 /* INLINE_BLOCK */;\r\n            case 'inline-list-item':\r\n                return 67108864 /* INLINE_LIST_ITEM */;\r\n            case 'inline-table':\r\n                return 134217728 /* INLINE_TABLE */;\r\n            case 'inline-flex':\r\n                return 268435456 /* INLINE_FLEX */;\r\n            case 'inline-grid':\r\n                return 536870912 /* INLINE_GRID */;\r\n        }\r\n        return 0 /* NONE */;\r\n    };\r\n\r\n    var FLOAT;\r\n    (function (FLOAT) {\r\n        FLOAT[FLOAT[\"NONE\"] = 0] = \"NONE\";\r\n        FLOAT[FLOAT[\"LEFT\"] = 1] = \"LEFT\";\r\n        FLOAT[FLOAT[\"RIGHT\"] = 2] = \"RIGHT\";\r\n        FLOAT[FLOAT[\"INLINE_START\"] = 3] = \"INLINE_START\";\r\n        FLOAT[FLOAT[\"INLINE_END\"] = 4] = \"INLINE_END\";\r\n    })(FLOAT || (FLOAT = {}));\r\n    var float = {\r\n        name: 'float',\r\n        initialValue: 'none',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (float) {\r\n            switch (float) {\r\n                case 'left':\r\n                    return FLOAT.LEFT;\r\n                case 'right':\r\n                    return FLOAT.RIGHT;\r\n                case 'inline-start':\r\n                    return FLOAT.INLINE_START;\r\n                case 'inline-end':\r\n                    return FLOAT.INLINE_END;\r\n            }\r\n            return FLOAT.NONE;\r\n        }\r\n    };\r\n\r\n    var letterSpacing = {\r\n        name: 'letter-spacing',\r\n        initialValue: '0',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.VALUE,\r\n        parse: function (token) {\r\n            if (token.type === TokenType.IDENT_TOKEN && token.value === 'normal') {\r\n                return 0;\r\n            }\r\n            if (token.type === TokenType.NUMBER_TOKEN) {\r\n                return token.number;\r\n            }\r\n            if (token.type === TokenType.DIMENSION_TOKEN) {\r\n                return token.number;\r\n            }\r\n            return 0;\r\n        }\r\n    };\r\n\r\n    var LINE_BREAK;\r\n    (function (LINE_BREAK) {\r\n        LINE_BREAK[\"NORMAL\"] = \"normal\";\r\n        LINE_BREAK[\"STRICT\"] = \"strict\";\r\n    })(LINE_BREAK || (LINE_BREAK = {}));\r\n    var lineBreak = {\r\n        name: 'line-break',\r\n        initialValue: 'normal',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (lineBreak) {\r\n            switch (lineBreak) {\r\n                case 'strict':\r\n                    return LINE_BREAK.STRICT;\r\n                case 'normal':\r\n                default:\r\n                    return LINE_BREAK.NORMAL;\r\n            }\r\n        }\r\n    };\r\n\r\n    var lineHeight = {\r\n        name: 'line-height',\r\n        initialValue: 'normal',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.TOKEN_VALUE\r\n    };\r\n    var computeLineHeight = function (token, fontSize) {\r\n        if (isIdentToken(token) && token.value === 'normal') {\r\n            return 1.2 * fontSize;\r\n        }\r\n        else if (token.type === TokenType.NUMBER_TOKEN) {\r\n            return fontSize * token.number;\r\n        }\r\n        else if (isLengthPercentage(token)) {\r\n            return getAbsoluteValue(token, fontSize);\r\n        }\r\n        return fontSize;\r\n    };\r\n\r\n    var listStyleImage = {\r\n        name: 'list-style-image',\r\n        initialValue: 'none',\r\n        type: PropertyDescriptorParsingType.VALUE,\r\n        prefix: false,\r\n        parse: function (token) {\r\n            if (token.type === TokenType.IDENT_TOKEN && token.value === 'none') {\r\n                return null;\r\n            }\r\n            return image.parse(token);\r\n        }\r\n    };\r\n\r\n    var LIST_STYLE_POSITION;\r\n    (function (LIST_STYLE_POSITION) {\r\n        LIST_STYLE_POSITION[LIST_STYLE_POSITION[\"INSIDE\"] = 0] = \"INSIDE\";\r\n        LIST_STYLE_POSITION[LIST_STYLE_POSITION[\"OUTSIDE\"] = 1] = \"OUTSIDE\";\r\n    })(LIST_STYLE_POSITION || (LIST_STYLE_POSITION = {}));\r\n    var listStylePosition = {\r\n        name: 'list-style-position',\r\n        initialValue: 'outside',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (position) {\r\n            switch (position) {\r\n                case 'inside':\r\n                    return LIST_STYLE_POSITION.INSIDE;\r\n                case 'outside':\r\n                default:\r\n                    return LIST_STYLE_POSITION.OUTSIDE;\r\n            }\r\n        }\r\n    };\r\n\r\n    var LIST_STYLE_TYPE;\r\n    (function (LIST_STYLE_TYPE) {\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"NONE\"] = -1] = \"NONE\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"DISC\"] = 0] = \"DISC\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"CIRCLE\"] = 1] = \"CIRCLE\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"SQUARE\"] = 2] = \"SQUARE\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"DECIMAL\"] = 3] = \"DECIMAL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"CJK_DECIMAL\"] = 4] = \"CJK_DECIMAL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"DECIMAL_LEADING_ZERO\"] = 5] = \"DECIMAL_LEADING_ZERO\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"LOWER_ROMAN\"] = 6] = \"LOWER_ROMAN\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"UPPER_ROMAN\"] = 7] = \"UPPER_ROMAN\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"LOWER_GREEK\"] = 8] = \"LOWER_GREEK\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"LOWER_ALPHA\"] = 9] = \"LOWER_ALPHA\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"UPPER_ALPHA\"] = 10] = \"UPPER_ALPHA\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"ARABIC_INDIC\"] = 11] = \"ARABIC_INDIC\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"ARMENIAN\"] = 12] = \"ARMENIAN\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"BENGALI\"] = 13] = \"BENGALI\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"CAMBODIAN\"] = 14] = \"CAMBODIAN\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"CJK_EARTHLY_BRANCH\"] = 15] = \"CJK_EARTHLY_BRANCH\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"CJK_HEAVENLY_STEM\"] = 16] = \"CJK_HEAVENLY_STEM\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"CJK_IDEOGRAPHIC\"] = 17] = \"CJK_IDEOGRAPHIC\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"DEVANAGARI\"] = 18] = \"DEVANAGARI\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"ETHIOPIC_NUMERIC\"] = 19] = \"ETHIOPIC_NUMERIC\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"GEORGIAN\"] = 20] = \"GEORGIAN\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"GUJARATI\"] = 21] = \"GUJARATI\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"GURMUKHI\"] = 22] = \"GURMUKHI\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"HEBREW\"] = 22] = \"HEBREW\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"HIRAGANA\"] = 23] = \"HIRAGANA\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"HIRAGANA_IROHA\"] = 24] = \"HIRAGANA_IROHA\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"JAPANESE_FORMAL\"] = 25] = \"JAPANESE_FORMAL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"JAPANESE_INFORMAL\"] = 26] = \"JAPANESE_INFORMAL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"KANNADA\"] = 27] = \"KANNADA\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"KATAKANA\"] = 28] = \"KATAKANA\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"KATAKANA_IROHA\"] = 29] = \"KATAKANA_IROHA\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"KHMER\"] = 30] = \"KHMER\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"KOREAN_HANGUL_FORMAL\"] = 31] = \"KOREAN_HANGUL_FORMAL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"KOREAN_HANJA_FORMAL\"] = 32] = \"KOREAN_HANJA_FORMAL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"KOREAN_HANJA_INFORMAL\"] = 33] = \"KOREAN_HANJA_INFORMAL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"LAO\"] = 34] = \"LAO\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"LOWER_ARMENIAN\"] = 35] = \"LOWER_ARMENIAN\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"MALAYALAM\"] = 36] = \"MALAYALAM\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"MONGOLIAN\"] = 37] = \"MONGOLIAN\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"MYANMAR\"] = 38] = \"MYANMAR\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"ORIYA\"] = 39] = \"ORIYA\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"PERSIAN\"] = 40] = \"PERSIAN\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"SIMP_CHINESE_FORMAL\"] = 41] = \"SIMP_CHINESE_FORMAL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"SIMP_CHINESE_INFORMAL\"] = 42] = \"SIMP_CHINESE_INFORMAL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"TAMIL\"] = 43] = \"TAMIL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"TELUGU\"] = 44] = \"TELUGU\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"THAI\"] = 45] = \"THAI\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"TIBETAN\"] = 46] = \"TIBETAN\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"TRAD_CHINESE_FORMAL\"] = 47] = \"TRAD_CHINESE_FORMAL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"TRAD_CHINESE_INFORMAL\"] = 48] = \"TRAD_CHINESE_INFORMAL\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"UPPER_ARMENIAN\"] = 49] = \"UPPER_ARMENIAN\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"DISCLOSURE_OPEN\"] = 50] = \"DISCLOSURE_OPEN\";\r\n        LIST_STYLE_TYPE[LIST_STYLE_TYPE[\"DISCLOSURE_CLOSED\"] = 51] = \"DISCLOSURE_CLOSED\";\r\n    })(LIST_STYLE_TYPE || (LIST_STYLE_TYPE = {}));\r\n    var listStyleType = {\r\n        name: 'list-style-type',\r\n        initialValue: 'none',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (type) {\r\n            switch (type) {\r\n                case 'disc':\r\n                    return LIST_STYLE_TYPE.DISC;\r\n                case 'circle':\r\n                    return LIST_STYLE_TYPE.CIRCLE;\r\n                case 'square':\r\n                    return LIST_STYLE_TYPE.SQUARE;\r\n                case 'decimal':\r\n                    return LIST_STYLE_TYPE.DECIMAL;\r\n                case 'cjk-decimal':\r\n                    return LIST_STYLE_TYPE.CJK_DECIMAL;\r\n                case 'decimal-leading-zero':\r\n                    return LIST_STYLE_TYPE.DECIMAL_LEADING_ZERO;\r\n                case 'lower-roman':\r\n                    return LIST_STYLE_TYPE.LOWER_ROMAN;\r\n                case 'upper-roman':\r\n                    return LIST_STYLE_TYPE.UPPER_ROMAN;\r\n                case 'lower-greek':\r\n                    return LIST_STYLE_TYPE.LOWER_GREEK;\r\n                case 'lower-alpha':\r\n                    return LIST_STYLE_TYPE.LOWER_ALPHA;\r\n                case 'upper-alpha':\r\n                    return LIST_STYLE_TYPE.UPPER_ALPHA;\r\n                case 'arabic-indic':\r\n                    return LIST_STYLE_TYPE.ARABIC_INDIC;\r\n                case 'armenian':\r\n                    return LIST_STYLE_TYPE.ARMENIAN;\r\n                case 'bengali':\r\n                    return LIST_STYLE_TYPE.BENGALI;\r\n                case 'cambodian':\r\n                    return LIST_STYLE_TYPE.CAMBODIAN;\r\n                case 'cjk-earthly-branch':\r\n                    return LIST_STYLE_TYPE.CJK_EARTHLY_BRANCH;\r\n                case 'cjk-heavenly-stem':\r\n                    return LIST_STYLE_TYPE.CJK_HEAVENLY_STEM;\r\n                case 'cjk-ideographic':\r\n                    return LIST_STYLE_TYPE.CJK_IDEOGRAPHIC;\r\n                case 'devanagari':\r\n                    return LIST_STYLE_TYPE.DEVANAGARI;\r\n                case 'ethiopic-numeric':\r\n                    return LIST_STYLE_TYPE.ETHIOPIC_NUMERIC;\r\n                case 'georgian':\r\n                    return LIST_STYLE_TYPE.GEORGIAN;\r\n                case 'gujarati':\r\n                    return LIST_STYLE_TYPE.GUJARATI;\r\n                case 'gurmukhi':\r\n                    return LIST_STYLE_TYPE.GURMUKHI;\r\n                case 'hebrew':\r\n                    return LIST_STYLE_TYPE.HEBREW;\r\n                case 'hiragana':\r\n                    return LIST_STYLE_TYPE.HIRAGANA;\r\n                case 'hiragana-iroha':\r\n                    return LIST_STYLE_TYPE.HIRAGANA_IROHA;\r\n                case 'japanese-formal':\r\n                    return LIST_STYLE_TYPE.JAPANESE_FORMAL;\r\n                case 'japanese-informal':\r\n                    return LIST_STYLE_TYPE.JAPANESE_INFORMAL;\r\n                case 'kannada':\r\n                    return LIST_STYLE_TYPE.KANNADA;\r\n                case 'katakana':\r\n                    return LIST_STYLE_TYPE.KATAKANA;\r\n                case 'katakana-iroha':\r\n                    return LIST_STYLE_TYPE.KATAKANA_IROHA;\r\n                case 'khmer':\r\n                    return LIST_STYLE_TYPE.KHMER;\r\n                case 'korean-hangul-formal':\r\n                    return LIST_STYLE_TYPE.KOREAN_HANGUL_FORMAL;\r\n                case 'korean-hanja-formal':\r\n                    return LIST_STYLE_TYPE.KOREAN_HANJA_FORMAL;\r\n                case 'korean-hanja-informal':\r\n                    return LIST_STYLE_TYPE.KOREAN_HANJA_INFORMAL;\r\n                case 'lao':\r\n                    return LIST_STYLE_TYPE.LAO;\r\n                case 'lower-armenian':\r\n                    return LIST_STYLE_TYPE.LOWER_ARMENIAN;\r\n                case 'malayalam':\r\n                    return LIST_STYLE_TYPE.MALAYALAM;\r\n                case 'mongolian':\r\n                    return LIST_STYLE_TYPE.MONGOLIAN;\r\n                case 'myanmar':\r\n                    return LIST_STYLE_TYPE.MYANMAR;\r\n                case 'oriya':\r\n                    return LIST_STYLE_TYPE.ORIYA;\r\n                case 'persian':\r\n                    return LIST_STYLE_TYPE.PERSIAN;\r\n                case 'simp-chinese-formal':\r\n                    return LIST_STYLE_TYPE.SIMP_CHINESE_FORMAL;\r\n                case 'simp-chinese-informal':\r\n                    return LIST_STYLE_TYPE.SIMP_CHINESE_INFORMAL;\r\n                case 'tamil':\r\n                    return LIST_STYLE_TYPE.TAMIL;\r\n                case 'telugu':\r\n                    return LIST_STYLE_TYPE.TELUGU;\r\n                case 'thai':\r\n                    return LIST_STYLE_TYPE.THAI;\r\n                case 'tibetan':\r\n                    return LIST_STYLE_TYPE.TIBETAN;\r\n                case 'trad-chinese-formal':\r\n                    return LIST_STYLE_TYPE.TRAD_CHINESE_FORMAL;\r\n                case 'trad-chinese-informal':\r\n                    return LIST_STYLE_TYPE.TRAD_CHINESE_INFORMAL;\r\n                case 'upper-armenian':\r\n                    return LIST_STYLE_TYPE.UPPER_ARMENIAN;\r\n                case 'disclosure-open':\r\n                    return LIST_STYLE_TYPE.DISCLOSURE_OPEN;\r\n                case 'disclosure-closed':\r\n                    return LIST_STYLE_TYPE.DISCLOSURE_CLOSED;\r\n                case 'none':\r\n                default:\r\n                    return LIST_STYLE_TYPE.NONE;\r\n            }\r\n        }\r\n    };\r\n\r\n    var marginForSide = function (side) { return ({\r\n        name: \"margin-\" + side,\r\n        initialValue: '0',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.TOKEN_VALUE\r\n    }); };\r\n    var marginTop = marginForSide('top');\r\n    var marginRight = marginForSide('right');\r\n    var marginBottom = marginForSide('bottom');\r\n    var marginLeft = marginForSide('left');\r\n\r\n    var OVERFLOW;\r\n    (function (OVERFLOW) {\r\n        OVERFLOW[OVERFLOW[\"VISIBLE\"] = 0] = \"VISIBLE\";\r\n        OVERFLOW[OVERFLOW[\"HIDDEN\"] = 1] = \"HIDDEN\";\r\n        OVERFLOW[OVERFLOW[\"SCROLL\"] = 2] = \"SCROLL\";\r\n        OVERFLOW[OVERFLOW[\"AUTO\"] = 3] = \"AUTO\";\r\n    })(OVERFLOW || (OVERFLOW = {}));\r\n    var overflow = {\r\n        name: 'overflow',\r\n        initialValue: 'visible',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            return tokens.filter(isIdentToken).map(function (overflow) {\r\n                switch (overflow.value) {\r\n                    case 'hidden':\r\n                        return OVERFLOW.HIDDEN;\r\n                    case 'scroll':\r\n                        return OVERFLOW.SCROLL;\r\n                    case 'auto':\r\n                        return OVERFLOW.AUTO;\r\n                    case 'visible':\r\n                    default:\r\n                        return OVERFLOW.VISIBLE;\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    var OVERFLOW_WRAP;\r\n    (function (OVERFLOW_WRAP) {\r\n        OVERFLOW_WRAP[\"NORMAL\"] = \"normal\";\r\n        OVERFLOW_WRAP[\"BREAK_WORD\"] = \"break-word\";\r\n    })(OVERFLOW_WRAP || (OVERFLOW_WRAP = {}));\r\n    var overflowWrap = {\r\n        name: 'overflow-wrap',\r\n        initialValue: 'normal',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (overflow) {\r\n            switch (overflow) {\r\n                case 'break-word':\r\n                    return OVERFLOW_WRAP.BREAK_WORD;\r\n                case 'normal':\r\n                default:\r\n                    return OVERFLOW_WRAP.NORMAL;\r\n            }\r\n        }\r\n    };\r\n\r\n    var paddingForSide = function (side) { return ({\r\n        name: \"padding-\" + side,\r\n        initialValue: '0',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.TYPE_VALUE,\r\n        format: 'length-percentage'\r\n    }); };\r\n    var paddingTop = paddingForSide('top');\r\n    var paddingRight = paddingForSide('right');\r\n    var paddingBottom = paddingForSide('bottom');\r\n    var paddingLeft = paddingForSide('left');\r\n\r\n    var TEXT_ALIGN;\r\n    (function (TEXT_ALIGN) {\r\n        TEXT_ALIGN[TEXT_ALIGN[\"LEFT\"] = 0] = \"LEFT\";\r\n        TEXT_ALIGN[TEXT_ALIGN[\"CENTER\"] = 1] = \"CENTER\";\r\n        TEXT_ALIGN[TEXT_ALIGN[\"RIGHT\"] = 2] = \"RIGHT\";\r\n    })(TEXT_ALIGN || (TEXT_ALIGN = {}));\r\n    var textAlign = {\r\n        name: 'text-align',\r\n        initialValue: 'left',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (textAlign) {\r\n            switch (textAlign) {\r\n                case 'right':\r\n                    return TEXT_ALIGN.RIGHT;\r\n                case 'center':\r\n                case 'justify':\r\n                    return TEXT_ALIGN.CENTER;\r\n                case 'left':\r\n                default:\r\n                    return TEXT_ALIGN.LEFT;\r\n            }\r\n        }\r\n    };\r\n\r\n    var POSITION;\r\n    (function (POSITION) {\r\n        POSITION[POSITION[\"STATIC\"] = 0] = \"STATIC\";\r\n        POSITION[POSITION[\"RELATIVE\"] = 1] = \"RELATIVE\";\r\n        POSITION[POSITION[\"ABSOLUTE\"] = 2] = \"ABSOLUTE\";\r\n        POSITION[POSITION[\"FIXED\"] = 3] = \"FIXED\";\r\n        POSITION[POSITION[\"STICKY\"] = 4] = \"STICKY\";\r\n    })(POSITION || (POSITION = {}));\r\n    var position = {\r\n        name: 'position',\r\n        initialValue: 'static',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (position) {\r\n            switch (position) {\r\n                case 'relative':\r\n                    return POSITION.RELATIVE;\r\n                case 'absolute':\r\n                    return POSITION.ABSOLUTE;\r\n                case 'fixed':\r\n                    return POSITION.FIXED;\r\n                case 'sticky':\r\n                    return POSITION.STICKY;\r\n            }\r\n            return POSITION.STATIC;\r\n        }\r\n    };\r\n\r\n    var textShadow = {\r\n        name: 'text-shadow',\r\n        initialValue: 'none',\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        prefix: false,\r\n        parse: function (tokens) {\r\n            if (tokens.length === 1 && isIdentWithValue(tokens[0], 'none')) {\r\n                return [];\r\n            }\r\n            return parseFunctionArgs(tokens).map(function (values) {\r\n                var shadow = {\r\n                    color: COLORS.TRANSPARENT,\r\n                    offsetX: ZERO_LENGTH,\r\n                    offsetY: ZERO_LENGTH,\r\n                    blur: ZERO_LENGTH\r\n                };\r\n                var c = 0;\r\n                for (var i = 0; i < values.length; i++) {\r\n                    var token = values[i];\r\n                    if (isLength(token)) {\r\n                        if (c === 0) {\r\n                            shadow.offsetX = token;\r\n                        }\r\n                        else if (c === 1) {\r\n                            shadow.offsetY = token;\r\n                        }\r\n                        else {\r\n                            shadow.blur = token;\r\n                        }\r\n                        c++;\r\n                    }\r\n                    else {\r\n                        shadow.color = color.parse(token);\r\n                    }\r\n                }\r\n                return shadow;\r\n            });\r\n        }\r\n    };\r\n\r\n    var TEXT_TRANSFORM;\r\n    (function (TEXT_TRANSFORM) {\r\n        TEXT_TRANSFORM[TEXT_TRANSFORM[\"NONE\"] = 0] = \"NONE\";\r\n        TEXT_TRANSFORM[TEXT_TRANSFORM[\"LOWERCASE\"] = 1] = \"LOWERCASE\";\r\n        TEXT_TRANSFORM[TEXT_TRANSFORM[\"UPPERCASE\"] = 2] = \"UPPERCASE\";\r\n        TEXT_TRANSFORM[TEXT_TRANSFORM[\"CAPITALIZE\"] = 3] = \"CAPITALIZE\";\r\n    })(TEXT_TRANSFORM || (TEXT_TRANSFORM = {}));\r\n    var textTransform = {\r\n        name: 'text-transform',\r\n        initialValue: 'none',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (textTransform) {\r\n            switch (textTransform) {\r\n                case 'uppercase':\r\n                    return TEXT_TRANSFORM.UPPERCASE;\r\n                case 'lowercase':\r\n                    return TEXT_TRANSFORM.LOWERCASE;\r\n                case 'capitalize':\r\n                    return TEXT_TRANSFORM.CAPITALIZE;\r\n            }\r\n            return TEXT_TRANSFORM.NONE;\r\n        }\r\n    };\r\n\r\n    var transform = {\r\n        name: 'transform',\r\n        initialValue: 'none',\r\n        prefix: true,\r\n        type: PropertyDescriptorParsingType.VALUE,\r\n        parse: function (token) {\r\n            if (token.type === TokenType.IDENT_TOKEN && token.value === 'none') {\r\n                return null;\r\n            }\r\n            if (token.type === TokenType.FUNCTION) {\r\n                var transformFunction = SUPPORTED_TRANSFORM_FUNCTIONS[token.name];\r\n                if (typeof transformFunction === 'undefined') {\r\n                    throw new Error(\"Attempting to parse an unsupported transform function \\\"\" + token.name + \"\\\"\");\r\n                }\r\n                return transformFunction(token.values);\r\n            }\r\n            return null;\r\n        }\r\n    };\r\n    var matrix = function (args) {\r\n        var values = args.filter(function (arg) { return arg.type === TokenType.NUMBER_TOKEN; }).map(function (arg) { return arg.number; });\r\n        return values.length === 6 ? values : null;\r\n    };\r\n    // doesn't support 3D transforms at the moment\r\n    var matrix3d = function (args) {\r\n        var values = args.filter(function (arg) { return arg.type === TokenType.NUMBER_TOKEN; }).map(function (arg) { return arg.number; });\r\n        var a1 = values[0], b1 = values[1], _a = values[2], _b = values[3], a2 = values[4], b2 = values[5], _c = values[6], _d = values[7], _e = values[8], _f = values[9], _g = values[10], _h = values[11], a4 = values[12], b4 = values[13], _j = values[14], _k = values[15];\r\n        return values.length === 16 ? [a1, b1, a2, b2, a4, b4] : null;\r\n    };\r\n    var SUPPORTED_TRANSFORM_FUNCTIONS = {\r\n        matrix: matrix,\r\n        matrix3d: matrix3d\r\n    };\r\n\r\n    var DEFAULT_VALUE = {\r\n        type: TokenType.PERCENTAGE_TOKEN,\r\n        number: 50,\r\n        flags: FLAG_INTEGER\r\n    };\r\n    var DEFAULT = [DEFAULT_VALUE, DEFAULT_VALUE];\r\n    var transformOrigin = {\r\n        name: 'transform-origin',\r\n        initialValue: '50% 50%',\r\n        prefix: true,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            var origins = tokens.filter(isLengthPercentage);\r\n            if (origins.length !== 2) {\r\n                return DEFAULT;\r\n            }\r\n            return [origins[0], origins[1]];\r\n        }\r\n    };\r\n\r\n    var VISIBILITY;\r\n    (function (VISIBILITY) {\r\n        VISIBILITY[VISIBILITY[\"VISIBLE\"] = 0] = \"VISIBLE\";\r\n        VISIBILITY[VISIBILITY[\"HIDDEN\"] = 1] = \"HIDDEN\";\r\n        VISIBILITY[VISIBILITY[\"COLLAPSE\"] = 2] = \"COLLAPSE\";\r\n    })(VISIBILITY || (VISIBILITY = {}));\r\n    var visibility = {\r\n        name: 'visible',\r\n        initialValue: 'none',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (visibility) {\r\n            switch (visibility) {\r\n                case 'hidden':\r\n                    return VISIBILITY.HIDDEN;\r\n                case 'collapse':\r\n                    return VISIBILITY.COLLAPSE;\r\n                case 'visible':\r\n                default:\r\n                    return VISIBILITY.VISIBLE;\r\n            }\r\n        }\r\n    };\r\n\r\n    var WORD_BREAK;\r\n    (function (WORD_BREAK) {\r\n        WORD_BREAK[\"NORMAL\"] = \"normal\";\r\n        WORD_BREAK[\"BREAK_ALL\"] = \"break-all\";\r\n        WORD_BREAK[\"KEEP_ALL\"] = \"keep-all\";\r\n    })(WORD_BREAK || (WORD_BREAK = {}));\r\n    var wordBreak = {\r\n        name: 'word-break',\r\n        initialValue: 'normal',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (wordBreak) {\r\n            switch (wordBreak) {\r\n                case 'break-all':\r\n                    return WORD_BREAK.BREAK_ALL;\r\n                case 'keep-all':\r\n                    return WORD_BREAK.KEEP_ALL;\r\n                case 'normal':\r\n                default:\r\n                    return WORD_BREAK.NORMAL;\r\n            }\r\n        }\r\n    };\r\n\r\n    var zIndex = {\r\n        name: 'z-index',\r\n        initialValue: 'auto',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.VALUE,\r\n        parse: function (token) {\r\n            if (token.type === TokenType.IDENT_TOKEN) {\r\n                return { auto: true, order: 0 };\r\n            }\r\n            if (isNumberToken(token)) {\r\n                return { auto: false, order: token.number };\r\n            }\r\n            throw new Error(\"Invalid z-index number parsed\");\r\n        }\r\n    };\r\n\r\n    var opacity = {\r\n        name: 'opacity',\r\n        initialValue: '1',\r\n        type: PropertyDescriptorParsingType.VALUE,\r\n        prefix: false,\r\n        parse: function (token) {\r\n            if (isNumberToken(token)) {\r\n                return token.number;\r\n            }\r\n            return 1;\r\n        }\r\n    };\r\n\r\n    var textDecorationColor = {\r\n        name: \"text-decoration-color\",\r\n        initialValue: 'transparent',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.TYPE_VALUE,\r\n        format: 'color'\r\n    };\r\n\r\n    var textDecorationLine = {\r\n        name: 'text-decoration-line',\r\n        initialValue: 'none',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            return tokens\r\n                .filter(isIdentToken)\r\n                .map(function (token) {\r\n                switch (token.value) {\r\n                    case 'underline':\r\n                        return 1 /* UNDERLINE */;\r\n                    case 'overline':\r\n                        return 2 /* OVERLINE */;\r\n                    case 'line-through':\r\n                        return 3 /* LINE_THROUGH */;\r\n                    case 'none':\r\n                        return 4 /* BLINK */;\r\n                }\r\n                return 0 /* NONE */;\r\n            })\r\n                .filter(function (line) { return line !== 0 /* NONE */; });\r\n        }\r\n    };\r\n\r\n    var fontFamily = {\r\n        name: \"font-family\",\r\n        initialValue: '',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            var accumulator = [];\r\n            var results = [];\r\n            tokens.forEach(function (token) {\r\n                switch (token.type) {\r\n                    case TokenType.IDENT_TOKEN:\r\n                    case TokenType.STRING_TOKEN:\r\n                        accumulator.push(token.value);\r\n                        break;\r\n                    case TokenType.NUMBER_TOKEN:\r\n                        accumulator.push(token.number.toString());\r\n                        break;\r\n                    case TokenType.COMMA_TOKEN:\r\n                        results.push(accumulator.join(' '));\r\n                        accumulator.length = 0;\r\n                        break;\r\n                }\r\n            });\r\n            if (accumulator.length) {\r\n                results.push(accumulator.join(' '));\r\n            }\r\n            return results.map(function (result) { return (result.indexOf(' ') === -1 ? result : \"'\" + result + \"'\"); });\r\n        }\r\n    };\r\n\r\n    var fontSize = {\r\n        name: \"font-size\",\r\n        initialValue: '0',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.TYPE_VALUE,\r\n        format: 'length'\r\n    };\r\n\r\n    var fontWeight = {\r\n        name: 'font-weight',\r\n        initialValue: 'normal',\r\n        type: PropertyDescriptorParsingType.VALUE,\r\n        prefix: false,\r\n        parse: function (token) {\r\n            if (isNumberToken(token)) {\r\n                return token.number;\r\n            }\r\n            if (isIdentToken(token)) {\r\n                switch (token.value) {\r\n                    case 'bold':\r\n                        return 700;\r\n                    case 'normal':\r\n                    default:\r\n                        return 400;\r\n                }\r\n            }\r\n            return 400;\r\n        }\r\n    };\r\n\r\n    var fontVariant = {\r\n        name: 'font-variant',\r\n        initialValue: 'none',\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        prefix: false,\r\n        parse: function (tokens) {\r\n            return tokens.filter(isIdentToken).map(function (token) { return token.value; });\r\n        }\r\n    };\r\n\r\n    var FONT_STYLE;\r\n    (function (FONT_STYLE) {\r\n        FONT_STYLE[\"NORMAL\"] = \"normal\";\r\n        FONT_STYLE[\"ITALIC\"] = \"italic\";\r\n        FONT_STYLE[\"OBLIQUE\"] = \"oblique\";\r\n    })(FONT_STYLE || (FONT_STYLE = {}));\r\n    var fontStyle = {\r\n        name: 'font-style',\r\n        initialValue: 'normal',\r\n        prefix: false,\r\n        type: PropertyDescriptorParsingType.IDENT_VALUE,\r\n        parse: function (overflow) {\r\n            switch (overflow) {\r\n                case 'oblique':\r\n                    return FONT_STYLE.OBLIQUE;\r\n                case 'italic':\r\n                    return FONT_STYLE.ITALIC;\r\n                case 'normal':\r\n                default:\r\n                    return FONT_STYLE.NORMAL;\r\n            }\r\n        }\r\n    };\r\n\r\n    var contains = function (bit, value) { return (bit & value) !== 0; };\r\n\r\n    var content = {\r\n        name: 'content',\r\n        initialValue: 'none',\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        prefix: false,\r\n        parse: function (tokens) {\r\n            if (tokens.length === 0) {\r\n                return [];\r\n            }\r\n            var first = tokens[0];\r\n            if (first.type === TokenType.IDENT_TOKEN && first.value === 'none') {\r\n                return [];\r\n            }\r\n            return tokens;\r\n        }\r\n    };\r\n\r\n    var counterIncrement = {\r\n        name: 'counter-increment',\r\n        initialValue: 'none',\r\n        prefix: true,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            if (tokens.length === 0) {\r\n                return null;\r\n            }\r\n            var first = tokens[0];\r\n            if (first.type === TokenType.IDENT_TOKEN && first.value === 'none') {\r\n                return null;\r\n            }\r\n            var increments = [];\r\n            var filtered = tokens.filter(nonWhiteSpace);\r\n            for (var i = 0; i < filtered.length; i++) {\r\n                var counter = filtered[i];\r\n                var next = filtered[i + 1];\r\n                if (counter.type === TokenType.IDENT_TOKEN) {\r\n                    var increment = next && isNumberToken(next) ? next.number : 1;\r\n                    increments.push({ counter: counter.value, increment: increment });\r\n                }\r\n            }\r\n            return increments;\r\n        }\r\n    };\r\n\r\n    var counterReset = {\r\n        name: 'counter-reset',\r\n        initialValue: 'none',\r\n        prefix: true,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            if (tokens.length === 0) {\r\n                return [];\r\n            }\r\n            var resets = [];\r\n            var filtered = tokens.filter(nonWhiteSpace);\r\n            for (var i = 0; i < filtered.length; i++) {\r\n                var counter = filtered[i];\r\n                var next = filtered[i + 1];\r\n                if (isIdentToken(counter) && counter.value !== 'none') {\r\n                    var reset = next && isNumberToken(next) ? next.number : 0;\r\n                    resets.push({ counter: counter.value, reset: reset });\r\n                }\r\n            }\r\n            return resets;\r\n        }\r\n    };\r\n\r\n    var quotes = {\r\n        name: 'quotes',\r\n        initialValue: 'none',\r\n        prefix: true,\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        parse: function (tokens) {\r\n            if (tokens.length === 0) {\r\n                return null;\r\n            }\r\n            var first = tokens[0];\r\n            if (first.type === TokenType.IDENT_TOKEN && first.value === 'none') {\r\n                return null;\r\n            }\r\n            var quotes = [];\r\n            var filtered = tokens.filter(isStringToken);\r\n            if (filtered.length % 2 !== 0) {\r\n                return null;\r\n            }\r\n            for (var i = 0; i < filtered.length; i += 2) {\r\n                var open_1 = filtered[i].value;\r\n                var close_1 = filtered[i + 1].value;\r\n                quotes.push({ open: open_1, close: close_1 });\r\n            }\r\n            return quotes;\r\n        }\r\n    };\r\n    var getQuote = function (quotes, depth, open) {\r\n        if (!quotes) {\r\n            return '';\r\n        }\r\n        var quote = quotes[Math.min(depth, quotes.length - 1)];\r\n        if (!quote) {\r\n            return '';\r\n        }\r\n        return open ? quote.open : quote.close;\r\n    };\r\n\r\n    var boxShadow = {\r\n        name: 'box-shadow',\r\n        initialValue: 'none',\r\n        type: PropertyDescriptorParsingType.LIST,\r\n        prefix: false,\r\n        parse: function (tokens) {\r\n            if (tokens.length === 1 && isIdentWithValue(tokens[0], 'none')) {\r\n                return [];\r\n            }\r\n            return parseFunctionArgs(tokens).map(function (values) {\r\n                var shadow = {\r\n                    color: 0x000000ff,\r\n                    offsetX: ZERO_LENGTH,\r\n                    offsetY: ZERO_LENGTH,\r\n                    blur: ZERO_LENGTH,\r\n                    spread: ZERO_LENGTH,\r\n                    inset: false\r\n                };\r\n                var c = 0;\r\n                for (var i = 0; i < values.length; i++) {\r\n                    var token = values[i];\r\n                    if (isIdentWithValue(token, 'inset')) {\r\n                        shadow.inset = true;\r\n                    }\r\n                    else if (isLength(token)) {\r\n                        if (c === 0) {\r\n                            shadow.offsetX = token;\r\n                        }\r\n                        else if (c === 1) {\r\n                            shadow.offsetY = token;\r\n                        }\r\n                        else if (c === 2) {\r\n                            shadow.blur = token;\r\n                        }\r\n                        else {\r\n                            shadow.spread = token;\r\n                        }\r\n                        c++;\r\n                    }\r\n                    else {\r\n                        shadow.color = color.parse(token);\r\n                    }\r\n                }\r\n                return shadow;\r\n            });\r\n        }\r\n    };\r\n\r\n    var CSSParsedDeclaration = /** @class */ (function () {\r\n        function CSSParsedDeclaration(declaration) {\r\n            this.backgroundClip = parse(backgroundClip, declaration.backgroundClip);\r\n            this.backgroundColor = parse(backgroundColor, declaration.backgroundColor);\r\n            this.backgroundImage = parse(backgroundImage, declaration.backgroundImage);\r\n            this.backgroundOrigin = parse(backgroundOrigin, declaration.backgroundOrigin);\r\n            this.backgroundPosition = parse(backgroundPosition, declaration.backgroundPosition);\r\n            this.backgroundRepeat = parse(backgroundRepeat, declaration.backgroundRepeat);\r\n            this.backgroundSize = parse(backgroundSize, declaration.backgroundSize);\r\n            this.borderTopColor = parse(borderTopColor, declaration.borderTopColor);\r\n            this.borderRightColor = parse(borderRightColor, declaration.borderRightColor);\r\n            this.borderBottomColor = parse(borderBottomColor, declaration.borderBottomColor);\r\n            this.borderLeftColor = parse(borderLeftColor, declaration.borderLeftColor);\r\n            this.borderTopLeftRadius = parse(borderTopLeftRadius, declaration.borderTopLeftRadius);\r\n            this.borderTopRightRadius = parse(borderTopRightRadius, declaration.borderTopRightRadius);\r\n            this.borderBottomRightRadius = parse(borderBottomRightRadius, declaration.borderBottomRightRadius);\r\n            this.borderBottomLeftRadius = parse(borderBottomLeftRadius, declaration.borderBottomLeftRadius);\r\n            this.borderTopStyle = parse(borderTopStyle, declaration.borderTopStyle);\r\n            this.borderRightStyle = parse(borderRightStyle, declaration.borderRightStyle);\r\n            this.borderBottomStyle = parse(borderBottomStyle, declaration.borderBottomStyle);\r\n            this.borderLeftStyle = parse(borderLeftStyle, declaration.borderLeftStyle);\r\n            this.borderTopWidth = parse(borderTopWidth, declaration.borderTopWidth);\r\n            this.borderRightWidth = parse(borderRightWidth, declaration.borderRightWidth);\r\n            this.borderBottomWidth = parse(borderBottomWidth, declaration.borderBottomWidth);\r\n            this.borderLeftWidth = parse(borderLeftWidth, declaration.borderLeftWidth);\r\n            this.boxShadow = parse(boxShadow, declaration.boxShadow);\r\n            this.color = parse(color$1, declaration.color);\r\n            this.display = parse(display, declaration.display);\r\n            this.float = parse(float, declaration.cssFloat);\r\n            this.fontFamily = parse(fontFamily, declaration.fontFamily);\r\n            this.fontSize = parse(fontSize, declaration.fontSize);\r\n            this.fontStyle = parse(fontStyle, declaration.fontStyle);\r\n            this.fontVariant = parse(fontVariant, declaration.fontVariant);\r\n            this.fontWeight = parse(fontWeight, declaration.fontWeight);\r\n            this.letterSpacing = parse(letterSpacing, declaration.letterSpacing);\r\n            this.lineBreak = parse(lineBreak, declaration.lineBreak);\r\n            this.lineHeight = parse(lineHeight, declaration.lineHeight);\r\n            this.listStyleImage = parse(listStyleImage, declaration.listStyleImage);\r\n            this.listStylePosition = parse(listStylePosition, declaration.listStylePosition);\r\n            this.listStyleType = parse(listStyleType, declaration.listStyleType);\r\n            this.marginTop = parse(marginTop, declaration.marginTop);\r\n            this.marginRight = parse(marginRight, declaration.marginRight);\r\n            this.marginBottom = parse(marginBottom, declaration.marginBottom);\r\n            this.marginLeft = parse(marginLeft, declaration.marginLeft);\r\n            this.opacity = parse(opacity, declaration.opacity);\r\n            var overflowTuple = parse(overflow, declaration.overflow);\r\n            this.overflowX = overflowTuple[0];\r\n            this.overflowY = overflowTuple[overflowTuple.length > 1 ? 1 : 0];\r\n            this.overflowWrap = parse(overflowWrap, declaration.overflowWrap);\r\n            this.paddingTop = parse(paddingTop, declaration.paddingTop);\r\n            this.paddingRight = parse(paddingRight, declaration.paddingRight);\r\n            this.paddingBottom = parse(paddingBottom, declaration.paddingBottom);\r\n            this.paddingLeft = parse(paddingLeft, declaration.paddingLeft);\r\n            this.position = parse(position, declaration.position);\r\n            this.textAlign = parse(textAlign, declaration.textAlign);\r\n            this.textDecorationColor = parse(textDecorationColor, declaration.textDecorationColor || declaration.color);\r\n            this.textDecorationLine = parse(textDecorationLine, declaration.textDecorationLine);\r\n            this.textShadow = parse(textShadow, declaration.textShadow);\r\n            this.textTransform = parse(textTransform, declaration.textTransform);\r\n            this.transform = parse(transform, declaration.transform);\r\n            this.transformOrigin = parse(transformOrigin, declaration.transformOrigin);\r\n            this.visibility = parse(visibility, declaration.visibility);\r\n            this.wordBreak = parse(wordBreak, declaration.wordBreak);\r\n            this.zIndex = parse(zIndex, declaration.zIndex);\r\n        }\r\n        CSSParsedDeclaration.prototype.isVisible = function () {\r\n            return this.display > 0 && this.opacity > 0 && this.visibility === VISIBILITY.VISIBLE;\r\n        };\r\n        CSSParsedDeclaration.prototype.isTransparent = function () {\r\n            return isTransparent(this.backgroundColor);\r\n        };\r\n        CSSParsedDeclaration.prototype.isTransformed = function () {\r\n            return this.transform !== null;\r\n        };\r\n        CSSParsedDeclaration.prototype.isPositioned = function () {\r\n            return this.position !== POSITION.STATIC;\r\n        };\r\n        CSSParsedDeclaration.prototype.isPositionedWithZIndex = function () {\r\n            return this.isPositioned() && !this.zIndex.auto;\r\n        };\r\n        CSSParsedDeclaration.prototype.isFloating = function () {\r\n            return this.float !== FLOAT.NONE;\r\n        };\r\n        CSSParsedDeclaration.prototype.isInlineLevel = function () {\r\n            return (contains(this.display, 4 /* INLINE */) ||\r\n                contains(this.display, 33554432 /* INLINE_BLOCK */) ||\r\n                contains(this.display, 268435456 /* INLINE_FLEX */) ||\r\n                contains(this.display, 536870912 /* INLINE_GRID */) ||\r\n                contains(this.display, 67108864 /* INLINE_LIST_ITEM */) ||\r\n                contains(this.display, 134217728 /* INLINE_TABLE */));\r\n        };\r\n        return CSSParsedDeclaration;\r\n    }());\r\n    var CSSParsedPseudoDeclaration = /** @class */ (function () {\r\n        function CSSParsedPseudoDeclaration(declaration) {\r\n            this.content = parse(content, declaration.content);\r\n            this.quotes = parse(quotes, declaration.quotes);\r\n        }\r\n        return CSSParsedPseudoDeclaration;\r\n    }());\r\n    var CSSParsedCounterDeclaration = /** @class */ (function () {\r\n        function CSSParsedCounterDeclaration(declaration) {\r\n            this.counterIncrement = parse(counterIncrement, declaration.counterIncrement);\r\n            this.counterReset = parse(counterReset, declaration.counterReset);\r\n        }\r\n        return CSSParsedCounterDeclaration;\r\n    }());\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    var parse = function (descriptor, style) {\r\n        var tokenizer = new Tokenizer();\r\n        var value = style !== null && typeof style !== 'undefined' ? style.toString() : descriptor.initialValue;\r\n        tokenizer.write(value);\r\n        var parser = new Parser(tokenizer.read());\r\n        switch (descriptor.type) {\r\n            case PropertyDescriptorParsingType.IDENT_VALUE:\r\n                var token = parser.parseComponentValue();\r\n                return descriptor.parse(isIdentToken(token) ? token.value : descriptor.initialValue);\r\n            case PropertyDescriptorParsingType.VALUE:\r\n                return descriptor.parse(parser.parseComponentValue());\r\n            case PropertyDescriptorParsingType.LIST:\r\n                return descriptor.parse(parser.parseComponentValues());\r\n            case PropertyDescriptorParsingType.TOKEN_VALUE:\r\n                return parser.parseComponentValue();\r\n            case PropertyDescriptorParsingType.TYPE_VALUE:\r\n                switch (descriptor.format) {\r\n                    case 'angle':\r\n                        return angle.parse(parser.parseComponentValue());\r\n                    case 'color':\r\n                        return color.parse(parser.parseComponentValue());\r\n                    case 'image':\r\n                        return image.parse(parser.parseComponentValue());\r\n                    case 'length':\r\n                        var length_1 = parser.parseComponentValue();\r\n                        return isLength(length_1) ? length_1 : ZERO_LENGTH;\r\n                    case 'length-percentage':\r\n                        var value_1 = parser.parseComponentValue();\r\n                        return isLengthPercentage(value_1) ? value_1 : ZERO_LENGTH;\r\n                }\r\n        }\r\n        throw new Error(\"Attempting to parse unsupported css format type \" + descriptor.format);\r\n    };\r\n\r\n    var ElementContainer = /** @class */ (function () {\r\n        function ElementContainer(element) {\r\n            this.styles = new CSSParsedDeclaration(window.getComputedStyle(element, null));\r\n            this.textNodes = [];\r\n            this.elements = [];\r\n            if (this.styles.transform !== null && isHTMLElementNode(element)) {\r\n                // getBoundingClientRect takes transforms into account\r\n                element.style.transform = 'none';\r\n            }\r\n            this.bounds = parseBounds(element);\r\n            this.flags = 0;\r\n        }\r\n        return ElementContainer;\r\n    }());\r\n\r\n    var TextBounds = /** @class */ (function () {\r\n        function TextBounds(text, bounds) {\r\n            this.text = text;\r\n            this.bounds = bounds;\r\n        }\r\n        return TextBounds;\r\n    }());\r\n    var parseTextBounds = function (value, styles, node) {\r\n        var textList = breakText(value, styles);\r\n        var textBounds = [];\r\n        var offset = 0;\r\n        textList.forEach(function (text) {\r\n            if (styles.textDecorationLine.length || text.trim().length > 0) {\r\n                if (FEATURES.SUPPORT_RANGE_BOUNDS) {\r\n                    textBounds.push(new TextBounds(text, getRangeBounds(node, offset, text.length)));\r\n                }\r\n                else {\r\n                    var replacementNode = node.splitText(text.length);\r\n                    textBounds.push(new TextBounds(text, getWrapperBounds(node)));\r\n                    node = replacementNode;\r\n                }\r\n            }\r\n            else if (!FEATURES.SUPPORT_RANGE_BOUNDS) {\r\n                node = node.splitText(text.length);\r\n            }\r\n            offset += text.length;\r\n        });\r\n        return textBounds;\r\n    };\r\n    var getWrapperBounds = function (node) {\r\n        var ownerDocument = node.ownerDocument;\r\n        if (ownerDocument) {\r\n            var wrapper = ownerDocument.createElement('html2canvaswrapper');\r\n            wrapper.appendChild(node.cloneNode(true));\r\n            var parentNode = node.parentNode;\r\n            if (parentNode) {\r\n                parentNode.replaceChild(wrapper, node);\r\n                var bounds = parseBounds(wrapper);\r\n                if (wrapper.firstChild) {\r\n                    parentNode.replaceChild(wrapper.firstChild, wrapper);\r\n                }\r\n                return bounds;\r\n            }\r\n        }\r\n        return new Bounds(0, 0, 0, 0);\r\n    };\r\n    var getRangeBounds = function (node, offset, length) {\r\n        var ownerDocument = node.ownerDocument;\r\n        if (!ownerDocument) {\r\n            throw new Error('Node has no owner document');\r\n        }\r\n        var range = ownerDocument.createRange();\r\n        range.setStart(node, offset);\r\n        range.setEnd(node, offset + length);\r\n        return Bounds.fromClientRect(range.getBoundingClientRect());\r\n    };\r\n    var breakText = function (value, styles) {\r\n        return styles.letterSpacing !== 0 ? toCodePoints(value).map(function (i) { return fromCodePoint(i); }) : breakWords(value, styles);\r\n    };\r\n    var breakWords = function (str, styles) {\r\n        var breaker = LineBreaker(str, {\r\n            lineBreak: styles.lineBreak,\r\n            wordBreak: styles.overflowWrap === OVERFLOW_WRAP.BREAK_WORD ? 'break-word' : styles.wordBreak\r\n        });\r\n        var words = [];\r\n        var bk;\r\n        while (!(bk = breaker.next()).done) {\r\n            if (bk.value) {\r\n                words.push(bk.value.slice());\r\n            }\r\n        }\r\n        return words;\r\n    };\r\n\r\n    var TextContainer = /** @class */ (function () {\r\n        function TextContainer(node, styles) {\r\n            this.text = transform$1(node.data, styles.textTransform);\r\n            this.textBounds = parseTextBounds(this.text, styles, node);\r\n        }\r\n        return TextContainer;\r\n    }());\r\n    var transform$1 = function (text, transform) {\r\n        switch (transform) {\r\n            case TEXT_TRANSFORM.LOWERCASE:\r\n                return text.toLowerCase();\r\n            case TEXT_TRANSFORM.CAPITALIZE:\r\n                return text.replace(CAPITALIZE, capitalize);\r\n            case TEXT_TRANSFORM.UPPERCASE:\r\n                return text.toUpperCase();\r\n            default:\r\n                return text;\r\n        }\r\n    };\r\n    var CAPITALIZE = /(^|\\s|:|-|\\(|\\))([a-z])/g;\r\n    var capitalize = function (m, p1, p2) {\r\n        if (m.length > 0) {\r\n            return p1 + p2.toUpperCase();\r\n        }\r\n        return m;\r\n    };\r\n\r\n    var ImageElementContainer = /** @class */ (function (_super) {\r\n        __extends(ImageElementContainer, _super);\r\n        function ImageElementContainer(img) {\r\n            var _this = _super.call(this, img) || this;\r\n            _this.src = img.currentSrc || img.src;\r\n            _this.intrinsicWidth = img.naturalWidth;\r\n            _this.intrinsicHeight = img.naturalHeight;\r\n            CacheStorage.getInstance().addImage(_this.src);\r\n            return _this;\r\n        }\r\n        return ImageElementContainer;\r\n    }(ElementContainer));\r\n\r\n    var CanvasElementContainer = /** @class */ (function (_super) {\r\n        __extends(CanvasElementContainer, _super);\r\n        function CanvasElementContainer(canvas) {\r\n            var _this = _super.call(this, canvas) || this;\r\n            _this.canvas = canvas;\r\n            _this.intrinsicWidth = canvas.width;\r\n            _this.intrinsicHeight = canvas.height;\r\n            return _this;\r\n        }\r\n        return CanvasElementContainer;\r\n    }(ElementContainer));\r\n\r\n    var SVGElementContainer = /** @class */ (function (_super) {\r\n        __extends(SVGElementContainer, _super);\r\n        function SVGElementContainer(img) {\r\n            var _this = _super.call(this, img) || this;\r\n            var s = new XMLSerializer();\r\n            _this.svg = \"data:image/svg+xml,\" + encodeURIComponent(s.serializeToString(img));\r\n            _this.intrinsicWidth = img.width.baseVal.value;\r\n            _this.intrinsicHeight = img.height.baseVal.value;\r\n            CacheStorage.getInstance().addImage(_this.svg);\r\n            return _this;\r\n        }\r\n        return SVGElementContainer;\r\n    }(ElementContainer));\r\n\r\n    var LIElementContainer = /** @class */ (function (_super) {\r\n        __extends(LIElementContainer, _super);\r\n        function LIElementContainer(element) {\r\n            var _this = _super.call(this, element) || this;\r\n            _this.value = element.value;\r\n            return _this;\r\n        }\r\n        return LIElementContainer;\r\n    }(ElementContainer));\r\n\r\n    var OLElementContainer = /** @class */ (function (_super) {\r\n        __extends(OLElementContainer, _super);\r\n        function OLElementContainer(element) {\r\n            var _this = _super.call(this, element) || this;\r\n            _this.start = element.start;\r\n            _this.reversed = typeof element.reversed === 'boolean' && element.reversed === true;\r\n            return _this;\r\n        }\r\n        return OLElementContainer;\r\n    }(ElementContainer));\r\n\r\n    var CHECKBOX_BORDER_RADIUS = [\r\n        {\r\n            type: TokenType.DIMENSION_TOKEN,\r\n            flags: 0,\r\n            unit: 'px',\r\n            number: 3\r\n        }\r\n    ];\r\n    var RADIO_BORDER_RADIUS = [\r\n        {\r\n            type: TokenType.PERCENTAGE_TOKEN,\r\n            flags: 0,\r\n            number: 50\r\n        }\r\n    ];\r\n    var reformatInputBounds = function (bounds) {\r\n        if (bounds.width > bounds.height) {\r\n            return new Bounds(bounds.left + (bounds.width - bounds.height) / 2, bounds.top, bounds.height, bounds.height);\r\n        }\r\n        else if (bounds.width < bounds.height) {\r\n            return new Bounds(bounds.left, bounds.top + (bounds.height - bounds.width) / 2, bounds.width, bounds.width);\r\n        }\r\n        return bounds;\r\n    };\r\n    var getInputValue = function (node) {\r\n        var value = node.type === PASSWORD ? new Array(node.value.length + 1).join('\\u2022') : node.value;\r\n        return value.length === 0 ? node.placeholder || '' : value;\r\n    };\r\n    var CHECKBOX = 'checkbox';\r\n    var RADIO = 'radio';\r\n    var PASSWORD = 'password';\r\n    var INPUT_COLOR = 0x2a2a2aff;\r\n    var InputElementContainer = /** @class */ (function (_super) {\r\n        __extends(InputElementContainer, _super);\r\n        function InputElementContainer(input) {\r\n            var _this = _super.call(this, input) || this;\r\n            _this.type = input.type.toLowerCase();\r\n            _this.checked = input.checked;\r\n            _this.value = getInputValue(input);\r\n            if (_this.type === CHECKBOX || _this.type === RADIO) {\r\n                _this.styles.backgroundColor = 0xdededeff;\r\n                _this.styles.borderTopColor = _this.styles.borderRightColor = _this.styles.borderBottomColor = _this.styles.borderLeftColor = 0xa5a5a5ff;\r\n                _this.styles.borderTopWidth = _this.styles.borderRightWidth = _this.styles.borderBottomWidth = _this.styles.borderLeftWidth = 1;\r\n                _this.styles.borderTopStyle = _this.styles.borderRightStyle = _this.styles.borderBottomStyle = _this.styles.borderLeftStyle =\r\n                    BORDER_STYLE.SOLID;\r\n                _this.styles.backgroundClip = [BACKGROUND_CLIP.BORDER_BOX];\r\n                _this.styles.backgroundOrigin = [0 /* BORDER_BOX */];\r\n                _this.bounds = reformatInputBounds(_this.bounds);\r\n            }\r\n            switch (_this.type) {\r\n                case CHECKBOX:\r\n                    _this.styles.borderTopRightRadius = _this.styles.borderTopLeftRadius = _this.styles.borderBottomRightRadius = _this.styles.borderBottomLeftRadius = CHECKBOX_BORDER_RADIUS;\r\n                    break;\r\n                case RADIO:\r\n                    _this.styles.borderTopRightRadius = _this.styles.borderTopLeftRadius = _this.styles.borderBottomRightRadius = _this.styles.borderBottomLeftRadius = RADIO_BORDER_RADIUS;\r\n                    break;\r\n            }\r\n            return _this;\r\n        }\r\n        return InputElementContainer;\r\n    }(ElementContainer));\r\n\r\n    var SelectElementContainer = /** @class */ (function (_super) {\r\n        __extends(SelectElementContainer, _super);\r\n        function SelectElementContainer(element) {\r\n            var _this = _super.call(this, element) || this;\r\n            var option = element.options[element.selectedIndex || 0];\r\n            _this.value = option ? option.text || '' : '';\r\n            return _this;\r\n        }\r\n        return SelectElementContainer;\r\n    }(ElementContainer));\r\n\r\n    var TextareaElementContainer = /** @class */ (function (_super) {\r\n        __extends(TextareaElementContainer, _super);\r\n        function TextareaElementContainer(element) {\r\n            var _this = _super.call(this, element) || this;\r\n            _this.value = element.value;\r\n            return _this;\r\n        }\r\n        return TextareaElementContainer;\r\n    }(ElementContainer));\r\n\r\n    var parseColor = function (value) { return color.parse(Parser.create(value).parseComponentValue()); };\r\n    var IFrameElementContainer = /** @class */ (function (_super) {\r\n        __extends(IFrameElementContainer, _super);\r\n        function IFrameElementContainer(iframe) {\r\n            var _this = _super.call(this, iframe) || this;\r\n            _this.src = iframe.src;\r\n            _this.width = parseInt(iframe.width, 10) || 0;\r\n            _this.height = parseInt(iframe.height, 10) || 0;\r\n            _this.backgroundColor = _this.styles.backgroundColor;\r\n            try {\r\n                if (iframe.contentWindow &&\r\n                    iframe.contentWindow.document &&\r\n                    iframe.contentWindow.document.documentElement) {\r\n                    _this.tree = parseTree(iframe.contentWindow.document.documentElement);\r\n                    // http://www.w3.org/TR/css3-background/#special-backgrounds\r\n                    var documentBackgroundColor = iframe.contentWindow.document.documentElement\r\n                        ? parseColor(getComputedStyle(iframe.contentWindow.document.documentElement)\r\n                            .backgroundColor)\r\n                        : COLORS.TRANSPARENT;\r\n                    var bodyBackgroundColor = iframe.contentWindow.document.body\r\n                        ? parseColor(getComputedStyle(iframe.contentWindow.document.body).backgroundColor)\r\n                        : COLORS.TRANSPARENT;\r\n                    _this.backgroundColor = isTransparent(documentBackgroundColor)\r\n                        ? isTransparent(bodyBackgroundColor)\r\n                            ? _this.styles.backgroundColor\r\n                            : bodyBackgroundColor\r\n                        : documentBackgroundColor;\r\n                }\r\n            }\r\n            catch (e) { }\r\n            return _this;\r\n        }\r\n        return IFrameElementContainer;\r\n    }(ElementContainer));\r\n\r\n    var LIST_OWNERS = ['OL', 'UL', 'MENU'];\r\n    var parseNodeTree = function (node, parent, root) {\r\n        for (var childNode = node.firstChild, nextNode = void 0; childNode; childNode = nextNode) {\r\n            nextNode = childNode.nextSibling;\r\n            if (isTextNode(childNode) && childNode.data.trim().length > 0) {\r\n                parent.textNodes.push(new TextContainer(childNode, parent.styles));\r\n            }\r\n            else if (isElementNode(childNode)) {\r\n                var container = createContainer(childNode);\r\n                if (container.styles.isVisible()) {\r\n                    if (createsRealStackingContext(childNode, container, root)) {\r\n                        container.flags |= 4 /* CREATES_REAL_STACKING_CONTEXT */;\r\n                    }\r\n                    else if (createsStackingContext(container.styles)) {\r\n                        container.flags |= 2 /* CREATES_STACKING_CONTEXT */;\r\n                    }\r\n                    if (LIST_OWNERS.indexOf(childNode.tagName) !== -1) {\r\n                        container.flags |= 8 /* IS_LIST_OWNER */;\r\n                    }\r\n                    parent.elements.push(container);\r\n                    if (!isTextareaElement(childNode) && !isSVGElement(childNode) && !isSelectElement(childNode)) {\r\n                        parseNodeTree(childNode, container, root);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    var createContainer = function (element) {\r\n        if (isImageElement(element)) {\r\n            return new ImageElementContainer(element);\r\n        }\r\n        if (isCanvasElement(element)) {\r\n            return new CanvasElementContainer(element);\r\n        }\r\n        if (isSVGElement(element)) {\r\n            return new SVGElementContainer(element);\r\n        }\r\n        if (isLIElement(element)) {\r\n            return new LIElementContainer(element);\r\n        }\r\n        if (isOLElement(element)) {\r\n            return new OLElementContainer(element);\r\n        }\r\n        if (isInputElement(element)) {\r\n            return new InputElementContainer(element);\r\n        }\r\n        if (isSelectElement(element)) {\r\n            return new SelectElementContainer(element);\r\n        }\r\n        if (isTextareaElement(element)) {\r\n            return new TextareaElementContainer(element);\r\n        }\r\n        if (isIFrameElement(element)) {\r\n            return new IFrameElementContainer(element);\r\n        }\r\n        return new ElementContainer(element);\r\n    };\r\n    var parseTree = function (element) {\r\n        var container = createContainer(element);\r\n        container.flags |= 4 /* CREATES_REAL_STACKING_CONTEXT */;\r\n        parseNodeTree(element, container, container);\r\n        return container;\r\n    };\r\n    var createsRealStackingContext = function (node, container, root) {\r\n        return (container.styles.isPositionedWithZIndex() ||\r\n            container.styles.opacity < 1 ||\r\n            container.styles.isTransformed() ||\r\n            (isBodyElement(node) && root.styles.isTransparent()));\r\n    };\r\n    var createsStackingContext = function (styles) { return styles.isPositioned() || styles.isFloating(); };\r\n    var isTextNode = function (node) { return node.nodeType === Node.TEXT_NODE; };\r\n    var isElementNode = function (node) { return node.nodeType === Node.ELEMENT_NODE; };\r\n    var isHTMLElementNode = function (node) {\r\n        return isElementNode(node) && typeof node.style !== 'undefined' && !isSVGElementNode(node);\r\n    };\r\n    var isSVGElementNode = function (element) {\r\n        return typeof element.className === 'object';\r\n    };\r\n    var isLIElement = function (node) { return node.tagName === 'LI'; };\r\n    var isOLElement = function (node) { return node.tagName === 'OL'; };\r\n    var isInputElement = function (node) { return node.tagName === 'INPUT'; };\r\n    var isHTMLElement = function (node) { return node.tagName === 'HTML'; };\r\n    var isSVGElement = function (node) { return node.tagName === 'svg'; };\r\n    var isBodyElement = function (node) { return node.tagName === 'BODY'; };\r\n    var isCanvasElement = function (node) { return node.tagName === 'CANVAS'; };\r\n    var isImageElement = function (node) { return node.tagName === 'IMG'; };\r\n    var isIFrameElement = function (node) { return node.tagName === 'IFRAME'; };\r\n    var isStyleElement = function (node) { return node.tagName === 'STYLE'; };\r\n    var isScriptElement = function (node) { return node.tagName === 'SCRIPT'; };\r\n    var isTextareaElement = function (node) { return node.tagName === 'TEXTAREA'; };\r\n    var isSelectElement = function (node) { return node.tagName === 'SELECT'; };\r\n\r\n    var CounterState = /** @class */ (function () {\r\n        function CounterState() {\r\n            this.counters = {};\r\n        }\r\n        CounterState.prototype.getCounterValue = function (name) {\r\n            var counter = this.counters[name];\r\n            if (counter && counter.length) {\r\n                return counter[counter.length - 1];\r\n            }\r\n            return 1;\r\n        };\r\n        CounterState.prototype.getCounterValues = function (name) {\r\n            var counter = this.counters[name];\r\n            return counter ? counter : [];\r\n        };\r\n        CounterState.prototype.pop = function (counters) {\r\n            var _this = this;\r\n            counters.forEach(function (counter) { return _this.counters[counter].pop(); });\r\n        };\r\n        CounterState.prototype.parse = function (style) {\r\n            var _this = this;\r\n            var counterIncrement = style.counterIncrement;\r\n            var counterReset = style.counterReset;\r\n            var canReset = true;\r\n            if (counterIncrement !== null) {\r\n                counterIncrement.forEach(function (entry) {\r\n                    var counter = _this.counters[entry.counter];\r\n                    if (counter && entry.increment !== 0) {\r\n                        canReset = false;\r\n                        counter[Math.max(0, counter.length - 1)] += entry.increment;\r\n                    }\r\n                });\r\n            }\r\n            var counterNames = [];\r\n            if (canReset) {\r\n                counterReset.forEach(function (entry) {\r\n                    var counter = _this.counters[entry.counter];\r\n                    counterNames.push(entry.counter);\r\n                    if (!counter) {\r\n                        counter = _this.counters[entry.counter] = [];\r\n                    }\r\n                    counter.push(entry.reset);\r\n                });\r\n            }\r\n            return counterNames;\r\n        };\r\n        return CounterState;\r\n    }());\r\n    var ROMAN_UPPER = {\r\n        integers: [1000, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1],\r\n        values: ['M', 'CM', 'D', 'CD', 'C', 'XC', 'L', 'XL', 'X', 'IX', 'V', 'IV', 'I']\r\n    };\r\n    var ARMENIAN = {\r\n        integers: [\r\n            9000,\r\n            8000,\r\n            7000,\r\n            6000,\r\n            5000,\r\n            4000,\r\n            3000,\r\n            2000,\r\n            1000,\r\n            900,\r\n            800,\r\n            700,\r\n            600,\r\n            500,\r\n            400,\r\n            300,\r\n            200,\r\n            100,\r\n            90,\r\n            80,\r\n            70,\r\n            60,\r\n            50,\r\n            40,\r\n            30,\r\n            20,\r\n            10,\r\n            9,\r\n            8,\r\n            7,\r\n            6,\r\n            5,\r\n            4,\r\n            3,\r\n            2,\r\n            1\r\n        ],\r\n        values: [\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            ''\r\n        ]\r\n    };\r\n    var HEBREW = {\r\n        integers: [\r\n            10000,\r\n            9000,\r\n            8000,\r\n            7000,\r\n            6000,\r\n            5000,\r\n            4000,\r\n            3000,\r\n            2000,\r\n            1000,\r\n            400,\r\n            300,\r\n            200,\r\n            100,\r\n            90,\r\n            80,\r\n            70,\r\n            60,\r\n            50,\r\n            40,\r\n            30,\r\n            20,\r\n            19,\r\n            18,\r\n            17,\r\n            16,\r\n            15,\r\n            10,\r\n            9,\r\n            8,\r\n            7,\r\n            6,\r\n            5,\r\n            4,\r\n            3,\r\n            2,\r\n            1\r\n        ],\r\n        values: [\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            ''\r\n        ]\r\n    };\r\n    var GEORGIAN = {\r\n        integers: [\r\n            10000,\r\n            9000,\r\n            8000,\r\n            7000,\r\n            6000,\r\n            5000,\r\n            4000,\r\n            3000,\r\n            2000,\r\n            1000,\r\n            900,\r\n            800,\r\n            700,\r\n            600,\r\n            500,\r\n            400,\r\n            300,\r\n            200,\r\n            100,\r\n            90,\r\n            80,\r\n            70,\r\n            60,\r\n            50,\r\n            40,\r\n            30,\r\n            20,\r\n            10,\r\n            9,\r\n            8,\r\n            7,\r\n            6,\r\n            5,\r\n            4,\r\n            3,\r\n            2,\r\n            1\r\n        ],\r\n        values: [\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            '',\r\n            ''\r\n        ]\r\n    };\r\n    var createAdditiveCounter = function (value, min, max, symbols, fallback, suffix) {\r\n        if (value < min || value > max) {\r\n            return createCounterText(value, fallback, suffix.length > 0);\r\n        }\r\n        return (symbols.integers.reduce(function (string, integer, index) {\r\n            while (value >= integer) {\r\n                value -= integer;\r\n                string += symbols.values[index];\r\n            }\r\n            return string;\r\n        }, '') + suffix);\r\n    };\r\n    var createCounterStyleWithSymbolResolver = function (value, codePointRangeLength, isNumeric, resolver) {\r\n        var string = '';\r\n        do {\r\n            if (!isNumeric) {\r\n                value--;\r\n            }\r\n            string = resolver(value) + string;\r\n            value /= codePointRangeLength;\r\n        } while (value * codePointRangeLength >= codePointRangeLength);\r\n        return string;\r\n    };\r\n    var createCounterStyleFromRange = function (value, codePointRangeStart, codePointRangeEnd, isNumeric, suffix) {\r\n        var codePointRangeLength = codePointRangeEnd - codePointRangeStart + 1;\r\n        return ((value < 0 ? '-' : '') +\r\n            (createCounterStyleWithSymbolResolver(Math.abs(value), codePointRangeLength, isNumeric, function (codePoint) {\r\n                return fromCodePoint(Math.floor(codePoint % codePointRangeLength) + codePointRangeStart);\r\n            }) +\r\n                suffix));\r\n    };\r\n    var createCounterStyleFromSymbols = function (value, symbols, suffix) {\r\n        if (suffix === void 0) { suffix = '. '; }\r\n        var codePointRangeLength = symbols.length;\r\n        return (createCounterStyleWithSymbolResolver(Math.abs(value), codePointRangeLength, false, function (codePoint) { return symbols[Math.floor(codePoint % codePointRangeLength)]; }) + suffix);\r\n    };\r\n    var CJK_ZEROS = 1 << 0;\r\n    var CJK_TEN_COEFFICIENTS = 1 << 1;\r\n    var CJK_TEN_HIGH_COEFFICIENTS = 1 << 2;\r\n    var CJK_HUNDRED_COEFFICIENTS = 1 << 3;\r\n    var createCJKCounter = function (value, numbers, multipliers, negativeSign, suffix, flags) {\r\n        if (value < -9999 || value > 9999) {\r\n            return createCounterText(value, LIST_STYLE_TYPE.CJK_DECIMAL, suffix.length > 0);\r\n        }\r\n        var tmp = Math.abs(value);\r\n        var string = suffix;\r\n        if (tmp === 0) {\r\n            return numbers[0] + string;\r\n        }\r\n        for (var digit = 0; tmp > 0 && digit <= 4; digit++) {\r\n            var coefficient = tmp % 10;\r\n            if (coefficient === 0 && contains(flags, CJK_ZEROS) && string !== '') {\r\n                string = numbers[coefficient] + string;\r\n            }\r\n            else if (coefficient > 1 ||\r\n                (coefficient === 1 && digit === 0) ||\r\n                (coefficient === 1 && digit === 1 && contains(flags, CJK_TEN_COEFFICIENTS)) ||\r\n                (coefficient === 1 && digit === 1 && contains(flags, CJK_TEN_HIGH_COEFFICIENTS) && value > 100) ||\r\n                (coefficient === 1 && digit > 1 && contains(flags, CJK_HUNDRED_COEFFICIENTS))) {\r\n                string = numbers[coefficient] + (digit > 0 ? multipliers[digit - 1] : '') + string;\r\n            }\r\n            else if (coefficient === 1 && digit > 0) {\r\n                string = multipliers[digit - 1] + string;\r\n            }\r\n            tmp = Math.floor(tmp / 10);\r\n        }\r\n        return (value < 0 ? negativeSign : '') + string;\r\n    };\r\n    var CHINESE_INFORMAL_MULTIPLIERS = '';\r\n    var CHINESE_FORMAL_MULTIPLIERS = '';\r\n    var JAPANESE_NEGATIVE = '';\r\n    var KOREAN_NEGATIVE = '';\r\n    var createCounterText = function (value, type, appendSuffix) {\r\n        var defaultSuffix = appendSuffix ? '. ' : '';\r\n        var cjkSuffix = appendSuffix ? '' : '';\r\n        var koreanSuffix = appendSuffix ? ', ' : '';\r\n        var spaceSuffix = appendSuffix ? ' ' : '';\r\n        switch (type) {\r\n            case LIST_STYLE_TYPE.DISC:\r\n                return '' + spaceSuffix;\r\n            case LIST_STYLE_TYPE.CIRCLE:\r\n                return '' + spaceSuffix;\r\n            case LIST_STYLE_TYPE.SQUARE:\r\n                return '' + spaceSuffix;\r\n            case LIST_STYLE_TYPE.DECIMAL_LEADING_ZERO:\r\n                var string = createCounterStyleFromRange(value, 48, 57, true, defaultSuffix);\r\n                return string.length < 4 ? \"0\" + string : string;\r\n            case LIST_STYLE_TYPE.CJK_DECIMAL:\r\n                return createCounterStyleFromSymbols(value, '', cjkSuffix);\r\n            case LIST_STYLE_TYPE.LOWER_ROMAN:\r\n                return createAdditiveCounter(value, 1, 3999, ROMAN_UPPER, LIST_STYLE_TYPE.DECIMAL, defaultSuffix).toLowerCase();\r\n            case LIST_STYLE_TYPE.UPPER_ROMAN:\r\n                return createAdditiveCounter(value, 1, 3999, ROMAN_UPPER, LIST_STYLE_TYPE.DECIMAL, defaultSuffix);\r\n            case LIST_STYLE_TYPE.LOWER_GREEK:\r\n                return createCounterStyleFromRange(value, 945, 969, false, defaultSuffix);\r\n            case LIST_STYLE_TYPE.LOWER_ALPHA:\r\n                return createCounterStyleFromRange(value, 97, 122, false, defaultSuffix);\r\n            case LIST_STYLE_TYPE.UPPER_ALPHA:\r\n                return createCounterStyleFromRange(value, 65, 90, false, defaultSuffix);\r\n            case LIST_STYLE_TYPE.ARABIC_INDIC:\r\n                return createCounterStyleFromRange(value, 1632, 1641, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.ARMENIAN:\r\n            case LIST_STYLE_TYPE.UPPER_ARMENIAN:\r\n                return createAdditiveCounter(value, 1, 9999, ARMENIAN, LIST_STYLE_TYPE.DECIMAL, defaultSuffix);\r\n            case LIST_STYLE_TYPE.LOWER_ARMENIAN:\r\n                return createAdditiveCounter(value, 1, 9999, ARMENIAN, LIST_STYLE_TYPE.DECIMAL, defaultSuffix).toLowerCase();\r\n            case LIST_STYLE_TYPE.BENGALI:\r\n                return createCounterStyleFromRange(value, 2534, 2543, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.CAMBODIAN:\r\n            case LIST_STYLE_TYPE.KHMER:\r\n                return createCounterStyleFromRange(value, 6112, 6121, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.CJK_EARTHLY_BRANCH:\r\n                return createCounterStyleFromSymbols(value, '', cjkSuffix);\r\n            case LIST_STYLE_TYPE.CJK_HEAVENLY_STEM:\r\n                return createCounterStyleFromSymbols(value, '', cjkSuffix);\r\n            case LIST_STYLE_TYPE.CJK_IDEOGRAPHIC:\r\n            case LIST_STYLE_TYPE.TRAD_CHINESE_INFORMAL:\r\n                return createCJKCounter(value, '', CHINESE_INFORMAL_MULTIPLIERS, '', cjkSuffix, CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);\r\n            case LIST_STYLE_TYPE.TRAD_CHINESE_FORMAL:\r\n                return createCJKCounter(value, '', CHINESE_FORMAL_MULTIPLIERS, '', cjkSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);\r\n            case LIST_STYLE_TYPE.SIMP_CHINESE_INFORMAL:\r\n                return createCJKCounter(value, '', CHINESE_INFORMAL_MULTIPLIERS, '', cjkSuffix, CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);\r\n            case LIST_STYLE_TYPE.SIMP_CHINESE_FORMAL:\r\n                return createCJKCounter(value, '', CHINESE_FORMAL_MULTIPLIERS, '', cjkSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS | CJK_HUNDRED_COEFFICIENTS);\r\n            case LIST_STYLE_TYPE.JAPANESE_INFORMAL:\r\n                return createCJKCounter(value, '', '', JAPANESE_NEGATIVE, cjkSuffix, 0);\r\n            case LIST_STYLE_TYPE.JAPANESE_FORMAL:\r\n                return createCJKCounter(value, '', '', JAPANESE_NEGATIVE, cjkSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS);\r\n            case LIST_STYLE_TYPE.KOREAN_HANGUL_FORMAL:\r\n                return createCJKCounter(value, '', '', KOREAN_NEGATIVE, koreanSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS);\r\n            case LIST_STYLE_TYPE.KOREAN_HANJA_INFORMAL:\r\n                return createCJKCounter(value, '', '', KOREAN_NEGATIVE, koreanSuffix, 0);\r\n            case LIST_STYLE_TYPE.KOREAN_HANJA_FORMAL:\r\n                return createCJKCounter(value, '', '', KOREAN_NEGATIVE, koreanSuffix, CJK_ZEROS | CJK_TEN_COEFFICIENTS | CJK_TEN_HIGH_COEFFICIENTS);\r\n            case LIST_STYLE_TYPE.DEVANAGARI:\r\n                return createCounterStyleFromRange(value, 0x966, 0x96f, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.GEORGIAN:\r\n                return createAdditiveCounter(value, 1, 19999, GEORGIAN, LIST_STYLE_TYPE.DECIMAL, defaultSuffix);\r\n            case LIST_STYLE_TYPE.GUJARATI:\r\n                return createCounterStyleFromRange(value, 0xae6, 0xaef, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.GURMUKHI:\r\n                return createCounterStyleFromRange(value, 0xa66, 0xa6f, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.HEBREW:\r\n                return createAdditiveCounter(value, 1, 10999, HEBREW, LIST_STYLE_TYPE.DECIMAL, defaultSuffix);\r\n            case LIST_STYLE_TYPE.HIRAGANA:\r\n                return createCounterStyleFromSymbols(value, '');\r\n            case LIST_STYLE_TYPE.HIRAGANA_IROHA:\r\n                return createCounterStyleFromSymbols(value, '');\r\n            case LIST_STYLE_TYPE.KANNADA:\r\n                return createCounterStyleFromRange(value, 0xce6, 0xcef, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.KATAKANA:\r\n                return createCounterStyleFromSymbols(value, '', cjkSuffix);\r\n            case LIST_STYLE_TYPE.KATAKANA_IROHA:\r\n                return createCounterStyleFromSymbols(value, '', cjkSuffix);\r\n            case LIST_STYLE_TYPE.LAO:\r\n                return createCounterStyleFromRange(value, 0xed0, 0xed9, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.MONGOLIAN:\r\n                return createCounterStyleFromRange(value, 0x1810, 0x1819, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.MYANMAR:\r\n                return createCounterStyleFromRange(value, 0x1040, 0x1049, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.ORIYA:\r\n                return createCounterStyleFromRange(value, 0xb66, 0xb6f, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.PERSIAN:\r\n                return createCounterStyleFromRange(value, 0x6f0, 0x6f9, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.TAMIL:\r\n                return createCounterStyleFromRange(value, 0xbe6, 0xbef, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.TELUGU:\r\n                return createCounterStyleFromRange(value, 0xc66, 0xc6f, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.THAI:\r\n                return createCounterStyleFromRange(value, 0xe50, 0xe59, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.TIBETAN:\r\n                return createCounterStyleFromRange(value, 0xf20, 0xf29, true, defaultSuffix);\r\n            case LIST_STYLE_TYPE.DECIMAL:\r\n            default:\r\n                return createCounterStyleFromRange(value, 48, 57, true, defaultSuffix);\r\n        }\r\n    };\r\n\r\n    var IGNORE_ATTRIBUTE = 'data-html2canvas-ignore';\r\n    var DocumentCloner = /** @class */ (function () {\r\n        function DocumentCloner(element, options) {\r\n            this.options = options;\r\n            this.scrolledElements = [];\r\n            this.referenceElement = element;\r\n            this.counters = new CounterState();\r\n            this.quoteDepth = 0;\r\n            if (!element.ownerDocument) {\r\n                throw new Error('Cloned element does not have an owner document');\r\n            }\r\n            this.documentElement = this.cloneNode(element.ownerDocument.documentElement);\r\n        }\r\n        DocumentCloner.prototype.toIFrame = function (ownerDocument, windowSize) {\r\n            var _this = this;\r\n            var iframe = createIFrameContainer(ownerDocument, windowSize);\r\n            if (!iframe.contentWindow) {\r\n                return Promise.reject(\"Unable to find iframe window\");\r\n            }\r\n            var scrollX = ownerDocument.defaultView.pageXOffset;\r\n            var scrollY = ownerDocument.defaultView.pageYOffset;\r\n            var cloneWindow = iframe.contentWindow;\r\n            var documentClone = cloneWindow.document;\r\n            /* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle\r\n             if window url is about:blank, we can assign the url to current by writing onto the document\r\n             */\r\n            var iframeLoad = iframeLoader(iframe).then(function () { return __awaiter(_this, void 0, void 0, function () {\r\n                var onclone;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            this.scrolledElements.forEach(restoreNodeScroll);\r\n                            if (cloneWindow) {\r\n                                cloneWindow.scrollTo(windowSize.left, windowSize.top);\r\n                                if (/(iPad|iPhone|iPod)/g.test(navigator.userAgent) &&\r\n                                    (cloneWindow.scrollY !== windowSize.top || cloneWindow.scrollX !== windowSize.left)) {\r\n                                    documentClone.documentElement.style.top = -windowSize.top + 'px';\r\n                                    documentClone.documentElement.style.left = -windowSize.left + 'px';\r\n                                    documentClone.documentElement.style.position = 'absolute';\r\n                                }\r\n                            }\r\n                            onclone = this.options.onclone;\r\n                            if (typeof this.clonedReferenceElement === 'undefined') {\r\n                                return [2 /*return*/, Promise.reject(\"Error finding the \" + this.referenceElement.nodeName + \" in the cloned document\")];\r\n                            }\r\n                            if (!(documentClone.fonts && documentClone.fonts.ready)) return [3 /*break*/, 2];\r\n                            return [4 /*yield*/, documentClone.fonts.ready];\r\n                        case 1:\r\n                            _a.sent();\r\n                            _a.label = 2;\r\n                        case 2:\r\n                            if (typeof onclone === 'function') {\r\n                                return [2 /*return*/, Promise.resolve()\r\n                                        .then(function () { return onclone(documentClone); })\r\n                                        .then(function () { return iframe; })];\r\n                            }\r\n                            return [2 /*return*/, iframe];\r\n                    }\r\n                });\r\n            }); });\r\n            documentClone.open();\r\n            documentClone.write(serializeDoctype(document.doctype) + \"<html></html>\");\r\n            // Chrome scrolls the parent document for some reason after the write to the cloned window???\r\n            restoreOwnerScroll(this.referenceElement.ownerDocument, scrollX, scrollY);\r\n            documentClone.replaceChild(documentClone.adoptNode(this.documentElement), documentClone.documentElement);\r\n            documentClone.close();\r\n            return iframeLoad;\r\n        };\r\n        DocumentCloner.prototype.createElementClone = function (node) {\r\n            if (isCanvasElement(node)) {\r\n                return this.createCanvasClone(node);\r\n            }\r\n            /*\r\n            if (isIFrameElement(node)) {\r\n                return this.createIFrameClone(node);\r\n            }\r\n    */\r\n            if (isStyleElement(node)) {\r\n                return this.createStyleClone(node);\r\n            }\r\n            var clone = node.cloneNode(false);\r\n            // @ts-ignore\r\n            if (isImageElement(clone) && clone.loading === 'lazy') {\r\n                // @ts-ignore\r\n                clone.loading = 'eager';\r\n            }\r\n            return clone;\r\n        };\r\n        DocumentCloner.prototype.createStyleClone = function (node) {\r\n            try {\r\n                var sheet = node.sheet;\r\n                if (sheet && sheet.cssRules) {\r\n                    var css = [].slice.call(sheet.cssRules, 0).reduce(function (css, rule) {\r\n                        if (rule && typeof rule.cssText === 'string') {\r\n                            return css + rule.cssText;\r\n                        }\r\n                        return css;\r\n                    }, '');\r\n                    var style = node.cloneNode(false);\r\n                    style.textContent = css;\r\n                    return style;\r\n                }\r\n            }\r\n            catch (e) {\r\n                // accessing node.sheet.cssRules throws a DOMException\r\n                Logger.getInstance(this.options.id).error('Unable to access cssRules property', e);\r\n                if (e.name !== 'SecurityError') {\r\n                    throw e;\r\n                }\r\n            }\r\n            return node.cloneNode(false);\r\n        };\r\n        DocumentCloner.prototype.createCanvasClone = function (canvas) {\r\n            if (this.options.inlineImages && canvas.ownerDocument) {\r\n                var img = canvas.ownerDocument.createElement('img');\r\n                try {\r\n                    img.src = canvas.toDataURL();\r\n                    return img;\r\n                }\r\n                catch (e) {\r\n                    Logger.getInstance(this.options.id).info(\"Unable to clone canvas contents, canvas is tainted\");\r\n                }\r\n            }\r\n            var clonedCanvas = canvas.cloneNode(false);\r\n            try {\r\n                clonedCanvas.width = canvas.width;\r\n                clonedCanvas.height = canvas.height;\r\n                var ctx = canvas.getContext('2d');\r\n                var clonedCtx = clonedCanvas.getContext('2d');\r\n                if (clonedCtx) {\r\n                    if (ctx) {\r\n                        clonedCtx.putImageData(ctx.getImageData(0, 0, canvas.width, canvas.height), 0, 0);\r\n                    }\r\n                    else {\r\n                        clonedCtx.drawImage(canvas, 0, 0);\r\n                    }\r\n                }\r\n                return clonedCanvas;\r\n            }\r\n            catch (e) { }\r\n            return clonedCanvas;\r\n        };\r\n        /*\r\n        createIFrameClone(iframe: HTMLIFrameElement) {\r\n            const tempIframe = <HTMLIFrameElement>iframe.cloneNode(false);\r\n            const iframeKey = generateIframeKey();\r\n            tempIframe.setAttribute('data-html2canvas-internal-iframe-key', iframeKey);\r\n\r\n            const {width, height} = parseBounds(iframe);\r\n\r\n            this.resourceLoader.cache[iframeKey] = getIframeDocumentElement(iframe, this.options)\r\n                .then(documentElement => {\r\n                    return this.renderer(\r\n                        documentElement,\r\n                        {\r\n                            allowTaint: this.options.allowTaint,\r\n                            backgroundColor: '#ffffff',\r\n                            canvas: null,\r\n                            imageTimeout: this.options.imageTimeout,\r\n                            logging: this.options.logging,\r\n                            proxy: this.options.proxy,\r\n                            removeContainer: this.options.removeContainer,\r\n                            scale: this.options.scale,\r\n                            foreignObjectRendering: this.options.foreignObjectRendering,\r\n                            useCORS: this.options.useCORS,\r\n                            target: new CanvasRenderer(),\r\n                            width,\r\n                            height,\r\n                            x: 0,\r\n                            y: 0,\r\n                            windowWidth: documentElement.ownerDocument.defaultView.innerWidth,\r\n                            windowHeight: documentElement.ownerDocument.defaultView.innerHeight,\r\n                            scrollX: documentElement.ownerDocument.defaultView.pageXOffset,\r\n                            scrollY: documentElement.ownerDocument.defaultView.pageYOffset\r\n                        },\r\n                    );\r\n                })\r\n                .then(\r\n                    (canvas: HTMLCanvasElement) =>\r\n                        new Promise((resolve, reject) => {\r\n                            const iframeCanvas = document.createElement('img');\r\n                            iframeCanvas.onload = () => resolve(canvas);\r\n                            iframeCanvas.onerror = (event) => {\r\n                                // Empty iframes may result in empty \"data:,\" URLs, which are invalid from the <img>'s point of view\r\n                                // and instead of `onload` cause `onerror` and unhandled rejection warnings\r\n                                // https://github.com/niklasvh/html2canvas/issues/1502\r\n                                iframeCanvas.src == 'data:,' ? resolve(canvas) : reject(event);\r\n                            };\r\n                            iframeCanvas.src = canvas.toDataURL();\r\n                            if (tempIframe.parentNode && iframe.ownerDocument && iframe.ownerDocument.defaultView) {\r\n                                tempIframe.parentNode.replaceChild(\r\n                                    copyCSSStyles(\r\n                                        iframe.ownerDocument.defaultView.getComputedStyle(iframe),\r\n                                        iframeCanvas\r\n                                    ),\r\n                                    tempIframe\r\n                                );\r\n                            }\r\n                        })\r\n                );\r\n            return tempIframe;\r\n        }\r\n    */\r\n        DocumentCloner.prototype.cloneNode = function (node) {\r\n            if (isTextNode(node)) {\r\n                return document.createTextNode(node.data);\r\n            }\r\n            if (!node.ownerDocument) {\r\n                return node.cloneNode(false);\r\n            }\r\n            var window = node.ownerDocument.defaultView;\r\n            if (window && isElementNode(node) && (isHTMLElementNode(node) || isSVGElementNode(node))) {\r\n                var clone = this.createElementClone(node);\r\n                var style = window.getComputedStyle(node);\r\n                var styleBefore = window.getComputedStyle(node, ':before');\r\n                var styleAfter = window.getComputedStyle(node, ':after');\r\n                if (this.referenceElement === node && isHTMLElementNode(clone)) {\r\n                    this.clonedReferenceElement = clone;\r\n                }\r\n                if (isBodyElement(clone)) {\r\n                    createPseudoHideStyles(clone);\r\n                }\r\n                var counters = this.counters.parse(new CSSParsedCounterDeclaration(style));\r\n                var before = this.resolvePseudoContent(node, clone, styleBefore, PseudoElementType.BEFORE);\r\n                for (var child = node.firstChild; child; child = child.nextSibling) {\r\n                    if (!isElementNode(child) ||\r\n                        (!isScriptElement(child) &&\r\n                            !child.hasAttribute(IGNORE_ATTRIBUTE) &&\r\n                            (typeof this.options.ignoreElements !== 'function' || !this.options.ignoreElements(child)))) {\r\n                        if (!this.options.copyStyles || !isElementNode(child) || !isStyleElement(child)) {\r\n                            clone.appendChild(this.cloneNode(child));\r\n                        }\r\n                    }\r\n                }\r\n                if (before) {\r\n                    clone.insertBefore(before, clone.firstChild);\r\n                }\r\n                var after = this.resolvePseudoContent(node, clone, styleAfter, PseudoElementType.AFTER);\r\n                if (after) {\r\n                    clone.appendChild(after);\r\n                }\r\n                this.counters.pop(counters);\r\n                if (style && (this.options.copyStyles || isSVGElementNode(node)) && !isIFrameElement(node)) {\r\n                    copyCSSStyles(style, clone);\r\n                }\r\n                //this.inlineAllImages(clone);\r\n                if (node.scrollTop !== 0 || node.scrollLeft !== 0) {\r\n                    this.scrolledElements.push([clone, node.scrollLeft, node.scrollTop]);\r\n                }\r\n                if ((isTextareaElement(node) || isSelectElement(node)) &&\r\n                    (isTextareaElement(clone) || isSelectElement(clone))) {\r\n                    clone.value = node.value;\r\n                }\r\n                return clone;\r\n            }\r\n            return node.cloneNode(false);\r\n        };\r\n        DocumentCloner.prototype.resolvePseudoContent = function (node, clone, style, pseudoElt) {\r\n            var _this = this;\r\n            if (!style) {\r\n                return;\r\n            }\r\n            var value = style.content;\r\n            var document = clone.ownerDocument;\r\n            if (!document || !value || value === 'none' || value === '-moz-alt-content' || style.display === 'none') {\r\n                return;\r\n            }\r\n            this.counters.parse(new CSSParsedCounterDeclaration(style));\r\n            var declaration = new CSSParsedPseudoDeclaration(style);\r\n            var anonymousReplacedElement = document.createElement('html2canvaspseudoelement');\r\n            copyCSSStyles(style, anonymousReplacedElement);\r\n            declaration.content.forEach(function (token) {\r\n                if (token.type === TokenType.STRING_TOKEN) {\r\n                    anonymousReplacedElement.appendChild(document.createTextNode(token.value));\r\n                }\r\n                else if (token.type === TokenType.URL_TOKEN) {\r\n                    var img = document.createElement('img');\r\n                    img.src = token.value;\r\n                    img.style.opacity = '1';\r\n                    anonymousReplacedElement.appendChild(img);\r\n                }\r\n                else if (token.type === TokenType.FUNCTION) {\r\n                    if (token.name === 'attr') {\r\n                        var attr = token.values.filter(isIdentToken);\r\n                        if (attr.length) {\r\n                            anonymousReplacedElement.appendChild(document.createTextNode(node.getAttribute(attr[0].value) || ''));\r\n                        }\r\n                    }\r\n                    else if (token.name === 'counter') {\r\n                        var _a = token.values.filter(nonFunctionArgSeparator), counter = _a[0], counterStyle = _a[1];\r\n                        if (counter && isIdentToken(counter)) {\r\n                            var counterState = _this.counters.getCounterValue(counter.value);\r\n                            var counterType = counterStyle && isIdentToken(counterStyle)\r\n                                ? listStyleType.parse(counterStyle.value)\r\n                                : LIST_STYLE_TYPE.DECIMAL;\r\n                            anonymousReplacedElement.appendChild(document.createTextNode(createCounterText(counterState, counterType, false)));\r\n                        }\r\n                    }\r\n                    else if (token.name === 'counters') {\r\n                        var _b = token.values.filter(nonFunctionArgSeparator), counter = _b[0], delim = _b[1], counterStyle = _b[2];\r\n                        if (counter && isIdentToken(counter)) {\r\n                            var counterStates = _this.counters.getCounterValues(counter.value);\r\n                            var counterType_1 = counterStyle && isIdentToken(counterStyle)\r\n                                ? listStyleType.parse(counterStyle.value)\r\n                                : LIST_STYLE_TYPE.DECIMAL;\r\n                            var separator = delim && delim.type === TokenType.STRING_TOKEN ? delim.value : '';\r\n                            var text = counterStates\r\n                                .map(function (value) { return createCounterText(value, counterType_1, false); })\r\n                                .join(separator);\r\n                            anonymousReplacedElement.appendChild(document.createTextNode(text));\r\n                        }\r\n                    }\r\n                }\r\n                else if (token.type === TokenType.IDENT_TOKEN) {\r\n                    switch (token.value) {\r\n                        case 'open-quote':\r\n                            anonymousReplacedElement.appendChild(document.createTextNode(getQuote(declaration.quotes, _this.quoteDepth++, true)));\r\n                            break;\r\n                        case 'close-quote':\r\n                            anonymousReplacedElement.appendChild(document.createTextNode(getQuote(declaration.quotes, --_this.quoteDepth, false)));\r\n                            break;\r\n                        default:\r\n                            // safari doesn't parse string tokens correctly because of lack of quotes\r\n                            anonymousReplacedElement.appendChild(document.createTextNode(token.value));\r\n                    }\r\n                }\r\n            });\r\n            anonymousReplacedElement.className = PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + \" \" + PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\r\n            var newClassName = pseudoElt === PseudoElementType.BEFORE\r\n                ? \" \" + PSEUDO_HIDE_ELEMENT_CLASS_BEFORE\r\n                : \" \" + PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\r\n            if (isSVGElementNode(clone)) {\r\n                clone.className.baseValue += newClassName;\r\n            }\r\n            else {\r\n                clone.className += newClassName;\r\n            }\r\n            return anonymousReplacedElement;\r\n        };\r\n        DocumentCloner.destroy = function (container) {\r\n            if (container.parentNode) {\r\n                container.parentNode.removeChild(container);\r\n                return true;\r\n            }\r\n            return false;\r\n        };\r\n        return DocumentCloner;\r\n    }());\r\n    var PseudoElementType;\r\n    (function (PseudoElementType) {\r\n        PseudoElementType[PseudoElementType[\"BEFORE\"] = 0] = \"BEFORE\";\r\n        PseudoElementType[PseudoElementType[\"AFTER\"] = 1] = \"AFTER\";\r\n    })(PseudoElementType || (PseudoElementType = {}));\r\n    var createIFrameContainer = function (ownerDocument, bounds) {\r\n        var cloneIframeContainer = ownerDocument.createElement('iframe');\r\n        cloneIframeContainer.className = 'html2canvas-container';\r\n        cloneIframeContainer.style.visibility = 'hidden';\r\n        cloneIframeContainer.style.position = 'fixed';\r\n        cloneIframeContainer.style.left = '-10000px';\r\n        cloneIframeContainer.style.top = '0px';\r\n        cloneIframeContainer.style.border = '0';\r\n        cloneIframeContainer.width = bounds.width.toString();\r\n        cloneIframeContainer.height = bounds.height.toString();\r\n        cloneIframeContainer.scrolling = 'no'; // ios won't scroll without it\r\n        cloneIframeContainer.setAttribute(IGNORE_ATTRIBUTE, 'true');\r\n        ownerDocument.body.appendChild(cloneIframeContainer);\r\n        return cloneIframeContainer;\r\n    };\r\n    var iframeLoader = function (iframe) {\r\n        return new Promise(function (resolve, reject) {\r\n            var cloneWindow = iframe.contentWindow;\r\n            if (!cloneWindow) {\r\n                return reject(\"No window assigned for iframe\");\r\n            }\r\n            var documentClone = cloneWindow.document;\r\n            cloneWindow.onload = iframe.onload = documentClone.onreadystatechange = function () {\r\n                cloneWindow.onload = iframe.onload = documentClone.onreadystatechange = null;\r\n                var interval = setInterval(function () {\r\n                    if (documentClone.body.childNodes.length > 0 && documentClone.readyState === 'complete') {\r\n                        clearInterval(interval);\r\n                        resolve(iframe);\r\n                    }\r\n                }, 50);\r\n            };\r\n        });\r\n    };\r\n    var copyCSSStyles = function (style, target) {\r\n        let counter = 0;\r\n        // Edge does not provide value for cssText\r\n        for (var i = style.length - 1; i >= 0; i--) {\r\n            var property = style.item(i);\r\n            // Safari shows pseudoelements if content is set\r\n            if (property !== 'content') {\r\n                target.style.setProperty(property, style.getPropertyValue(property));\r\n            }\r\n        }\r\n        HACK(style, target);\r\n    };\r\n    var serializeDoctype = function (doctype) {\r\n        var str = '';\r\n        if (doctype) {\r\n            str += '<!DOCTYPE ';\r\n            if (doctype.name) {\r\n                str += doctype.name;\r\n            }\r\n            if (doctype.internalSubset) {\r\n                str += doctype.internalSubset;\r\n            }\r\n            if (doctype.publicId) {\r\n                str += \"\\\"\" + doctype.publicId + \"\\\"\";\r\n            }\r\n            if (doctype.systemId) {\r\n                str += \"\\\"\" + doctype.systemId + \"\\\"\";\r\n            }\r\n            str += '>';\r\n        }\r\n        return str;\r\n    };\r\n    var restoreOwnerScroll = function (ownerDocument, x, y) {\r\n        if (ownerDocument &&\r\n            ownerDocument.defaultView &&\r\n            (x !== ownerDocument.defaultView.pageXOffset || y !== ownerDocument.defaultView.pageYOffset)) {\r\n            ownerDocument.defaultView.scrollTo(x, y);\r\n        }\r\n    };\r\n    var restoreNodeScroll = function (_a) {\r\n        var element = _a[0], x = _a[1], y = _a[2];\r\n        element.scrollLeft = x;\r\n        element.scrollTop = y;\r\n    };\r\n    var PSEUDO_BEFORE = ':before';\r\n    var PSEUDO_AFTER = ':after';\r\n    var PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = '___html2canvas___pseudoelement_before';\r\n    var PSEUDO_HIDE_ELEMENT_CLASS_AFTER = '___html2canvas___pseudoelement_after';\r\n    var PSEUDO_HIDE_ELEMENT_STYLE = \"{\\n    content: \\\"\\\" !important;\\n    display: none !important;\\n}\";\r\n    var createPseudoHideStyles = function (body) {\r\n        createStyles(body, \".\" + PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + PSEUDO_BEFORE + PSEUDO_HIDE_ELEMENT_STYLE + \"\\n         .\" + PSEUDO_HIDE_ELEMENT_CLASS_AFTER + PSEUDO_AFTER + PSEUDO_HIDE_ELEMENT_STYLE);\r\n    };\r\n    var createStyles = function (body, styles) {\r\n        var document = body.ownerDocument;\r\n        if (document) {\r\n            var style = document.createElement('style');\r\n            style.textContent = styles;\r\n            body.appendChild(style);\r\n        }\r\n    };\r\n\r\n    var PathType;\r\n    (function (PathType) {\r\n        PathType[PathType[\"VECTOR\"] = 0] = \"VECTOR\";\r\n        PathType[PathType[\"BEZIER_CURVE\"] = 1] = \"BEZIER_CURVE\";\r\n    })(PathType || (PathType = {}));\r\n    var equalPath = function (a, b) {\r\n        if (a.length === b.length) {\r\n            return a.some(function (v, i) { return v === b[i]; });\r\n        }\r\n        return false;\r\n    };\r\n    var transformPath = function (path, deltaX, deltaY, deltaW, deltaH) {\r\n        return path.map(function (point, index) {\r\n            switch (index) {\r\n                case 0:\r\n                    return point.add(deltaX, deltaY);\r\n                case 1:\r\n                    return point.add(deltaX + deltaW, deltaY);\r\n                case 2:\r\n                    return point.add(deltaX + deltaW, deltaY + deltaH);\r\n                case 3:\r\n                    return point.add(deltaX, deltaY + deltaH);\r\n            }\r\n            return point;\r\n        });\r\n    };\r\n\r\n    var Vector = /** @class */ (function () {\r\n        function Vector(x, y) {\r\n            this.type = PathType.VECTOR;\r\n            this.x = x;\r\n            this.y = y;\r\n        }\r\n        Vector.prototype.add = function (deltaX, deltaY) {\r\n            return new Vector(this.x + deltaX, this.y + deltaY);\r\n        };\r\n        return Vector;\r\n    }());\r\n\r\n    var lerp = function (a, b, t) {\r\n        return new Vector(a.x + (b.x - a.x) * t, a.y + (b.y - a.y) * t);\r\n    };\r\n    var BezierCurve = /** @class */ (function () {\r\n        function BezierCurve(start, startControl, endControl, end) {\r\n            this.type = PathType.BEZIER_CURVE;\r\n            this.start = start;\r\n            this.startControl = startControl;\r\n            this.endControl = endControl;\r\n            this.end = end;\r\n        }\r\n        BezierCurve.prototype.subdivide = function (t, firstHalf) {\r\n            var ab = lerp(this.start, this.startControl, t);\r\n            var bc = lerp(this.startControl, this.endControl, t);\r\n            var cd = lerp(this.endControl, this.end, t);\r\n            var abbc = lerp(ab, bc, t);\r\n            var bccd = lerp(bc, cd, t);\r\n            var dest = lerp(abbc, bccd, t);\r\n            return firstHalf ? new BezierCurve(this.start, ab, abbc, dest) : new BezierCurve(dest, bccd, cd, this.end);\r\n        };\r\n        BezierCurve.prototype.add = function (deltaX, deltaY) {\r\n            return new BezierCurve(this.start.add(deltaX, deltaY), this.startControl.add(deltaX, deltaY), this.endControl.add(deltaX, deltaY), this.end.add(deltaX, deltaY));\r\n        };\r\n        BezierCurve.prototype.reverse = function () {\r\n            return new BezierCurve(this.end, this.endControl, this.startControl, this.start);\r\n        };\r\n        return BezierCurve;\r\n    }());\r\n    var isBezierCurve = function (path) { return path.type === PathType.BEZIER_CURVE; };\r\n\r\n    var BoundCurves = /** @class */ (function () {\r\n        function BoundCurves(element) {\r\n            var styles = element.styles;\r\n            var bounds = element.bounds;\r\n            var _a = getAbsoluteValueForTuple(styles.borderTopLeftRadius, bounds.width, bounds.height), tlh = _a[0], tlv = _a[1];\r\n            var _b = getAbsoluteValueForTuple(styles.borderTopRightRadius, bounds.width, bounds.height), trh = _b[0], trv = _b[1];\r\n            var _c = getAbsoluteValueForTuple(styles.borderBottomRightRadius, bounds.width, bounds.height), brh = _c[0], brv = _c[1];\r\n            var _d = getAbsoluteValueForTuple(styles.borderBottomLeftRadius, bounds.width, bounds.height), blh = _d[0], blv = _d[1];\r\n            var factors = [];\r\n            factors.push((tlh + trh) / bounds.width);\r\n            factors.push((blh + brh) / bounds.width);\r\n            factors.push((tlv + blv) / bounds.height);\r\n            factors.push((trv + brv) / bounds.height);\r\n            var maxFactor = Math.max.apply(Math, factors);\r\n            if (maxFactor > 1) {\r\n                tlh /= maxFactor;\r\n                tlv /= maxFactor;\r\n                trh /= maxFactor;\r\n                trv /= maxFactor;\r\n                brh /= maxFactor;\r\n                brv /= maxFactor;\r\n                blh /= maxFactor;\r\n                blv /= maxFactor;\r\n            }\r\n            var topWidth = bounds.width - trh;\r\n            var rightHeight = bounds.height - brv;\r\n            var bottomWidth = bounds.width - brh;\r\n            var leftHeight = bounds.height - blv;\r\n            var borderTopWidth = styles.borderTopWidth;\r\n            var borderRightWidth = styles.borderRightWidth;\r\n            var borderBottomWidth = styles.borderBottomWidth;\r\n            var borderLeftWidth = styles.borderLeftWidth;\r\n            var paddingTop = getAbsoluteValue(styles.paddingTop, element.bounds.width);\r\n            var paddingRight = getAbsoluteValue(styles.paddingRight, element.bounds.width);\r\n            var paddingBottom = getAbsoluteValue(styles.paddingBottom, element.bounds.width);\r\n            var paddingLeft = getAbsoluteValue(styles.paddingLeft, element.bounds.width);\r\n            this.topLeftBorderBox =\r\n                tlh > 0 || tlv > 0\r\n                    ? getCurvePoints(bounds.left, bounds.top, tlh, tlv, CORNER.TOP_LEFT)\r\n                    : new Vector(bounds.left, bounds.top);\r\n            this.topRightBorderBox =\r\n                trh > 0 || trv > 0\r\n                    ? getCurvePoints(bounds.left + topWidth, bounds.top, trh, trv, CORNER.TOP_RIGHT)\r\n                    : new Vector(bounds.left + bounds.width, bounds.top);\r\n            this.bottomRightBorderBox =\r\n                brh > 0 || brv > 0\r\n                    ? getCurvePoints(bounds.left + bottomWidth, bounds.top + rightHeight, brh, brv, CORNER.BOTTOM_RIGHT)\r\n                    : new Vector(bounds.left + bounds.width, bounds.top + bounds.height);\r\n            this.bottomLeftBorderBox =\r\n                blh > 0 || blv > 0\r\n                    ? getCurvePoints(bounds.left, bounds.top + leftHeight, blh, blv, CORNER.BOTTOM_LEFT)\r\n                    : new Vector(bounds.left, bounds.top + bounds.height);\r\n            this.topLeftPaddingBox =\r\n                tlh > 0 || tlv > 0\r\n                    ? getCurvePoints(bounds.left + borderLeftWidth, bounds.top + borderTopWidth, Math.max(0, tlh - borderLeftWidth), Math.max(0, tlv - borderTopWidth), CORNER.TOP_LEFT)\r\n                    : new Vector(bounds.left + borderLeftWidth, bounds.top + borderTopWidth);\r\n            this.topRightPaddingBox =\r\n                trh > 0 || trv > 0\r\n                    ? getCurvePoints(bounds.left + Math.min(topWidth, bounds.width + borderLeftWidth), bounds.top + borderTopWidth, topWidth > bounds.width + borderLeftWidth ? 0 : trh - borderLeftWidth, trv - borderTopWidth, CORNER.TOP_RIGHT)\r\n                    : new Vector(bounds.left + bounds.width - borderRightWidth, bounds.top + borderTopWidth);\r\n            this.bottomRightPaddingBox =\r\n                brh > 0 || brv > 0\r\n                    ? getCurvePoints(bounds.left + Math.min(bottomWidth, bounds.width - borderLeftWidth), bounds.top + Math.min(rightHeight, bounds.height + borderTopWidth), Math.max(0, brh - borderRightWidth), brv - borderBottomWidth, CORNER.BOTTOM_RIGHT)\r\n                    : new Vector(bounds.left + bounds.width - borderRightWidth, bounds.top + bounds.height - borderBottomWidth);\r\n            this.bottomLeftPaddingBox =\r\n                blh > 0 || blv > 0\r\n                    ? getCurvePoints(bounds.left + borderLeftWidth, bounds.top + leftHeight, Math.max(0, blh - borderLeftWidth), blv - borderBottomWidth, CORNER.BOTTOM_LEFT)\r\n                    : new Vector(bounds.left + borderLeftWidth, bounds.top + bounds.height - borderBottomWidth);\r\n            this.topLeftContentBox =\r\n                tlh > 0 || tlv > 0\r\n                    ? getCurvePoints(bounds.left + borderLeftWidth + paddingLeft, bounds.top + borderTopWidth + paddingTop, Math.max(0, tlh - (borderLeftWidth + paddingLeft)), Math.max(0, tlv - (borderTopWidth + paddingTop)), CORNER.TOP_LEFT)\r\n                    : new Vector(bounds.left + borderLeftWidth + paddingLeft, bounds.top + borderTopWidth + paddingTop);\r\n            this.topRightContentBox =\r\n                trh > 0 || trv > 0\r\n                    ? getCurvePoints(bounds.left + Math.min(topWidth, bounds.width + borderLeftWidth + paddingLeft), bounds.top + borderTopWidth + paddingTop, topWidth > bounds.width + borderLeftWidth + paddingLeft ? 0 : trh - borderLeftWidth + paddingLeft, trv - (borderTopWidth + paddingTop), CORNER.TOP_RIGHT)\r\n                    : new Vector(bounds.left + bounds.width - (borderRightWidth + paddingRight), bounds.top + borderTopWidth + paddingTop);\r\n            this.bottomRightContentBox =\r\n                brh > 0 || brv > 0\r\n                    ? getCurvePoints(bounds.left + Math.min(bottomWidth, bounds.width - (borderLeftWidth + paddingLeft)), bounds.top + Math.min(rightHeight, bounds.height + borderTopWidth + paddingTop), Math.max(0, brh - (borderRightWidth + paddingRight)), brv - (borderBottomWidth + paddingBottom), CORNER.BOTTOM_RIGHT)\r\n                    : new Vector(bounds.left + bounds.width - (borderRightWidth + paddingRight), bounds.top + bounds.height - (borderBottomWidth + paddingBottom));\r\n            this.bottomLeftContentBox =\r\n                blh > 0 || blv > 0\r\n                    ? getCurvePoints(bounds.left + borderLeftWidth + paddingLeft, bounds.top + leftHeight, Math.max(0, blh - (borderLeftWidth + paddingLeft)), blv - (borderBottomWidth + paddingBottom), CORNER.BOTTOM_LEFT)\r\n                    : new Vector(bounds.left + borderLeftWidth + paddingLeft, bounds.top + bounds.height - (borderBottomWidth + paddingBottom));\r\n        }\r\n        return BoundCurves;\r\n    }());\r\n    var CORNER;\r\n    (function (CORNER) {\r\n        CORNER[CORNER[\"TOP_LEFT\"] = 0] = \"TOP_LEFT\";\r\n        CORNER[CORNER[\"TOP_RIGHT\"] = 1] = \"TOP_RIGHT\";\r\n        CORNER[CORNER[\"BOTTOM_RIGHT\"] = 2] = \"BOTTOM_RIGHT\";\r\n        CORNER[CORNER[\"BOTTOM_LEFT\"] = 3] = \"BOTTOM_LEFT\";\r\n    })(CORNER || (CORNER = {}));\r\n    var getCurvePoints = function (x, y, r1, r2, position) {\r\n        var kappa = 4 * ((Math.sqrt(2) - 1) / 3);\r\n        var ox = r1 * kappa; // control point offset horizontal\r\n        var oy = r2 * kappa; // control point offset vertical\r\n        var xm = x + r1; // x-middle\r\n        var ym = y + r2; // y-middle\r\n        switch (position) {\r\n            case CORNER.TOP_LEFT:\r\n                return new BezierCurve(new Vector(x, ym), new Vector(x, ym - oy), new Vector(xm - ox, y), new Vector(xm, y));\r\n            case CORNER.TOP_RIGHT:\r\n                return new BezierCurve(new Vector(x, y), new Vector(x + ox, y), new Vector(xm, ym - oy), new Vector(xm, ym));\r\n            case CORNER.BOTTOM_RIGHT:\r\n                return new BezierCurve(new Vector(xm, y), new Vector(xm, y + oy), new Vector(x + ox, ym), new Vector(x, ym));\r\n            case CORNER.BOTTOM_LEFT:\r\n            default:\r\n                return new BezierCurve(new Vector(xm, ym), new Vector(xm - ox, ym), new Vector(x, y + oy), new Vector(x, y));\r\n        }\r\n    };\r\n    var calculateBorderBoxPath = function (curves) {\r\n        return [curves.topLeftBorderBox, curves.topRightBorderBox, curves.bottomRightBorderBox, curves.bottomLeftBorderBox];\r\n    };\r\n    var calculateContentBoxPath = function (curves) {\r\n        return [\r\n            curves.topLeftContentBox,\r\n            curves.topRightContentBox,\r\n            curves.bottomRightContentBox,\r\n            curves.bottomLeftContentBox\r\n        ];\r\n    };\r\n    var calculatePaddingBoxPath = function (curves) {\r\n        return [\r\n            curves.topLeftPaddingBox,\r\n            curves.topRightPaddingBox,\r\n            curves.bottomRightPaddingBox,\r\n            curves.bottomLeftPaddingBox\r\n        ];\r\n    };\r\n\r\n    var TransformEffect = /** @class */ (function () {\r\n        function TransformEffect(offsetX, offsetY, matrix) {\r\n            this.type = 0 /* TRANSFORM */;\r\n            this.offsetX = offsetX;\r\n            this.offsetY = offsetY;\r\n            this.matrix = matrix;\r\n            this.target = 2 /* BACKGROUND_BORDERS */ | 4 /* CONTENT */;\r\n        }\r\n        return TransformEffect;\r\n    }());\r\n    var ClipEffect = /** @class */ (function () {\r\n        function ClipEffect(path, target) {\r\n            this.type = 1 /* CLIP */;\r\n            this.target = target;\r\n            this.path = path;\r\n        }\r\n        return ClipEffect;\r\n    }());\r\n    var isTransformEffect = function (effect) {\r\n        return effect.type === 0 /* TRANSFORM */;\r\n    };\r\n    var isClipEffect = function (effect) { return effect.type === 1 /* CLIP */; };\r\n\r\n    var StackingContext = /** @class */ (function () {\r\n        function StackingContext(container) {\r\n            this.element = container;\r\n            this.inlineLevel = [];\r\n            this.nonInlineLevel = [];\r\n            this.negativeZIndex = [];\r\n            this.zeroOrAutoZIndexOrTransformedOrOpacity = [];\r\n            this.positiveZIndex = [];\r\n            this.nonPositionedFloats = [];\r\n            this.nonPositionedInlineLevel = [];\r\n        }\r\n        return StackingContext;\r\n    }());\r\n    var ElementPaint = /** @class */ (function () {\r\n        function ElementPaint(element, parentStack) {\r\n            this.container = element;\r\n            this.effects = parentStack.slice(0);\r\n            this.curves = new BoundCurves(element);\r\n            if (element.styles.transform !== null) {\r\n                var offsetX = element.bounds.left + element.styles.transformOrigin[0].number;\r\n                var offsetY = element.bounds.top + element.styles.transformOrigin[1].number;\r\n                var matrix = element.styles.transform;\r\n                this.effects.push(new TransformEffect(offsetX, offsetY, matrix));\r\n            }\r\n            if (element.styles.overflowX !== OVERFLOW.VISIBLE) {\r\n                var borderBox = calculateBorderBoxPath(this.curves);\r\n                var paddingBox = calculatePaddingBoxPath(this.curves);\r\n                if (equalPath(borderBox, paddingBox)) {\r\n                    this.effects.push(new ClipEffect(borderBox, 2 /* BACKGROUND_BORDERS */ | 4 /* CONTENT */));\r\n                }\r\n                else {\r\n                    this.effects.push(new ClipEffect(borderBox, 2 /* BACKGROUND_BORDERS */));\r\n                    this.effects.push(new ClipEffect(paddingBox, 4 /* CONTENT */));\r\n                }\r\n            }\r\n        }\r\n        ElementPaint.prototype.getParentEffects = function () {\r\n            var effects = this.effects.slice(0);\r\n            if (this.container.styles.overflowX !== OVERFLOW.VISIBLE) {\r\n                var borderBox = calculateBorderBoxPath(this.curves);\r\n                var paddingBox = calculatePaddingBoxPath(this.curves);\r\n                if (!equalPath(borderBox, paddingBox)) {\r\n                    effects.push(new ClipEffect(paddingBox, 2 /* BACKGROUND_BORDERS */ | 4 /* CONTENT */));\r\n                }\r\n            }\r\n            return effects;\r\n        };\r\n        return ElementPaint;\r\n    }());\r\n    var parseStackTree = function (parent, stackingContext, realStackingContext, listItems) {\r\n        parent.container.elements.forEach(function (child) {\r\n            var treatAsRealStackingContext = contains(child.flags, 4 /* CREATES_REAL_STACKING_CONTEXT */);\r\n            var createsStackingContext = contains(child.flags, 2 /* CREATES_STACKING_CONTEXT */);\r\n            var paintContainer = new ElementPaint(child, parent.getParentEffects());\r\n            if (contains(child.styles.display, 2048 /* LIST_ITEM */)) {\r\n                listItems.push(paintContainer);\r\n            }\r\n            var listOwnerItems = contains(child.flags, 8 /* IS_LIST_OWNER */) ? [] : listItems;\r\n            if (treatAsRealStackingContext || createsStackingContext) {\r\n                var parentStack = treatAsRealStackingContext || child.styles.isPositioned() ? realStackingContext : stackingContext;\r\n                var stack = new StackingContext(paintContainer);\r\n                if (child.styles.isPositioned() || child.styles.opacity < 1 || child.styles.isTransformed()) {\r\n                    var order_1 = child.styles.zIndex.order;\r\n                    if (order_1 < 0) {\r\n                        var index_1 = 0;\r\n                        parentStack.negativeZIndex.some(function (current, i) {\r\n                            if (order_1 > current.element.container.styles.zIndex.order) {\r\n                                index_1 = i;\r\n                                return false;\r\n                            }\r\n                            else if (index_1 > 0) {\r\n                                return true;\r\n                            }\r\n                            return false;\r\n                        });\r\n                        parentStack.negativeZIndex.splice(index_1, 0, stack);\r\n                    }\r\n                    else if (order_1 > 0) {\r\n                        var index_2 = 0;\r\n                        parentStack.positiveZIndex.some(function (current, i) {\r\n                            if (order_1 >= current.element.container.styles.zIndex.order) {\r\n                                index_2 = i + 1;\r\n                                return false;\r\n                            }\r\n                            else if (index_2 > 0) {\r\n                                return true;\r\n                            }\r\n                            return false;\r\n                        });\r\n                        parentStack.positiveZIndex.splice(index_2, 0, stack);\r\n                    }\r\n                    else {\r\n                        parentStack.zeroOrAutoZIndexOrTransformedOrOpacity.push(stack);\r\n                    }\r\n                }\r\n                else {\r\n                    if (child.styles.isFloating()) {\r\n                        parentStack.nonPositionedFloats.push(stack);\r\n                    }\r\n                    else {\r\n                        parentStack.nonPositionedInlineLevel.push(stack);\r\n                    }\r\n                }\r\n                parseStackTree(paintContainer, stack, treatAsRealStackingContext ? stack : realStackingContext, listOwnerItems);\r\n            }\r\n            else {\r\n                if (child.styles.isInlineLevel()) {\r\n                    stackingContext.inlineLevel.push(paintContainer);\r\n                }\r\n                else {\r\n                    stackingContext.nonInlineLevel.push(paintContainer);\r\n                }\r\n                parseStackTree(paintContainer, stackingContext, realStackingContext, listOwnerItems);\r\n            }\r\n            if (contains(child.flags, 8 /* IS_LIST_OWNER */)) {\r\n                processListItems(child, listOwnerItems);\r\n            }\r\n        });\r\n    };\r\n    var processListItems = function (owner, elements) {\r\n        var numbering = owner instanceof OLElementContainer ? owner.start : 1;\r\n        var reversed = owner instanceof OLElementContainer ? owner.reversed : false;\r\n        for (var i = 0; i < elements.length; i++) {\r\n            var item = elements[i];\r\n            if (item.container instanceof LIElementContainer &&\r\n                typeof item.container.value === 'number' &&\r\n                item.container.value !== 0) {\r\n                numbering = item.container.value;\r\n            }\r\n            item.listValue = createCounterText(numbering, item.container.styles.listStyleType, true);\r\n            numbering += reversed ? -1 : 1;\r\n        }\r\n    };\r\n    var parseStackingContexts = function (container) {\r\n        var paintContainer = new ElementPaint(container, []);\r\n        var root = new StackingContext(paintContainer);\r\n        var listItems = [];\r\n        parseStackTree(paintContainer, root, root, listItems);\r\n        processListItems(paintContainer.container, listItems);\r\n        return root;\r\n    };\r\n\r\n    var parsePathForBorder = function (curves, borderSide) {\r\n        switch (borderSide) {\r\n            case 0:\r\n                return createPathFromCurves(curves.topLeftBorderBox, curves.topLeftPaddingBox, curves.topRightBorderBox, curves.topRightPaddingBox);\r\n            case 1:\r\n                return createPathFromCurves(curves.topRightBorderBox, curves.topRightPaddingBox, curves.bottomRightBorderBox, curves.bottomRightPaddingBox);\r\n            case 2:\r\n                return createPathFromCurves(curves.bottomRightBorderBox, curves.bottomRightPaddingBox, curves.bottomLeftBorderBox, curves.bottomLeftPaddingBox);\r\n            case 3:\r\n            default:\r\n                return createPathFromCurves(curves.bottomLeftBorderBox, curves.bottomLeftPaddingBox, curves.topLeftBorderBox, curves.topLeftPaddingBox);\r\n        }\r\n    };\r\n    var createPathFromCurves = function (outer1, inner1, outer2, inner2) {\r\n        var path = [];\r\n        if (isBezierCurve(outer1)) {\r\n            path.push(outer1.subdivide(0.5, false));\r\n        }\r\n        else {\r\n            path.push(outer1);\r\n        }\r\n        if (isBezierCurve(outer2)) {\r\n            path.push(outer2.subdivide(0.5, true));\r\n        }\r\n        else {\r\n            path.push(outer2);\r\n        }\r\n        if (isBezierCurve(inner2)) {\r\n            path.push(inner2.subdivide(0.5, true).reverse());\r\n        }\r\n        else {\r\n            path.push(inner2);\r\n        }\r\n        if (isBezierCurve(inner1)) {\r\n            path.push(inner1.subdivide(0.5, false).reverse());\r\n        }\r\n        else {\r\n            path.push(inner1);\r\n        }\r\n        return path;\r\n    };\r\n\r\n    var paddingBox = function (element) {\r\n        var bounds = element.bounds;\r\n        var styles = element.styles;\r\n        return bounds.add(styles.borderLeftWidth, styles.borderTopWidth, -(styles.borderRightWidth + styles.borderLeftWidth), -(styles.borderTopWidth + styles.borderBottomWidth));\r\n    };\r\n    var contentBox = function (element) {\r\n        var styles = element.styles;\r\n        var bounds = element.bounds;\r\n        var paddingLeft = getAbsoluteValue(styles.paddingLeft, bounds.width);\r\n        var paddingRight = getAbsoluteValue(styles.paddingRight, bounds.width);\r\n        var paddingTop = getAbsoluteValue(styles.paddingTop, bounds.width);\r\n        var paddingBottom = getAbsoluteValue(styles.paddingBottom, bounds.width);\r\n        return bounds.add(paddingLeft + styles.borderLeftWidth, paddingTop + styles.borderTopWidth, -(styles.borderRightWidth + styles.borderLeftWidth + paddingLeft + paddingRight), -(styles.borderTopWidth + styles.borderBottomWidth + paddingTop + paddingBottom));\r\n    };\r\n\r\n    var calculateBackgroundPositioningArea = function (backgroundOrigin, element) {\r\n        if (backgroundOrigin === 0 /* BORDER_BOX */) {\r\n            return element.bounds;\r\n        }\r\n        if (backgroundOrigin === 2 /* CONTENT_BOX */) {\r\n            return contentBox(element);\r\n        }\r\n        return paddingBox(element);\r\n    };\r\n    var calculateBackgroundPaintingArea = function (backgroundClip, element) {\r\n        if (backgroundClip === BACKGROUND_CLIP.BORDER_BOX) {\r\n            return element.bounds;\r\n        }\r\n        if (backgroundClip === BACKGROUND_CLIP.CONTENT_BOX) {\r\n            return contentBox(element);\r\n        }\r\n        return paddingBox(element);\r\n    };\r\n    var calculateBackgroundRendering = function (container, index, intrinsicSize) {\r\n        var backgroundPositioningArea = calculateBackgroundPositioningArea(getBackgroundValueForIndex(container.styles.backgroundOrigin, index), container);\r\n        var backgroundPaintingArea = calculateBackgroundPaintingArea(getBackgroundValueForIndex(container.styles.backgroundClip, index), container);\r\n        var backgroundImageSize = calculateBackgroundSize(getBackgroundValueForIndex(container.styles.backgroundSize, index), intrinsicSize, backgroundPositioningArea);\r\n        var sizeWidth = backgroundImageSize[0], sizeHeight = backgroundImageSize[1];\r\n        var position = getAbsoluteValueForTuple(getBackgroundValueForIndex(container.styles.backgroundPosition, index), backgroundPositioningArea.width - sizeWidth, backgroundPositioningArea.height - sizeHeight);\r\n        var path = calculateBackgroundRepeatPath(getBackgroundValueForIndex(container.styles.backgroundRepeat, index), position, backgroundImageSize, backgroundPositioningArea, backgroundPaintingArea);\r\n        var offsetX = Math.round(backgroundPositioningArea.left + position[0]);\r\n        var offsetY = Math.round(backgroundPositioningArea.top + position[1]);\r\n        return [path, offsetX, offsetY, sizeWidth, sizeHeight];\r\n    };\r\n    var isAuto = function (token) { return isIdentToken(token) && token.value === BACKGROUND_SIZE.AUTO; };\r\n    var hasIntrinsicValue = function (value) { return typeof value === 'number'; };\r\n    var calculateBackgroundSize = function (size, _a, bounds) {\r\n        var intrinsicWidth = _a[0], intrinsicHeight = _a[1], intrinsicProportion = _a[2];\r\n        var first = size[0], second = size[1];\r\n        if (isLengthPercentage(first) && second && isLengthPercentage(second)) {\r\n            return [getAbsoluteValue(first, bounds.width), getAbsoluteValue(second, bounds.height)];\r\n        }\r\n        var hasIntrinsicProportion = hasIntrinsicValue(intrinsicProportion);\r\n        if (isIdentToken(first) && (first.value === BACKGROUND_SIZE.CONTAIN || first.value === BACKGROUND_SIZE.COVER)) {\r\n            if (hasIntrinsicValue(intrinsicProportion)) {\r\n                var targetRatio = bounds.width / bounds.height;\r\n                return targetRatio < intrinsicProportion !== (first.value === BACKGROUND_SIZE.COVER)\r\n                    ? [bounds.width, bounds.width / intrinsicProportion]\r\n                    : [bounds.height * intrinsicProportion, bounds.height];\r\n            }\r\n            return [bounds.width, bounds.height];\r\n        }\r\n        var hasIntrinsicWidth = hasIntrinsicValue(intrinsicWidth);\r\n        var hasIntrinsicHeight = hasIntrinsicValue(intrinsicHeight);\r\n        var hasIntrinsicDimensions = hasIntrinsicWidth || hasIntrinsicHeight;\r\n        // If the background-size is auto or auto auto:\r\n        if (isAuto(first) && (!second || isAuto(second))) {\r\n            // If the image has both horizontal and vertical intrinsic dimensions, it's rendered at that size.\r\n            if (hasIntrinsicWidth && hasIntrinsicHeight) {\r\n                return [intrinsicWidth, intrinsicHeight];\r\n            }\r\n            // If the image has no intrinsic dimensions and has no intrinsic proportions,\r\n            // it's rendered at the size of the background positioning area.\r\n            if (!hasIntrinsicProportion && !hasIntrinsicDimensions) {\r\n                return [bounds.width, bounds.height];\r\n            }\r\n            // TODO If the image has no intrinsic dimensions but has intrinsic proportions, it's rendered as if contain had been specified instead.\r\n            // If the image has only one intrinsic dimension and has intrinsic proportions, it's rendered at the size corresponding to that one dimension.\r\n            // The other dimension is computed using the specified dimension and the intrinsic proportions.\r\n            if (hasIntrinsicDimensions && hasIntrinsicProportion) {\r\n                var width_1 = hasIntrinsicWidth\r\n                    ? intrinsicWidth\r\n                    : intrinsicHeight * intrinsicProportion;\r\n                var height_1 = hasIntrinsicHeight\r\n                    ? intrinsicHeight\r\n                    : intrinsicWidth / intrinsicProportion;\r\n                return [width_1, height_1];\r\n            }\r\n            // If the image has only one intrinsic dimension but has no intrinsic proportions,\r\n            // it's rendered using the specified dimension and the other dimension of the background positioning area.\r\n            var width_2 = hasIntrinsicWidth ? intrinsicWidth : bounds.width;\r\n            var height_2 = hasIntrinsicHeight ? intrinsicHeight : bounds.height;\r\n            return [width_2, height_2];\r\n        }\r\n        // If the image has intrinsic proportions, it's stretched to the specified dimension.\r\n        // The unspecified dimension is computed using the specified dimension and the intrinsic proportions.\r\n        if (hasIntrinsicProportion) {\r\n            var width_3 = 0;\r\n            var height_3 = 0;\r\n            if (isLengthPercentage(first)) {\r\n                width_3 = getAbsoluteValue(first, bounds.width);\r\n            }\r\n            else if (isLengthPercentage(second)) {\r\n                height_3 = getAbsoluteValue(second, bounds.height);\r\n            }\r\n            if (isAuto(first)) {\r\n                width_3 = height_3 * intrinsicProportion;\r\n            }\r\n            else if (!second || isAuto(second)) {\r\n                height_3 = width_3 / intrinsicProportion;\r\n            }\r\n            return [width_3, height_3];\r\n        }\r\n        // If the image has no intrinsic proportions, it's stretched to the specified dimension.\r\n        // The unspecified dimension is computed using the image's corresponding intrinsic dimension,\r\n        // if there is one. If there is no such intrinsic dimension,\r\n        // it becomes the corresponding dimension of the background positioning area.\r\n        var width = null;\r\n        var height = null;\r\n        if (isLengthPercentage(first)) {\r\n            width = getAbsoluteValue(first, bounds.width);\r\n        }\r\n        else if (second && isLengthPercentage(second)) {\r\n            height = getAbsoluteValue(second, bounds.height);\r\n        }\r\n        if (width !== null && (!second || isAuto(second))) {\r\n            height =\r\n                hasIntrinsicWidth && hasIntrinsicHeight\r\n                    ? (width / intrinsicWidth) * intrinsicHeight\r\n                    : bounds.height;\r\n        }\r\n        if (height !== null && isAuto(first)) {\r\n            width =\r\n                hasIntrinsicWidth && hasIntrinsicHeight\r\n                    ? (height / intrinsicHeight) * intrinsicWidth\r\n                    : bounds.width;\r\n        }\r\n        if (width !== null && height !== null) {\r\n            return [width, height];\r\n        }\r\n        throw new Error(\"Unable to calculate background-size for element\");\r\n    };\r\n    var getBackgroundValueForIndex = function (values, index) {\r\n        var value = values[index];\r\n        if (typeof value === 'undefined') {\r\n            return values[0];\r\n        }\r\n        return value;\r\n    };\r\n    var calculateBackgroundRepeatPath = function (repeat, _a, _b, backgroundPositioningArea, backgroundPaintingArea) {\r\n        var x = _a[0], y = _a[1];\r\n        var width = _b[0], height = _b[1];\r\n        switch (repeat) {\r\n            case BACKGROUND_REPEAT.REPEAT_X:\r\n                return [\r\n                    new Vector(Math.round(backgroundPositioningArea.left), Math.round(backgroundPositioningArea.top + y)),\r\n                    new Vector(Math.round(backgroundPositioningArea.left + backgroundPositioningArea.width), Math.round(backgroundPositioningArea.top + y)),\r\n                    new Vector(Math.round(backgroundPositioningArea.left + backgroundPositioningArea.width), Math.round(height + backgroundPositioningArea.top + y)),\r\n                    new Vector(Math.round(backgroundPositioningArea.left), Math.round(height + backgroundPositioningArea.top + y))\r\n                ];\r\n            case BACKGROUND_REPEAT.REPEAT_Y:\r\n                return [\r\n                    new Vector(Math.round(backgroundPositioningArea.left + x), Math.round(backgroundPositioningArea.top)),\r\n                    new Vector(Math.round(backgroundPositioningArea.left + x + width), Math.round(backgroundPositioningArea.top)),\r\n                    new Vector(Math.round(backgroundPositioningArea.left + x + width), Math.round(backgroundPositioningArea.height + backgroundPositioningArea.top)),\r\n                    new Vector(Math.round(backgroundPositioningArea.left + x), Math.round(backgroundPositioningArea.height + backgroundPositioningArea.top))\r\n                ];\r\n            case BACKGROUND_REPEAT.NO_REPEAT:\r\n                return [\r\n                    new Vector(Math.round(backgroundPositioningArea.left + x), Math.round(backgroundPositioningArea.top + y)),\r\n                    new Vector(Math.round(backgroundPositioningArea.left + x + width), Math.round(backgroundPositioningArea.top + y)),\r\n                    new Vector(Math.round(backgroundPositioningArea.left + x + width), Math.round(backgroundPositioningArea.top + y + height)),\r\n                    new Vector(Math.round(backgroundPositioningArea.left + x), Math.round(backgroundPositioningArea.top + y + height))\r\n                ];\r\n            default:\r\n                return [\r\n                    new Vector(Math.round(backgroundPaintingArea.left), Math.round(backgroundPaintingArea.top)),\r\n                    new Vector(Math.round(backgroundPaintingArea.left + backgroundPaintingArea.width), Math.round(backgroundPaintingArea.top)),\r\n                    new Vector(Math.round(backgroundPaintingArea.left + backgroundPaintingArea.width), Math.round(backgroundPaintingArea.height + backgroundPaintingArea.top)),\r\n                    new Vector(Math.round(backgroundPaintingArea.left), Math.round(backgroundPaintingArea.height + backgroundPaintingArea.top))\r\n                ];\r\n        }\r\n    };\r\n\r\n    var SMALL_IMAGE = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\r\n\r\n    var SAMPLE_TEXT = 'Hidden Text';\r\n    var FontMetrics = /** @class */ (function () {\r\n        function FontMetrics(document) {\r\n            this._data = {};\r\n            this._document = document;\r\n        }\r\n        FontMetrics.prototype.parseMetrics = function (fontFamily, fontSize) {\r\n            var container = this._document.createElement('div');\r\n            var img = this._document.createElement('img');\r\n            var span = this._document.createElement('span');\r\n            var body = this._document.body;\r\n            container.style.visibility = 'hidden';\r\n            container.style.fontFamily = fontFamily;\r\n            container.style.fontSize = fontSize;\r\n            container.style.margin = '0';\r\n            container.style.padding = '0';\r\n            body.appendChild(container);\r\n            img.src = SMALL_IMAGE;\r\n            img.width = 1;\r\n            img.height = 1;\r\n            img.style.margin = '0';\r\n            img.style.padding = '0';\r\n            img.style.verticalAlign = 'baseline';\r\n            span.style.fontFamily = fontFamily;\r\n            span.style.fontSize = fontSize;\r\n            span.style.margin = '0';\r\n            span.style.padding = '0';\r\n            span.appendChild(this._document.createTextNode(SAMPLE_TEXT));\r\n            container.appendChild(span);\r\n            container.appendChild(img);\r\n            var baseline = img.offsetTop - span.offsetTop + 2;\r\n            container.removeChild(span);\r\n            container.appendChild(this._document.createTextNode(SAMPLE_TEXT));\r\n            container.style.lineHeight = 'normal';\r\n            img.style.verticalAlign = 'super';\r\n            var middle = img.offsetTop - container.offsetTop + 2;\r\n            body.removeChild(container);\r\n            return { baseline: baseline, middle: middle };\r\n        };\r\n        FontMetrics.prototype.getMetrics = function (fontFamily, fontSize) {\r\n            var key = fontFamily + \" \" + fontSize;\r\n            if (typeof this._data[key] === 'undefined') {\r\n                this._data[key] = this.parseMetrics(fontFamily, fontSize);\r\n            }\r\n            return this._data[key];\r\n        };\r\n        return FontMetrics;\r\n    }());\r\n\r\n    var MASK_OFFSET = 10000;\r\n    var CanvasRenderer = /** @class */ (function () {\r\n        function CanvasRenderer(options) {\r\n            this._activeEffects = [];\r\n            this.canvas = options.canvas ? options.canvas : document.createElement('canvas');\r\n            this.ctx = this.canvas.getContext('2d');\r\n            this.options = options;\r\n            if (!options.canvas) {\r\n                this.canvas.width = Math.floor(options.width * options.scale);\r\n                this.canvas.height = Math.floor(options.height * options.scale);\r\n                this.canvas.style.width = options.width + \"px\";\r\n                this.canvas.style.height = options.height + \"px\";\r\n            }\r\n            this.fontMetrics = new FontMetrics(document);\r\n            this.ctx.scale(this.options.scale, this.options.scale);\r\n            this.ctx.translate(-options.x + options.scrollX, -options.y + options.scrollY);\r\n            this.ctx.textBaseline = 'bottom';\r\n            this._activeEffects = [];\r\n            Logger.getInstance(options.id).debug(\"Canvas renderer initialized (\" + options.width + \"x\" + options.height + \" at \" + options.x + \",\" + options.y + \") with scale \" + options.scale);\r\n        }\r\n        CanvasRenderer.prototype.applyEffects = function (effects, target) {\r\n            var _this = this;\r\n            while (this._activeEffects.length) {\r\n                this.popEffect();\r\n            }\r\n            effects.filter(function (effect) { return contains(effect.target, target); }).forEach(function (effect) { return _this.applyEffect(effect); });\r\n        };\r\n        CanvasRenderer.prototype.applyEffect = function (effect) {\r\n            this.ctx.save();\r\n            if (isTransformEffect(effect)) {\r\n                this.ctx.translate(effect.offsetX, effect.offsetY);\r\n                this.ctx.transform(effect.matrix[0], effect.matrix[1], effect.matrix[2], effect.matrix[3], effect.matrix[4], effect.matrix[5]);\r\n                this.ctx.translate(-effect.offsetX, -effect.offsetY);\r\n            }\r\n            if (isClipEffect(effect)) {\r\n                this.path(effect.path);\r\n                this.ctx.clip();\r\n            }\r\n            this._activeEffects.push(effect);\r\n        };\r\n        CanvasRenderer.prototype.popEffect = function () {\r\n            this._activeEffects.pop();\r\n            this.ctx.restore();\r\n        };\r\n        CanvasRenderer.prototype.renderStack = function (stack) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var styles;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            styles = stack.element.container.styles;\r\n                            if (!styles.isVisible()) return [3 /*break*/, 2];\r\n                            this.ctx.globalAlpha = styles.opacity;\r\n                            return [4 /*yield*/, this.renderStackContent(stack)];\r\n                        case 1:\r\n                            _a.sent();\r\n                            _a.label = 2;\r\n                        case 2: return [2 /*return*/];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        CanvasRenderer.prototype.renderNode = function (paint) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            if (!paint.container.styles.isVisible()) return [3 /*break*/, 3];\r\n                            return [4 /*yield*/, this.renderNodeBackgroundAndBorders(paint)];\r\n                        case 1:\r\n                            _a.sent();\r\n                            return [4 /*yield*/, this.renderNodeContent(paint)];\r\n                        case 2:\r\n                            _a.sent();\r\n                            _a.label = 3;\r\n                        case 3: return [2 /*return*/];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        CanvasRenderer.prototype.renderTextWithLetterSpacing = function (text, letterSpacing) {\r\n            var _this = this;\r\n            if (letterSpacing === 0) {\r\n                this.ctx.fillText(text.text, text.bounds.left, text.bounds.top + text.bounds.height);\r\n            }\r\n            else {\r\n                var letters = toCodePoints(text.text).map(function (i) { return fromCodePoint(i); });\r\n                letters.reduce(function (left, letter) {\r\n                    _this.ctx.fillText(letter, left, text.bounds.top + text.bounds.height);\r\n                    return left + _this.ctx.measureText(letter).width;\r\n                }, text.bounds.left);\r\n            }\r\n        };\r\n        CanvasRenderer.prototype.createFontStyle = function (styles) {\r\n            var fontVariant = styles.fontVariant\r\n                .filter(function (variant) { return variant === 'normal' || variant === 'small-caps'; })\r\n                .join('');\r\n            var fontFamily = styles.fontFamily.join(', ');\r\n            var fontSize = isDimensionToken(styles.fontSize)\r\n                ? \"\" + styles.fontSize.number + styles.fontSize.unit\r\n                : styles.fontSize.number + \"px\";\r\n            return [\r\n                [styles.fontStyle, fontVariant, styles.fontWeight, fontSize, fontFamily].join(' '),\r\n                fontFamily,\r\n                fontSize\r\n            ];\r\n        };\r\n        CanvasRenderer.prototype.renderTextNode = function (text, styles) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var _a, font, fontFamily, fontSize;\r\n                var _this = this;\r\n                return __generator(this, function (_b) {\r\n                    _a = this.createFontStyle(styles), font = _a[0], fontFamily = _a[1], fontSize = _a[2];\r\n                    this.ctx.font = font;\r\n                    text.textBounds.forEach(function (text) {\r\n                        _this.ctx.fillStyle = asString(styles.color);\r\n                        _this.renderTextWithLetterSpacing(text, styles.letterSpacing);\r\n                        var textShadows = styles.textShadow;\r\n                        if (textShadows.length && text.text.trim().length) {\r\n                            textShadows\r\n                                .slice(0)\r\n                                .reverse()\r\n                                .forEach(function (textShadow) {\r\n                                _this.ctx.shadowColor = asString(textShadow.color);\r\n                                _this.ctx.shadowOffsetX = textShadow.offsetX.number * _this.options.scale;\r\n                                _this.ctx.shadowOffsetY = textShadow.offsetY.number * _this.options.scale;\r\n                                _this.ctx.shadowBlur = textShadow.blur.number;\r\n                                _this.ctx.fillText(text.text, text.bounds.left, text.bounds.top + text.bounds.height);\r\n                            });\r\n                            _this.ctx.shadowColor = '';\r\n                            _this.ctx.shadowOffsetX = 0;\r\n                            _this.ctx.shadowOffsetY = 0;\r\n                            _this.ctx.shadowBlur = 0;\r\n                        }\r\n                        if (styles.textDecorationLine.length) {\r\n                            _this.ctx.fillStyle = asString(styles.textDecorationColor || styles.color);\r\n                            styles.textDecorationLine.forEach(function (textDecorationLine) {\r\n                                switch (textDecorationLine) {\r\n                                    case 1 /* UNDERLINE */:\r\n                                        // Draws a line at the baseline of the font\r\n                                        // TODO As some browsers display the line as more than 1px if the font-size is big,\r\n                                        // need to take that into account both in position and size\r\n                                        var baseline = _this.fontMetrics.getMetrics(fontFamily, fontSize).baseline;\r\n                                        _this.ctx.fillRect(text.bounds.left, Math.round(text.bounds.top + baseline), text.bounds.width, 1);\r\n                                        break;\r\n                                    case 2 /* OVERLINE */:\r\n                                        _this.ctx.fillRect(text.bounds.left, Math.round(text.bounds.top), text.bounds.width, 1);\r\n                                        break;\r\n                                    case 3 /* LINE_THROUGH */:\r\n                                        // TODO try and find exact position for line-through\r\n                                        var middle = _this.fontMetrics.getMetrics(fontFamily, fontSize).middle;\r\n                                        _this.ctx.fillRect(text.bounds.left, Math.ceil(text.bounds.top + middle), text.bounds.width, 1);\r\n                                        break;\r\n                                }\r\n                            });\r\n                        }\r\n                    });\r\n                    return [2 /*return*/];\r\n                });\r\n            });\r\n        };\r\n        CanvasRenderer.prototype.renderReplacedElement = function (container, curves, image) {\r\n            if (image && container.intrinsicWidth > 0 && container.intrinsicHeight > 0) {\r\n                var box = contentBox(container);\r\n                var path = calculatePaddingBoxPath(curves);\r\n                this.path(path);\r\n                this.ctx.save();\r\n                this.ctx.clip();\r\n                this.ctx.drawImage(image, 0, 0, container.intrinsicWidth, container.intrinsicHeight, box.left, box.top, box.width, box.height);\r\n                this.ctx.restore();\r\n            }\r\n        };\r\n        CanvasRenderer.prototype.renderNodeContent = function (paint) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var container, curves, styles, _i, _a, child, image, e_1, image, e_2, iframeRenderer, canvas, size, bounds, x, textBounds, img, image, url, e_3, bounds;\r\n                return __generator(this, function (_b) {\r\n                    switch (_b.label) {\r\n                        case 0:\r\n                            this.applyEffects(paint.effects, 4 /* CONTENT */);\r\n                            container = paint.container;\r\n                            curves = paint.curves;\r\n                            styles = container.styles;\r\n                            _i = 0, _a = container.textNodes;\r\n                            _b.label = 1;\r\n                        case 1:\r\n                            if (!(_i < _a.length)) return [3 /*break*/, 4];\r\n                            child = _a[_i];\r\n                            return [4 /*yield*/, this.renderTextNode(child, styles)];\r\n                        case 2:\r\n                            _b.sent();\r\n                            _b.label = 3;\r\n                        case 3:\r\n                            _i++;\r\n                            return [3 /*break*/, 1];\r\n                        case 4:\r\n                            if (!(container instanceof ImageElementContainer)) return [3 /*break*/, 8];\r\n                            _b.label = 5;\r\n                        case 5:\r\n                            _b.trys.push([5, 7, , 8]);\r\n                            return [4 /*yield*/, this.options.cache.match(container.src)];\r\n                        case 6:\r\n                            image = _b.sent();\r\n                            this.renderReplacedElement(container, curves, image);\r\n                            return [3 /*break*/, 8];\r\n                        case 7:\r\n                            e_1 = _b.sent();\r\n                            Logger.getInstance(this.options.id).error(\"Error loading image \" + container.src);\r\n                            return [3 /*break*/, 8];\r\n                        case 8:\r\n                            if (container instanceof CanvasElementContainer) {\r\n                                this.renderReplacedElement(container, curves, container.canvas);\r\n                            }\r\n                            if (!(container instanceof SVGElementContainer)) return [3 /*break*/, 12];\r\n                            _b.label = 9;\r\n                        case 9:\r\n                            _b.trys.push([9, 11, , 12]);\r\n                            return [4 /*yield*/, this.options.cache.match(container.svg)];\r\n                        case 10:\r\n                            image = _b.sent();\r\n                            this.renderReplacedElement(container, curves, image);\r\n                            return [3 /*break*/, 12];\r\n                        case 11:\r\n                            e_2 = _b.sent();\r\n                            Logger.getInstance(this.options.id).error(\"Error loading svg \" + container.svg.substring(0, 255));\r\n                            return [3 /*break*/, 12];\r\n                        case 12:\r\n                            if (!(container instanceof IFrameElementContainer && container.tree)) return [3 /*break*/, 14];\r\n                            iframeRenderer = new CanvasRenderer({\r\n                                id: this.options.id,\r\n                                scale: this.options.scale,\r\n                                backgroundColor: container.backgroundColor,\r\n                                x: 0,\r\n                                y: 0,\r\n                                scrollX: 0,\r\n                                scrollY: 0,\r\n                                width: container.width,\r\n                                height: container.height,\r\n                                cache: this.options.cache,\r\n                                windowWidth: container.width,\r\n                                windowHeight: container.height\r\n                            });\r\n                            return [4 /*yield*/, iframeRenderer.render(container.tree)];\r\n                        case 13:\r\n                            canvas = _b.sent();\r\n                            if (container.width && container.height) {\r\n                                this.ctx.drawImage(canvas, 0, 0, container.width, container.height, container.bounds.left, container.bounds.top, container.bounds.width, container.bounds.height);\r\n                            }\r\n                            _b.label = 14;\r\n                        case 14:\r\n                            if (container instanceof InputElementContainer) {\r\n                                size = Math.min(container.bounds.width, container.bounds.height);\r\n                                if (container.type === CHECKBOX) {\r\n                                    if (container.checked) {\r\n                                        this.ctx.save();\r\n                                        this.path([\r\n                                            new Vector(container.bounds.left + size * 0.39363, container.bounds.top + size * 0.79),\r\n                                            new Vector(container.bounds.left + size * 0.16, container.bounds.top + size * 0.5549),\r\n                                            new Vector(container.bounds.left + size * 0.27347, container.bounds.top + size * 0.44071),\r\n                                            new Vector(container.bounds.left + size * 0.39694, container.bounds.top + size * 0.5649),\r\n                                            new Vector(container.bounds.left + size * 0.72983, container.bounds.top + size * 0.23),\r\n                                            new Vector(container.bounds.left + size * 0.84, container.bounds.top + size * 0.34085),\r\n                                            new Vector(container.bounds.left + size * 0.39363, container.bounds.top + size * 0.79)\r\n                                        ]);\r\n                                        this.ctx.fillStyle = asString(INPUT_COLOR);\r\n                                        this.ctx.fill();\r\n                                        this.ctx.restore();\r\n                                    }\r\n                                }\r\n                                else if (container.type === RADIO) {\r\n                                    if (container.checked) {\r\n                                        this.ctx.save();\r\n                                        this.ctx.beginPath();\r\n                                        this.ctx.arc(container.bounds.left + size / 2, container.bounds.top + size / 2, size / 4, 0, Math.PI * 2, true);\r\n                                        this.ctx.fillStyle = asString(INPUT_COLOR);\r\n                                        this.ctx.fill();\r\n                                        this.ctx.restore();\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (isTextInputElement(container) && container.value.length) {\r\n                                this.ctx.font = this.createFontStyle(styles)[0];\r\n                                this.ctx.fillStyle = asString(styles.color);\r\n                                this.ctx.textBaseline = 'middle';\r\n                                this.ctx.textAlign = canvasTextAlign(container.styles.textAlign);\r\n                                bounds = contentBox(container);\r\n                                x = 0;\r\n                                switch (container.styles.textAlign) {\r\n                                    case TEXT_ALIGN.CENTER:\r\n                                        x += bounds.width / 2;\r\n                                        break;\r\n                                    case TEXT_ALIGN.RIGHT:\r\n                                        x += bounds.width;\r\n                                        break;\r\n                                }\r\n                                textBounds = bounds.add(x, 0, 0, -bounds.height / 2 + 1);\r\n                                this.ctx.save();\r\n                                this.path([\r\n                                    new Vector(bounds.left, bounds.top),\r\n                                    new Vector(bounds.left + bounds.width, bounds.top),\r\n                                    new Vector(bounds.left + bounds.width, bounds.top + bounds.height),\r\n                                    new Vector(bounds.left, bounds.top + bounds.height)\r\n                                ]);\r\n                                this.ctx.clip();\r\n                                this.renderTextWithLetterSpacing(new TextBounds(container.value, textBounds), styles.letterSpacing);\r\n                                this.ctx.restore();\r\n                                this.ctx.textBaseline = 'bottom';\r\n                                this.ctx.textAlign = 'left';\r\n                            }\r\n                            if (!contains(container.styles.display, 2048 /* LIST_ITEM */)) return [3 /*break*/, 20];\r\n                            if (!(container.styles.listStyleImage !== null)) return [3 /*break*/, 19];\r\n                            img = container.styles.listStyleImage;\r\n                            if (!(img.type === CSSImageType.URL)) return [3 /*break*/, 18];\r\n                            image = void 0;\r\n                            url = img.url;\r\n                            _b.label = 15;\r\n                        case 15:\r\n                            _b.trys.push([15, 17, , 18]);\r\n                            return [4 /*yield*/, this.options.cache.match(url)];\r\n                        case 16:\r\n                            image = _b.sent();\r\n                            this.ctx.drawImage(image, container.bounds.left - (image.width + 10), container.bounds.top);\r\n                            return [3 /*break*/, 18];\r\n                        case 17:\r\n                            e_3 = _b.sent();\r\n                            Logger.getInstance(this.options.id).error(\"Error loading list-style-image \" + url);\r\n                            return [3 /*break*/, 18];\r\n                        case 18: return [3 /*break*/, 20];\r\n                        case 19:\r\n                            if (paint.listValue && container.styles.listStyleType !== LIST_STYLE_TYPE.NONE) {\r\n                                this.ctx.font = this.createFontStyle(styles)[0];\r\n                                this.ctx.fillStyle = asString(styles.color);\r\n                                this.ctx.textBaseline = 'middle';\r\n                                this.ctx.textAlign = 'right';\r\n                                bounds = new Bounds(container.bounds.left, container.bounds.top + getAbsoluteValue(container.styles.paddingTop, container.bounds.width), container.bounds.width, computeLineHeight(styles.lineHeight, styles.fontSize.number) / 2 + 1);\r\n                                this.renderTextWithLetterSpacing(new TextBounds(paint.listValue, bounds), styles.letterSpacing);\r\n                                this.ctx.textBaseline = 'bottom';\r\n                                this.ctx.textAlign = 'left';\r\n                            }\r\n                            _b.label = 20;\r\n                        case 20: return [2 /*return*/];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        CanvasRenderer.prototype.renderStackContent = function (stack) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var _i, _a, child, _b, _c, child, _d, _e, child, _f, _g, child, _h, _j, child, _k, _l, child, _m, _o, child;\r\n                return __generator(this, function (_p) {\r\n                    switch (_p.label) {\r\n                        case 0: \r\n                        // https://www.w3.org/TR/css-position-3/#painting-order\r\n                        // 1. the background and borders of the element forming the stacking context.\r\n                        return [4 /*yield*/, this.renderNodeBackgroundAndBorders(stack.element)];\r\n                        case 1:\r\n                            // https://www.w3.org/TR/css-position-3/#painting-order\r\n                            // 1. the background and borders of the element forming the stacking context.\r\n                            _p.sent();\r\n                            _i = 0, _a = stack.negativeZIndex;\r\n                            _p.label = 2;\r\n                        case 2:\r\n                            if (!(_i < _a.length)) return [3 /*break*/, 5];\r\n                            child = _a[_i];\r\n                            return [4 /*yield*/, this.renderStack(child)];\r\n                        case 3:\r\n                            _p.sent();\r\n                            _p.label = 4;\r\n                        case 4:\r\n                            _i++;\r\n                            return [3 /*break*/, 2];\r\n                        case 5: \r\n                        // 3. For all its in-flow, non-positioned, block-level descendants in tree order:\r\n                        return [4 /*yield*/, this.renderNodeContent(stack.element)];\r\n                        case 6:\r\n                            // 3. For all its in-flow, non-positioned, block-level descendants in tree order:\r\n                            _p.sent();\r\n                            _b = 0, _c = stack.nonInlineLevel;\r\n                            _p.label = 7;\r\n                        case 7:\r\n                            if (!(_b < _c.length)) return [3 /*break*/, 10];\r\n                            child = _c[_b];\r\n                            return [4 /*yield*/, this.renderNode(child)];\r\n                        case 8:\r\n                            _p.sent();\r\n                            _p.label = 9;\r\n                        case 9:\r\n                            _b++;\r\n                            return [3 /*break*/, 7];\r\n                        case 10:\r\n                            _d = 0, _e = stack.nonPositionedFloats;\r\n                            _p.label = 11;\r\n                        case 11:\r\n                            if (!(_d < _e.length)) return [3 /*break*/, 14];\r\n                            child = _e[_d];\r\n                            return [4 /*yield*/, this.renderStack(child)];\r\n                        case 12:\r\n                            _p.sent();\r\n                            _p.label = 13;\r\n                        case 13:\r\n                            _d++;\r\n                            return [3 /*break*/, 11];\r\n                        case 14:\r\n                            _f = 0, _g = stack.nonPositionedInlineLevel;\r\n                            _p.label = 15;\r\n                        case 15:\r\n                            if (!(_f < _g.length)) return [3 /*break*/, 18];\r\n                            child = _g[_f];\r\n                            return [4 /*yield*/, this.renderStack(child)];\r\n                        case 16:\r\n                            _p.sent();\r\n                            _p.label = 17;\r\n                        case 17:\r\n                            _f++;\r\n                            return [3 /*break*/, 15];\r\n                        case 18:\r\n                            _h = 0, _j = stack.inlineLevel;\r\n                            _p.label = 19;\r\n                        case 19:\r\n                            if (!(_h < _j.length)) return [3 /*break*/, 22];\r\n                            child = _j[_h];\r\n                            return [4 /*yield*/, this.renderNode(child)];\r\n                        case 20:\r\n                            _p.sent();\r\n                            _p.label = 21;\r\n                        case 21:\r\n                            _h++;\r\n                            return [3 /*break*/, 19];\r\n                        case 22:\r\n                            _k = 0, _l = stack.zeroOrAutoZIndexOrTransformedOrOpacity;\r\n                            _p.label = 23;\r\n                        case 23:\r\n                            if (!(_k < _l.length)) return [3 /*break*/, 26];\r\n                            child = _l[_k];\r\n                            return [4 /*yield*/, this.renderStack(child)];\r\n                        case 24:\r\n                            _p.sent();\r\n                            _p.label = 25;\r\n                        case 25:\r\n                            _k++;\r\n                            return [3 /*break*/, 23];\r\n                        case 26:\r\n                            _m = 0, _o = stack.positiveZIndex;\r\n                            _p.label = 27;\r\n                        case 27:\r\n                            if (!(_m < _o.length)) return [3 /*break*/, 30];\r\n                            child = _o[_m];\r\n                            return [4 /*yield*/, this.renderStack(child)];\r\n                        case 28:\r\n                            _p.sent();\r\n                            _p.label = 29;\r\n                        case 29:\r\n                            _m++;\r\n                            return [3 /*break*/, 27];\r\n                        case 30: return [2 /*return*/];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        CanvasRenderer.prototype.mask = function (paths) {\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(0, 0);\r\n            this.ctx.lineTo(this.canvas.width, 0);\r\n            this.ctx.lineTo(this.canvas.width, this.canvas.height);\r\n            this.ctx.lineTo(0, this.canvas.height);\r\n            this.ctx.lineTo(0, 0);\r\n            this.formatPath(paths.slice(0).reverse());\r\n            this.ctx.closePath();\r\n        };\r\n        CanvasRenderer.prototype.path = function (paths) {\r\n            this.ctx.beginPath();\r\n            this.formatPath(paths);\r\n            this.ctx.closePath();\r\n        };\r\n        CanvasRenderer.prototype.formatPath = function (paths) {\r\n            var _this = this;\r\n            paths.forEach(function (point, index) {\r\n                var start = isBezierCurve(point) ? point.start : point;\r\n                if (index === 0) {\r\n                    _this.ctx.moveTo(start.x, start.y);\r\n                }\r\n                else {\r\n                    _this.ctx.lineTo(start.x, start.y);\r\n                }\r\n                if (isBezierCurve(point)) {\r\n                    _this.ctx.bezierCurveTo(point.startControl.x, point.startControl.y, point.endControl.x, point.endControl.y, point.end.x, point.end.y);\r\n                }\r\n            });\r\n        };\r\n        CanvasRenderer.prototype.renderRepeat = function (path, pattern, offsetX, offsetY) {\r\n            this.path(path);\r\n            this.ctx.fillStyle = pattern;\r\n            this.ctx.translate(offsetX, offsetY);\r\n            this.ctx.fill();\r\n            this.ctx.translate(-offsetX, -offsetY);\r\n        };\r\n        CanvasRenderer.prototype.resizeImage = function (image, width, height) {\r\n            if (image.width === width && image.height === height) {\r\n                return image;\r\n            }\r\n            var canvas = this.canvas.ownerDocument.createElement('canvas');\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n            var ctx = canvas.getContext('2d');\r\n            ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, width, height);\r\n            return canvas;\r\n        };\r\n        CanvasRenderer.prototype.renderBackgroundImage = function (container) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var index, _loop_1, this_1, _i, _a, backgroundImage;\r\n                return __generator(this, function (_b) {\r\n                    switch (_b.label) {\r\n                        case 0:\r\n                            index = container.styles.backgroundImage.length - 1;\r\n                            _loop_1 = function (backgroundImage) {\r\n                                var image, url, e_4, _a, path, x, y, width, height, pattern, _b, path, x, y, width, height, _c, lineLength, x0, x1, y0, y1, canvas, ctx, gradient_1, pattern, _d, path, left, top_1, width, height, position, x, y, _e, rx, ry, radialGradient_1, midX, midY, f, invF;\r\n                                return __generator(this, function (_f) {\r\n                                    switch (_f.label) {\r\n                                        case 0:\r\n                                            if (!(backgroundImage.type === CSSImageType.URL)) return [3 /*break*/, 5];\r\n                                            image = void 0;\r\n                                            url = backgroundImage.url;\r\n                                            _f.label = 1;\r\n                                        case 1:\r\n                                            _f.trys.push([1, 3, , 4]);\r\n                                            return [4 /*yield*/, this_1.options.cache.match(url)];\r\n                                        case 2:\r\n                                            image = _f.sent();\r\n                                            return [3 /*break*/, 4];\r\n                                        case 3:\r\n                                            e_4 = _f.sent();\r\n                                            Logger.getInstance(this_1.options.id).error(\"Error loading background-image \" + url);\r\n                                            return [3 /*break*/, 4];\r\n                                        case 4:\r\n                                            if (image) {\r\n                                                _a = calculateBackgroundRendering(container, index, [\r\n                                                    image.width,\r\n                                                    image.height,\r\n                                                    image.width / image.height\r\n                                                ]), path = _a[0], x = _a[1], y = _a[2], width = _a[3], height = _a[4];\r\n                                                pattern = this_1.ctx.createPattern(this_1.resizeImage(image, width, height), 'repeat');\r\n                                                this_1.renderRepeat(path, pattern, x, y);\r\n                                            }\r\n                                            return [3 /*break*/, 6];\r\n                                        case 5:\r\n                                            if (isLinearGradient(backgroundImage)) {\r\n                                                _b = calculateBackgroundRendering(container, index, [null, null, null]), path = _b[0], x = _b[1], y = _b[2], width = _b[3], height = _b[4];\r\n                                                _c = calculateGradientDirection(backgroundImage.angle, width, height), lineLength = _c[0], x0 = _c[1], x1 = _c[2], y0 = _c[3], y1 = _c[4];\r\n                                                canvas = document.createElement('canvas');\r\n                                                canvas.width = width;\r\n                                                canvas.height = height;\r\n                                                ctx = canvas.getContext('2d');\r\n                                                gradient_1 = ctx.createLinearGradient(x0, y0, x1, y1);\r\n                                                processColorStops(backgroundImage.stops, lineLength).forEach(function (colorStop) {\r\n                                                    return gradient_1.addColorStop(colorStop.stop, asString(colorStop.color));\r\n                                                });\r\n                                                ctx.fillStyle = gradient_1;\r\n                                                ctx.fillRect(0, 0, width, height);\r\n                                                if (width > 0 && height > 0) {\r\n                                                    pattern = this_1.ctx.createPattern(canvas, 'repeat');\r\n                                                    this_1.renderRepeat(path, pattern, x, y);\r\n                                                }\r\n                                            }\r\n                                            else if (isRadialGradient(backgroundImage)) {\r\n                                                _d = calculateBackgroundRendering(container, index, [\r\n                                                    null,\r\n                                                    null,\r\n                                                    null\r\n                                                ]), path = _d[0], left = _d[1], top_1 = _d[2], width = _d[3], height = _d[4];\r\n                                                position = backgroundImage.position.length === 0 ? [FIFTY_PERCENT] : backgroundImage.position;\r\n                                                x = getAbsoluteValue(position[0], width);\r\n                                                y = getAbsoluteValue(position[position.length - 1], height);\r\n                                                _e = calculateRadius(backgroundImage, x, y, width, height), rx = _e[0], ry = _e[1];\r\n                                                if (rx > 0 && rx > 0) {\r\n                                                    radialGradient_1 = this_1.ctx.createRadialGradient(left + x, top_1 + y, 0, left + x, top_1 + y, rx);\r\n                                                    processColorStops(backgroundImage.stops, rx * 2).forEach(function (colorStop) {\r\n                                                        return radialGradient_1.addColorStop(colorStop.stop, asString(colorStop.color));\r\n                                                    });\r\n                                                    this_1.path(path);\r\n                                                    this_1.ctx.fillStyle = radialGradient_1;\r\n                                                    if (rx !== ry) {\r\n                                                        midX = container.bounds.left + 0.5 * container.bounds.width;\r\n                                                        midY = container.bounds.top + 0.5 * container.bounds.height;\r\n                                                        f = ry / rx;\r\n                                                        invF = 1 / f;\r\n                                                        this_1.ctx.save();\r\n                                                        this_1.ctx.translate(midX, midY);\r\n                                                        this_1.ctx.transform(1, 0, 0, f, 0, 0);\r\n                                                        this_1.ctx.translate(-midX, -midY);\r\n                                                        this_1.ctx.fillRect(left, invF * (top_1 - midY) + midY, width, height * invF);\r\n                                                        this_1.ctx.restore();\r\n                                                    }\r\n                                                    else {\r\n                                                        this_1.ctx.fill();\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                            _f.label = 6;\r\n                                        case 6:\r\n                                            index--;\r\n                                            return [2 /*return*/];\r\n                                    }\r\n                                });\r\n                            };\r\n                            this_1 = this;\r\n                            _i = 0, _a = container.styles.backgroundImage.slice(0).reverse();\r\n                            _b.label = 1;\r\n                        case 1:\r\n                            if (!(_i < _a.length)) return [3 /*break*/, 4];\r\n                            backgroundImage = _a[_i];\r\n                            return [5 /*yield**/, _loop_1(backgroundImage)];\r\n                        case 2:\r\n                            _b.sent();\r\n                            _b.label = 3;\r\n                        case 3:\r\n                            _i++;\r\n                            return [3 /*break*/, 1];\r\n                        case 4: return [2 /*return*/];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        CanvasRenderer.prototype.renderBorder = function (color, side, curvePoints) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                return __generator(this, function (_a) {\r\n                    this.path(parsePathForBorder(curvePoints, side));\r\n                    this.ctx.fillStyle = asString(color);\r\n                    this.ctx.fill();\r\n                    return [2 /*return*/];\r\n                });\r\n            });\r\n        };\r\n        CanvasRenderer.prototype.renderNodeBackgroundAndBorders = function (paint) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var styles, hasBackground, borders, backgroundPaintingArea, side, _i, borders_1, border;\r\n                var _this = this;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            this.applyEffects(paint.effects, 2 /* BACKGROUND_BORDERS */);\r\n                            styles = paint.container.styles;\r\n                            hasBackground = !isTransparent(styles.backgroundColor) || styles.backgroundImage.length;\r\n                            borders = [\r\n                                { style: styles.borderTopStyle, color: styles.borderTopColor },\r\n                                { style: styles.borderRightStyle, color: styles.borderRightColor },\r\n                                { style: styles.borderBottomStyle, color: styles.borderBottomColor },\r\n                                { style: styles.borderLeftStyle, color: styles.borderLeftColor }\r\n                            ];\r\n                            backgroundPaintingArea = calculateBackgroundCurvedPaintingArea(getBackgroundValueForIndex(styles.backgroundClip, 0), paint.curves);\r\n                            if (!(hasBackground || styles.boxShadow.length)) return [3 /*break*/, 2];\r\n                            this.ctx.save();\r\n                            this.path(backgroundPaintingArea);\r\n                            this.ctx.clip();\r\n                            if (!isTransparent(styles.backgroundColor)) {\r\n                                this.ctx.fillStyle = asString(styles.backgroundColor);\r\n                                this.ctx.fill();\r\n                            }\r\n                            return [4 /*yield*/, this.renderBackgroundImage(paint.container)];\r\n                        case 1:\r\n                            _a.sent();\r\n                            this.ctx.restore();\r\n                            styles.boxShadow\r\n                                .slice(0)\r\n                                .reverse()\r\n                                .forEach(function (shadow) {\r\n                                _this.ctx.save();\r\n                                var borderBoxArea = calculateBorderBoxPath(paint.curves);\r\n                                var maskOffset = shadow.inset ? 0 : MASK_OFFSET;\r\n                                var shadowPaintingArea = transformPath(borderBoxArea, -maskOffset + (shadow.inset ? 1 : -1) * shadow.spread.number, (shadow.inset ? 1 : -1) * shadow.spread.number, shadow.spread.number * (shadow.inset ? -2 : 2), shadow.spread.number * (shadow.inset ? -2 : 2));\r\n                                if (shadow.inset) {\r\n                                    _this.path(borderBoxArea);\r\n                                    _this.ctx.clip();\r\n                                    _this.mask(shadowPaintingArea);\r\n                                }\r\n                                else {\r\n                                    _this.mask(borderBoxArea);\r\n                                    _this.ctx.clip();\r\n                                    _this.path(shadowPaintingArea);\r\n                                }\r\n                                _this.ctx.shadowOffsetX = shadow.offsetX.number + maskOffset;\r\n                                _this.ctx.shadowOffsetY = shadow.offsetY.number;\r\n                                _this.ctx.shadowColor = asString(shadow.color);\r\n                                _this.ctx.shadowBlur = shadow.blur.number;\r\n                                _this.ctx.fillStyle = shadow.inset ? asString(shadow.color) : 'rgba(0,0,0,1)';\r\n                                _this.ctx.fill();\r\n                                _this.ctx.restore();\r\n                            });\r\n                            _a.label = 2;\r\n                        case 2:\r\n                            side = 0;\r\n                            _i = 0, borders_1 = borders;\r\n                            _a.label = 3;\r\n                        case 3:\r\n                            if (!(_i < borders_1.length)) return [3 /*break*/, 7];\r\n                            border = borders_1[_i];\r\n                            if (!(border.style !== BORDER_STYLE.NONE && !isTransparent(border.color))) return [3 /*break*/, 5];\r\n                            return [4 /*yield*/, this.renderBorder(border.color, side, paint.curves)];\r\n                        case 4:\r\n                            _a.sent();\r\n                            _a.label = 5;\r\n                        case 5:\r\n                            side++;\r\n                            _a.label = 6;\r\n                        case 6:\r\n                            _i++;\r\n                            return [3 /*break*/, 3];\r\n                        case 7: return [2 /*return*/];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        CanvasRenderer.prototype.render = function (element) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var stack;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            if (this.options.backgroundColor) {\r\n                                this.ctx.fillStyle = asString(this.options.backgroundColor);\r\n                                this.ctx.fillRect(this.options.x - this.options.scrollX, this.options.y - this.options.scrollY, this.options.width, this.options.height);\r\n                            }\r\n                            stack = parseStackingContexts(element);\r\n                            return [4 /*yield*/, this.renderStack(stack)];\r\n                        case 1:\r\n                            _a.sent();\r\n                            this.applyEffects([], 2 /* BACKGROUND_BORDERS */);\r\n                            return [2 /*return*/, this.canvas];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        return CanvasRenderer;\r\n    }());\r\n    var isTextInputElement = function (container) {\r\n        if (container instanceof TextareaElementContainer) {\r\n            return true;\r\n        }\r\n        else if (container instanceof SelectElementContainer) {\r\n            return true;\r\n        }\r\n        else if (container instanceof InputElementContainer && container.type !== RADIO && container.type !== CHECKBOX) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    var calculateBackgroundCurvedPaintingArea = function (clip, curves) {\r\n        switch (clip) {\r\n            case BACKGROUND_CLIP.BORDER_BOX:\r\n                return calculateBorderBoxPath(curves);\r\n            case BACKGROUND_CLIP.CONTENT_BOX:\r\n                return calculateContentBoxPath(curves);\r\n            case BACKGROUND_CLIP.PADDING_BOX:\r\n            default:\r\n                return calculatePaddingBoxPath(curves);\r\n        }\r\n    };\r\n    var canvasTextAlign = function (textAlign) {\r\n        switch (textAlign) {\r\n            case TEXT_ALIGN.CENTER:\r\n                return 'center';\r\n            case TEXT_ALIGN.RIGHT:\r\n                return 'right';\r\n            case TEXT_ALIGN.LEFT:\r\n            default:\r\n                return 'left';\r\n        }\r\n    };\r\n\r\n    var ForeignObjectRenderer = /** @class */ (function () {\r\n        function ForeignObjectRenderer(options) {\r\n            this.canvas = options.canvas ? options.canvas : document.createElement('canvas');\r\n            this.ctx = this.canvas.getContext('2d');\r\n            this.options = options;\r\n            this.canvas.width = Math.floor(options.width * options.scale);\r\n            this.canvas.height = Math.floor(options.height * options.scale);\r\n            this.canvas.style.width = options.width + \"px\";\r\n            this.canvas.style.height = options.height + \"px\";\r\n            this.ctx.scale(this.options.scale, this.options.scale);\r\n            this.ctx.translate(-options.x + options.scrollX, -options.y + options.scrollY);\r\n            Logger.getInstance(options.id).debug(\"EXPERIMENTAL ForeignObject renderer initialized (\" + options.width + \"x\" + options.height + \" at \" + options.x + \",\" + options.y + \") with scale \" + options.scale);\r\n        }\r\n        ForeignObjectRenderer.prototype.render = function (element) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var svg, img;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            svg = createForeignObjectSVG(Math.max(this.options.windowWidth, this.options.width) * this.options.scale, Math.max(this.options.windowHeight, this.options.height) * this.options.scale, this.options.scrollX * this.options.scale, this.options.scrollY * this.options.scale, element);\r\n                            return [4 /*yield*/, loadSerializedSVG$1(svg)];\r\n                        case 1:\r\n                            img = _a.sent();\r\n                            if (this.options.backgroundColor) {\r\n                                this.ctx.fillStyle = asString(this.options.backgroundColor);\r\n                                this.ctx.fillRect(0, 0, this.options.width * this.options.scale, this.options.height * this.options.scale);\r\n                            }\r\n                            this.ctx.drawImage(img, -this.options.x * this.options.scale, -this.options.y * this.options.scale);\r\n                            return [2 /*return*/, this.canvas];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        return ForeignObjectRenderer;\r\n    }());\r\n    var loadSerializedSVG$1 = function (svg) {\r\n        return new Promise(function (resolve, reject) {\r\n            var img = new Image();\r\n            img.onload = function () {\r\n                resolve(img);\r\n            };\r\n            img.onerror = reject;\r\n            img.src = \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(new XMLSerializer().serializeToString(svg));\r\n        });\r\n    };\r\n\r\n    var _this = undefined;\r\n    var parseColor$1 = function (value) { return color.parse(Parser.create(value).parseComponentValue()); };\r\n    var html2canvas = function (element, options) {\r\n        if (options === void 0) { options = {}; }\r\n        return renderElement(element, options);\r\n    };\r\n    if (typeof window !== 'undefined') {\r\n        CacheStorage.setContext(window);\r\n    }\r\n    var renderElement = function (element, opts) { return __awaiter(_this, void 0, void 0, function () {\r\n        var ownerDocument, defaultView, instanceName, _a, width, height, left, top, defaultResourceOptions, resourceOptions, defaultOptions, options, windowBounds, documentCloner, clonedElement, container, documentBackgroundColor, bodyBackgroundColor, bgColor, defaultBackgroundColor, backgroundColor, renderOptions, canvas, renderer, root, renderer;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    ownerDocument = element.ownerDocument;\r\n                    if (!ownerDocument) {\r\n                        throw new Error(\"Element is not attached to a Document\");\r\n                    }\r\n                    defaultView = ownerDocument.defaultView;\r\n                    if (!defaultView) {\r\n                        throw new Error(\"Document is not attached to a Window\");\r\n                    }\r\n                    instanceName = (Math.round(Math.random() * 1000) + Date.now()).toString(16);\r\n                    _a = isBodyElement(element) || isHTMLElement(element) ? parseDocumentSize(ownerDocument) : parseBounds(element), width = _a.width, height = _a.height, left = _a.left, top = _a.top;\r\n                    defaultResourceOptions = {\r\n                        allowTaint: false,\r\n                        imageTimeout: 15000,\r\n                        proxy: undefined,\r\n                        useCORS: false\r\n                    };\r\n                    resourceOptions = __assign({}, defaultResourceOptions, opts);\r\n                    defaultOptions = {\r\n                        backgroundColor: '#ffffff',\r\n                        cache: opts.cache ? opts.cache : CacheStorage.create(instanceName, resourceOptions),\r\n                        logging: true,\r\n                        removeContainer: true,\r\n                        foreignObjectRendering: false,\r\n                        scale: defaultView.devicePixelRatio || 1,\r\n                        windowWidth: defaultView.innerWidth,\r\n                        windowHeight: defaultView.innerHeight,\r\n                        scrollX: defaultView.pageXOffset,\r\n                        scrollY: defaultView.pageYOffset,\r\n                        x: left,\r\n                        y: top,\r\n                        width: Math.ceil(width),\r\n                        height: Math.ceil(height),\r\n                        id: instanceName\r\n                    };\r\n                    options = __assign({}, defaultOptions, resourceOptions, opts);\r\n                    windowBounds = new Bounds(options.scrollX, options.scrollY, options.windowWidth, options.windowHeight);\r\n                    Logger.create({ id: instanceName, enabled: options.logging });\r\n                    Logger.getInstance(instanceName).debug(\"Starting document clone\");\r\n                    documentCloner = new DocumentCloner(element, {\r\n                        id: instanceName,\r\n                        onclone: options.onclone,\r\n                        ignoreElements: options.ignoreElements,\r\n                        inlineImages: options.foreignObjectRendering,\r\n                        copyStyles: options.foreignObjectRendering\r\n                    });\r\n                    clonedElement = documentCloner.clonedReferenceElement;\r\n                    if (!clonedElement) {\r\n                        return [2 /*return*/, Promise.reject(\"Unable to find element in cloned iframe\")];\r\n                    }\r\n                    return [4 /*yield*/, documentCloner.toIFrame(ownerDocument, windowBounds)];\r\n                case 1:\r\n                    container = _b.sent();\r\n                    documentBackgroundColor = ownerDocument.documentElement\r\n                        ? parseColor$1(getComputedStyle(ownerDocument.documentElement).backgroundColor)\r\n                        : COLORS.TRANSPARENT;\r\n                    bodyBackgroundColor = ownerDocument.body\r\n                        ? parseColor$1(getComputedStyle(ownerDocument.body).backgroundColor)\r\n                        : COLORS.TRANSPARENT;\r\n                    bgColor = opts.backgroundColor;\r\n                    defaultBackgroundColor = typeof bgColor === 'string' ? parseColor$1(bgColor) : bgColor === null ? COLORS.TRANSPARENT : 0xffffffff;\r\n                    backgroundColor = element === ownerDocument.documentElement\r\n                        ? isTransparent(documentBackgroundColor)\r\n                            ? isTransparent(bodyBackgroundColor)\r\n                                ? defaultBackgroundColor\r\n                                : bodyBackgroundColor\r\n                            : documentBackgroundColor\r\n                        : defaultBackgroundColor;\r\n                    renderOptions = {\r\n                        id: instanceName,\r\n                        cache: options.cache,\r\n                        canvas: options.canvas,\r\n                        backgroundColor: backgroundColor,\r\n                        scale: options.scale,\r\n                        x: options.x,\r\n                        y: options.y,\r\n                        scrollX: options.scrollX,\r\n                        scrollY: options.scrollY,\r\n                        width: options.width,\r\n                        height: options.height,\r\n                        windowWidth: options.windowWidth,\r\n                        windowHeight: options.windowHeight\r\n                    };\r\n                    if (!options.foreignObjectRendering) return [3 /*break*/, 3];\r\n                    Logger.getInstance(instanceName).debug(\"Document cloned, using foreign object rendering\");\r\n                    renderer = new ForeignObjectRenderer(renderOptions);\r\n                    return [4 /*yield*/, renderer.render(clonedElement)];\r\n                case 2:\r\n                    canvas = _b.sent();\r\n                    return [3 /*break*/, 5];\r\n                case 3:\r\n                    Logger.getInstance(instanceName).debug(\"Document cloned, using computed rendering\");\r\n                    CacheStorage.attachInstance(options.cache);\r\n                    Logger.getInstance(instanceName).debug(\"Starting DOM parsing\");\r\n                    root = parseTree(clonedElement);\r\n                    CacheStorage.detachInstance();\r\n                    if (backgroundColor === root.styles.backgroundColor) {\r\n                        root.styles.backgroundColor = COLORS.TRANSPARENT;\r\n                    }\r\n                    Logger.getInstance(instanceName).debug(\"Starting renderer\");\r\n                    renderer = new CanvasRenderer(renderOptions);\r\n                    return [4 /*yield*/, renderer.render(root)];\r\n                case 4:\r\n                    canvas = _b.sent();\r\n                    _b.label = 5;\r\n                case 5:\r\n                    if (options.removeContainer === true) {\r\n                        if (!DocumentCloner.destroy(container)) {\r\n                            Logger.getInstance(instanceName).error(\"Cannot detach cloned iframe as it is not in the DOM anymore\");\r\n                        }\r\n                    }\r\n                    Logger.getInstance(instanceName).debug(\"Finished rendering\");\r\n                    Logger.destroy(instanceName);\r\n                    CacheStorage.destroy(instanceName);\r\n                    return [2 /*return*/, canvas];\r\n            }\r\n        });\r\n    }); };\r\n\r\n    return html2canvas;\r\n\r\n}));\r\n//# sourceMappingURL=html2canvas.js.map\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"base_container__aJMkP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"mac_container__1ZlQm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"win_container__2RxW-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"base_container__rlYxm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"mac_container__3ZbeA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"win_container__3b565\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"mac_container__sEnQB\",\"borderWeak\":\"mac_borderWeak__3V1vq\",\"borderStrong\":\"mac_borderStrong__1lkpO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"win_container__31d5l\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"canvas_container__KH5yw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"active_container__3joLV\",\"react-draggable-dragging\":\"active_react-draggable-dragging__1JdPr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"add_container__2lSlZ\",\"slide-in\":\"add_slide-in__2Hk9K\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"boolean_container__1bqLB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"remove_container__Ts2Bx\",\"slide-in\":\"remove_slide-in__3caLT\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"menu_container__3TSuN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"blank_container__3L-Iq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"resizer_container__EbBWw\"};","module.exports = \"data:image/png;base64,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\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"privacy_container__1BD1S\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"row_container__2yTZp\",\"over\":\"row_over__2gC30\",\"field\":\"row_field__2hv8_\",\"field1st\":\"row_field1st__2SQMa\",\"field2nd\":\"row_field2nd__1IGMO\",\"fields\":\"row_fields__aeh9B\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"edge_container__1EyW3\",\"from\":\"edge_from__1Ovs9\",\"to\":\"edge_to__3E3uJ\",\"path\":\"edge_path__x4S4v\",\"dot\":\"edge_dot__2KuhC\",\"selected\":\"edge_selected__1Gpep\",\"hitarea\":\"edge_hitarea__3Airq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"resize-div_container__3-RmC\",\"line\":\"resize-div_line__4CgvK\",\"noDrag\":\"resize-div_noDrag__dEsRZ\",\"drag\":\"resize-div_drag__1ELh9\",\"disable\":\"resize-div_disable__1aSit\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"view_container__2oDm-\",\"header\":\"view_header__3f7ol\",\"body\":\"view_body__1Z1mW\",\"library\":\"view_library__o-Um8\",\"canvas\":\"view_canvas__1gDV-\"};","import { background, borderColor } from \"@moai/core\";\nimport * as React from \"react\";\nimport s from \"./arrow.module.scss\";\n\ninterface Props {\n\tstyle: React.CSSProperties;\n\tsetArrow: React.Dispatch<React.SetStateAction<HTMLElement | null>>;\n\tattributes: { [key: string]: string };\n}\n\nexport const CreateEdgeArrow = (props: Props) => (\n\t<div\n\t\tstyle={props.style}\n\t\tclassName={s.container}\n\t\tref={props.setArrow}\n\t\t{...props.attributes}\n\t>\n\t\t<div\n\t\t\tclassName={[\n\t\t\t\ts.shape,\n\t\t\t\tborderColor.strong,\n\t\t\t\tbackground.primary,\n\t\t\t].join(\" \")}\n\t\t/>\n\t</div>\n);\n","import { Background, Button, DivGrow, MutedDiv } from \"@moai/core\";\nimport * as React from \"react\";\nimport s from \"./footer.module.css\";\n\nexport const CreateEdgeFooter = () => (\n    <Background color=\"secondary\">\n        <div className={s.container}>\n            <MutedDiv>\n                <div className={s.help}>\n                    You can also drag the green<br />\n                    circle to create reference\n                </div>\n            </MutedDiv>\n            <DivGrow />\n            <Button\n                type=\"submit\"\n                size={Button.size.medium}\n                highlight\n                style={Button.style.outset}\n                children=\"Create\"\n            />\n        </div>\n    </Background>\n);\n","import { background, Strong } from \"@moai/core\";\nimport * as React from \"react\";\nimport s from \"./header.module.css\";\n\nexport const CreateEdgeHeader = () => (\n    <div className={[s.container, background.secondary].join(\" \")}>\n        <Strong>Create reference</Strong>\n    </div>\n);\n","import { Border, Button, DivPx, Input } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { EditTable } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\nimport s from \"./rows.module.css\";\n\ninterface Props {\n    idKey: string;\n    table: EditTable | null;\n    rows: string[];\n    setRows: React.Dispatch<React.SetStateAction<string[]>>;\n}\n\ntype Reducer = (rows: string[]) => string[];\n\nconst addRow = (): Reducer => {\n    return (rows) => rows.concat(\"\");\n};\n\nconst removeRow = (index: number): Reducer => {\n    return (rows) => rows.filter((_r, i) => i !== index);\n};\n\nconst setRow = (index: number, row: string): Reducer => {\n    return (rows) => rows.map((r, i) => (i === index ? row : r));\n};\n\nconst getList = (props: Props): string[] => {\n    if (props.table === null) return [];\n    return props.table.value.rows\n        .map((row) => row.value[props.idKey] as string)\n        .filter((row) => !props.rows.includes(row));\n};\n\nconst dispatchRemove = (props: Props, index: number) => {\n    return (event: React.MouseEvent) => {\n        props.setRows(removeRow(index));\n        event.stopPropagation();\n        // Because \"click outside to close popup\" is handled outside of React's\n        // event system. See https://stackoverflow.com/q/24415631/6621213\n        event.nativeEvent.stopImmediatePropagation();\n    };\n};\n\nexport const CreateEdgeRows = (props: Props) => (\n    <div>\n        {props.rows.map((row, index) => (\n            <div className={s.row} key={index}>\n                <div className={s.input}>\n                    <Input\n                        value={row}\n                        setValue={(value) => {\n                            props.setRows(setRow(index, value));\n                        }}\n                        // @TODO(https://github.com/dvkndn/moai/issues/9)\n                        // Use same list for all inputs\n                        list={{\n                            id: `${props.table?.id}-rows-${index}`,\n                            values: getList(props),\n                        }}\n                        size={Input.size.small}\n                        style={Input.style.flat}\n                        placeholder=\"Column\"\n                    />\n                </div>\n                <DivPx size={8} />\n                <Border color=\"weak\" />\n                <DivPx size={8} />\n                {index === 0 ? (\n                    <Button\n                        onClick={() => void props.setRows(addRow())}\n                        icon={icons.plus}\n                        style={Button.style.flat}\n                        size={Button.size.small}\n                        title=\"Add column (Composite foreign key)\"\n                    />\n                ) : (\n                    <Button\n                        onClick={dispatchRemove(props, index)}\n                        icon={icons.cross}\n                        style={Button.style.flat}\n                        size={Button.size.small}\n                        title=\"Remove column from reference\"\n                    />\n                )}\n            </div>\n        ))}\n    </div>\n);\n","import { Border, DivPx, Input, MutedSpan } from \"@moai/core\";\nimport { EditTable } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\nimport { CreateEdgeRows } from \"../rows/rows\";\nimport s from \"./side.module.css\";\n\ninterface Props {\n    label: string;\n    idKey: string;\n    tables: EditTable[];\n    table: string;\n    setTable: React.Dispatch<React.SetStateAction<string>>;\n    rows: string[];\n    setRows: React.Dispatch<React.SetStateAction<string[]>>;\n    autoFocus: boolean;\n}\n\nconst getList = (props: Props): string[] => {\n    return props.tables.map((table) => table.value.name);\n};\n\nconst getTable = (props: Props): EditTable | null => {\n    const byName = (table: EditTable) => {\n        return table.value.name === props.table;\n    };\n    return props.tables.find(byName) ?? null;\n};\n\nexport const CreateEdgeSide = (props: Props) => (\n    <div className={s.container}>\n        <div className={s.label}>\n            <MutedSpan>{props.label}</MutedSpan>\n        </div>\n        <DivPx size={8} />\n        <div className={s.table}>\n            <Input\n                value={props.table}\n                setValue={props.setTable}\n                autoFocus={props.autoFocus}\n                size={Input.size.small}\n                style={Input.style.flat}\n                placeholder=\"Table\"\n                list={{\n                    id: `${props.label}-table`,\n                    values: getList(props),\n                }}\n            />\n        </div>\n        <DivPx size={8} />\n        <Border color=\"weak\" />\n        <DivPx size={8} />\n        <CreateEdgeRows\n            idKey={props.idKey}\n            table={getTable(props)}\n            rows={props.rows}\n            setRows={props.setRows}\n        />\n    </div>\n);\n","import { background, Border, borderColor, boxShadow } from \"@moai/core\";\nimport { EditRow, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { AddRefPayload, AddRefSide } from \"diagram/reducer/ref/add\";\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { showAlert } from \"@moai/core\";\nimport { CreateEdgeArrow } from \"./arrow/arrow\";\nimport sArrow from \"./arrow/arrow.module.scss\";\nimport s from \"./create.module.css\";\nimport { CreateEdgeFooter } from \"./footer/footer\";\nimport { CreateEdgeHeader } from \"./header/header\";\nimport { CreateEdgeSide } from \"./side/side\";\nimport { CreateEdgeProps } from \"./state\";\n\ninterface Props extends CreateEdgeProps {\n    idKey: string; // row[idKey]\n    tables: EditTable[];\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nconst getTable = (props: Props): EditTable => {\n    const id = props.fromTable;\n    const table = props.tables.find((t) => t.id === id);\n    if (table === undefined) throw Error(`Table \"${id}\" not found`);\n    return table;\n};\n\nconst getInitialFromTable = (props: Props): string => {\n    const table = getTable(props);\n    return table?.value.name ?? \"\";\n};\n\nconst getInitialFromRows = (props: Props): string[] => {\n    const ids = props.fromRows;\n    const table = getTable(props);\n    const rows: EditRow[] = ids.map((id) => {\n        const row = table.value.rows.find((row) => row.id === id);\n        if (row !== undefined) return row;\n        throw Error(`Row \"${id}\" not found`);\n    });\n    return rows.map((row) => row.value[props.idKey] as string);\n};\n\nconst getEdgeSide = (\n    props: Props,\n    tableName: string,\n    rowsIds: string[]\n): AddRefSide => {\n    const table = props.tables.find((table) => table.value.name === tableName);\n    if (table === undefined) throw Error(`Table \"${tableName}\" is undefined`);\n    const rows: number[] = rowsIds.map((id) => {\n        const row = table.value.rows.find((row) => {\n            return row.value[props.idKey] === id;\n        });\n        if (row !== undefined) return row.id;\n        throw Error(`Row \"${id}\" not found`);\n    });\n    return { table: table.id, rows };\n};\n\nconst submit = (\n    props: Props,\n    from: [string, string[]],\n    to: [string, string[]]\n): void => {\n    try {\n        const payload: AddRefPayload = {\n            from: getEdgeSide(props, from[0], from[1]),\n            to: getEdgeSide(props, to[0], to[1]),\n        };\n        props.diagramDispatch({ type: \"add-ref\", payload });\n    } catch (error) {\n        showAlert([\"Cannot create ref\", error.message]);\n    }\n};\n\nconst portalContainer = document.getElementById(\"portals\");\nif (portalContainer === null) throw Error(\"#portals is null\");\n\nconst className = [\n    s.container,\n    sArrow.menu,\n    background.primary,\n    boxShadow.strong,\n    borderColor.strong,\n].join(\" \");\n\nexport const CreateEdge = (props: Props) => {\n    const [fromTable, setFromTable] = React.useState<string>(() => {\n        return getInitialFromTable(props);\n    });\n    const [fromRows, setFromRows] = React.useState<string[]>(() => {\n        return getInitialFromRows(props);\n    });\n    const [toTable, setToTable] = React.useState<string>(\"\");\n    const [toRows, setToRows] = React.useState<string[]>([\"\"]);\n\n    const popup = (\n        <div\n            id=\"create-edge-popup\"\n            className={className}\n            ref={props.setPopup}\n            style={props.styles.popper}\n            {...props.attributes.popper}\n        >\n            <form\n                className={s.form}\n                onSubmit={(event) => {\n                    event.preventDefault();\n                    submit(props, [fromTable, fromRows], [toTable, toRows]);\n                    props.setVisible(false);\n                }}\n            >\n                <CreateEdgeHeader />\n                <Border color=\"weak\" />\n                <CreateEdgeSide\n                    label=\"From\"\n                    idKey={props.idKey}\n                    tables={props.tables}\n                    table={fromTable}\n                    setTable={setFromTable}\n                    rows={fromRows}\n                    setRows={setFromRows}\n                    autoFocus={false}\n                />\n                <Border color=\"weak\" />\n                <CreateEdgeSide\n                    label=\"To\"\n                    idKey={props.idKey}\n                    tables={props.tables}\n                    table={toTable}\n                    setTable={setToTable}\n                    rows={toRows}\n                    setRows={setToRows}\n                    autoFocus={true}\n                />\n                <Border color=\"weak\" />\n                <CreateEdgeFooter />\n            </form>\n            <CreateEdgeArrow\n                setArrow={props.setArrow}\n                style={props.styles.arrow}\n                attributes={props.attributes.arrow}\n            />\n        </div>\n    );\n\n    return ReactDOM.createPortal(popup, portalContainer);\n};\n","type VoidFn = (...args: any[]) => void;\n\n// Functions for outside to use\nconst globalFns: { [name: string]: Function } = {};\n\nexport const globalLogger: [string, any][] = [[\"Initialized\", {}]];\n\nexport const addExternalFnDirect = (name: string, fn: Function) => {\n    globalFns[name] = fn;\n};\n\nexport const addExternalFn = (name: string): ((fn: VoidFn) => void) => {\n    let internalFn: VoidFn | null = null;\n    const pendingArgs: any[][] = [];\n\n    // External\n    const externalFn = (...args: any[]) => {\n        if (internalFn !== null) {\n            globalLogger.push([\"Execute\", args]);\n            return internalFn(...args);\n        } else {\n            globalLogger.push([\"Pending\", args]);\n            pendingArgs.push(args);\n        }\n    };\n    globalFns[name] = externalFn;\n\n    // Register\n    const registerFn = (fn: VoidFn) => {\n        internalFn = fn;\n        while (pendingArgs.length > 0) {\n            const args = pendingArgs.shift();\n            globalLogger.push([\"Execute pending item\", args]);\n            (internalFn as VoidFn)(...args);\n        }\n    };\n    return registerFn;\n};\n\nexport const initExternalFns = () => {\n    (window as any).Diagram = globalFns;\n    (window as any).Logger = globalLogger;\n};\n","import React from \"react\";\nimport { addExternalFn } from \"utils/external\";\n\nexport type Platform = \"web\" | \"mac\" | \"win\";\n\nconst webDomains = [\"localhost\", \"diagramplus.com\"];\n\nconst initial: Platform = (() => {\n    if (webDomains.includes(window.location.hostname)) return \"web\";\n    if (window.location.hostname.startsWith(\"192.168.1\")) return \"web\";\n    const platform = navigator.platform.toLowerCase();\n    if (platform.includes(\"mac\")) return \"mac\";\n    if (platform.includes(\"win\")) return \"win\";\n    return \"web\";\n})();\n\nexport const PlatformContext = React.createContext<Platform>(initial);\n\n/**\n * The platform the app is running on. This is not navigator.platform, but to\n * separate between running directly in browsers and embedded in desktop apps\n */\nexport const usePlatform = (): Platform => {\n    return React.useContext(PlatformContext);\n};\n\nconst registerExternal = addExternalFn(\"setPlatform\");\n\nexport const usePlatformProvider = (): Platform => {\n    const [platform, setPlatform] = React.useState<Platform>(initial);\n    React.useEffect(() => {\n        const external = (text: Platform): void => void setPlatform(text);\n        registerExternal(external);\n    }, []);\n    return platform;\n};\n","import { Border, DivPx } from \"@moai/core\";\nimport * as React from \"react\";\nimport { usePlatform } from \"utils/platform\";\n\nexport const HeaderBigDiv = (): JSX.Element => {\n    const platform = usePlatform();\n    switch (platform) {\n        case \"mac\":\n        case \"win\":\n            return <DivPx size={16} />;\n        case \"web\":\n            return (\n                <>\n                    <DivPx size={16} />\n                    <Border color=\"weak\" />\n                    <DivPx size={16} />\n                </>\n            );\n    }\n};\n","export const getTableElementId = (tableId: number) => `table . ${tableId}`;\n\nexport const getTableElement = (tableId: number): HTMLDivElement => {\n    const element = document.getElementById(getTableElementId(tableId));\n    if (element instanceof HTMLDivElement) return element;\n    throw Error(\"Element is not HTMLDivElement\");\n};\n\nexport const getRowElementId = (tableId: number, rowId: number) =>\n    `row . ${tableId} . ${rowId}`;\n\ntype RowElement = HTMLDivElement;\n\nexport const getRowElement = (\n    tableId: number,\n    rowId: number\n): RowElement | null => {\n    const element = document.getElementById(getRowElementId(tableId, rowId));\n    if (element instanceof HTMLDivElement) return element;\n    return null;\n};\n\nexport const focusChild = (column: Element): void => {\n    const element = column.querySelector(\"select,input,button,[tabindex]\");\n    if (element instanceof HTMLElement) return element.focus();\n    throw Error(\"No focusable element under column\");\n};\n","const getGenericId = <T>(ids: T[], makeId: (counter: number) => T): T => {\n    const set = new Set(ids);\n    let counter = 1;\n    let id = makeId(counter);\n    while (set.has(id)) {\n        counter = counter + 1;\n        id = makeId(counter);\n    }\n    return id;\n};\n\nexport const getStringId = (ids: string[], prefix: string) =>\n    getGenericId(ids, (counter) =>\n        counter === 1 ? prefix : `${prefix}_${counter}`\n    );\n\nexport const getNumberId = (ids: number[]) =>\n    getGenericId(ids, (counter) => counter);\n","import { Button } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { getTableElement } from \"app/dom/dom\";\nimport { EditTable } from \"diagram/models/edit/edit\";\nimport { getNumberId } from \"diagram/reducer/id\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport React from \"react\";\nimport { SetSelectIds } from \"app/view/select/select\";\nimport { HeaderChildProps } from \"../header\";\n\ninterface Props extends HeaderChildProps {\n    tables: EditTable[];\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    setSelectIds: SetSelectIds;\n}\n\n// @TODO unify this and the one at \"search\"?\nconst scrollOption: ScrollIntoViewOptions = {\n    behavior: \"smooth\",\n    block: \"center\",\n    inline: \"center\",\n};\n\nexport const HeaderAddTable = (props: Props) => {\n    const onClick = () => {\n        const id = getNumberId(props.tables.map((t) => t.id));\n        props.diagramDispatch({ type: \"add-table\", payload: { id } });\n        window.setTimeout(() => {\n            props.setSelectIds([{ type: \"table\", value: id }]);\n            getTableElement(id).scrollIntoView(scrollOption);\n        }, 0); // Run after React's render new table\n    };\n    return (\n        <Button\n            onClick={onClick}\n            size={props.size.button}\n            style={props.style.button}\n            icon={icons.plus}\n            children=\"Table\"\n            title=\"Add a table to the diagram\"\n        />\n    );\n};\n","// html2canvas does not supported SVG explicitly so we still need\n// to use this outdated library\n// Ref: https://github.com/niklasvh/html2canvas/issues/2329\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport domtoimage from \"dom-to-image\";\nimport { ExportImageOptions, ExportImageResult } from \"../export\";\n// this html2canvas is a manual fork to fix a safari issue\n// Ref: https://github.com/TablePlus/diagram/issues/31\n// @ts-ignore\nimport html2canvas from \"./html2canvas\";\n\nconst getImageData = async (\n    canvas: HTMLElement,\n    options: ExportImageOptions\n): Promise<string> => {\n    const { format, scale } = options;\n    switch (format) {\n        case \"png\":\n            const result = await html2canvas(canvas, { scale });\n            return result.toDataURL();\n        case \"svg\":\n            return await domtoimage.toSvg(canvas);\n    }\n};\n\nexport const exportDiagramAsImage = async (\n    // @TODO(https://github.com/TablePlus/diagram/issues/35)\n    // Explore alternative approach which uses the diagram param\n    _diagram: EditDiagram,\n    options: ExportImageOptions\n): Promise<ExportImageResult> => {\n    const canvas = document.getElementById(\"canvas\");\n    if (canvas === null) throw Error(\"#canvas element is null\");\n    const data = await getImageData(canvas, options);\n    // Remove the mimetype prefix (e.g. \"data:png;base64,\")\n    const body = data.slice(data.indexOf(\",\") + 1);\n    return { body };\n};\n","import * as Edit from \"diagram/models/edit/edit\";\nimport * as Base from \"diagram/models/base/base\";\n\n// Prepared maps from EDIT ids to [name, schema] to speed up EditRef conversion\ntype Ids = {\n    table: { name: string; schema: string | undefined };\n    rows: Map<number, string>;\n};\ntype IdsMap = Map<number, Ids>;\n\nconst makeIdsMap = (tables: Edit.EditTable[]): IdsMap => {\n    const idsMap = new Map<number, Ids>();\n    tables.forEach((table) => {\n        const rows = new Map<number, string>();\n        table.value.rows.forEach((row) => void rows.set(row.id, row.value.id));\n        const idsTable = { name: table.value.name, schema: table.value.schema };\n        idsMap.set(table.id, { table: idsTable, rows });\n    });\n    return idsMap;\n};\n\nconst makeRefSide = (map: IdsMap, side: Edit.EditRefSide): Base.BaseRefSide => {\n    const ids = map.get(side.table);\n    if (!ids) throw Error(`Table Ids \"${side.table}\" not found`);\n    const rows = side.rows.map((editId) => {\n        const realId = ids.rows.get(editId);\n        if (!realId) throw Error(`Row id \"${editId}\" not found`);\n        return realId;\n    });\n    const { name, schema } = ids.table;\n    return { name, schema, rows };\n};\n\nexport const makeBaseDiagramFromEdit = (\n    edit: Edit.EditDiagram\n): Base.BaseDiagram => ({\n    type: \"base\",\n    version: edit.version,\n    columns: edit.columns.map((column) => column.value),\n    items: edit.tables.map((table) => ({\n        schema: table.value.schema,\n        name: table.value.name,\n        id: table.value.id,\n        rows: table.value.rows.map((row) => row.value),\n    })),\n    refs: (() => {\n        const idsMap = makeIdsMap(edit.tables);\n        return edit.refs.map((ref) => ({\n            from: makeRefSide(idsMap, ref.from),\n            to: makeRefSide(idsMap, ref.to),\n        }));\n    })(),\n    schema: edit.schema,\n});\n","import { EditDiagram } from \"diagram/models/edit/edit\";\nimport { makeBaseDiagramFromEdit } from \"../base\";\nimport { ExportSqlOptions, ExportSqlResult } from \"../export\";\n\nexport const exportSqlDrivers = [\n    \"MySQL\",\n    \"MariaDB\",\n    \"SQLite\",\n    \"PostgreSQL\",\n    \"Cassandra\",\n    \"Snowflake\",\n    \"MicrosoftSQLServer\",\n];\n\nexport const exportDiagramAsSql = (\n    diagram: EditDiagram,\n    options: ExportSqlOptions\n): ExportSqlResult => {\n    // At the moment all drivers use the same export format so we only check\n    // for existence here\n    if (exportSqlDrivers.includes(options.driver) === false) {\n        throw Error(`Unknown driver: ${options.driver}`);\n    }\n    const base = makeBaseDiagramFromEdit(diagram);\n    return { base };\n};\n","/**\n * Encoding and decoding here means between:\n * - a unicode string (e.g. \"ting vit\")\n * - its bytes representation in base64 (e.g. \"dGnhur9uZyB2aeG7h3Q=\")\n */\n\nconst encoder = new TextEncoder();\n\nexport const encodeText = (unicode: string): string => {\n    const bytes: Uint8Array = encoder.encode(unicode);\n    // Can't use Uint8Array.map here because its return type is Uint8Array\n    const chars: string[] = new Array(bytes.length);\n    bytes.forEach((byte) => void chars.push(String.fromCharCode(byte)));\n    return btoa(chars.join(\"\"));\n};\n\nconst decoder = new TextDecoder();\n\nconst toCharCode = (char: string): number => char.charCodeAt(0);\n\nexport const decodeText = (base64: string): string => {\n    const bytes = Uint8Array.from(atob(base64), toCharCode);\n    return decoder.decode(bytes);\n};\n","import { BaseDiagram } from \"diagram/models/base/base\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport { exportDiagramAsImage } from \"./image/image\";\nimport { exportDiagramAsSql } from \"./sql/sql\";\nimport { exportDiagramAsText } from \"./text/text\";\n\nexport interface ExportImageOptions {\n    type: \"image\";\n    format: \"png\" | \"svg\";\n    scale: 1 | 2;\n}\n\nexport interface ExportImageResult {\n    body: string;\n}\n\nexport interface ExportSqlOptions {\n    type: \"sql\";\n    driver: string;\n}\n\nexport interface ExportSqlResult {\n    base: BaseDiagram;\n}\n\nexport type ExportTextFormat = \"json\" | \"base64\"\n\nexport interface ExportTextOptions {\n    type: \"text\";\n    level: \"base\" | \"edit\";\n    format: ExportTextFormat;\n}\n\nexport interface ExportTextResult {\n    value: string;\n}\n\nexport type ExportOptions =\n    | ExportImageOptions\n    | ExportSqlOptions\n    | ExportTextOptions;\n\nexport type ExportResult<T> = T extends ExportTextOptions\n    ? ExportTextResult\n    : T extends ExportSqlOptions\n    ? ExportSqlResult\n    : T extends ExportImageOptions\n    ? Promise<ExportImageResult>\n    : never;\n\nexport const exportDiagram = <T extends ExportOptions>(\n    diagram: EditDiagram,\n    options: T\n): ExportResult<T> => {\n    // To explain the \"any\" in this function:\n    // https://github.com/microsoft/TypeScript/issues/24929\n    switch (options.type) {\n        case \"text\":\n            return exportDiagramAsText(diagram, options as any) as any;\n        case \"image\":\n            return exportDiagramAsImage(diagram, options as any) as any;\n        case \"sql\":\n            return exportDiagramAsSql(diagram, options as any) as any;\n    }\n};\n","import { EditDiagram } from \"diagram/models/edit/edit\";\nimport { makeBaseDiagramFromEdit } from \"../base\";\nimport { ExportTextOptions, ExportTextResult } from \"../export\";\nimport { encodeText } from \"utils/encode\";\n\nexport const exportDiagramAsText = (\n    diagram: EditDiagram,\n    options: ExportTextOptions\n): ExportTextResult => {\n    const obj: object = (() => {\n        switch (options.level) {\n            case \"base\":\n                return makeBaseDiagramFromEdit(diagram);\n            case \"edit\":\n                return diagram;\n        }\n    })();\n    const json: string = JSON.stringify(obj);\n    const value: string = (() => {\n        switch (options.format) {\n            case \"json\":\n                return json;\n            case \"base64\":\n                return encodeText(json);\n        }\n    })();\n    return { value };\n};\n","import { fileExtensions, FileFormat, SaveFileProps } from \"./file\";\n\nconst mimes: {\n    [key in FileFormat]: string;\n} = {\n    png: \"image/png;base64\",\n    svg: \"image/svg+xml;charset=utf-8\",\n    diagram: \"text/plain\",\n};\n\nexport const saveFileInWeb = (props: SaveFileProps): void => {\n    const link = document.createElement(\"a\");\n    link.download = `${props.name}.${fileExtensions[props.format]}`;\n    link.href = `data:${mimes[props.format]},${props.content}`;\n    link.click();\n};\n","import { BaseDiagram } from \"diagram/models/base/base\";\nimport * as React from \"react\";\n\ntype Platform = \"mac\" | \"win\";\n\nconst post = (platform: Platform, method: string, data: any): void => {\n    switch (platform) {\n        case \"mac\":\n            const handlers = (window as any).webkit.messageHandlers;\n            handlers[method].postMessage(data);\n            return;\n        case \"win\":\n            const message = { message: method, args: data };\n            (window as any).CefSharp.PostMessage(message);\n            return;\n    }\n};\n\ninterface SqlData {\n    data: BaseDiagram;\n    driver: string;\n}\n\nexport const exportSqlToHost = (platform: Platform, data: SqlData): void => {\n    post(platform, \"exportSQL\", data);\n};\n\ninterface FileData {\n    data: string;\n    ext: string;\n    name: string;\n    title: string;\n}\n\nexport const saveFileToHost = (platform: Platform, data: FileData): void => {\n    post(platform, \"saveFile\", data);\n};\n\nconst LINK = \"https://github.com/TablePlus/diagram-plugin/\";\n\nexport const UseHostInstruction = () => (\n    <span>\n        <span>Please install the </span>\n        <a href={LINK} children=\"Diagram plugin\" />\n        <span> and use it inside TablePlus app</span>\n    </span>\n);\n","import { SaveFileProps, fileExtensions, FileFormat } from \"./file\";\nimport { saveFileToHost } from \"utils/host\";\nimport { encodeText } from \"utils/encode\";\n\nconst clean = (text: string): string => {\n    let result = text;\n    // TODO: Investigate more why the encoder can't encode these characters\n    // instead of manually maintaining this blacklist\n    [\"&%23xA;\", \"&%239;\"].forEach((word) => {\n        result = result.split(word).join(\"\");\n    });\n    return result;\n};\n\nconst isBase64Format = (format: FileFormat): boolean => {\n    switch (format) {\n        case \"diagram\":\n        case \"svg\":\n            return false;\n        case \"png\":\n            return true;\n    }\n};\n\nconst toBase64 = (props: SaveFileProps): string => {\n    // If base64 already\n    if (isBase64Format(props.format)) return props.content;\n    // If not ---> convert text to base64\n    return encodeText(clean(props.content));\n};\n\nexport const saveFileInApp = (props: SaveFileProps): void => {\n    if (props.platform === \"web\")\n        throw Error('Calling saveFileInApp with \"web\" platform');\n    saveFileToHost(props.platform, {\n        data: toBase64(props),\n        ext: fileExtensions[props.format],\n        name: props.name,\n        title: `Save ${props.name} as`,\n    });\n};\n","import { Platform } from \"../platform\";\nimport { saveFileInWeb } from \"./web\";\nimport { saveFileInApp } from \"./app\";\n\nexport type FileFormat = \"png\" | \"svg\" | \"diagram\";\n\nexport const fileExtensions: {\n    [key in FileFormat]: string;\n} = {\n    png: \"png\",\n    svg: \"svg\",\n    diagram: \"diagram\",\n};\n\nexport interface SaveFileProps {\n    platform: Platform;\n    format: FileFormat;\n    content: string;\n    name: string;\n}\n\nexport const saveFile = (props: SaveFileProps): void => {\n    switch (props.platform) {\n        case \"web\":\n            return saveFileInWeb(props);\n        case \"mac\":\n        case \"win\":\n            return saveFileInApp(props);\n    }\n};\n","import { Platform } from \"utils/platform\";\nimport * as Export from \"diagram/export/export\";\nimport { ButtonMenuItem } from \"@moai/core\";\nimport { exportSqlDrivers } from \"diagram/export/sql/sql\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport { exportSqlToHost, UseHostInstruction } from \"utils/host\";\nimport * as React from \"react\";\nimport { showAlert } from \"@moai/core\";\n\nexport interface ExportProps {\n    options: Export.ExportSqlOptions;\n    result: Export.ExportSqlResult;\n    platform: Platform;\n}\n\nconst exportSql = (props: ExportProps): void => {\n    if (props.platform === \"web\")\n        throw Error('Calling exportSql but current platform is \"web\"');\n    exportSqlToHost(props.platform, {\n        data: props.result.base,\n        driver: props.options.driver,\n    });\n};\n\ninterface Props {\n    diagram: EditDiagram;\n    platform: Platform;\n}\n\nconst appMessage = [\n    \"Export to database requires TablePlus app\",\n    <UseHostInstruction />\n];\n\nexport const getHeaderExportSqlItems = (props: Props): ButtonMenuItem[] => {\n    const { diagram, platform } = props;\n    if (platform === \"web\") {\n        return [\n            {\n                label: \"Export to a database\",\n                fn: () => void showAlert(appMessage),\n            },\n        ];\n    } else {\n        return exportSqlDrivers.map((driver) => ({\n            label: `Export to ${driver}`,\n            fn: () => {\n                type Options = Export.ExportSqlOptions;\n                const options: Options = { type: \"sql\", driver };\n                const result = Export.exportDiagram(diagram, options);\n                exportSql({ result, options, platform });\n            },\n        }));\n    }\n};\n","import { showPrompt } from \"@moai/core\";\n\nexport const copyToClipboard = async (text: string): Promise<void> => {\n    try {\n        await navigator.clipboard.writeText(text);\n    } catch (error) {\n        await showPrompt(\"Please copy from the textbox below:\", text);\n    }\n};\n","import { ButtonMenuItem } from \"@moai/core\";\nimport * as Export from \"diagram/export/export\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport { showAlert } from \"@moai/core\";\nimport { copyToClipboard } from \"utils/clipboard\";\nimport { saveFile } from \"utils/file/file\";\nimport { Platform } from \"utils/platform\";\n\nconst toText = (diagram: EditDiagram) => {\n    type Options = Export.ExportTextOptions;\n    const options: Options = { type: \"text\", level: \"edit\", format: \"json\" };\n    return Export.exportDiagram(diagram, options).value;\n};\n\nconst toClipboard = async (diagram: EditDiagram): Promise<void> => {\n    const text = toText(diagram);\n    await copyToClipboard(text);\n    await showAlert([\n        \"Your diagram is copied to clipboard\",\n        `To import it, go to \"Import\" > \"Import from text\"`,\n    ]);\n};\n\nconst toFile = (platform: Platform, diagram: EditDiagram): void => {\n    saveFile({\n        platform,\n        format: \"diagram\",\n        name: \"diagram\",\n        content: toText(diagram),\n    });\n};\n\nexport const getHeaderExportTextItems = (\n    platform: Platform,\n    diagram: EditDiagram\n): ButtonMenuItem[] => [\n    { label: \"Save to file\", fn: () => toFile(platform, diagram) },\n    { label: \"Copy to clipboard\", fn: () => void toClipboard(diagram) },\n];\n","import { ButtonMenu, ButtonMenuItem } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport * as Export from \"diagram/export/export\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport React from \"react\";\nimport { Platform, usePlatform } from \"utils/platform\";\nimport { HeaderChildProps } from \"../../header\";\nimport { exportImage } from \"./image\";\nimport { getHeaderExportSqlItems } from \"./sql\";\nimport { getHeaderExportTextItems } from \"./text\";\n\ninterface Props extends HeaderChildProps {\n    diagram: EditDiagram;\n    setIsCapture: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst sleep = async (num: number): Promise<void> => {\n    await new Promise((resolve) => window.setTimeout(() => resolve(), num));\n};\n\nconst getImageItems = (\n    diagram: EditDiagram,\n    platform: Platform,\n    setIsCapture: React.Dispatch<React.SetStateAction<boolean>>\n): ButtonMenuItem[] => {\n    const images: [string, Export.ExportImageOptions[\"format\"], 1 | 2][] = [\n        [\"Save as PNG (High quality)\", \"png\", 2],\n        [\"Save as PNG (Low quality)\", \"png\", 1],\n        [\"Save as SVG (Web page)\", \"svg\", 1],\n    ];\n    return images.map(([label, format, scale]) => {\n        const fn = async () => {\n            setIsCapture(true);\n            await sleep(100);\n            type Options = Export.ExportImageOptions;\n            const options: Options = { type: \"image\", format, scale };\n            const result = await Export.exportDiagram(diagram, options);\n            exportImage({ result, options, platform });\n            setIsCapture(false);\n        };\n        return { label, fn };\n    });\n};\n\nexport const HeaderExport = (props: Props) => {\n    const { diagram, setIsCapture } = props;\n    const platform = usePlatform();\n    return (\n        <ButtonMenu\n            items={[\n                ...getHeaderExportTextItems(platform, diagram),\n                \"divider\",\n                ...getImageItems(diagram, platform, setIsCapture),\n                \"divider\",\n                ...getHeaderExportSqlItems({ diagram, platform }),\n            ]}\n            button={{\n                icon: icons.share,\n                size: props.size.button,\n                style: props.style.button,\n                title: \"Export\",\n            }}\n        />\n    );\n};\n","import * as Export from \"diagram/export/export\";\nimport { Platform } from \"utils/platform\";\nimport { saveFile } from \"utils/file/file\";\n\ninterface Props {\n    options: Export.ExportImageOptions;\n    result: Export.ExportImageResult;\n    platform: Platform;\n}\n\nexport const exportImage = (props: Props): void => {\n    saveFile({\n        platform: props.platform,\n        format: props.options.format,\n        content: props.result.body,\n        name: \"diagram\",\n    });\n};\n","import { Button, ButtonGroup } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { UndoAction } from \"diagram/state/undo/undo\";\nimport React from \"react\";\nimport { HeaderChildProps } from \"../header\";\n\ninterface Props<T> extends HeaderChildProps {\n    past: T[];\n    future: T[];\n    dispatch: React.Dispatch<UndoAction>;\n}\n\nexport const HeaderHistory = <T,>(props: Props<T>) => (\n    <ButtonGroup>\n        {[\n            <Button\n                key=\"undo\"\n                onClick={() => props.dispatch({ type: \"undo\" })}\n                icon={icons.undo}\n                size={props.size.button}\n                style={props.style.button}\n                disabled={props.past.length === 0}\n                title=\"Undo\"\n            />,\n            <Button\n                key=\"redo\"\n                onClick={() => props.dispatch({ type: \"redo\" })}\n                icon={icons.redo}\n                size={props.size.button}\n                style={props.style.button}\n                disabled={props.future.length === 0}\n                title=\"Redo\"\n            />,\n        ]}\n    </ButtonGroup>\n);\n","import { ButtonMenuItem } from \"@moai/core\";\nimport { ImportPayload } from \"diagram/reducer/import/import\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\n\ntype setIsBusy = React.Dispatch<React.SetStateAction<boolean>>;\n\nconst loadRemote = async (props: Props, url: string) => {\n    props.setIsBusy(true);\n    const source = await fetch(url).then((response) => response.json());\n    const payload: ImportPayload = { source, isAppend: false };\n    props.diagramDispatch({ type: \"import\", payload });\n    props.setIsBusy(false);\n};\n\ninterface Props {\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    setIsBusy: setIsBusy;\n}\n\nexport const getHeaderImportSampleItems = (props: Props): ButtonMenuItem[] =>\n    [\n        [\"Load the Airlines sample\", \"airlines\"],\n        [\"Load the IMDb sample\", \"imdb\"],\n        [\"Load the Employees sample\", \"employees\"],\n        // \"divider\",\n        // [\"Import a small sample (3 tables)\", \"1\"],\n        // [\"Import sample 2 (Table with many columns)\", \"2\"],\n        // [\"Import sample 3 (28 tables)\", \"3\"],\n        // [\"Import a large sample (1710 tables)\", \"4\"],\n    ].map((item) => {\n        // if (item === \"divider\") return \"divider\";\n        const [label, name] = item;\n        const url = `https://diagramplus.com/samples/${name}.json`;\n        return { label, fn: () => loadRemote(props, url) };\n    });\n","import { ButtonMenuItem } from \"@moai/core\";\nimport * as React from \"react\";\nimport { showAlert } from \"@moai/core\";\nimport { UseHostInstruction } from \"utils/host\";\nimport { Platform } from \"utils/platform\";\n\ninterface Props {\n    platform: Platform;\n}\n\nconst fn = (): void => {\n    showAlert([\n        \"Generate from database require TablePlus app\",\n        <UseHostInstruction />,\n    ]);\n};\n\nexport const getHeaderImportSqlItems = (props: Props): ButtonMenuItem[] => {\n    if (props.platform !== \"web\") return [];\n    return [{ label: \"Generate from a database\", fn }];\n};\n","import { ButtonMenuItem } from \"@moai/core\";\nimport { ImportPayload } from \"diagram/reducer/import/import\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { showPrompt } from \"@moai/core\";\n\nconst dispatch = (props: Props, source: unknown) => {\n    const payload: ImportPayload = { source, isAppend: false };\n    props.diagramDispatch({ type: \"import\", payload });\n};\n\nconst importText = async (props: Props): Promise<void> => {\n    const source = await showPrompt([\n        \"Paste a diagram into the textbox below\",\n        'To export diagrams as text, go to \"Export\" > \"Copy to clipboard\"',\n    ]);\n    if (source === null || !source) return;\n    dispatch(props, source);\n};\n\nconst importFile = (props: Props) => {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.addEventListener(\"change\", (event) => {\n        const file = (event as any).target.files[0];\n        const reader = new FileReader();\n        reader.readAsText(file);\n        reader.addEventListener(\"load\", (event) => {\n            const source = event.target?.result;\n            if (typeof source !== \"string\")\n                throw Error(`Unknown content type: ${typeof source}`);\n            dispatch(props, source);\n        });\n    });\n    input.click();\n};\n\ninterface Props {\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nexport const getHeaderImportTextItems = (props: Props): ButtonMenuItem[] => [\n    { label: `Open file`, fn: () => importFile(props) },\n    { label: `Import from text`, fn: () => importText(props) },\n];\n","import { ButtonMenu, ButtonMenuItem } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport * as React from \"react\";\nimport { Platform, usePlatform } from \"utils/platform\";\nimport { HeaderChildProps } from \"../../header\";\nimport { getHeaderImportSampleItems } from \"./sample\";\nimport { getHeaderImportSqlItems } from \"./sql\";\nimport { getHeaderImportTextItems } from \"./text\";\n\ninterface InternalProps {\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    platform: Platform;\n    setIsBusy: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst getItems = (props: InternalProps): ButtonMenuItem[] => {\n    const items: ButtonMenuItem[] = [\n        ...getHeaderImportTextItems(props),\n        \"divider\",\n        ...getHeaderImportSampleItems(props),\n    ];\n    const sql = getHeaderImportSqlItems(props);\n    if (sql.length > 0) items.push(\"divider\", ...sql);\n    return items;\n};\n\ninterface Props extends HeaderChildProps {\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nexport const HeaderImport = (props: Props) => {\n    const [isBusy, setIsBusy] = React.useState(false);\n    const platform = usePlatform();\n    const { diagramDispatch } = props;\n    return (\n        <ButtonMenu\n            button={{\n                size: props.size.button,\n                style: props.style.button,\n                icon: icons.import,\n                children: \"Import\",\n                isBusy,\n                title: \"Import a diagram\",\n            }}\n            items={getItems({ setIsBusy, platform, diagramDispatch })}\n        />\n    );\n};\n","import { Button, ButtonGroup, ButtonMenu, ButtonMenuItem } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport React from \"react\";\nimport { HeaderChildProps } from \"../../header\";\n\ninterface Props extends HeaderChildProps {\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nconst layoutAction: DiagramAction = {\n    type: \"set-layout\",\n    payload: { type: \"auto\" },\n};\n\nconst setExpandAndArrange = (props: Props, payload: boolean): void => {\n    // @TODO: Should not fire 2 dispatch like this\n    props.diagramDispatch({ type: \"set-all-tables-rows-expand\", payload });\n    window.setTimeout(() => props.diagramDispatch(layoutAction), 0);\n};\n\nconst getMenuItems = (props: Props): ButtonMenuItem[] => [\n    {\n        label: \"Expand all columns and Arrange\",\n        fn: () => setExpandAndArrange(props, true),\n    },\n    {\n        label: \"Collapse columns and Arrange\",\n        fn: () => setExpandAndArrange(props, false),\n    },\n];\n\nexport const HeaderLayout = (props: Props) => (\n    <ButtonGroup>\n        {[\n            <Button\n                key=\"arrange\"\n                icon={icons.layoutAuto}\n                onClick={() => void props.diagramDispatch(layoutAction)}\n                children=\"Arrange\"\n                size={props.size.button}\nstyle={props.style.button}\n                title=\"Auto-arrange tables\"\n            />,\n            <ButtonMenu\n                key=\"more\"\n                button={{\n                    icon: icons.caret,\n                    size: props.size.button,\n                    style: props.style.button,\n                    title: \"More arrange options\",\n                }}\n                items={getMenuItems(props)}\n            />,\n        ]}\n    </ButtonGroup>\n);\n","import * as React from \"react\";\nimport { HeaderChildProps } from \"../../header\";\nimport { PrefsProps, Prefs } from \"pref/pref\";\nimport { Button } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\n\ninterface Props extends HeaderChildProps, PrefsProps {}\n\nconst toggle = (prefs: Prefs): Prefs => ({\n    ...prefs,\n    libraryVisible: !prefs.libraryVisible,\n});\n\nexport const HeaderLibrary = (props: Props) => (\n    <Button\n        onClick={() => void props.setPrefs(toggle)}\n        selected={props.prefs.libraryVisible}\n        size={props.size.button}\n        style={props.style.button}\n        icon={icons.menuOpen}\n    />\n);\n","import { EditRef } from \"diagram/models/edit/edit\";\nimport { SelectId, SetSelectIds } from \"./select\";\n\ninterface Props {\n    tableId: number;\n    refs: EditRef[];\n    setSelectIds: SetSelectIds;\n}\n\nconst isRelated = (target: number) => (ref: EditRef): boolean =>\n    [ref.from.table, ref.to.table].includes(target);\n\ntype Event = React.MouseEvent<HTMLDivElement>;\n\nexport const getTableRelatedIds = (\n    tableId: number,\n    refs: EditRef[]\n): SelectId[] => {\n    const ids: SelectId[] = refs\n        .filter(isRelated(tableId))\n        .map((ref) => ({ type: \"ref\", value: ref.id }));\n    ids.push({ type: \"table\", value: tableId });\n    return ids;\n};\n\nexport const selectOnTableFocus = (props: Props) => (event: Event) => {\n    if (event.target instanceof HTMLInputElement) return;\n    const ids = getTableRelatedIds(props.tableId, props.refs);\n    props.setSelectIds(ids);\n};\n","import { Input } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { getTableElement } from \"app/dom/dom\";\nimport { SetSelectIds } from \"app/view/select/select\";\nimport { getTableRelatedIds } from \"app/view/select/table\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport React from \"react\";\nimport { HeaderChildProps } from \"../header\";\n\ninterface Props extends HeaderChildProps {\n    diagram: EditDiagram;\n    setSelectIds: SetSelectIds;\n}\n\nconst scrollOption: ScrollIntoViewOptions = {\n    behavior: \"smooth\",\n    block: \"center\",\n    inline: \"center\",\n};\n\nconst focusTable = (\n    diagram: EditDiagram,\n    setSelectIds: SetSelectIds,\n    name: string\n) => {\n    // Select the table in state\n    const table = diagram.tables.find((table) => table.value.name === name);\n    // Throwing error here because we already check in the useEffect\n    if (table === undefined) throw Error(\"table is undefined\");\n    setSelectIds(getTableRelatedIds(table.id, diagram.refs));\n    // Scroll the element into view\n    getTableElement(table.id).scrollIntoView(scrollOption);\n};\n\nexport const HeaderSearch = (props: Props) => {\n    const { diagram, setSelectIds } = props;\n\n    const tables: string[] = React.useMemo(() => {\n        const set = new Set<string>();\n        diagram.tables.forEach((table) => void set.add(table.value.name));\n        return [...set];\n    }, [diagram.tables]);\n\n    const [value, _setValue] = React.useState(\"\");\n\n    const focusIfNecessary = (name: string) => {\n        if (tables.includes(name) === false) return;\n        focusTable(diagram, setSelectIds, name);\n    };\n\n    return (\n        <div style={{ flex: \"1 1 0px\" }}>\n            <Input\n                icon={icons.search}\n                placeholder=\"Find table\"\n                value={value}\n                setValue={(newValue) => {\n                    _setValue(newValue);\n                    focusIfNecessary(newValue);\n                }}\n                list={{ id: \"header-search\", values: tables }}\n                onKeyUp={(event) => {\n                    if (event.key !== \"Enter\") return;\n                    focusIfNecessary(value);\n                }}\n                size={props.size.input}\n                style={props.style.input}\n            />\n        </div>\n    );\n};\n","import { Button } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport * as React from \"react\";\nimport { HeaderChildProps } from \"../../header\";\n\ninterface Props extends HeaderChildProps {\n    isHeaderExpand: boolean;\n    setIsHeaderExpand: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nexport const HeaderSetting = (props: Props) => (\n    <Button\n        selected={props.isHeaderExpand}\n        onClick={() => props.setIsHeaderExpand((bool) => !bool)}\n        icon={icons.cog}\n        size={props.size.button}\n        style={props.style.button}\n        title=\"Settings\"\n    />\n);\n","import { Button, ButtonGroup, Select } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { PrefsProps } from \"pref/pref\";\nimport React from \"react\";\nimport { HeaderChildProps } from \"../../header\";\n\ninterface Props extends HeaderChildProps, PrefsProps {}\n\nconst zoomOptions = [25, 50, 75, 100, 125, 150, 175, 200].map((value) => {\n    return { label: `${value}%`, value: value / 100 };\n});\n\nexport const HeaderZoom = (props: Props) => {\n    const setZoom = (zoom: number) =>\n        props.setPrefs((prev) => ({ ...prev, zoom }));\n    return (\n        <ButtonGroup>\n            {[\n                <Button\n                    key=\"out\"\n                    icon={icons.zoomOut}\n                    onClick={() => setZoom(props.prefs.zoom - 0.25)}\n                    size={props.size.button}\n                    style={props.style.button}\n                    title=\"Zoom out\"\n                />,\n                <Select\n                    key=\"select\"\n                    value={props.prefs.zoom}\n                    setValue={setZoom}\n                    options={zoomOptions}\n                    size={props.size.select}\n                    style={props.style.select}\n                    title=\"Set zoom level\"\n                />,\n                <Button\n                    key=\"in\"\n                    icon={icons.zoomIn}\n                    onClick={() => setZoom(props.prefs.zoom + 0.25)}\n                    size={props.size.button}\n                    style={props.style.button}\n                    title=\"Zoom in\"\n                />,\n            ]}\n        </ButtonGroup>\n    );\n};\n","import { DivPx } from \"@moai/core\";\nimport { SetSelectIds } from \"app/view/select/select\";\nimport { LibraryProps } from \"diagram/library/state\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { UndoAction } from \"diagram/state/undo/undo\";\nimport { PrefsProps } from \"pref/pref\";\nimport React from \"react\";\nimport { Platform, usePlatform } from \"utils/platform\";\nimport { HeaderChildProps } from \"../header\";\nimport { HeaderBigDiv } from \"../utils/div\";\nimport { HeaderAddTable } from \"./add\";\nimport { HeaderExport } from \"./export/export\";\nimport { HeaderHistory } from \"./history\";\nimport { HeaderImport } from \"./import/import\";\nimport { HeaderLayout } from \"./layout/layout\";\nimport { HeaderLibrary } from \"./library/library\";\nimport { HeaderSearch } from \"./search\";\nimport { HeaderSetting } from \"./setting/setting\";\nimport sBase from \"./style/base.module.scss\";\nimport sMac from \"./style/mac.module.scss\";\nimport sWin from \"./style/win.module.scss\";\nimport { HeaderZoom } from \"./zoom/zoom\";\n\nexport interface HeaderPrimaryProps\n    extends HeaderChildProps,\n        PrefsProps,\n        LibraryProps {\n    // Diagram\n    diagram: EditDiagram;\n    diagramPast: EditDiagram[];\n    diagramFuture: EditDiagram[];\n    diagramDispatch: React.Dispatch<DiagramAction | UndoAction>;\n    // State\n    setIsCapture: React.Dispatch<React.SetStateAction<boolean>>;\n    setSelectIds: SetSelectIds;\n    // Header\n    isHeaderExpand: boolean;\n    setIsHeaderExpand: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst getContainerClass = (platform: Platform): string => {\n    const cls = [sBase.container];\n    if (platform === \"mac\") cls.push(sMac.container);\n    if (platform === \"win\") cls.push(sWin.container);\n    return cls.join(\" \");\n};\n\nexport const HeaderPrimary = (props: HeaderPrimaryProps) => {\n    const platform = usePlatform();\n    return (\n        <div className={getContainerClass(platform)}>\n            <DivPx size={16} />\n            <HeaderLibrary\n                prefs={props.prefs}\n                setPrefs={props.setPrefs}\n                size={props.size}\n                style={props.style}\n            />\n            <DivPx size={16} />\n            <HeaderImport\n                diagramDispatch={props.diagramDispatch}\n                size={props.size}\n                style={props.style}\n            />\n            <HeaderBigDiv />\n            <HeaderAddTable\n                tables={props.diagram.tables}\n                diagramDispatch={props.diagramDispatch}\n                setSelectIds={props.setSelectIds}\n                size={props.size}\n                style={props.style}\n            />\n            <DivPx size={16} />\n            <HeaderHistory\n                past={props.diagramPast}\n                future={props.diagramFuture}\n                dispatch={props.diagramDispatch}\n                size={props.size}\n                style={props.style}\n            />\n            <HeaderBigDiv />\n            <HeaderSearch\n                diagram={props.diagram}\n                setSelectIds={props.setSelectIds}\n                size={props.size}\n                style={props.style}\n            />\n            <HeaderBigDiv />\n            <HeaderLayout\n                diagramDispatch={props.diagramDispatch}\n                size={props.size}\n                style={props.style}\n            />\n            <DivPx size={16} />\n            <HeaderZoom\n                prefs={props.prefs}\n                setPrefs={props.setPrefs}\n                size={props.size}\n                style={props.style}\n            />\n            <DivPx size={16} />\n            <HeaderExport\n                diagram={props.diagram}\n                setIsCapture={props.setIsCapture}\n                size={props.size}\n                style={props.style}\n            />\n            <HeaderBigDiv />\n            <HeaderSetting\n                isHeaderExpand={props.isHeaderExpand}\n                setIsHeaderExpand={props.setIsHeaderExpand}\n                size={props.size}\n                style={props.style}\n            />\n            <DivPx size={16} />\n        </div>\n    );\n};\n","import * as React from \"react\";\nimport { Checkbox, Input, Paragraph, MutedDiv } from \"@moai/core\";\nimport s from \"./item.module.css\";\n\nexport interface ReportItemState {\n    has: boolean;\n    setHas: React.Dispatch<React.SetStateAction<boolean>>;\n    text: string;\n    setText: React.Dispatch<React.SetStateAction<string>>;\n}\n\ninterface Props {\n    label: string;\n    state: ReportItemState;\n    placeholder?: string;\n    children?: React.ReactNode;\n}\n\nexport const useReportItem = (getInitial: () => string): ReportItemState => {\n    const [has, setHas] = React.useState(true);\n    const [text, setText] = React.useState(getInitial);\n    return { has, setHas, text, setText };\n};\n\nexport const ReportItem = (props: Props) => (\n    <div className={s.container}>\n        <div className={s.input}>\n            <div className={s.has}>\n                <Checkbox\n                    value={props.state.has}\n                    setValue={props.state.setHas}\n                    children={props.label}\n                />\n            </div>\n            <div className={s.text}>\n                <Input\n                    value={props.state.text}\n                    setValue={props.state.setText}\n                    disabled={!props.state.has}\n                    placeholder={props.placeholder}\n                />\n            </div>\n        </div>\n        {props.children && (\n            <MutedDiv>\n                <Paragraph>{props.children}</Paragraph>\n            </MutedDiv>\n        )}\n    </div>\n);\n","import { DiagramUnknown } from \"../unknown/unknown\";\nimport * as V1 from \"./base-v1\";\nimport * as V2 from \"./base-v2\";\n\nexport type BaseDiagramUnknown = V1.BaseDiagramV1 | V2.BaseDiagramV2;\nexport type BaseDiagramLatest = V2.BaseDiagramV2;\n\nexport type BaseDiagram = BaseDiagramLatest;\nexport type BaseRow = V1.BaseRowV1;\nexport type BaseColumn = V1.BaseColumnV1;\nexport type BaseItem = V1.BaseItemV1;\nexport type BaseRef = V1.BaseRefV1;\nexport type BaseRefSide = V1.BaseRefSideV1;\n\nexport const migrateBaseDiagram = (\n    unknown: BaseDiagramUnknown\n): BaseDiagramLatest => {\n    if (V1.isBaseDiagramV1(unknown)) {\n        return V2.migrateBaseDiagramV1toV2(unknown);\n    }\n    if (V2.isBaseDiagramV2(unknown)) {\n        return unknown;\n    }\n    throw Error(\"Unknown base diagram version\");\n};\n\nexport const isBaseDiagramUknown = (\n    diagram: DiagramUnknown\n): diagram is BaseDiagramUnknown => {\n    // Starting from V2, BaseDiagram.type === \"base\"\n    if ((diagram as V2.BaseDiagramV2).type === \"base\") return true; // V2\n    // In V1 we need to depend on an ad-hoc check\n    if ((diagram as V1.BaseDiagramV1).items !== undefined) return true; // V1\n    return false;\n};\n","import { BaseDiagramUnknown } from \"./base\";\n\nexport interface BaseColumnV1 {\n    id: string;\n    name: string;\n    type: string;\n}\n\nexport interface BaseRowV1 {\n    id: string;\n    [key: string]: string | undefined;\n}\n\nexport interface BaseItemV1 {\n    id: string;\n    name: string;\n    schema?: string;\n    rows: BaseRowV1[];\n}\n\nexport interface BaseRefSideV1 {\n    name: string;\n    schema?: string;\n    rows: string[];\n}\n\nexport interface BaseRefV1 {\n    from: BaseRefSideV1;\n    to: BaseRefSideV1;\n}\n\nexport interface BaseDiagramV1 {\n    columns: BaseColumnV1[];\n    items: BaseItemV1[];\n    refs: BaseRefV1[];\n    schema: string;\n    $schema?: string;\n}\n\nexport const isBaseDiagramV1 = (\n    diagram: BaseDiagramUnknown\n): diagram is BaseDiagramV1 => {\n    return \"version\" in diagram === false;\n};\n","import { BaseDiagramUnknown } from \"./base\";\nimport { BaseDiagramV1 } from \"./base-v1\";\n\nexport interface BaseDiagramV2 extends BaseDiagramV1 {\n    type: \"base\";\n    version: 2;\n}\n\nexport const isBaseDiagramV2 = (\n    diagram: BaseDiagramUnknown\n): diagram is BaseDiagramV2 => {\n    return \"version\" in diagram && diagram.version === 2;\n};\n\nexport const migrateBaseDiagramV1toV2 = (v1: BaseDiagramV1): BaseDiagramV2 => ({\n    ...v1,\n    type: \"base\",\n    version: 2,\n});\n","import { DiagramUnknown } from \"../unknown/unknown\";\nimport * as V1 from \"./edit-v1\";\nimport * as V2 from \"./edit-v2\";\n\nexport type EditDiagramUnknown = V1.EditDiagramV1 | V2.EditDiagramV2;\nexport type EditDiagramLatest = V2.EditDiagramV2;\n\nexport type EditDiagram = EditDiagramLatest;\nexport type EditRow = V1.EditRowV1;\nexport type EditColumn = V1.EditColumnV1;\nexport type EditTable = V1.EditTableV1;\nexport type EditTableValue = V1.EditTableValueV1;\nexport type EditRef = V1.EditRefV1;\nexport type EditRefSide = V1.EditRefSideV1;\nexport type EditEdge = V1.EditEdgeV1;\nexport type EditEdgeSide = V1.EditEdgeSideV1;\n\nexport const migrateEditDiagram = (\n    unknown: EditDiagramUnknown\n): EditDiagramLatest => {\n    if (V1.isEditDiagramV1(unknown)) {\n        return V2.migrateEditDiagramV1toV2(unknown);\n    }\n    if (V2.isEditDiagramV2(unknown)) {\n        return unknown;\n    }\n    throw Error(\"Unknown edit diagram version\");\n};\n\nexport const isEditDiagramUknown = (\n    diagram: DiagramUnknown\n): diagram is EditDiagramUnknown => {\n    // Starting from V2, EditDiagram.type === \"edit\"\n    if ((diagram as V2.EditDiagramV2).type === \"edit\") return true; // V2\n    // In V1 we need to depend on an ad-hoc check\n    if ((diagram as V1.EditDiagramV1).tables !== undefined) return true; // V1\n    return false;\n};\n","import { BaseColumnV1, BaseRowV1 } from \"../base/base-v1\";\nimport { EditDiagramUnknown } from \"./edit\";\nimport { Position, Size } from \"../layout\";\n\nexport interface EditColumnV1 {\n    id: number;\n    value: BaseColumnV1;\n}\n\nexport interface EditRowV1 {\n    value: BaseRowV1;\n    id: number;\n}\n\nexport interface EditTableValueV1 {\n    id: string;\n    name: string;\n    schema?: string;\n    rows: EditRowV1[];\n}\n\nexport interface EditTableV1 {\n    id: number;\n    value: EditTableValueV1;\n    position: Position;\n    isRowsExpand: boolean;\n}\n\nexport interface EditRefSideV1 {\n    table: number;\n    rows: number[];\n}\n\nexport interface EditRefV1 {\n    id: number;\n    from: EditRefSideV1;\n    to: EditRefSideV1;\n}\n\n// Alias to avoid conflict with React's \"ref\" naming\nexport type EditEdgeV1 = EditRefV1;\nexport type EditEdgeSideV1 = EditRefSideV1;\n\nexport interface EditDiagramV1 {\n    columns: EditColumnV1[];\n    tables: EditTableV1[];\n    refs: EditRefV1[];\n    size: Size;\n    schema: string;\n}\n\nexport const isEditDiagramV1 = (\n    diagram: EditDiagramUnknown\n): diagram is EditDiagramV1 => {\n    return \"version\" in diagram === false;\n};\n","import { EditDiagramUnknown } from \"./edit\";\nimport { EditDiagramV1 } from \"./edit-v1\";\n\nexport interface EditDiagramV2 extends EditDiagramV1 {\n    type: \"edit\";\n    version: 2;\n}\n\nexport const isEditDiagramV2 = (\n    diagram: EditDiagramUnknown\n): diagram is EditDiagramV2 => {\n    return \"version\" in diagram && diagram.version === 2;\n};\n\nexport const migrateEditDiagramV1toV2 = (v1: EditDiagramV1): EditDiagramV2 => ({\n    ...v1,\n    type: \"edit\",\n    version: 2,\n});\n","export const ROW_HEIGHT = 24;\nexport const MAX_ROWS_COUNT = 50;\nexport const GRID_CELL = 16;\nexport const TABLE_CLIENT_WIDTH = GRID_CELL * 16;\n// Basically width of 2 columns\nexport const TABLE_BODY_WIDTH = TABLE_CLIENT_WIDTH - 16;\n// When expand (edit mode) Table will take 2xGRID_CELL each side\nexport const TABLE_MARGIN_SINGLE = GRID_CELL * 2 + GRID_CELL;\nexport const TABLE_MARGIN_DOUBLE = TABLE_MARGIN_SINGLE * 2;\nexport const TABLE_OFFSET_WIDTH = TABLE_CLIENT_WIDTH + TABLE_MARGIN_DOUBLE;\n\nexport const TABLE_ROW_CLASS = \"table-row\";\nexport const TABLE_ROW_SELECTOR = `.${TABLE_ROW_CLASS}`;\nexport const TABLE_COLUMN_CLASS = \"row-control\";\nexport const TABLE_COLUMN_SELECTOR = `.${TABLE_COLUMN_CLASS}`;\n","import { EditTable } from \"diagram/models/edit/edit\";\nimport { getTableElement } from \"./dom\";\nimport * as Constants from \"./constants\";\n\ninterface Size {\n    width: number;\n    height: number;\n}\n\nexport const getTableEstimatedSize = (table: EditTable): Size => {\n    // We hide rows when there are more\n    const count = table.isRowsExpand\n        ? table.value.rows.length\n        : Math.min(table.value.rows.length, Constants.MAX_ROWS_COUNT + 1);\n    // Use an estimated value based on the number of rows (these values\n    // come from manually measuring the initial render)\n    return { width: Constants.TABLE_CLIENT_WIDTH, height: count * 24 + 64 };\n};\n\nexport const getTableSize = (table: EditTable): Size => {\n    // Try to get exact size if possible\n    try {\n        const element = getTableElement(table.id);\n        // Double check to avoid using one from previous diagram. This happens\n        // when import a new layout\n        if (element.dataset.name !== table.value.name)\n            throw Error(\"Outdated table from previous diagram\");\n        return { width: element.clientWidth, height: element.clientHeight };\n    } catch (e) {\n        // If can't find the element then use estimated size\n        // (This happens when the algo is run before rendering, like in import)\n        return getTableEstimatedSize(table);\n    }\n};\n\nexport const getRowHeight = (edgesToHereCount: number): number => {\n    const additionalHeight =\n        (edgesToHereCount - 1) * (Constants.ROW_HEIGHT / 2);\n    return Constants.ROW_HEIGHT + Math.max(additionalHeight, 0);\n};\n","import * as Const from \"app/dom/constants\";\nimport { getTableSize } from \"app/dom/size\";\nimport dagre from \"dagre\";\nimport { Position } from \"diagram/models/layout\";\nimport { LayoutDiagram } from \"./layout\";\n\nconst roundPoint = (num: number) => Math.round(num / 8) * 8;\nconst roundWidth = (num: number) =>\n    Math.ceil(num / Const.TABLE_OFFSET_WIDTH) * Const.TABLE_OFFSET_WIDTH;\n\nexport const applyDagreeLayout = (diagram: LayoutDiagram): LayoutDiagram => {\n    const g = new dagre.graphlib.Graph({ multigraph: true });\n    g.setGraph({\n        rankdir: \"LR\",\n        nodesep: Const.TABLE_MARGIN_DOUBLE,\n        ranksep: Const.TABLE_MARGIN_DOUBLE,\n        marginx: Const.TABLE_MARGIN_SINGLE,\n        marginy: Const.TABLE_MARGIN_SINGLE,\n    });\n    g.setDefaultEdgeLabel(() => ({}));\n\n    // nodes\n    diagram.tables.forEach((table) => {\n        const { width, height } = getTableSize(table);\n        g.setNode(table.id.toString(), { label: \"\", width, height });\n    });\n\n    // edges\n    diagram.refs.forEach((ref) => {\n        g.setEdge(ref.from.table.toString(), ref.to.table.toString());\n    });\n\n    dagre.layout(g);\n\n    return {\n        tables: diagram.tables.map((prev) => {\n            const box = g.node(prev.id.toString()); // @TODO check undefined?\n            // Note that dagre's x y is center, not top left\n            const position: Position = { top: 0, left: 0 };\n            position.top = roundPoint(box.y - box.height / 2);\n            position.left = roundPoint(box.x - box.width / 2);\n            return { ...prev, position };\n        }),\n        refs: diagram.refs,\n        size: {\n            width: roundWidth(g.graph().width ?? -1), // @TODO throw Error?\n            height: roundPoint(g.graph().height ?? -1),\n        },\n    };\n};\n","import { TABLE_OFFSET_WIDTH } from \"app/dom/constants\";\nimport { LayoutDiagram } from \"./layout\";\n\ninterface Position {\n    top: number;\n    left: number;\n}\n\ninterface AppendPosition {\n    top: number;\n    leftIndex: number;\n}\n\nexport interface MasonryNode {\n    id: number;\n    width: number;\n    height: number;\n}\n\nexport type MasonryMap = Map<number, Position>;\n\nconst area = (node: MasonryNode) => node.height * node.width;\n\n// Try to make a 2:1 rectangle\nconst getColumnCount = (nodes: MasonryNode[]): number => {\n    // Should be bigger than the biggest node's width\n    const minWidth = nodes.reduce((max, node) => {\n        return max > node.width ? max : node.width;\n    }, -Infinity);\n    // Total area\n    const totalArea = nodes.reduce((sum, node) => sum + area(node), 0);\n    const expectedWidth = Math.sqrt(totalArea / 2) * 2;\n    const width = Math.max(expectedWidth, minWidth);\n    // 1 column is TABLE_OFFSET_WIDTH px wide\n    return Math.ceil(width / TABLE_OFFSET_WIDTH);\n};\n\nexport const getMasonryLayout = (diagrams: LayoutDiagram[]): MasonryMap => {\n    const nodes: MasonryNode[] = diagrams.map((diagram) => ({\n        id: diagram.tables[0].id,\n        width: diagram.size.width,\n        height: diagram.size.height,\n    }));\n\n    const columnsCount = getColumnCount(nodes);\n    const tops = Array(columnsCount).fill(0);\n    const positions = new Map<number, Position>();\n\n    // Max top is the actual top if a target of \"width\" is put at \"start\"\n    const getRangeMaxTop = (start: number, columns: number): number => {\n        if (start + columns > tops.length) return Infinity;\n        let max = -Infinity;\n        for (let i = 0; i < columns; i++) {\n            const top = tops[start + i];\n            max = Math.max(top, max);\n        }\n        return max;\n    };\n\n    const getAppendPosition = (columns: number): AppendPosition => {\n        // Actual top if put target at \"index\"\n        const candidates = tops.map((_top, index) => {\n            const height = getRangeMaxTop(index, columns);\n            return { leftIndex: index, top: height };\n        });\n        // Pick the one with smallest top\n        return candidates.reduce((prev, current) =>\n            current.top < prev.top ? current : prev\n        );\n    };\n\n    const appendTarget = (target: MasonryNode) => {\n        const columns = target.width / TABLE_OFFSET_WIDTH;\n        const position = getAppendPosition(columns);\n        // Update \"tops\" map\n        const newHeight = position.top + target.height;\n        for (let i = 0; i < columns; i++) {\n            tops[position.leftIndex + i] = newHeight;\n        }\n        // Set position\n        positions.set(target.id, {\n            left: position.leftIndex * TABLE_OFFSET_WIDTH,\n            top: position.top,\n        });\n    };\n\n    nodes\n        .sort((a, b) => area(b) - area(a)) // Put big table first\n        .forEach(appendTarget);\n    return positions;\n};\n","import {\n    TABLE_MARGIN_DOUBLE as MARGIN_DOUBLE,\n    TABLE_MARGIN_SINGLE as MARGIN_SINGLE,\n} from \"app/dom/constants\";\nimport { EditDiagram, EditTable } from \"diagram/models/edit/edit\";\nimport { Position } from \"diagram/models/layout\";\nimport { LayoutDiagram } from \"./layout\";\nimport { MasonryMap } from \"./masonry\";\n\ninterface Params {\n    originalDiagram: EditDiagram;\n    diagrams: LayoutDiagram[];\n    masonry: MasonryMap;\n}\n\ninterface Size {\n    width: number;\n    height: number;\n}\n\nconst getSize = ({ diagrams, masonry }: Params): Size => {\n    let [width, height] = [0, 0];\n    diagrams.forEach((diagram) => {\n        const position = masonry.get(diagram.tables[0].id);\n        if (position === undefined) throw Error(`position is undefined`);\n        const right = position.left + diagram.size.width;\n        width = Math.max(width, right);\n        const bottom = position.top + diagram.size.height;\n        height = Math.max(height, bottom);\n    });\n    [width, height] = [width + MARGIN_DOUBLE, height + MARGIN_DOUBLE];\n\n    // Scrollbar is 16 - 20px\n    width = Math.max(window.screen.availWidth - 20, width);\n    height = Math.max(window.screen.availHeight, height);\n\n    return { width, height };\n};\n\nconst getTables = (params: Params): EditTable[] => {\n    const tables: EditTable[] = [];\n    params.diagrams.forEach((diagram) => {\n        const translate = params.masonry.get(diagram.tables[0].id);\n        if (translate === undefined) throw Error(\"translate is undefined\");\n        diagram.tables.forEach((prev) => {\n            const position: Position = {\n                top: translate.top + prev.position.top + MARGIN_SINGLE,\n                left: translate.left + prev.position.left + MARGIN_SINGLE,\n            };\n            tables.push({ ...prev, position });\n        });\n    });\n    if (tables.length === params.originalDiagram.tables.length) return tables;\n    throw Error(\"new tables and old tables have different length\");\n};\n\nexport const mergeDiagram = (params: Params): EditDiagram => ({\n    type: \"edit\",\n    version: params.originalDiagram.version,\n    columns: params.originalDiagram.columns,\n    tables: getTables(params),\n    refs: params.originalDiagram.refs,\n    size: getSize(params),\n    schema: params.originalDiagram.schema,\n});\n","import { EditDiagram, EditRef, EditTable } from \"diagram/models/edit/edit\";\nimport { applyDagreeLayout } from \"./dagree\";\nimport { LayoutDiagram } from \"./layout\";\n\ninterface State {\n    diagram: LayoutDiagram;\n    done: Map<number, boolean>;\n    tableMap: Map<number, EditTable>;\n    refMap: Map<number, EditRef[]>;\n}\n\nconst pushTableToDiagram = (state: State, table: EditTable): void => {\n    const { diagram, done, refMap, tableMap } = state;\n    if (done.get(table.id) === true) return;\n    diagram.tables.push(table);\n    refMap.get(table.id)?.forEach((ref) => {\n        if (diagram.refs.includes(ref)) return;\n        diagram.refs.push(ref);\n    });\n    done.set(table.id, true);\n    (refMap.get(table.id) ?? []).forEach((ref) => {\n        const fromTable = tableMap.get(ref.from.table);\n        const toTable = tableMap.get(ref.to.table);\n        if (fromTable === undefined || toTable === undefined)\n            throw Error(`\"fromTable\" or \"toTable\" is undefined`);\n        pushTableToDiagram(state, fromTable);\n        pushTableToDiagram(state, toTable);\n    });\n};\n\n/**\n * Split a Diagram into a group of diagrams where each diagram only contains\n * nodes that are connected to each other (from one node can go to another).\n */\nexport const splitDiagram = (bigDiagram: EditDiagram): LayoutDiagram[] => {\n    // Sub diagrams split from bigDiagram\n    const diagrams: LayoutDiagram[] = [];\n    // Tables that are put into a sub diagram\n    const done = new Map<number, boolean>();\n\n    // Table id to instance for quick reference\n    const tableMap = new Map<number, EditTable>();\n    bigDiagram.tables.forEach((table) => {\n        tableMap.set(table.id, table);\n    });\n\n    // Table id to related refs for quick reference\n    const refMap = new Map<number, EditRef[]>();\n    bigDiagram.refs.forEach((ref) => {\n        const [from, to] = [ref.from.table, ref.to.table];\n        refMap.set(from, (refMap.get(from) ?? []).concat(ref));\n        refMap.set(to, (refMap.get(to) ?? []).concat(ref));\n    });\n\n    bigDiagram.tables.forEach((table) => {\n        if (done.get(table.id) === true) return;\n        const size = { width: 0, height: 0 }; // Will provide later\n        const diagram: LayoutDiagram = { tables: [], refs: [], size };\n        pushTableToDiagram({ diagram, done, tableMap, refMap }, table);\n        diagrams.push(diagram);\n    });\n\n    diagrams.forEach((diagram) => {\n        applyDagreeLayout(diagram);\n    });\n\n    return diagrams;\n};\n","import * as Edit from \"diagram/models/edit/edit\";\nimport { Size } from \"diagram/models/layout\";\nimport { applyDagreeLayout } from \"./dagree\";\nimport { getMasonryLayout } from \"./masonry\";\nimport { mergeDiagram } from \"./merge\";\nimport { splitDiagram } from \"./split\";\n\n/**\n * Like EditDiagram but only contains enough data for layout purpose. Most\n * notably there is no \"columns\".\n */\nexport interface LayoutDiagram {\n    refs: Edit.EditRef[];\n    tables: Edit.EditTable[];\n    size: Size;\n}\n\n// Split -> Dagree -> Masonry -> Merge\nexport const applyAutoLayout = (\n    originalDiagram: Edit.EditDiagram\n): Edit.EditDiagram => {\n    // Split the diagram into sub diagrams\n    let diagrams = splitDiagram(originalDiagram);\n    // Arrange each diagram with dagree\n    diagrams = diagrams.map(applyDagreeLayout);\n    // Arrange sub diagrams into a big canvas\n    const masonry = getMasonryLayout(diagrams);\n    // Merge sub diagrams back into one diagram\n    return mergeDiagram({ originalDiagram, masonry, diagrams });\n};\n","import { applyAutoLayout } from \"diagram/layout/layout\";\nimport * as Base from \"diagram/models/base/base\";\nimport * as Edit from \"diagram/models/edit/edit\";\n\n// Prepared maps from table's [name, schema] to EDIT ids to speed up EditRef\n// conversion\ntype Ids = { table: number; rows: Map<string, number> };\ntype IdsMap = Map<string, Ids>; // string here is \"<schema> . <name>\"\n\nconst makeIdsMap = (\n    fallbackSchema: string,\n    tables: Edit.EditTable[]\n): IdsMap => {\n    const idsMap = new Map<string, Ids>();\n    tables.forEach((table) => {\n        const rows = new Map<string, number>();\n        table.value.rows.forEach((row) => void rows.set(row.value.id, row.id));\n        const schema = table.value.schema ?? fallbackSchema;\n        const tuple = `${schema} . ${table.value.name}`;\n        idsMap.set(tuple, { table: table.id, rows });\n    });\n    return idsMap;\n};\n\nconst makeRefSide = (\n    fallbackSchema: string,\n    map: IdsMap,\n    side: Base.BaseRefSide\n): Edit.EditRefSide => {\n    const schema = side.schema ?? fallbackSchema;\n    const ids = map.get(`${schema} . ${side.name}`);\n    if (ids === undefined) throw Error(`Table Ids \"${side.name}\" not found`);\n    const rows = side.rows.map((editId) => {\n        const realId = ids.rows.get(editId);\n        if (realId === undefined) throw Error(`Row id \"${editId}\" not found`);\n        return realId;\n    });\n    return { table: ids.table, rows };\n};\n\nconst makeTable = (base: Base.BaseItem, index: number): Edit.EditTable => {\n    const rows = base.rows.map((value, id) => ({ id, value }));\n    const { name, id, schema } = base;\n    const value: Edit.EditTableValue = { rows, name, id, schema };\n    const position = { top: 0, left: 0 }; // we will provide below\n    return { value, position, id: index, isRowsExpand: false };\n};\n\nconst makeColumn = (base: Base.BaseColumn, index: number): Edit.EditColumn => {\n    return { id: index, value: base };\n};\n\nconst makeRef = (schema: string, idsMap: IdsMap) => {\n    return (base: Base.BaseRef, index: number): Edit.EditRef => ({\n        id: index,\n        from: makeRefSide(schema, idsMap, base.from),\n        to: makeRefSide(schema, idsMap, base.to),\n    });\n};\n\nexport const makeEditDiagramFromBase = (\n    base: Base.BaseDiagram\n): Edit.EditDiagram => {\n    const schema = base.schema;\n    const tables: Edit.EditTable[] = base.items.map(makeTable);\n    const edit: Edit.EditDiagram = {\n        type: \"edit\",\n        version: base.version,\n        schema,\n        tables,\n        refs: (() => {\n            const idsMap = makeIdsMap(schema, tables);\n            return base.refs.map(makeRef(schema, idsMap));\n        })(),\n        columns: base.columns.map(makeColumn),\n        size: { width: 0, height: 0 },\n    };\n    return applyAutoLayout(edit);\n};\n","import * as Base from \"diagram/models/base/base\";\nimport * as Edit from \"diagram/models/edit/edit\";\nimport { DiagramUnknown } from \"diagram/models/unknown/unknown\";\nimport { decodeText } from \"utils/encode\";\nimport { makeEditDiagramFromBase } from \"./base\";\n\nconst importObject = (diagram: DiagramUnknown): Edit.EditDiagram => {\n    if (Base.isBaseDiagramUknown(diagram)) {\n        const latest = Base.migrateBaseDiagram(diagram);\n        return makeEditDiagramFromBase(latest);\n    }\n    if (Edit.isEditDiagramUknown(diagram)) {\n        return Edit.migrateEditDiagram(diagram);\n    }\n    throw Error(\"Diagram is neither Base or Edit type\");\n};\n\nconst importJson = (json: string): Edit.EditDiagram => {\n    const object = JSON.parse(json);\n    return importObject(object);\n};\n\nconst importBase64 = (base64: string): Edit.EditDiagram => {\n    const json = decodeText(base64);\n    return importJson(json);\n};\n\nexport const importDiagram = (source: unknown): Edit.EditDiagram => {\n    if (typeof source === \"string\") {\n        if (source.startsWith(\"{\")) {\n            return importJson(source);\n        } else {\n            return importBase64(source);\n        }\n    } else if (typeof source === \"object\") {\n        return importObject(source as DiagramUnknown);\n    }\n    throw Error(\"Unknown diagram type\");\n};\n","import { EditDiagram } from \"diagram/models/edit/edit\";\nimport { makeEditDiagramFromBase } from \"diagram/import/base\";\n\nexport const emptyDiagram: EditDiagram = makeEditDiagramFromBase({\n    type: \"base\",\n    version: 2,\n    columns: [\n        { id: \"0\", name: \"name\", type: \"string\" },\n        { id: \"1\", name: \"type\", type: \"string\" },\n        { id: \"2\", name: \"nullable\", type: \"boolean\" },\n    ],\n    schema: \"main\",\n    items: [],\n    refs: [],\n});\n\nexport const fallbackDiagram: EditDiagram = makeEditDiagramFromBase({\n    type: \"base\",\n    version: 2,\n    columns: [\n        { id: \"0\", name: \"name\", type: \"string\" },\n        { id: \"1\", name: \"type\", type: \"string\" },\n        { id: \"2\", name: \"nullable\", type: \"boolean\" },\n    ],\n    items: [\n        {\n            id: \"table\",\n            name: \"Bookings\",\n            schema: \"new\",\n            rows: [\n                { id: \"column\", name: \"book_ref\", type: \"char(6)\" },\n                {\n                    id: \"column_2\",\n                    name: \"book_date\",\n                    type: \"timestamptz\",\n                },\n                {\n                    id: \"column_3\",\n                    name: \"total_amount\",\n                    type: \"numeric(10,2)\",\n                },\n            ],\n        },\n        {\n            id: \"table_2\",\n            name: \"Tickets\",\n            schema: \"new\",\n            rows: [\n                { id: \"column\", name: \"ticket_no\", type: \"char(13)\" },\n                { id: \"column_2\", name: \"book_ref\", type: \"char(6)\" },\n                {\n                    id: \"column_3\",\n                    name: \"passenger_id\",\n                    type: \"varchar(20)\",\n                },\n                { id: \"column_4\", name: \"passenger_name\", type: \"text\" },\n                { id: \"column_5\", name: \"contact_data\", type: \"jsonb\" },\n            ],\n        },\n        {\n            id: \"table_3\",\n            name: \"Ticket_flights\",\n            schema: \"new\",\n            rows: [\n                { id: \"column\", name: \"ticket_no\", type: \"char(13)\" },\n                { id: \"column_2\", name: \"flight_id\", type: \"integer\" },\n                {\n                    id: \"column_3\",\n                    name: \"fare_conditions\",\n                    type: \"varchar(10)\",\n                },\n                { id: \"column_4\", name: \"amount\", type: \"numeric(10,2)\" },\n            ],\n        },\n        {\n            id: \"table_4\",\n            name: \"Boarding_passes\",\n            schema: \"new\",\n            rows: [\n                { id: \"column\", name: \"ticket_no\", type: \"char(13)\" },\n                { id: \"column_2\", name: \"flight_id\", type: \"integer\" },\n                { id: \"column_3\", name: \"boarding_no\", type: \"integer\" },\n                { id: \"column_4\", name: \"seat_no\", type: \"varchar(4)\" },\n            ],\n        },\n        {\n            id: \"table_5\",\n            name: \"Flights\",\n            schema: \"new\",\n            rows: [\n                { id: \"column\", name: \"flight_id\", type: \"serial\" },\n                { id: \"column_2\", name: \"flight_no\", type: \"char(6)\" },\n                {\n                    id: \"column_3\",\n                    name: \"scheduled_departure\",\n                    type: \"timestamptz\",\n                },\n                {\n                    id: \"column_4\",\n                    name: \"scheduled_arrival\",\n                    type: \"timestamptz\",\n                },\n                {\n                    id: \"column_5\",\n                    name: \"departure_airport\",\n                    type: \"char(3)\",\n                },\n                {\n                    id: \"column_6\",\n                    name: \"arrival_airport\",\n                    type: \"char(3)\",\n                },\n                { id: \"column_7\", name: \"status\", type: \"varchar(20)\" },\n                {\n                    id: \"column_8\",\n                    name: \"aircraft_code\",\n                    type: \"char(3)\",\n                },\n                {\n                    id: \"column_9\",\n                    name: \"actual_departure\",\n                    type: \"timestamptz\",\n                },\n                {\n                    id: \"column_10\",\n                    name: \"actual_arrival\",\n                    type: \"timestamptz\",\n                },\n            ],\n        },\n        {\n            id: \"table_6\",\n            name: \"Airports\",\n            schema: \"new\",\n            rows: [\n                { id: \"column\", name: \"airport_code\", type: \"char(3)\" },\n                { id: \"column_2\", name: \"airport_name\", type: \"text\" },\n                { id: \"column_3\", name: \"city\", type: \"text\" },\n                { id: \"column_4\", name: \"coordinates\", type: \"point\" },\n                { id: \"column_5\", name: \"timezone\", type: \"text\" },\n            ],\n        },\n        {\n            id: \"table_7\",\n            name: \"Aircrafts\",\n            schema: \"new\",\n            rows: [\n                { id: \"column\", name: \"aircraft_code\", type: \"char(3)\" },\n                { id: \"column_2\", name: \"model\", type: \"text\" },\n                { id: \"column_3\", name: \"range\", type: \"integer\" },\n            ],\n        },\n        {\n            id: \"table_8\",\n            name: \"Seats\",\n            schema: \"new\",\n            rows: [\n                { id: \"column\", name: \"aircraft_code\", type: \"char(3)\" },\n                { id: \"column_2\", name: \"seat_no\", type: \"varchar(4)\" },\n                {\n                    id: \"column_3\",\n                    name: \"fare_conditions\",\n                    type: \"varchar(10)\",\n                },\n            ],\n        },\n    ],\n    refs: [\n        {\n            from: {\n                name: \"Tickets\",\n                schema: \"new\",\n                rows: [\"column_2\"],\n            },\n            to: { name: \"Bookings\", schema: \"new\", rows: [\"column\"] },\n        },\n        {\n            from: {\n                name: \"Ticket_flights\",\n                schema: \"new\",\n                rows: [\"column\"],\n            },\n            to: { name: \"Tickets\", schema: \"new\", rows: [\"column\"] },\n        },\n        {\n            from: {\n                name: \"Boarding_passes\",\n                schema: \"new\",\n                rows: [\"column\", \"column_2\"],\n            },\n            to: {\n                name: \"Ticket_flights\",\n                schema: \"new\",\n                rows: [\"column\", \"column_2\"],\n            },\n        },\n        {\n            from: {\n                name: \"Ticket_flights\",\n                schema: \"new\",\n                rows: [\"column_2\"],\n            },\n            to: { name: \"Flights\", schema: \"new\", rows: [\"column\"] },\n        },\n        {\n            from: {\n                name: \"Flights\",\n                schema: \"new\",\n                rows: [\"column_5\"],\n            },\n            to: { name: \"Airports\", schema: \"new\", rows: [\"column\"] },\n        },\n        {\n            from: {\n                name: \"Flights\",\n                schema: \"new\",\n                rows: [\"column_8\"],\n            },\n            to: { name: \"Aircrafts\", schema: \"new\", rows: [\"column\"] },\n        },\n        {\n            from: { name: \"Seats\", schema: \"new\", rows: [\"column\"] },\n            to: { name: \"Aircrafts\", schema: \"new\", rows: [\"column\"] },\n        },\n        {\n            from: {\n                name: \"Flights\",\n                schema: \"new\",\n                rows: [\"column_6\"],\n            },\n            to: { name: \"Airports\", schema: \"new\", rows: [\"column\"] },\n        },\n    ],\n    schema: \"main\",\n});\n","import { exportDiagram, ExportTextOptions } from \"diagram/export/export\";\nimport { importDiagram } from \"diagram/import/import\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport { getStringId } from \"diagram/reducer/id\";\nimport { showConfirm } from \"@moai/core\";\nimport { Platform } from \"utils/platform\";\nimport { emptyDiagram, fallbackDiagram } from \"./fallback\";\nimport { DEFAULT_DIAGRAM_NAME, Library } from \"./state\";\n\ntype Dispatch = React.Dispatch<React.SetStateAction<Library>>;\n\nconst DOC_PREFIX = \"dg/doc/\";\n\nconst getStorageKey = (id: string): string => `${DOC_PREFIX}${id}`;\n\n// Get\n\nexport const getLibraryDiagram = (name: string): EditDiagram | null => {\n    const key = getStorageKey(name);\n    const stored = window.localStorage.getItem(key);\n    if (stored === null) return null;\n    return importDiagram(stored);\n};\n\n// Set\n\nexport const setLibraryDiagram = (diagram: EditDiagram, id: string): void => {\n    type Options = ExportTextOptions;\n    const options: Options = { type: \"text\", level: \"edit\", format: \"json\" };\n    const value = exportDiagram(diagram, options);\n    const key = getStorageKey(id);\n    window.localStorage.setItem(key, value.value);\n};\n\n// Create\n\nconst createInStorage = (diagram: EditDiagram): string => {\n    const names = getAllLibraryDiagrams();\n    const name = getStringId(names, \"Untitled\");\n    setLibraryDiagram(diagram, name);\n    return name;\n};\n\nconst createUpdater = (name: string) => (prev: Library): Library => ({\n    current: name,\n    all: [name, ...prev.all],\n});\n\nexport const createLibraryDiagram = (\n    diagram: EditDiagram,\n    dispatch: Dispatch\n): void => {\n    const name = createInStorage(diagram);\n    dispatch(createUpdater(name));\n};\n\n// Duplicate\n\nexport const duplicateLibraryDiagram = (\n    from: string,\n    prevAll: string[],\n    dispatch: Dispatch\n): void => {\n    const diagram = getLibraryDiagram(from);\n    if (diagram === null) throw Error(`Diagram \"${from}\" is null`);\n    const to = getStringId(prevAll, from);\n    const fromIndex = prevAll.indexOf(from);\n    if (fromIndex === -1) throw Error(`Diagram \"${from}\" not found`);\n    const nextAll = [...prevAll];\n    nextAll.splice(fromIndex + 1, 0, to);\n    setLibraryDiagram(diagram, to);\n    dispatch((prev) => ({ ...prev, all: nextAll }));\n};\n\n// Delete\n\nconst deleteUpdater = (name: string) => (prev: Library): Library => {\n    const all = prev.all.filter((n) => n !== name);\n    return { ...prev, all };\n};\n\nconst deleteInStorage = (name: string): void => {\n    window.localStorage.removeItem(getStorageKey(name));\n};\n\nexport const deleteLibraryDiagram = (\n    name: string,\n    dispatch: Dispatch\n): void => {\n    deleteInStorage(name);\n    dispatch(deleteUpdater(name));\n};\n\n// Rename\n\nconst renameInStorage = async (\n    fromName: string,\n    toName: string\n): Promise<boolean> => {\n    const toValue = getLibraryDiagram(toName);\n    if (toValue !== null) {\n        const sure = await showConfirm(`Do you want to override \"${toName}\"?`);\n        if (sure === false) return false;\n    }\n    const fromValue = getLibraryDiagram(fromName);\n    if (fromValue === null) throw Error(`No diagram at \"${fromName}\"`);\n    setLibraryDiagram(fromValue, toName);\n    deleteInStorage(fromName);\n    return true;\n};\n\nconst renameUpdater = (from: string, to: string) => {\n    return (prev: Library): Library => {\n        const current = prev.current === from ? to : prev.current;\n        const index = prev.all.indexOf(from);\n        if (index === -1) throw Error(`\"${from}\" not found`);\n        let all: string[];\n        if (prev.all.includes(to)) {\n            all = prev.all.filter((name) => name !== from);\n        } else {\n            all = [...prev.all];\n            all[index] = to;\n        }\n        return { current, all };\n    };\n};\n\nexport const renameLibraryDiagram = async (\n    dispatch: Dispatch,\n    fromName: string,\n    toName: string\n): Promise<void> => {\n    const renamed = await renameInStorage(fromName, toName);\n    if (renamed) dispatch(renameUpdater(fromName, toName));\n};\n\n// List\n\nexport const getAllLibraryDiagrams = (): string[] => {\n    const list = Object.keys(window.localStorage)\n        .filter((key) => key.startsWith(DOC_PREFIX))\n        .map((key) => key.replace(DOC_PREFIX, \"\"));\n    if (list.length === 0) list.push(DEFAULT_DIAGRAM_NAME);\n    return list;\n};\n\n// Initial\n\nexport const getInitialLibraryDiagram = (\n    platform: Platform,\n    id: string\n): EditDiagram => {\n    // Desktop apps should not have initial diagram\n    if (platform !== \"web\") return emptyDiagram;\n    const stored = getLibraryDiagram(id);\n    if (stored !== null) return stored;\n    // Previous version (pre-Library era)\n    const legacy = window.localStorage.getItem(\"diagram\");\n    if (legacy !== null) return importDiagram(legacy);\n    // Default\n    return fallbackDiagram;\n};\n\n// Open\n\nconst openUpdater = (name: string) => (prev: Library): Library => ({\n    ...prev,\n    current: name,\n});\n\nexport const openLibraryDiagram = (\n    name: string,\n    dispatch: Dispatch\n): EditDiagram => {\n    const diagram = getLibraryDiagram(name);\n    if (diagram === null) throw Error(`Diagram not found \"${name}\"`);\n    dispatch(openUpdater(name));\n    return diagram;\n};\n","import * as React from \"react\";\nimport { Platform, usePlatform } from \"utils/platform\";\nimport { getAllLibraryDiagrams } from \"./actions\";\n\n/* Notes:\n\n1. Desktop apps should not remember last opened diagram i.e. no get \"current\"\n   from storage). Note that we still set it so error report knows\n*/\n\nexport interface Library {\n    current: string;\n    all: string[];\n}\n\nexport const CURRENT_DIAGRAM_KEY = \"dg/current\";\nexport const DEFAULT_DIAGRAM_NAME = \"Untitled\";\n\nconst getInitialCurrent = (platform: Platform): string => {\n    if (platform !== \"web\") return DEFAULT_DIAGRAM_NAME; // 1\n    const stored = window.localStorage.getItem(CURRENT_DIAGRAM_KEY);\n    return stored ?? DEFAULT_DIAGRAM_NAME;\n};\n\nconst getInitialState = (platform: Platform): Library => ({\n    current: getInitialCurrent(platform),\n    all: getAllLibraryDiagrams(),\n});\n\nexport interface LibraryProps {\n    library: Library;\n    setLibrary: React.Dispatch<React.SetStateAction<Library>>;\n}\n\nconst titleSuffix = \"Diagram by TablePlus\";\n\nexport const useDiagramLibrary = (): LibraryProps => {\n    const platform = usePlatform();\n\n    const state = React.useState<Library>(getInitialState(platform));\n    const [library, setLibrary] = state;\n    const { current } = library;\n\n    // Save \"current\" state\n    React.useEffect(() => {\n        window.localStorage.setItem(CURRENT_DIAGRAM_KEY, current); // Note 1\n    }, [current]);\n\n    // Update document's title following \"current\"\n    React.useEffect(() => {\n        const prefix = current === null ? \"\" : `${current} | `;\n        document.title = `${prefix}${titleSuffix}`;\n    }, [current]);\n\n    return { library, setLibrary };\n};\n","import { Border, Button, DivPx, TextArea } from \"@moai/core\";\nimport * as React from \"react\";\nimport { globalLogger } from \"utils/external\";\nimport { usePlatform } from \"utils/platform\";\nimport { ReportItem, ReportItemState, useReportItem } from \"../item/item\";\nimport s from \"./form.module.css\";\nimport { APP_VERSION } from \"utils/version\";\nimport {\n    CURRENT_DIAGRAM_KEY,\n    DEFAULT_DIAGRAM_NAME,\n} from \"diagram/library/state\";\nimport { showAlert } from \"@moai/core\";\n\nexport type ReportType = \"uncaught\" | \"manual\";\n\nexport interface ReportFormProps {\n    type: ReportType;\n    title: string;\n    description: React.ReactNode;\n    footer?: React.ReactNode;\n    error?: any;\n    onDone?: () => void;\n}\n\nconst getDiagram = (): string => {\n    const name = window.localStorage.getItem(CURRENT_DIAGRAM_KEY);\n    const key = `dg/doc/${name ?? DEFAULT_DIAGRAM_NAME}`;\n    return window.localStorage.getItem(key) ?? \"Not found\";\n};\n\ninterface ReportBody {\n    title: string;\n    platform: string;\n    version: string;\n    error?: string;\n    message?: string;\n    contact?: string;\n    agent?: string;\n    diagram?: string;\n    log?: string;\n}\n\nconst getItem = (state: ReportItemState): string | undefined =>\n    state.has ? state.text : undefined;\n\nconst getError = (error: any): string => {\n    if (!error) return \"\";\n    return `${error}\\n${error.stack}`;\n};\n\nexport const ReportForm = (props: ReportFormProps) => {\n    const isUncaught = props.type === \"uncaught\";\n\n    const message = useReportItem(() => \"\");\n    const contact = useReportItem(() => \"\");\n    const error = useReportItem(() => getError(props.error));\n    const log = useReportItem(() => JSON.stringify(globalLogger));\n    const diagram = useReportItem(() => getDiagram());\n    const agent = useReportItem(() => window.navigator.userAgent);\n    const platform = usePlatform();\n    const [isBusy, setIsBusy] = React.useState(false);\n\n    const submitReport = async (event: React.FormEvent) => {\n        event.preventDefault();\n        setIsBusy(true);\n        const body: ReportBody = {\n            title: isUncaught ? \"Uncaught error\" : \"Manual report\",\n            platform,\n            version: APP_VERSION,\n            error: getItem(error),\n            message: getItem(message),\n            contact: getItem(contact),\n            agent: getItem(agent),\n            diagram: getItem(diagram),\n            log: getItem(log),\n        };\n        await window.fetch(\"https://diagramplus.com/api/report\", {\n            method: \"POST\",\n            body: JSON.stringify(body),\n            headers: { \"Content-type\": \"application/json\" },\n        });\n        showAlert(\"The report has been sent successfully\");\n        setIsBusy(false);\n        props.onDone?.();\n    };\n\n    return (\n        <form onSubmit={(event) => submitReport(event)}>\n            <h1 className={s.title}>{props.title}</h1>\n            <DivPx size={16} />\n            <Border color=\"weak\" />\n            <DivPx size={16} />\n            {props.description}\n            <TextArea\n                autoFocus\n                rows={3}\n                value={message.text}\n                setValue={message.setText}\n            />\n            <DivPx size={16} />\n            {isUncaught && (\n                <>\n                    <ReportItem label=\"Include error detail\" state={error} />\n                    <DivPx size={8} />\n                </>\n            )}\n            <ReportItem label=\"Include the diagram\" state={diagram} />\n            <DivPx size={8} />\n            <ReportItem label=\"Include user agent\" state={agent} />\n            <DivPx size={8} />\n            <ReportItem label=\"Include application log\" state={log} />\n            <DivPx size={8} />\n            <ReportItem\n                state={contact}\n                label=\"Allow us to contact you at:\"\n                placeholder=\"name@example.com\"\n            />\n            <DivPx size={16} />\n            <Border color=\"weak\" />\n            <DivPx size={16} />\n            <div className={s.footer}>\n                {props.footer}\n                <DivPx size={16} />\n                <Button\n                    type=\"submit\"\n                    highlight\n                    children=\"Send Report\"\n                    isBusy={isBusy}\n                />\n            </div>\n        </form>\n    );\n};\n","const BREAKING_VERSION = \"6\";\n\n/**\n * Temporary safe lock to avoid compatible issues\n */\nexport const initVersionControl = () => {\n    const prev = window.localStorage.getItem(\"version\");\n    if (prev === BREAKING_VERSION) return;\n    window.localStorage.clear();\n    window.localStorage.setItem(\"version\", BREAKING_VERSION);\n};\n\nexport const APP_VERSION = \"15\";\n","import { background, borderColor, boxShadow } from \"@moai/core\";\nimport * as React from \"react\";\nimport { ReportForm, ReportFormProps } from \"./form/form\";\nimport s from \"./report.module.css\";\n\ninterface Props extends ReportFormProps {\n    onClickOutside?: () => void;\n}\n\nexport const ErrorReport = (props: Props) => (\n    <div className={s.container}>\n        <div className={[s.backdrop, background.secondary].join(\" \")} />\n        <div\n            className={s.main}\n            onClick={(event) => {\n                if (event.target !== event.currentTarget) return;\n                props.onClickOutside?.();\n            }}\n        >\n            <div\n                className={[\n                    s.body,\n                    borderColor.strong,\n                    background.primary,\n                    boxShadow.strong,\n                ].join(\" \")}\n            >\n                <ReportForm {...props} />\n            </div>\n        </div>\n    </div>\n);\n","import { Button, DivPx, Paragraph } from \"@moai/core\";\nimport { ErrorReport } from \"app/app/error/report/report\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nexport const useHeaderReport = () => {\n    const [reportVisible, setReportVisible] = React.useState(false);\n    React.useEffect(() => {\n        const listener = (event: KeyboardEvent) => {\n            if (!event.metaKey && !event.ctrlKey) return;\n            if (event.key !== \"e\") return;\n            setReportVisible((bool) => !bool);\n        };\n        document.addEventListener(\"keydown\", listener);\n        return () => document.removeEventListener(\"keydown\", listener);\n    }, []);\n    return { reportVisible, setReportVisible };\n};\n\nconst Description = () => (\n    <>\n        <Paragraph>\n            Thank you for helping us improve the app. We will treat your report\n            as confidential and anonymous.\n        </Paragraph>\n        <DivPx size={8} />\n        <Paragraph>\n            Please describe the issue, including any steps to reproduce it:\n        </Paragraph>\n        <DivPx size={8} />\n    </>\n);\n\nconst Footer = (props: { cancel: () => void }) => (\n    <Button onClick={() => props.cancel()} children=\"Cancel\" />\n);\n\ninterface Props {\n    reportVisible: boolean;\n    setReportVisible: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nexport const HeaderReportDialog = (props: Props) => {\n    if (props.reportVisible === false) return null;\n    const portalContainer = document.getElementById(\"portals\");\n    if (portalContainer === null) throw Error(\"#portals is null\");\n    const closeReport = () => props.setReportVisible(false);\n    return ReactDOM.createPortal(\n        <ErrorReport\n            type=\"manual\"\n            title=\"Report an Issue\"\n            description={<Description />}\n            footer={<Footer cancel={closeReport} />}\n            onDone={closeReport}\n            onClickOutside={closeReport}\n        />,\n        portalContainer\n    );\n};\n","import { Checkbox } from \"@moai/core\";\nimport { PrefsProps } from \"pref/pref\";\nimport * as React from \"react\";\n\ninterface Props extends PrefsProps {}\n\nexport const HeaderAnimation = (props: Props) => (\n    <Checkbox\n        value={props.prefs.edgeAnimation}\n        setValue={(value) =>\n            props.setPrefs((prev) => ({ ...prev, edgeAnimation: value }))\n        }\n        children=\"Show animation on highlighted arrows\"\n    />\n);\n","import { Checkbox } from \"@moai/core\";\nimport { PrefsProps } from \"pref/pref\";\nimport * as React from \"react\";\n\ninterface Props extends PrefsProps {}\n\nexport const HeaderFooter = (props: Props) => (\n    <Checkbox\n        value={props.prefs.footerVisible}\n        setValue={(value) =>\n            props.setPrefs((prev) => ({ ...prev, footerVisible: value }))\n        }\n        children=\"Show footer\"\n    />\n);\n","import { Button } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport React from \"react\";\nimport { HeaderChildProps } from \"../../header\";\n\ninterface Props extends HeaderChildProps {\n    setReportVisible: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nexport const HeaderReportButton = (props: Props) => (\n    <Button\n        onClick={() => props.setReportVisible(true)}\n        size={props.size.button}\n        style={props.style.button}\n        icon={icons.issue}\n        children=\"Report issue\"\n    />\n);\n","import { Switcher, SwitcherOption } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { PrefsProps } from \"pref/pref\";\nimport { Theme } from \"pref/theme\";\nimport React from \"react\";\nimport { HeaderChildProps } from \"../../header\";\n\nconst options: SwitcherOption<Theme>[] = [\n    { value: \"light\", label: \"Light\", icon: icons.flash, key: \"light\" },\n    { value: \"auto\", label: \"System\", key: \"auto\" },\n    { value: \"dark\", label: \"Dark\", icon: icons.moon, key: \"dark\" },\n];\n\ninterface Props extends HeaderChildProps, PrefsProps {}\n\nexport const HeaderTheme = (props: Props) => (\n    <Switcher<Theme>\n        value={props.prefs.theme}\n        setValue={(theme) => props.setPrefs((prev) => ({ ...prev, theme }))}\n        options={options}\n        size={props.size.button}\n        style={props.style.button}\n    />\n);\n","import { DivGrow, DivPx } from \"@moai/core\";\nimport { PrefsProps } from \"pref/pref\";\nimport * as React from \"react\";\nimport { Platform, usePlatform } from \"utils/platform\";\nimport { HeaderChildProps } from \"../header\";\nimport { HeaderBigDiv } from \"../utils/div\";\nimport { HeaderAnimation } from \"./animation/animation\";\nimport { HeaderFooter } from \"./footer/footer\";\nimport { HeaderReportButton } from \"./report/report\";\nimport sBase from \"./style/base.module.scss\";\nimport sMac from \"./style/mac.module.scss\";\nimport sWin from \"./style/win.module.scss\";\nimport { HeaderTheme } from \"./theme/theme\";\n\nexport interface HeaderSecondaryProps extends HeaderChildProps, PrefsProps {\n    setReportVisible: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst getContainerClass = (platform: Platform): string => {\n    const cls = [sBase.container];\n    if (platform === \"mac\") cls.push(sMac.container);\n    if (platform === \"win\") cls.push(sWin.container);\n    return cls.join(\" \");\n};\n\nexport const HeaderSecondary = (props: HeaderSecondaryProps) => {\n    const platform = usePlatform();\n    return (\n        <div className={getContainerClass(platform)}>\n            <DivPx size={16} />\n            {platform === \"web\" && (\n                <>\n                    <HeaderTheme {...props} />\n                    <HeaderBigDiv />\n                </>\n            )}\n            <HeaderAnimation {...props} />\n            <DivPx size={16} />\n            {platform === \"web\" && (\n                <>\n                    <HeaderFooter {...props} />\n                </>\n            )}\n            <DivGrow />\n            <HeaderReportButton\n                setReportVisible={props.setReportVisible}\n                size={props.size}\n                style={props.style}\n            />\n            <DivPx size={16} />\n        </div>\n    );\n};\n","import { Border } from \"@moai/core\";\nimport * as React from \"react\";\nimport { Platform, usePlatform } from \"utils/platform\";\nimport { HeaderPrimary, HeaderPrimaryProps } from \"./primary/primary\";\nimport { HeaderReportDialog, useHeaderReport } from \"./report/report\";\nimport { HeaderSecondary, HeaderSecondaryProps } from \"./secondary/secondary\";\nimport sBase from \"./style/base.module.scss\";\nimport sMac from \"./style/mac.module.scss\";\nimport sWin from \"./style/win.module.scss\";\nimport { getHeaderSize, HeaderSize } from \"./utils/size\";\nimport { getHeaderStyle, HeaderStyle } from \"./utils/style\";\n\ntype PrimaryProps = Omit<\n    HeaderPrimaryProps,\n    \"isHeaderExpand\" | \"setIsHeaderExpand\" | \"size\"\n>;\n\nexport interface HeaderChildProps {\n    size: HeaderSize;\n    style: HeaderStyle;\n}\n\ntype SecondaryProps = Omit<HeaderSecondaryProps, \"\">;\n\ntype Props = Omit<\n    PrimaryProps & SecondaryProps,\n    \"style\" | \"size\" | \"setReportVisible\"\n>;\n\nconst getPlatformClasses = (platform: Platform) => {\n    const s = platform === \"mac\" ? sMac : platform === \"win\" ? sWin : null;\n    return {\n        container: [sBase.container, s?.container ?? \"\"].join(\" \"),\n        borderStrong: [sBase.borderStrong, s?.borderStrong ?? \"\"].join(\" \"),\n        borderWeak: [sBase.borderWeak, s?.borderWeak ?? \"\"].join(\" \"),\n    };\n};\n\nconst HeaderPure = (props: Props) => {\n    const [isExpand, setIsExpand] = React.useState(false);\n    const platform = usePlatform();\n    const size = getHeaderSize(platform);\n    const style = getHeaderStyle(platform);\n    const { reportVisible, setReportVisible } = useHeaderReport();\n    const classes = getPlatformClasses(platform);\n    return (\n        <div className={classes.container}>\n            <HeaderPrimary\n                {...props}\n                isHeaderExpand={isExpand}\n                setIsHeaderExpand={setIsExpand}\n                size={size}\n                style={style}\n            />\n            {isExpand && (\n                <>\n                    <div className={classes.borderWeak}>\n                        <Border color=\"weak\" />\n                    </div>\n                    <HeaderSecondary\n                        {...props}\n                        setReportVisible={setReportVisible}\n                        size={size}\n                        style={style}\n                    />\n                </>\n            )}\n            <HeaderReportDialog\n                reportVisible={reportVisible}\n                setReportVisible={setReportVisible}\n            />\n            <div className={classes.borderStrong}>\n                <Border color=\"strong\" />\n            </div>\n        </div>\n    );\n};\n\nexport const Header = React.memo(HeaderPure);\n","import * as Moai from \"@moai/core\";\nimport { Platform } from \"utils/platform\";\n\nexport interface HeaderSize {\n    button: Moai.ButtonSize;\n    input: Moai.InputSize;\n    select: Moai.SelectSize;\n}\n\nexport const getHeaderSize = (platform: Platform): HeaderSize => {\n    switch (platform) {\n        case \"mac\":\n            return {\n                button: Moai.Button.size.small,\n                input: Moai.Input.size.small,\n                select: Moai.Select.size.small,\n            };\n        default:\n            return {\n                button: Moai.Button.size.medium,\n                input: Moai.Input.size.medium,\n                select: Moai.Select.size.medium,\n            };\n    }\n};\n","import * as Moai from \"@moai/core\";\nimport { Platform } from \"utils/platform\";\n\nexport interface HeaderStyle {\n    button: Moai.ButtonStyle;\n    input: Moai.InputStyle;\n    select: Moai.SelectStyle;\n}\n\nexport const getHeaderStyle = (platform: Platform): HeaderStyle => {\n    switch (platform) {\n        // case \"win\":\n        //     return {\n        //         button: Moai.Button.style.flat,\n        //         input: Moai.Input.style.flat,\n        //         select: Moai.Select.style.flat,\n        //     };\n        default:\n            return {\n                button: Moai.Button.style.outset,\n                input: Moai.Input.style.outset,\n                select: Moai.Select.style.outset,\n            };\n    }\n};\n","import React from \"react\";\nimport { useDragLayer, DragLayerMonitor } from \"react-dnd\";\nimport { icons } from \"@moai/icon\";\nimport { Icon } from \"@moai/core\";\nimport s from \"./layer.module.scss\";\nimport { RowDragItem } from \"../drag\";\nimport { debugLog } from \"utils/debug\";\n\ninterface DraggingProps {\n    item: RowDragItem;\n    top: number;\n    left: number;\n}\n\nconst collect = (monitor: DragLayerMonitor): DraggingProps | null => {\n    if (!monitor.isDragging()) return null;\n    if (monitor.getItemType() !== \"row\") return null;\n    const offset = monitor.getClientOffset();\n    const item = monitor.getItem();\n    if (item === null || offset === null) return null;\n    return { item, top: offset.y, left: offset.x };\n};\n\ninterface InitialState {\n    scrollLeft: number;\n    scrollTop: number;\n    top: number;\n    left: number;\n}\n\ninterface Props {\n    viewportRef: React.RefObject<HTMLDivElement>;\n}\n\nconst getInitialState = (\n    viewportRef: React.RefObject<HTMLDivElement>,\n    sourceRef: React.RefObject<HTMLDivElement>\n): InitialState => {\n    const viewport = viewportRef.current;\n    if (viewport === null) throw Error(\"Viewport is not defined\");\n    const source = sourceRef.current;\n    if (source === null) throw Error(\"Source drag is not defined\");\n    const box = source.getBoundingClientRect();\n    const [top, left] = [box.top + box.height / 2, box.left + box.width / 2];\n    const { scrollTop, scrollLeft } = viewport;\n    return { top, left, scrollTop, scrollLeft };\n};\n\nconst ToIconPure = ({ top, left }: { top: number; left: number }) => (\n    <div style={{ color: \"var(--accent-2)\" }}>\n        <div className={s.icon} style={{ top: top - 8, left: left - 8 }}>\n            <Icon path={icons.locate} size={16} />\n        </div>\n    </div>\n);\n\nconst ToIcon = React.memo(ToIconPure);\n\nconst RowDragLayerPure = (props: Props) => {\n    debugLog(\"RowDragLayer\");\n\n    const dragging = useDragLayer(collect);\n    const initialRef = React.useRef<InitialState | null>(null);\n\n    // Reset initial state based on is dragging or not\n    const dragTargetRef = dragging?.item.elementRef;\n    const { viewportRef } = props;\n    React.useEffect(() => {\n        initialRef.current =\n            dragTargetRef === undefined\n                ? null\n                : getInitialState(viewportRef, dragTargetRef);\n    }, [viewportRef, dragTargetRef]);\n\n    const initial = initialRef.current;\n    if (dragging === null || initial === null) return null;\n    const viewport = props.viewportRef.current;\n    if (viewport === null) throw Error(\"viewport is not defined\");\n\n    const diffLeft = viewport.scrollLeft - initial.scrollLeft;\n    const diffTop = viewport.scrollTop - initial.scrollTop;\n\n    return (\n        <div className={s.container}>\n            <svg className={s.svg}>\n                <line\n                    className={s.line}\n                    x1={initial.left - diffLeft}\n                    y1={initial.top - diffTop}\n                    x2={dragging.left}\n                    y2={dragging.top}\n                />\n            </svg>\n            <ToIcon top={dragging.top} left={dragging.left} />\n        </div>\n    );\n};\n\nexport const RowDragLayer = React.memo(RowDragLayerPure);\n","import { EditColumn, EditTable, EditRow } from \"diagram/models/edit/edit\";\nimport { DiagramReducer } from \"../reducer\";\nimport { getStringId, getNumberId } from \"../id\";\nimport { BaseColumn } from \"diagram/models/base/base\";\n\nexport interface AddRowPayload {\n    tableId: number;\n}\n\ntype Payload = AddRowPayload;\n\nconst defaultFields: Map<BaseColumn[\"type\"], string> = new Map();\ndefaultFields.set(\"boolean\", \"FALSE\");\ndefaultFields.set(\"string\", \"\");\n\nconst getRowField = (column: EditColumn): string => {\n    const field = defaultFields.get(column.value.type);\n    if (field !== undefined) return field;\n    throw Error(`Unknown column type \"${column.value.type}\"`);\n};\n\nexport const getDefaultRow = (\n    columns: EditColumn[],\n    rows: EditRow[]\n): EditRow => {\n    // 1. Provide ids for a row. A row has 2 unique ids:\n    // 1.1. row.id: the id of an EditRow, use in the app to edit the diagram\n    const id: number = getNumberId(rows.map((r) => r.id));\n    // 1.2. row.value.id: the id of a BaseRow, use when import and export the\n    //    diagram\n    const allValueIds: string[] = rows.map((r) => r.value.id);\n    const valueId: string = getStringId(allValueIds, \"column\");\n    // Note that there is also row.value[column[0].value] which is the id in\n    // user's perspective, but for us it's just a field\n\n    // 2. Provide fields based on columns\n    const value: EditRow[\"value\"] = { id: valueId };\n    columns.forEach((column, index) => {\n        // First column is special case: the \"id\" in user's perspective, so it's\n        // better to have a meaningful string here to start with\n        value[column.value.name] = index === 0 ? valueId : getRowField(column);\n    });\n\n    return { id, value };\n};\n\nconst updateTable = (payload: Payload, columns: EditColumn[]) => {\n    return (table: EditTable): EditTable => {\n        if (table.id !== payload.tableId) return table;\n        const row = getDefaultRow(columns, table.value.rows);\n        const rows = table.value.rows.concat(row);\n        return { ...table, value: { ...table.value, rows } };\n    };\n};\n\nexport const addRow: DiagramReducer<Payload> = (diagram, payload) => {\n    const update = updateTable(payload, diagram.columns);\n    return { ...diagram, tables: diagram.tables.map(update) };\n};\n","import { debugLog } from \"utils/debug\";\nimport React from \"react\";\n\nexport interface UndoState<S> {\n    past: S[];\n    present: S;\n    future: S[];\n}\n\nexport type UndoAction = { type: \"undo\" } | { type: \"redo\" };\n\nexport const createUndoInitial = <S>(initial: S): UndoState<S> => ({\n    past: [],\n    present: initial,\n    future: [],\n});\n\ntype Action = { type: string };\n\nexport const createUndoReducer = <S, A extends Action>(\n    orgReducer: React.Reducer<S, A>\n) => (prev: UndoState<S>, action: UndoAction | A): UndoState<S> => {\n    switch (action.type) {\n        case \"undo\": {\n            const [present, ...past] = prev.past;\n            const future = [prev.present, ...prev.future];\n            return { past, present, future };\n        }\n        case \"redo\": {\n            const [present, ...future] = prev.future;\n            const past = [prev.present, ...prev.past];\n            return { past, present, future };\n        }\n        default: {\n            debugLog(\"Undo create new past\");\n            const present = orgReducer(prev.present, action as any);\n            let past = [prev.present, ...prev.past];\n            past = past.length < 20 ? past : past.slice(0, 20);\n            return { past, present, future: [] };\n        }\n    }\n};\n","import { TABLE_CLIENT_WIDTH, TABLE_MARGIN_DOUBLE } from \"app/dom/constants\";\nimport * as Edit from \"diagram/models/edit/edit\";\nimport { Size, Position } from \"diagram/models/layout\";\nimport { getNumberId, getStringId } from \"../id\";\nimport { DiagramReducer } from \"../reducer\";\nimport { getDefaultRow } from \"../row/add\";\n\nexport interface AddTablePayload {\n    id?: number;\n}\n\ntype Payload = AddTablePayload;\n\nconst toMaxLeft = (prev: number, table: Edit.EditTable) =>\n    Math.max(table.position.left, prev);\n\nconst leftToRight = TABLE_CLIENT_WIDTH + TABLE_MARGIN_DOUBLE;\n\n// For now we will just put it on the right side of the most right table\nexport const getTableNewPosition = (tables: Edit.EditTable[]): Position => {\n    const maxLeft = tables.reduce(toMaxLeft, 0);\n    return { top: TABLE_MARGIN_DOUBLE, left: maxLeft + leftToRight };\n};\n\nconst getNewSize = (size: Size, position: Position): Size => {\n    const width = Math.max(size.width, position.left + leftToRight);\n    return width === size.width ? size : { ...size, width };\n};\n\nexport const addTable: DiagramReducer<Payload> = (diagram, payload) => {\n    // value\n    const valueIds = diagram.tables.map((table) => table.value.id);\n    const name = getStringId(valueIds, \"table\");\n    const row = getDefaultRow(diagram.columns, []);\n    // edit table\n    const table: Edit.EditTable = {\n        id: payload.id ?? getNumberId(diagram.tables.map((table) => table.id)),\n        value: { name, id: name, schema: \"new\", rows: [row] },\n        position: getTableNewPosition(diagram.tables),\n        isRowsExpand: false,\n    };\n    return {\n        ...diagram,\n        tables: diagram.tables.concat(table),\n        size: getNewSize(diagram.size, table.position),\n    };\n};\n","import { DiagramReducer } from \"../reducer\";\nimport { importDiagram } from \"diagram/import/import\";\nimport { appendDiagram } from \"./append\";\n\nexport interface ImportPayload {\n    isAppend: boolean;\n    source: unknown;\n}\n\nexport type DiagramImportActions = { type: \"import\"; payload: ImportPayload };\n\nexport const diagramImportReducer: DiagramReducer = (prev, action) => {\n    switch (action.type) {\n        case \"import\":\n            const next = importDiagram(action.payload.source);\n            if (action.payload.isAppend === false) return next;\n            return appendDiagram(prev, next);\n        default:\n            return prev;\n    }\n};\n","import { TABLE_MARGIN_DOUBLE } from \"app/dom/constants\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport { Position, Size } from \"diagram/models/layout\";\nimport { getNumberId } from \"../id\";\nimport { getTableNewPosition } from \"../table/add\";\n\nexport const appendDiagram = (\n    original: EditDiagram,\n    target: EditDiagram\n): EditDiagram => {\n    if (original.columns.length !== target.columns.length)\n        throw Error(\"Cannot merge diagrams with different columns\");\n\n    const ids = original.tables.map((t) => t.id);\n\n    // @TODO should not have this fix\n    const offset = getTableNewPosition(original.tables);\n    offset.top = offset.top - TABLE_MARGIN_DOUBLE;\n    offset.left = offset.left - TABLE_MARGIN_DOUBLE;\n\n    const tables = [...original.tables];\n    target.tables.forEach((table) => {\n        // @TODO this is slow because we need to create new ids everytime\n        // a faster way should be letting getId to accept Set\n        const id = getNumberId(ids);\n        ids.push(id); // Avoid using this id next time\n        const position: Position = {\n            top: table.position.top + offset.top,\n            left: table.position.left + offset.left,\n        };\n        tables.push({ ...table, id, position });\n    });\n\n    const width = offset.left + target.size.width;\n    const size: Size = { ...original.size, width };\n    return { ...original, tables, size };\n};\n","import { DiagramReducer } from \"../reducer\";\n\nexport interface RemoveRefPayload {\n    id: number;\n}\n\nexport interface RemoveMultipleRefsPayload {\n    ids: number[];\n}\n\ntype Payload = RemoveRefPayload;\ntype MultiplePayload = RemoveMultipleRefsPayload;\n\nexport const removeRef: DiagramReducer<Payload> = (diagram, payload) => {\n    const refs = diagram.refs.filter((ref) => ref.id !== payload.id);\n    return { ...diagram, refs };\n};\n\ntype MultipleReducer = DiagramReducer<MultiplePayload>;\nexport const removeMultipleRefs: MultipleReducer = (diagram, payload) => {\n    let next = diagram;\n    payload.ids.forEach((id) => {\n        next = removeRef(next, { id });\n    });\n    return next;\n};\n","import { DiagramReducer } from \"../reducer\";\nimport { addRef, AddRefPayload } from \"./add\";\nimport {\n    removeMultipleRefs,\n    RemoveMultipleRefsPayload,\n    removeRef,\n    RemoveRefPayload,\n} from \"./remove\";\n\nexport type DiagramRefActions =\n    | { type: \"add-ref\"; payload: AddRefPayload }\n    | { type: \"remove-ref\"; payload: RemoveRefPayload }\n    | { type: \"remove-multiple-refs\"; payload: RemoveMultipleRefsPayload };\n\nexport const diagramRefReducer: DiagramReducer = (diagram, action) => {\n    switch (action.type) {\n        case \"add-ref\":\n            return addRef(diagram, action.payload);\n        case \"remove-ref\":\n            return removeRef(diagram, action.payload);\n        case \"remove-multiple-refs\":\n            return removeMultipleRefs(diagram, action.payload);\n        default:\n            return diagram;\n    }\n};\n","import { EditRef } from \"diagram/models/edit/edit\";\nimport { DiagramReducer } from \"../reducer\";\nimport { getNumberId } from \"../id\";\n\nexport interface AddRefSide {\n    table: number;\n    rows: number[];\n}\n\nexport interface AddRefPayload {\n    from: AddRefSide;\n    to: AddRefSide;\n}\n\ntype Payload = AddRefPayload;\n\nconst isFromPayload = (ref: EditRef, payload: Payload): boolean =>\n    ref.from.table === payload.from.table &&\n    ref.from.rows.some((id) => payload.from.rows.includes(id));\n\nexport const addRef: DiagramReducer<Payload> = (diagram, payload) => {\n    // Must remove related ref(s) before adding the new one\n    const refs = diagram.refs.filter((ref) => !isFromPayload(ref, payload));\n    // New ref\n    const prevIds = diagram.refs.map((ref) => ref.id);\n    const ref = { ...payload, id: getNumberId(prevIds) };\n    refs.push(ref);\n    return { ...diagram, refs };\n};\n","import { EditRef, EditRefSide, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramReducer } from \"../reducer\";\n\nexport interface RemoveRowPayload {\n    tableId: number;\n    rowId: number;\n}\n\ntype Payload = RemoveRowPayload;\n\nconst isSideRelated = (payload: Payload, side: EditRefSide): boolean =>\n    side.table === payload.tableId && side.rows.includes(payload.rowId);\n\nconst isRelated = (payload: Payload, ref: EditRef): boolean =>\n    isSideRelated(payload, ref.from) || isSideRelated(payload, ref.to);\n\nconst updateTable = (payload: Payload) => (table: EditTable): EditTable => {\n    if (table.id !== payload.tableId) return table;\n    const rows = table.value.rows.filter((row) => row.id !== payload.rowId);\n    return { ...table, value: { ...table.value, rows } };\n};\n\nexport const removeRow: DiagramReducer<Payload> = (diagram, payload) => {\n    const tables = diagram.tables.map(updateTable(payload));\n    let refs = diagram.refs.filter((ref) => !isRelated(payload, ref));\n    if (refs.length === diagram.refs.length) refs = diagram.refs;\n    return { ...diagram, tables, refs };\n};\n","import { EditDiagram, EditRow, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramReducer } from \"../reducer\";\n\nexport interface UpdateRowPayload {\n    tableId: number;\n    rowId: number;\n    property: string;\n    value: string;\n}\n\ntype Payload = UpdateRowPayload;\n\nconst updateEditRow = (payload: Payload) => (row: EditRow): EditRow => {\n    if (row.id !== payload.rowId) return row;\n    const value = { ...row.value }; // EditRow.value or Diagram.Row\n    value[payload.property] = payload.value;\n    return { ...row, value };\n};\n\nconst updateTable = (payload: Payload) => (table: EditTable): EditTable => {\n    if (table.id !== payload.tableId) return table;\n    const rows = table.value.rows.map(updateEditRow(payload));\n    return { ...table, value: { ...table.value, rows } };\n};\n\nconst isSame = (diagram: EditDiagram, payload: Payload): boolean => {\n    const { tableId, rowId, property: attribute, value } = payload;\n    const row = diagram.tables\n        .find((table) => table.id === tableId) // table\n        ?.value.rows.find((row) => row.id === rowId); // row\n    if (!row) throw Error(`Row \"${tableId}.${rowId}\" not found`);\n    return row.value[attribute] === value;\n};\n\nexport const updateRow: DiagramReducer<Payload> = (diagram, payload) => {\n    if (isSame(diagram, payload)) return diagram;\n    const tables = diagram.tables.map(updateTable(payload));\n    return { ...diagram, tables };\n};\n","import { EditRef } from \"diagram/models/edit/edit\";\nimport { DiagramReducer } from \"../reducer\";\n\nexport interface RemoveTablePayload {\n    id: number;\n}\n\nexport interface RemoveMultipleTablesPayload {\n    ids: number[];\n}\n\ntype Payload = RemoveTablePayload;\ntype MultiplePayload = RemoveMultipleTablesPayload;\n\nconst isRelated = (payload: Payload, ref: EditRef): boolean =>\n    ref.from.table === payload.id || ref.to.table === payload.id;\n\nexport const removeTable: DiagramReducer<Payload> = (diagram, payload) => {\n    const tables = diagram.tables.filter((table) => table.id !== payload.id);\n    const refs = diagram.refs.filter((ref) => !isRelated(payload, ref));\n    return { ...diagram, tables, refs };\n};\n\ntype MultipleReducer = DiagramReducer<MultiplePayload>;\nexport const removeMultipleTables: MultipleReducer = (diagram, payload) => {\n    let next = diagram;\n    payload.ids.forEach((id) => {\n        next = removeTable(next, { id });\n    });\n    return next;\n};\n","import { EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramReducer } from \"../reducer\";\n\nexport interface UpdateTableNamePayload {\n    id: number;\n    name: string;\n}\n\ntype Payload = UpdateTableNamePayload;\n\nconst updateName = (payload: Payload) => (table: EditTable): EditTable => {\n    if (table.id !== payload.id) return table;\n    return { ...table, value: { ...table.value, name: payload.name } };\n};\n\nexport const updateTableName: DiagramReducer<Payload> = (diagram, payload) => {\n    const tables = diagram.tables.map(updateName(payload));\n    return { ...diagram, tables };\n};\n","import { DiagramReducer } from \"../reducer\";\nimport { addTable, AddTablePayload } from \"./add\";\nimport { setTablePosition, SetTablePositionPayload } from \"./position\";\nimport { removeMultipleTables, RemoveMultipleTablesPayload, removeTable, RemoveTablePayload } from \"./remove\"; // prettier-ignore\nimport { updateTableName, UpdateTableNamePayload } from \"./update-name\";\nimport { SetTableRowsExpandPayload, SetAllTablesRowsExpandPayload, setTableRowsExpand, setAllTablesRowsExpand } from \"./row\"; // prettier-ignore\nimport { duplicateTable, DuplicateTablePayload } from \"./duplicate\";\n\nexport type DiagramTableActions =\n    | { type: \"remove-table\"; payload: RemoveTablePayload }\n    | { type: \"remove-multiple-tables\"; payload: RemoveMultipleTablesPayload }\n    | { type: \"add-table\"; payload: AddTablePayload }\n    | { type: \"set-table-position\"; payload: SetTablePositionPayload }\n    | { type: \"set-table-rows-expand\"; payload: SetTableRowsExpandPayload }\n    | { type: \"set-all-tables-rows-expand\"; payload: SetAllTablesRowsExpandPayload } // prettier-ignore\n    | { type: \"duplicate-table\"; payload: DuplicateTablePayload }\n    | { type: \"update-table-name\"; payload: UpdateTableNamePayload };\n\nexport const diagramTableReducer: DiagramReducer = (diagram, action) => {\n    switch (action.type) {\n        case \"add-table\":\n            return addTable(diagram, action.payload);\n        case \"remove-table\":\n            return removeTable(diagram, action.payload);\n        case \"remove-multiple-tables\":\n            return removeMultipleTables(diagram, action.payload);\n        case \"update-table-name\":\n            return updateTableName(diagram, action.payload);\n        case \"set-table-position\":\n            return setTablePosition(diagram, action.payload);\n        case \"set-table-rows-expand\":\n            return setTableRowsExpand(diagram, action.payload);\n        case \"set-all-tables-rows-expand\":\n            return setAllTablesRowsExpand(diagram, action.payload);\n        case \"duplicate-table\":\n            return duplicateTable(diagram, action.payload);\n        default:\n            return diagram;\n    }\n};\n","import { Position } from \"diagram/models/layout\";\nimport { DiagramReducer } from \"../reducer\";\n\nexport interface SetTablePositionPayload {\n    id: number;\n    position: Position;\n}\n\ntype Reducer = DiagramReducer<SetTablePositionPayload>;\n\nexport const setTablePosition: Reducer = (diagram, payload) => ({\n    ...diagram,\n    tables: diagram.tables.map((table) => {\n        if (table.id !== payload.id) return table;\n        return { ...table, position: payload.position };\n    }),\n});\n","import { DiagramReducer } from \"../reducer\";\n\nexport interface SetTableRowsExpandPayload {\n    id: number;\n    isExpand: boolean;\n}\n\nexport type SetAllTablesRowsExpandPayload = boolean;\n\ntype Reducer = DiagramReducer<SetTableRowsExpandPayload>;\nexport const setTableRowsExpand: Reducer = (diagram, payload) => {\n    const tables = diagram.tables.map((table) => {\n        if (table.id !== payload.id) return table;\n        return { ...table, isRowsExpand: payload.isExpand };\n    });\n    return { ...diagram, tables };\n};\n\ntype AllReducer = DiagramReducer<SetAllTablesRowsExpandPayload>;\nexport const setAllTablesRowsExpand: AllReducer = (diagram, payload) => {\n    const tables = diagram.tables.map((table) => {\n        return { ...table, isRowsExpand: payload };\n    });\n    return { ...diagram, tables };\n};\n","import { TABLE_OFFSET_WIDTH } from \"app/dom/constants\";\nimport * as Edit from \"diagram/models/edit/edit\";\nimport { getNumberId, getStringId } from \"../id\";\nimport { DiagramReducer } from \"../reducer\";\n\nexport interface DuplicateTablePayload {\n    id: number;\n}\n\ntype Payload = DuplicateTablePayload;\n\nexport const duplicateTable: DiagramReducer<Payload> = (diagram, payload) => {\n    const prev = diagram.tables.find((t) => t.id === payload.id);\n    if (prev === undefined) throw Error(`Table \"${payload.id}\" not found`);\n    const allValueIds = diagram.tables.map((t) => t.value.id);\n    const next: Edit.EditTable = {\n        id: getNumberId(diagram.tables.map((t) => t.id)),\n        value: {\n            rows: prev.value.rows,\n            schema: prev.value.schema,\n            name: `${prev.value.name}_2`,\n            id: getStringId(allValueIds, \"table\"),\n        },\n        position: {\n            top: prev.position.top,\n            left: prev.position.left + TABLE_OFFSET_WIDTH,\n        },\n        isRowsExpand: false,\n    };\n\n    return { ...diagram, tables: diagram.tables.concat(next) };\n};\n","import { exportDiagram } from \"diagram/export/export\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport { ImportPayload } from \"diagram/reducer/import/import\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport React from \"react\";\nimport { addExternalFn, addExternalFnDirect } from \"utils/external\";\n\nconst registerJson = addExternalFn(\"importDiagramJSON\");\nconst registerObject = addExternalFn(\"importDiagramObject\");\nconst registerBase64 = addExternalFn(\"importDiagramBase64\");\n\nexport const useDiagramExternal = (\n    diagram: EditDiagram,\n    diagramDispatch: React.Dispatch<DiagramAction>\n) => {\n    React.useEffect(() => {\n        // Having 3 separated methods is only for backware-compatibility. The\n        // importDiagram can handle any format\n        const importDiagram = (source: unknown): void => {\n            const payload: ImportPayload = { source, isAppend: false };\n            diagramDispatch({ type: \"import\", payload });\n        };\n        registerJson(importDiagram);\n        registerObject(importDiagram);\n        registerBase64(importDiagram);\n    }, [diagramDispatch]);\n\n    React.useEffect(() => {\n        const bound = exportDiagram.bind(null, diagram);\n        addExternalFnDirect(\"exportDiagramBase\", () => {\n            return bound({ type: \"text\", level: \"base\", format: \"json\" });\n        });\n        addExternalFnDirect(\"exportDiagramEdit\", () => {\n            return bound({ type: \"text\", level: \"edit\", format: \"json\" });\n        });\n    }, [diagram]);\n};\n","import * as React from \"react\";\nimport { UndoAction } from \"./undo\";\n\ninterface Props {\n    past: any[];\n    future: any[];\n    dispatch: React.Dispatch<UndoAction>;\n}\n\nconst makeListener = (props: Props) => (event: KeyboardEvent) => {\n    if (event.target instanceof HTMLInputElement) return;\n    if (event.target instanceof HTMLTextAreaElement) return;\n    if (!event.ctrlKey && !event.metaKey) return;\n    // Redo on Ctrl + Y or Ctrl + Shift + Z\n    if (\n        event.key === \"y\" ||\n        (event.key === \"z\" && event.shiftKey) ||\n        event.key === \"Z\"\n    ) {\n        if (props.future.length === 0) return;\n        return props.dispatch({ type: \"redo\" });\n    }\n    // Undo on Ctrl + Z\n    if (event.key === \"z\") {\n        if (props.past.length === 0) return;\n        return props.dispatch({ type: \"undo\" });\n    }\n};\n\nexport const useDiagramUndoShortcut = (props: Props) => {\n    const { past, future, dispatch } = props;\n    React.useEffect(() => {\n        const listener = makeListener({ past, future, dispatch });\n        document.addEventListener(\"keydown\", listener);\n        return () => document.removeEventListener(\"keydown\", listener);\n    }, [past, future, dispatch]);\n};\n","import React from \"react\";\nimport { EditDiagram } from \"../models/edit/edit\";\nimport { DiagramAction, diagramReducer } from \"../reducer/reducer\";\nimport { useDiagramExternal } from \"./external/external\";\nimport { useDiagramUndoShortcut } from \"./undo/shortcut\";\nimport * as Undo from \"./undo/undo\";\n\nexport interface DiagramState {\n    history: Undo.UndoState<EditDiagram>;\n    dispatch: React.Dispatch<DiagramAction | Undo.UndoAction>;\n}\n\nconst undoReducer = Undo.createUndoReducer(diagramReducer);\n\nexport const useDiagram = (initial: EditDiagram): DiagramState => {\n    const [history, dispatch] = React.useReducer(undoReducer, undefined, () => {\n        return Undo.createUndoInitial(initial);\n    });\n    const { past, present, future } = history;\n    useDiagramExternal(present, dispatch);\n    useDiagramUndoShortcut({ past, future, dispatch });\n    return { history, dispatch };\n};\n","import { EditDiagram } from \"diagram/models/edit/edit\";\nimport { DiagramLayoutAction, diagramLayoutReducer } from \"./layout/layout\";\nimport { DiagramImportActions, diagramImportReducer } from \"./import/import\";\nimport { DiagramRefActions, diagramRefReducer } from \"./ref/ref\";\nimport { DiagramRowActions, diagramRowReducer } from \"./row/row\";\nimport { DiagramTableActions, diagramTableReducer } from \"./table/table\";\n\nexport type DiagramReducer<T = DiagramAction> = (\n    diagram: EditDiagram,\n    arg: T\n) => EditDiagram;\n\nexport type DiagramAction =\n    | DiagramTableActions\n    | DiagramRowActions\n    | DiagramRefActions\n    | DiagramLayoutAction\n    | DiagramImportActions;\n\nexport const diagramReducer: DiagramReducer = (prev, action) => {\n    let next = prev;\n    next = diagramTableReducer(next, action);\n    next = diagramRowReducer(next, action);\n    next = diagramRefReducer(next, action);\n    next = diagramImportReducer(next, action);\n    next = diagramLayoutReducer(next, action);\n    return next;\n};\n","import { DiagramReducer } from \"../reducer\";\nimport { addRow, AddRowPayload } from \"./add\";\nimport { removeRow, RemoveRowPayload } from \"./remove\";\nimport { updateRow, UpdateRowPayload } from \"./update\";\n\nexport type DiagramRowActions =\n    | { type: \"add-row\"; payload: AddRowPayload }\n    | { type: \"remove-row\"; payload: RemoveRowPayload }\n    | { type: \"update-row\"; payload: UpdateRowPayload }\n\nexport const diagramRowReducer: DiagramReducer = (diagram, action) => {\n    switch (action.type) {\n        case \"add-row\":\n            return addRow(diagram, action.payload);\n        case \"remove-row\":\n            return removeRow(diagram, action.payload);\n        case \"update-row\":\n            return updateRow(diagram, action.payload);\n        default:\n            return diagram;\n    }\n};\n","import { applyAutoLayout } from \"diagram/layout/layout\";\nimport { DiagramReducer } from \"../reducer\";\n\nexport interface SetDiagramLayoutPayload {\n    type: \"auto\";\n}\n\nexport type DiagramLayoutAction = {\n    type: \"set-layout\";\n    payload: SetDiagramLayoutPayload;\n};\n\nexport const diagramLayoutReducer: DiagramReducer = (diagram, action) => {\n    switch (action.type) {\n        case \"set-layout\":\n            switch (action.payload.type) {\n                case \"auto\":\n                    return applyAutoLayout(diagram);\n                default:\n                    return diagram;\n            }\n        default:\n            return diagram;\n    }\n};\n","import { SetSelectIds } from \"./select\";\n\ninterface Props {\n    refId: number;\n    setSelectIds: SetSelectIds;\n}\n\nexport const selectOnRefClick = (props: Props) => () => {\n    props.setSelectIds([{ type: \"ref\", value: props.refId }]);\n};\n","import { getRowElement, getTableElement } from \"app/dom/dom\";\nimport { EditEdge, EditEdgeSide, EditTable } from \"diagram/models/edit/edit\";\nimport { Position } from \"diagram/models/layout\";\n\nexport interface EdgeBox {\n    top: number;\n    left: number;\n    right: number;\n}\n\nexport interface EdgeBoxes {\n    from: EdgeBox[];\n    to: EdgeBox[];\n}\n\nconst getOffsetUntil = (target: HTMLElement, container: Element) => {\n    let [top, left, element] = [0, 0, target];\n    do {\n        [top, left] = [top + element.offsetTop, left + element.offsetLeft];\n        const parent = element.offsetParent;\n        if (!(parent instanceof HTMLElement)) break;\n        element = parent;\n    } while (element !== container);\n    return { top, left };\n};\n\nconst getEdgeSideBoxes = (\n    edge: EditEdgeSide,\n    tablePosition: Position\n): EdgeBox[] => {\n    const { top: tableTop, left: tableLeft } = tablePosition;\n    const table = getTableElement(edge.table);\n    return edge.rows.map((rowId) => {\n        const row = getRowElement(edge.table, rowId);\n        if (row !== null) {\n            // If row is rendered then use row\n            const { top: rowTop, left: rowLeft } = getOffsetUntil(row, table);\n            const top = rowTop + tableTop + row.clientHeight / 2;\n            const left = rowLeft + tableLeft;\n            return { top, left, right: left + row.clientWidth };\n        } else {\n            // If row is not rendered then use center of table\n            return {\n                top: tableTop + table.clientHeight / 2,\n                left: tableLeft,\n                right: tableLeft + table.clientWidth,\n            };\n        }\n    });\n};\n\ninterface Props {\n    edge: EditEdge;\n    fromTable: EditTable;\n    toTable: EditTable;\n}\n\nexport const getEdgeBoxes = (props: Props): EdgeBoxes => ({\n    from: getEdgeSideBoxes(props.edge.from, props.fromTable.position),\n    to: getEdgeSideBoxes(props.edge.to, props.toTable.position),\n});\n","import { getTableElement } from \"app/dom/dom\";\nimport { EditEdge } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\n\nconst mutationCb = (setChanged: () => void): MutationCallback => (records) => {\n    records.forEach((record) => {\n        if (record.type !== \"attributes\") return;\n        if (record.attributeName !== \"data-is-visible\") return;\n        setChanged();\n    });\n};\n\nconst resizeCb = (setChanged: () => void): ResizeObserverCallback => () => {\n    setChanged();\n};\n\nconst mutationInit = {\n    attributes: true, // Required for Edge\n    attributeFilter: [\"data-is-visible\"],\n};\n\nexport const useEdgeObserve = (edge: EditEdge): object => {\n    // Watch for non-react dependencies (e.g. DOM rendering)\n    const [changed, setChanged] = React.useState({});\n    React.useLayoutEffect(() => {\n        const from = getTableElement(edge.from.table);\n        const to = getTableElement(edge.to.table);\n        const set = () => setChanged({});\n        // resize\n        const resize = new window.ResizeObserver(resizeCb(set));\n        resize.observe(from);\n        resize.observe(to);\n        // mutation\n        const mutation = new MutationObserver(mutationCb(set));\n        mutation.observe(from, mutationInit);\n        mutation.observe(to, mutationInit);\n        return () => {\n            mutation.disconnect();\n            resize.disconnect();\n        };\n    }, [edge]);\n\n    return changed;\n};\n","/*\nThe code here comes from https://github.com/pgkelley4/line-segments-intersect\nwhich come from http://stackoverflow.com/a/565282/786339\nIt is modified to more suitable to DiagramPlus\n*/\n\ninterface Point {\n    x: number;\n    y: number;\n}\n\n/** Subtract the second point from the first. */\nexport const subtractPoints = (point1: Point, point2: Point): Point => ({\n    x: point1.x - point2.x,\n    y: point1.y - point2.y,\n});\n\n/** Add the second point to the first. */\nexport const addPoints = (point1: Point, point2: Point): Point => ({\n    x: point1.x + point2.x,\n    y: point1.y + point2.y,\n});\n\n/** Multiply point by a number */\nexport const multiplyPoint = (point: Point, i: number): Point => ({\n    x: point.x * i,\n    y: point.y * i,\n});\n\n/** Calculate the cross product of the two points. */\nconst crossProduct = (point1: Point, point2: Point): number => {\n    return point1.x * point2.y - point1.y * point2.x;\n};\n\n/**\n * Return the intersection point between 2 line segments, or null otherwise.\n * When the intersection is a segment instead of a line, consider it as null.\n */\nexport const getSegmentIntersection = (\n    p1: Point,\n    p2: Point,\n    q1: Point,\n    q2: Point\n): Point | null => {\n    const r = subtractPoints(p2, p1);\n    const s = subtractPoints(q2, q1);\n\n    const uNumerator = crossProduct(subtractPoints(q1, p1), r);\n    const denominator = crossProduct(r, s);\n\n    // Segments are collinear. Technically there can be no overlap, or the\n    // intersection will be a segment. However, under DiagramPlus's perspective\n    // we don't care about both\n    if (uNumerator === 0 && denominator === 0) return null;\n\n    // Segments are paralell.\n    if (denominator === 0) return null;\n\n    const u = uNumerator / denominator;\n    const t = crossProduct(subtractPoints(q1, p1), s) / denominator;\n\n    // Segments are not parallel but do not intersect.\n    if (t < 0 || t > 1 || u < 0 || u > 1) return null;\n\n    const addend = multiplyPoint(r, t);\n    const intersection = addPoints(p1, addend);\n    return intersection;\n};\n","import { addPoints, multiplyPoint, subtractPoints } from \"./segment\";\n\ninterface Point {\n    x: number;\n    y: number;\n}\n\nexport const getSegmentLength = (A: Point, B: Point): number => {\n    return Math.sqrt(Math.pow(A.x - B.x, 2) + Math.pow(A.y - B.y, 2));\n};\n\n/**\n * Split \"B\" into C and D where C and D are on AB line and CB = BD = len.\n * Returns [C, D] array.\n */\nexport const splitSegment = (\n    A: Point,\n    B: Point,\n    len: number\n): [Point, Point] => {\n    const dAB = getSegmentLength(A, B);\n    // B = A + 1 * r\n    const r = subtractPoints(B, A);\n    // C = A + t * r where t is AC / CB (%)\n    const dCB = len;\n    const t = 1 - dCB / dAB;\n    const C = addPoints(A, multiplyPoint(r, t));\n    // D = A + u * r similar to C\n    const u = 1 + dCB / dAB;\n    const D = addPoints(A, multiplyPoint(r, u));\n    return [C, D];\n};\n","import { getSegmentLength } from \"./split\";\n\ninterface Point {\n    x: number;\n    y: number;\n}\n\n/** Draw a circle arc from A to B */\nexport const getArc = (A: Point, B: Point): string => {\n    const radius = getSegmentLength(A, B) / 2;\n    return `A ${radius} ${radius} 0 0 1 ${B.x} ${B.y}`;\n};\n","import { GRID_CELL } from \"app/dom/constants\";\n/**\n * This module makes an edge \"jumps\" over others on intersection. In the figure\n * below, edge CD intersects edge AB at X. If CD is drawn later than AB then a\n * \"jump\" happen at X on CD:\n *\n * A >----+\n *        |\n * C >----X-----> D\n *        |\n *        +-----> B\n */\n\nimport { EditEdge } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\nimport { EdgePoint } from \"../point\";\nimport { getArc } from \"./arc\";\nimport { getSegmentIntersection } from \"./segment\";\nimport { getSegmentLength, splitSegment } from \"./split\";\n\nexport type EdgesPoints = Map<EditEdge[\"id\"], EdgePoint[]>;\n\ntype Ref = React.MutableRefObject<EdgesPoints>;\n\nexport const useEdgesPoints = (edges: EditEdge[]): Ref => {\n    const ref: Ref = React.useRef<EdgesPoints>(new Map());\n\n    // Remove not existed edges\n    React.useEffect(() => {\n        const edgesSet = new Set(edges.map((e) => e.id));\n        ref.current.forEach((_value, key) => {\n            if (edgesSet.has(key) === false) ref.current.delete(key);\n        });\n    }, [edges]);\n\n    return ref;\n};\n\nconst INTERSECTION_RADIUS = GRID_CELL / 4;\n\n/**\n * Draw a line segment from A to B. If the segment intersects with other\n * segments in EdgesPoints then a jump (arc) will be drawn at the intersection.\n *\n * Assume that the pointer is already at A\n */\nexport const getLineWithIntersection = (\n    edgesPoints: EdgesPoints,\n    edgeId: EditEdge[\"id\"],\n    A: EdgePoint,\n    B: EdgePoint\n): string => {\n    let P: EdgePoint = A; // Previous point\n    const edgesIds = [...edgesPoints.keys()];\n    const path: string[] = [];\n    for (let i = 0; i < edgesIds.length; i++) {\n        const id = edgesIds[i];\n        if (id === edgeId) {\n            // We stop here, as a line should not avoid lines added after it\n            break;\n        };\n        const points = edgesPoints.get(id)!;\n        for (let j = 0; j < points.length - 1; j++) {\n            // CD is current segment to be checked, E is the intersection\n            const [C, D] = [points[j], points[j + 1]];\n            const E = getSegmentIntersection(P, B, C, D);\n            if (E === null) continue;\n            // If intersection is too close, we also don't draw the arc\n            if (getSegmentLength(P, E) < INTERSECTION_RADIUS) continue;\n            if (getSegmentLength(B, E) < INTERSECTION_RADIUS) continue;\n            // Split Q to M and N to draw arc\n            const [M, N] = splitSegment(P, E, INTERSECTION_RADIUS);\n            path.push(`L ${M.x} ${M.y}`);\n            path.push(getArc(M, N));\n            // N is the new Previous point\n            P = N;\n        }\n    }\n    path.push(`L ${B.x} ${B.y}`);\n    return path.join(\" \");\n};\n","import { GRID_CELL } from \"app/dom/constants\";\nimport { EditEdge } from \"diagram/models/edit/edit\";\nimport { EdgesPoints, getLineWithIntersection } from \"./intersect/intersect\";\nimport { EdgePoint, EdgePoints } from \"./point\";\n\nexport interface EdgePath {\n    paths: string[];\n    length: number;\n}\n\ntype Point = EdgePoint;\n\nconst RADIUS = GRID_CELL / 2;\n\nconst getAnchorAxis = (A: Point, B: Point, key: keyof Point) => {\n    const [a, b] = [A[key], B[key]];\n    const r = Math.min(RADIUS, Math.abs(a - b) / 2);\n    if (a === b) return a;\n    return b + r * (a > b ? 1 : -1);\n};\n\nconst getAnchor = (A: Point, B: Point): Point => ({\n    x: getAnchorAxis(A, B, \"x\"),\n    y: getAnchorAxis(A, B, \"y\"),\n});\n\nconst isDiagonal = (A: Point, B: Point): boolean => B.x !== A.x && B.y !== A.y;\n\nconst pushPoint = (\n    props: Props,\n    points: Point[],\n    path: string[],\n    i: number\n): void => {\n    // PrevPoint (A) > CurrentPoint (B) > NextPoint (C)\n    const [A, B, C] = [points[i - 1], points[i], points[i + 1]];\n    // We only round 90deg corners\n    if (isDiagonal(A, B) || isDiagonal(B, C)) {\n        if (props.edgesPoints === null) {\n            path.push(`L ${B.x} ${B.y}`);\n        } else {\n            const ps = props.edgesPoints;\n            const line = getLineWithIntersection(ps, props.edge.id, A, B);\n            path.push(line);\n        }\n    } else {\n        // Round the corner\n        const [X, Y] = [getAnchor(A, B), getAnchor(C, B)];\n        // @TODO: Combine this with the above logic\n        if (props.edgesPoints === null) {\n            path.push(`L ${X.x} ${X.y}`);\n        } else {\n            const ps = props.edgesPoints;\n            const line = getLineWithIntersection(ps, props.edge.id, A, X);\n            path.push(line);\n        }\n        path.push(`Q ${B.x} ${B.y} ${Y.x} ${Y.y}`);\n        points[i] = Y;\n    }\n};\n\nconst getPathD = (props: Props, orgPoints: EdgePoint[]): string => {\n    if (orgPoints.length === 0) return \"\";\n    if (orgPoints.length === 1) throw Error(\"points.length must be 0 or 2+\");\n    const points = [...orgPoints];\n    const path = [`M ${points[0].x} ${points[0].y}`];\n    const last = points.length - 1;\n    for (let i = 1; i < last; i++) {\n        pushPoint(props, points, path, i);\n    }\n    path.push(`L ${points[last].x} ${points[last].y}`);\n    return path.join(\" \");\n};\n\nconst getPathLength = (points: EdgePoint[]): number =>\n    points.reduce((prev, point, index) => {\n        if (index === 0) return 0;\n        const { x: x1, y: y1 } = point;\n        const { x: x2, y: y2 } = points[index - 1];\n        return prev + Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n    }, 0);\n\nconst getPoints = (map: EdgePoints, index: number): Point[] => {\n    const { from, mid: C, to } = map;\n    // FromInner > FromOuter > Mid > ToOuter > ToInner\n    // A           B           C     D         E\n    const [A, E] = [from.inners[index], to.inners[index]];\n    const [B, D] = [from.outer, to.outer];\n    // Simple case where one row link to one row\n    const isSingle = A.x === B.x && D.x === E.x;\n    return isSingle ? [A, ...C, E] : [A, B, ...C, D, E];\n};\n\ninterface Props {\n    edge: EditEdge;\n    edgePoints: EdgePoints;\n    edgesPoints: EdgesPoints | null;\n}\n\nexport const getEdgePath = (props: Props): EdgePath => {\n    const { edge, edgePoints, edgesPoints } = props;\n    const { from, mid, to } = edgePoints;\n\n    const paths: string[] = from.inners.map((_, index) => {\n        const points = getPoints(edgePoints, index);\n        const path = getPathD(props, points);\n        edgesPoints?.set(edge.id, points);\n        return path;\n    });\n\n    const length: number = getPathLength([\n        from.inners[0],\n        ...mid,\n        to.inners[0],\n    ]);\n\n    return { paths, length };\n};\n","import { GRID_CELL, TABLE_MARGIN_SINGLE } from \"app/dom/constants\";\nimport { EditEdge } from \"diagram/models/edit/edit\";\nimport { EdgeBox, EdgeBoxes } from \"./box\";\nimport { avoidMidCollision, EdgesMids } from \"./split-x\";\nimport { RowYMap, getRowFreeY, getRowYMapId } from \"./split-y\";\n\n// TL;DR: From Box (top, left) to Point (x, y)!\n\nexport interface EdgePoint {\n    x: number;\n    y: number;\n}\n\ntype Side = \"left\" | \"right\";\n\n/**\n * Points of \"from\" and \"to\" (where an Edge starts and ends)\n *\n * Let's say a path is drawn from id1 and id2 rows (composite keys). In this\n * case, the path will start from B and C, then join at A, then go outside of\n * the table:\n *\n *       . . . . . . . . . . . . . .\n *       .\n *       .   |------------------|\n *       .   |    user table    |\n *       .   |------------------|\n *       A   B  id1       uuid  |\n *       .   C  id2       uuid  |\n *\n * A:       outer\n * B & C:   inners\n */\nexport interface EdgePointsEnd {\n    inners: EdgePoint[];\n    outer: EdgePoint;\n    side: Side;\n}\n\n/** A complete set of points to draw an Edge */\nexport interface EdgePoints {\n    from: EdgePointsEnd;\n    mid: EdgePoint[];\n    to: EdgePointsEnd;\n}\n\nconst toPoint = (side: Side) => (box: EdgeBox): EdgePoint => ({\n    x: side === \"left\" ? box.left : box.right,\n    y: box.top,\n});\n\nconst getOuterPoint = (inners: EdgePoint[], side: Side): EdgePoint => ({\n    x: inners[0].x + (side === \"right\" ? 1 : -1) * GRID_CELL,\n    y: inners.reduce((sum, point) => sum + point.y, 0) / inners.length,\n});\n\n/**\n * Decide which side of a table should we draw from. For simplicity this\n * returns EdgePoints but with empty \"mid\". The \"mid\" will be provide later.\n */\nconst getEndPoints = (props: {\n    rowYMap: RowYMap | null;\n    edge: EditEdge;\n    boxes: EdgeBoxes;\n}): Omit<EdgePoints, \"mid\"> => {\n    const { rowYMap, edge, boxes } = props;\n\n    const SAFE_SPACE = TABLE_MARGIN_SINGLE;\n    // Horizontal-wise, we only need to compare one row\n    const [from, to] = [boxes.from[0], boxes.to[0]];\n    let [fromSide, toSide]: Side[] = [\"right\", \"right\"];\n    if (from.right <= to.left - SAFE_SPACE) {\n        [fromSide, toSide] = [\"right\", \"left\"];\n    } else if (from.left >= to.right + SAFE_SPACE) {\n        [fromSide, toSide] = [\"left\", \"right\"];\n    }\n    const fromInners = boxes.from.map(toPoint(fromSide));\n    const fromOuter = getOuterPoint(fromInners, fromSide);\n    let toInners = boxes.to.map(toPoint(toSide));\n    // HEADS UP! Should apply collision preventation for ToInnerPoints\n    if (rowYMap !== null) {\n        toInners = toInners.map((point, index) => {\n            const rowYId = getRowYMapId(edge.to.table, edge.to.rows[index]);\n            const edgeId = edge.id;\n            const y = getRowFreeY({ rowYMap, rowYId, edgeId, y: point.y });\n            return { x: point.x, y };\n        });\n    }\n    const toOuter = getOuterPoint(toInners, toSide);\n    return {\n        from: { inners: fromInners, side: fromSide, outer: fromOuter },\n        to: { inners: toInners, side: toSide, outer: toOuter },\n    };\n};\n\n/**\n * Return the middle points between 2 sides so that the path between them\n * doesn't have a diagonal line\n */\nconst getMidPoints = (points: Omit<EdgePoints, \"mid\">): EdgePoint[] => {\n    const { from, to } = points;\n\n    // When 2 ends are from different side, we need to pick mid points from the\n    // middle area between S(tart) and E(nd) points:\n    // S o------------X <-- a mid point\n    //                |\n    //                Y---> E\n    if (from.side !== to.side) {\n        // We will pick the further point from B (end)\n        const centerX = (from.outer.x + to.outer.x) / 2;\n        // TABLE_MARGIN_SINGLE is from inner points so we need to minus\n        // GRID_CELL to use with outer points\n        const margin = TABLE_MARGIN_SINGLE - GRID_CELL;\n        const direction = to.outer.x > from.outer.x ? \"ltr\" : \"rtl\";\n        const maxX = to.outer.x + (direction === \"ltr\" ? -1 : 1) * margin;\n        const midX =\n            direction === \"ltr\"\n                ? Math.max(maxX, centerX)\n                : Math.min(maxX, centerX);\n        return [\n            { x: midX, y: from.outer.y },\n            { x: midX, y: to.outer.y },\n        ];\n    }\n\n    // When 2 ends are from the same side, we need to pick a mid point from\n    // that side (to avoid the path from overlapping the target):\n    //\n    //   A o----X\n    //          |\n    //     B <--Y\n    //\n    // Note that we still need to produce two mid points even though the \"safe\"\n    // point can already be a mid point. This is requires for the \"avoid edge\n    // collision algorithm\" to work properly.\n    if (from.side === to.side) {\n        const midX = Math.max(from.outer.x, to.outer.x);\n        return [\n            { x: midX, y: from.outer.y },\n            { x: midX, y: to.outer.y },\n        ];\n    }\n    throw Error(\"never\");\n};\n\ninterface Props {\n    edgesMids: EdgesMids | null;\n    rowYMap: RowYMap | null;\n    edge: EditEdge;\n    boxes: EdgeBoxes;\n}\n\nexport const getEdgePoints = (props: Props): EdgePoints => {\n    const { edgesMids, edge, boxes, rowYMap } = props;\n    // Get points\n    const { from, to } = getEndPoints({ boxes, rowYMap, edge });\n    let mid = getMidPoints({ from, to });\n    // Avoid collision if possible\n    if (edgesMids !== null) {\n        mid = avoidMidCollision({ edgesMids, edge, midPoints: mid });\n    }\n    return { from, mid, to };\n};\n","/**\n * This module is to avoid lines merged vertically:\n *\n * A -----+\n *        |\n * B --+  |\n *     |  |\n *     +--+----> C\n *         ^^^^^\n *         we don't want this\n *\n * Should be:\n *\n * A -----+\n *        |\n * B --+  |\n *     |  +----> C1\n *     +--+----> C2 (C row is bigger)\n */\n\nimport { ROW_HEIGHT } from \"app/dom/constants\";\nimport { EditEdge } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\n\n// Map from an edge's id to its Y position on a row\ntype EdgeYMap = Map<number, number>;\n// Map from a row (${table}.${row}) to its EdgeYMap\nexport type RowYMap = Map<string, EdgeYMap>;\n\nexport const getRowYMapId = (table: number, row: number): string =>\n    `${table}.${row}`;\n\ntype Ref = React.MutableRefObject<RowYMap>;\nexport const useRowYMap = (edges: EditEdge[]): Ref => {\n    const map = React.useRef<RowYMap>(new Map());\n    // Delete outdated edges references\n    React.useEffect(() => {\n        const edgeIds: Set<number> = new Set(edges.map((edge) => edge.id));\n        [...map.current.values()].forEach((edgeYMap: EdgeYMap) => {\n            [...edgeYMap.keys()].forEach((id) => {\n                if (edgeIds.has(id) === false) edgeYMap.delete(id);\n            });\n        });\n    }, [edges]);\n    return map;\n};\n\nconst getNextFree = (set: Set<number>, start: number): number => {\n    let [i, result] = [0, start];\n    while (set.has(result)) {\n        result = start + (i * ROW_HEIGHT) / 2;\n        i = i = i > 0 ? -i : -i + 1;\n    }\n    return result;\n};\n\ninterface Props {\n    rowYMap: RowYMap;\n    rowYId: string;\n    edgeId: number;\n    y: number;\n}\n\nexport const getRowFreeY = (props: Props): number => {\n    // Ensure we have the current edgeYMap\n    const { rowYId, rowYMap } = props;\n    if (rowYMap.get(rowYId) === undefined) rowYMap.set(rowYId, new Map());\n    const edgeYMap: EdgeYMap = rowYMap.get(rowYId)!;\n\n    const prev = edgeYMap.get(props.edgeId);\n    const next = props.y;\n\n    // \"next\" is good because it's already in the record\n    if (next === prev) return next;\n\n    // \"next\" is new, we need to figure out a position for it. But anyway we\n    // need to remove its previous record\n    if (prev !== undefined) edgeYMap.delete(props.edgeId);\n\n    // Get a \"free\" position as close to \"next\" as possible\n    const used = new Set(edgeYMap.values());\n    const free = getNextFree(used, next);\n    edgeYMap.set(props.edgeId, free);\n    return free;\n};\n","import { EditEdge } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\n// import { PairMap } from \"./pair-map\";\nimport { EdgePoint } from \"./point\";\nimport { GRID_CELL } from \"app/dom/constants\";\n\n// The purpose of this module is to avoid the situation where the \"x\" of \"mids\"\n// points of some edges are the same thus it's not clear which edge ends at\n// which row. For example, in the figure below, it's not clear whether A or C\n// is connected to X:\n//\n// A >-----+\n// B       |\n// C >-----+\n//         |\n//         |\n//         +----> X\n//         |      Y\n//         +----> Z\n//\n\ninterface UseEdgesMidsProps {\n    edges: EditEdge[];\n}\n\nexport interface EdgesMids {\n    edgesMap: Map<number, { mid: number; detail: EditEdge }>;\n    // usedMids: PairMap<number, Set<number>>;\n    usedMids: Set<number>;\n}\n\nexport const useEdgesMids = (props: UseEdgesMidsProps) => {\n    const edgesMids = React.useRef<EdgesMids>({\n        edgesMap: new Map(),\n        // usedMids: new PairMap(),\n        usedMids: new Set(),\n    });\n\n    // Remove outdated edges\n    React.useEffect(() => {\n        const ids = new Set(props.edges.map((edge) => edge.id));\n        edgesMids.current.edgesMap.forEach((edge, id) => {\n            if (ids.has(id)) return;\n            // id is not inside ids ===> removed ref\n            // edgesMids.current.usedMids\n            //     .get(edge.detail.from.table, edge.detail.to.table)\n            //     ?.delete(edge.mid);\n            edgesMids.current.usedMids.delete(edge.mid);\n            edgesMids.current.edgesMap.delete(id);\n        });\n    }, [props.edges]);\n\n    return edgesMids;\n};\n\ninterface CollisionProps {\n    edgesMids: EdgesMids;\n    edge: EditEdge;\n    midPoints: EdgePoint[];\n}\n\nconst getClosestAvailable = (set: Set<number>, start: number): number => {\n    let result = start;\n    let i = 1;\n    while (set.has(result)) {\n        result = start + i * GRID_CELL / 2;\n        i = i > 0 ? -i : -i + 1;\n    }\n    return result;\n};\n\nexport const avoidMidCollision = (props: CollisionProps): EdgePoint[] => {\n    const { edgesMap, usedMids } = props.edgesMids;\n    const next = props.midPoints[0].x; // All mid points have the same \"x\"\n    const prev = edgesMap.get(props.edge.id)?.mid;\n\n    // Nothing changes\n    if (prev === next) return props.midPoints;\n\n    // const [from, to] = [props.edge.from.table, props.edge.to.table];\n    // const set = usedMids.getOrSet(from, to, new Set());\n    const set = usedMids;\n\n    // Remove previous value if set\n    if (prev !== undefined) set.delete(prev);\n\n    if (set.has(next)) {\n        // Collision happens! Must choose new x\n        const x = getClosestAvailable(set, next);\n        edgesMap.set(props.edge.id, { detail: props.edge, mid: x });\n        set.add(x);\n        return props.midPoints.map((point) => ({ ...point, x }));\n    } else {\n        // No collision. Just record the new one and move on\n        edgesMap.set(props.edge.id, { detail: props.edge, mid: next });\n        set.add(next);\n        return props.midPoints;\n    }\n};\n","import { EditDiagram, EditEdge, EditTable } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\nimport { debugLog } from \"utils/debug\";\nimport { getEdgeBoxes } from \"./box\";\nimport { EdgesPoints } from \"./intersect/intersect\";\nimport { useEdgeObserve } from \"./observe\";\nimport { EdgePath, getEdgePath } from \"./path\";\nimport { getEdgePoints } from \"./point\";\nimport { EdgesMids } from \"./split-x\";\nimport { RowYMap } from \"./split-y\";\n\ninterface Props {\n    edge: EditEdge;\n    fromTable: EditTable;\n    toTable: EditTable;\n    // UI optimization. These can be null when getEdgeState is called from\n    // environment where performance is crucial (like when dragging)\n    edgesMids: React.MutableRefObject<EdgesMids> | null;\n    rowYMap: React.MutableRefObject<RowYMap> | null;\n    edgesPoints: React.MutableRefObject<EdgesPoints> | null;\n    // @TODO(#52) this is a hack to force the re-render of all edges when one\n    // changes. This is not even correct because edges can be changed due to\n    // other reasons\n    __hack__diagram: EditDiagram;\n}\n\nexport const getEdgeState = (\n    props: Omit<Props, \"__hack__diagram\">\n): EdgePath => {\n    debugLog(\"getEdgeState\");\n    const boxes = getEdgeBoxes(props);\n\n    const edgesMids = props.edgesMids?.current ?? null;\n    const rowYMap = props.rowYMap?.current ?? null;\n    const edgesPoints = props.edgesPoints?.current ?? null;\n\n    const { edge } = props;\n    const edgePoints = getEdgePoints({ edgesMids, edge, boxes, rowYMap });\n    const path = getEdgePath({ edge, edgesPoints, edgePoints });\n    return path;\n};\n\nexport const useEdgeState = (props: Props): EdgePath | null => {\n    const { edge, fromTable, toTable, edgesMids, edgesPoints, rowYMap } = props;\n\n    const changed = useEdgeObserve(edge);\n\n    // \"draw\" calculation depends on the result of rendered tables so it can\n    // not be calculated on edge's render but instead as an effect after\n    const [state, setState] = React.useState<EdgePath | null>(null);\n    const prev = React.useRef(0);\n    React.useLayoutEffect(() => {\n        window.clearTimeout(prev.current);\n        // setTimeout to fix a bug in Firefox where styles are not applied\n        // fully at the time when get element\n        prev.current = window.setTimeout(() => {\n            const newState = getEdgeState({\n                edge,\n                fromTable,\n                toTable,\n                edgesMids,\n                rowYMap,\n                edgesPoints,\n            });\n            setState(newState);\n        }, 0);\n        return () => window.clearTimeout(prev.current);\n    }, [\n        edge,\n        fromTable,\n        toTable,\n        edgesMids,\n        edgesPoints,\n        changed,\n        rowYMap,\n        props.__hack__diagram,\n    ]);\n    return state;\n};\n","export const getEdgeElementId = (edgeId: number) => `edge . ${edgeId}`;\n\nexport const getEdgeElement = (edgeId: number): SVGGElement => {\n    const element = document.getElementById(getEdgeElementId(edgeId));\n    if (element instanceof SVGGElement) return element;\n    throw Error(\"Element is not SVGGElement\");\n};\n\ntype Type = \"path-main\" | \"from\" | \"to\" | \"highlight\";\ntype Fn<T> = (edgeId: number, type: Type, index?: number) => T;\n\nexport const getEdgeSubElementId: Fn<string> = (edgeId, type, index) =>\n    `edge . ${edgeId} . ${type} . ${index ?? 0}`;\n\nexport const getEdgeSubElement: Fn<SVGElement> = (edgeId, type, index) => {\n    const id = getEdgeSubElementId(edgeId, type, index);\n    const element = document.getElementById(id);\n    if (element instanceof SVGElement) return element;\n    throw Error(\"Element is not SVGElement\");\n};\n","import { EditEdge } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\nimport s from \"./edge.module.scss\";\nimport { EdgePath } from \"./state/path\";\nimport { getEdgeSubElementId } from \"./utils\";\n\ninterface Props {\n    edge: EditEdge;\n    path: EdgePath;\n}\n\nexport const EdgeHighlight = (props: Props) => (\n    <circle className={s.dot} r=\"4\">\n        <animateMotion\n            dur={`${props.path.length / 150}s`}\n            repeatCount=\"indefinite\"\n            id={getEdgeSubElementId(props.edge.id, \"highlight\")}\n            path={props.path.paths[0]}\n        />\n    </circle>\n);\n","import { selectOnRefClick } from \"app/view/select/edge\";\nimport { SetSelectIds } from \"app/view/select/select\";\nimport { EditDiagram, EditEdge, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport React from \"react\";\nimport { debugLog } from \"utils/debug\";\nimport s from \"./edge.module.scss\";\nimport { useEdgeState } from \"./state/state\";\nimport { getEdgeElementId, getEdgeSubElementId } from \"./utils\";\nimport { EdgeHighlight } from \"./highlight\";\nimport { EdgesMids } from \"./state/split-x\";\nimport { RowYMap } from \"./state/split-y\";\nimport { EdgesPoints } from \"./state/intersect/intersect\";\n\ninterface Props {\n    edge: EditEdge;\n    // Tables\n    fromTable: EditTable;\n    toTable: EditTable;\n    // Diagram\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    // Select\n    isSelected: boolean;\n    setSelectIds: SetSelectIds;\n    // Pref\n    edgeAnimation: boolean;\n    // Optimization\n    edgesMids: React.MutableRefObject<EdgesMids>;\n    edgesPoints: React.MutableRefObject<EdgesPoints>;\n    rowYMap: React.MutableRefObject<RowYMap>;\n    __hack__diagram: EditDiagram;\n}\n\nconst getClassName = (props: Props): string => {\n    const array = [s.container];\n    if (props.isSelected) array.push(s.selected);\n    return array.join(\" \");\n};\n\nexport const Edge = (props: Props) => {\n    debugLog(\"Edge\", props.edge.from.rows, props.edge.to.rows);\n\n    const path = useEdgeState({\n        edge: props.edge,\n        fromTable: props.fromTable,\n        toTable: props.toTable,\n        // Optimization\n        edgesMids: props.edgesMids,\n        edgesPoints: props.edgesPoints,\n        rowYMap: props.rowYMap,\n        __hack__diagram: props.__hack__diagram,\n    });\n    if (path === null) return null;\n\n    return (\n        <g id={getEdgeElementId(props.edge.id)} className={getClassName(props)}>\n            {path.paths.map((d, index) => (\n                <path\n                    key={index}\n                    id={getEdgeSubElementId(props.edge.id, \"path-main\", index)}\n                    className={s.path}\n                    d={d}\n                    // DO NOT define markers here. See the edge.module.scss\n                />\n            ))}\n            {props.isSelected && props.edgeAnimation && (\n                <EdgeHighlight edge={props.edge} path={path} />\n            )}\n            <path\n                className={s.hitarea}\n                d={path.paths[0]}\n                onClick={selectOnRefClick({\n                    refId: props.edge.id,\n                    setSelectIds: props.setSelectIds,\n                })}\n            />\n        </g>\n    );\n};\n","import * as React from \"react\";\nimport s from \"./marker.module.scss\";\n\nconst From = () => (\n    <marker\n        id=\"edge-from\"\n        viewBox=\"0 0 10 10\"\n        refX=\"5\"\n        refY=\"5\"\n        markerWidth=\"10\"\n        markerHeight=\"10\"\n        markerUnits=\"userSpaceOnUse\"\n    >\n        <circle className={s.container} cx=\"5\" cy=\"5\" r=\"4\" />\n    </marker>\n);\n\nconst To = () => (\n    <marker\n        id=\"edge-to\"\n        viewBox=\"0 0 10 10\"\n        refX=\"10\"\n        refY=\"5\"\n        markerWidth=\"10\"\n        markerHeight=\"10\"\n        markerUnits=\"userSpaceOnUse\"\n        orient=\"auto-start-reverse\"\n    >\n        <polygon className={s.container} points=\"1,1 9,5 1,9\" />\n    </marker>\n);\n\nexport const EdgeMarkers = () => (\n    <defs>\n        <From />\n        <To />\n    </defs>\n);\n","import { useEdgesMids } from \"app/edge/state/split-x\";\nimport { SetSelectIds } from \"app/view/select/select\";\nimport { EditDiagram, EditRefSide, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport * as React from \"react\";\nimport { Edge } from \"../edge\";\nimport s from \"./canvas.module.css\";\nimport { EdgeMarkers } from \"./marker/marker\";\nimport { useRowYMap } from \"../state/split-y\";\nimport { useEdgesPoints } from \"../state/intersect/intersect\";\n\ninterface Props {\n    diagram: EditDiagram;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    selectedRefs: Set<number>;\n    setSelectIds: SetSelectIds;\n    tablesMap: Map<number, EditTable>;\n    edgeAnimation: boolean;\n}\n\nexport const EdgesCanvas = (props: Props) => {\n    const getTable = (side: EditRefSide): EditTable => {\n        const table = props.tablesMap.get(side.table);\n        if (table !== undefined) return table;\n        throw Error(\"Table is undefined\");\n    };\n\n    const edgesMids = useEdgesMids({ edges: props.diagram.refs });\n    const rowYMap = useRowYMap(props.diagram.refs);\n    const edgesPoints = useEdgesPoints(props.diagram.refs);\n\n    return (\n        <svg\n            className={s.container}\n            width={props.diagram.size.width}\n            height={props.diagram.size.height}\n        >\n            <EdgeMarkers />\n            {props.diagram.refs.map((edge) => (\n                <Edge\n                    key={edge.id}\n                    edge={edge}\n                    // Select\n                    isSelected={props.selectedRefs.has(edge.id)}\n                    setSelectIds={props.setSelectIds}\n                    // Tables\n                    fromTable={getTable(edge.from)}\n                    toTable={getTable(edge.to)}\n                    // Diagram\n                    diagramDispatch={props.diagramDispatch}\n                    // Pref\n                    edgeAnimation={props.edgeAnimation}\n                    // Optimization\n                    edgesPoints={edgesPoints}\n                    edgesMids={edgesMids}\n                    rowYMap={rowYMap}\n                    __hack__diagram={props.diagram}\n                />\n            ))}\n        </svg>\n    );\n};\n","import { getEdgeState } from \"app/edge/state/state\";\nimport { getEdgeSubElement } from \"app/edge/utils\";\nimport { RelatedTable } from \"app/view/canvas/edge\";\nimport { EditTable } from \"diagram/models/edit/edit\";\nimport { Position } from \"diagram/models/layout\";\nimport { DraggableEventHandler } from \"react-draggable\";\n\ninterface Props {\n    table: EditTable;\n    relatedTables: RelatedTable[];\n}\n\nconst updateEdgeElements = (table: EditTable) => (related: RelatedTable) => {\n    const [edge, other] = related;\n    const isSame = edge.from.table === edge.to.table;\n    const isTo = edge.to.table === table.id;\n    const path = getEdgeState({\n        edge,\n        fromTable: isSame ? table : isTo ? other : table,\n        toTable: isSame ? table : isTo ? table : other,\n        rowYMap: null,\n        edgesMids: null,\n        edgesPoints: null,\n    });\n    // Path\n    path.paths.forEach((d, index) => {\n        getEdgeSubElement(edge.id, \"path-main\", index).setAttribute(\"d\", d);\n    });\n    // Highlight\n    try {\n        const highlight = getEdgeSubElement(edge.id, \"highlight\");\n        highlight.setAttribute(\"path\", \"\");\n    } catch (e) {\n        // Nothing, it's ok to fail when highlight is not rendered\n    }\n};\n\nexport const onTableDragMove = (props: Props): DraggableEventHandler => {\n    return (_event, data) => {\n        // Some browsers always fire the \"move\" event on mouse down even though\n        // the table is not moved yet. This checks is to prevent entering\n        // \"optimized\" mode unnecessarily. See #16 and #19\n        if (data.x === 0 && data.y === 0) return;\n        const position: Position = {\n            left: props.table.position.left + data.x,\n            top: props.table.position.top + data.y,\n        };\n        const table = { ...props.table, position };\n        props.relatedTables.forEach(updateEdgeElements(table));\n    };\n};\n","import { EditTable } from \"diagram/models/edit/edit\";\nimport { Position } from \"diagram/models/layout\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { DraggableEventHandler } from \"react-draggable\";\n\nconst round = (num: number) => Math.round(num / 16) * 16;\n\ninterface Props {\n    table: EditTable;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nexport const onTableDragStop = (props: Props): DraggableEventHandler => {\n    return (_event, data) => {\n        if (data.x === 0 && data.y === 0) return;\n        const position: Position = {\n            left: round(props.table.position.left + data.x),\n            top: round(props.table.position.top + data.y),\n        };\n        props.diagramDispatch({\n            type: \"set-table-position\",\n            payload: { id: props.table.id, position },\n        });\n    };\n};\n","import * as React from \"react\";\n\nexport type SelectIdType = \"table\" | \"ref\";\n\nexport interface SelectId {\n    type: SelectIdType;\n    value: number;\n}\n\nexport type SetSelectIds = React.Dispatch<React.SetStateAction<SelectId[]>>;\n\ninterface SelectState {\n    ids: SelectId[];\n    setIds: SetSelectIds;\n    // Derived values\n    tables: Set<number>;\n    refs: Set<number>;\n}\n\nconst filterId = (ids: SelectId[], type: SelectIdType): number[] =>\n    ids.filter((id) => id.type === type).map((id) => id.value);\n\nexport const getSelectSets = (ids: SelectId[]) => ({\n    tables: new Set(filterId(ids, \"table\")),\n    refs: new Set(filterId(ids, \"ref\")),\n});\n\nexport const isSameSelectIds = (a: SelectId[], b: SelectId[]): boolean => {\n    if (a.length !== b.length) return false;\n    const { tables, refs } = getSelectSets(a);\n    return b.every((id) => {\n        if (id.type === \"table\" && tables.has(id.value)) return true;\n        if (id.type === \"ref\" && refs.has(id.value)) return true;\n        return false;\n    });\n};\n\nexport const useSelect = (): SelectState => {\n    const [ids, setIds] = React.useState<SelectId[]>([]);\n    const { tables, refs } = React.useMemo(() => getSelectSets(ids), [ids]);\n    return { ids, setIds, tables, refs };\n};\n","import React from \"react\";\nimport s from \"./add.module.scss\";\nimport { Button } from \"@moai/core\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { AddRowPayload } from \"diagram/reducer/row/add\";\nimport { icons } from \"@moai/icon\";\n\ninterface Props {\n    tableId: number;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nconst addRow = (props: Props) => () => {\n    const payload: AddRowPayload = { tableId: props.tableId };\n    props.diagramDispatch({ type: \"add-row\", payload });\n};\n\nexport const TableBodyAdd = (props: Props) => (\n    <div className={s.container}>\n        <Button\n            onClick={addRow(props)}\n            icon={icons.add}\n            size={Button.size.small}\n            style={Button.style.flat}\n            isFullWidth={true}\n        >\n            Add\n        </Button>\n    </div>\n);\n","import * as Constants from \"app/dom/constants\";\n\n/**\n * Notes about DOM structure:\n *\n * 1. Rows are all siblings of each other, but not continously (there might be\n * different elements in between). For example:\n *     <Row />\n *     <Row />\n *     <Foo /> <--- Not Row but still sibling\n *     <Row />\n *\n * 2. Columns are not siblings of each other. Some are nested (maybe together):\n *     <Column />\n *     <div> <--- Nested together\n *         <Column />\n *         <Column />\n *     </div>\n *     <div> <--- Nested alone\n *         <Column />\n *     </div>\n */\n\ntype RowDirection = \"up\" | \"down\";\ntype ColumnDirection = \"left\" | \"right\";\ntype ColumnIndex = \"first\" | \"last\" | number;\n\nconst getSibling = (\n    element: Element,\n    direction: RowDirection\n): Element | null =>\n    direction === \"up\"\n        ? element.previousElementSibling\n        : element.nextElementSibling;\n\n/**\n * Returns the row below or above @param element, or null if element is at\n * first or last row already\n */\nexport const getAdjacentRow = (\n    element: Element,\n    direction: RowDirection\n): Element | null => {\n    const currRow = element.closest(Constants.TABLE_ROW_SELECTOR);\n    if (currRow === null) throw Error(\"row is null\");\n    let targetRow: Element | null = getSibling(currRow, direction);\n    while (targetRow !== null) {\n        // Because rows are ordered continously\n        if (targetRow.classList.contains(Constants.TABLE_ROW_CLASS))\n            return targetRow;\n        targetRow = getSibling(targetRow, direction);\n    }\n    return null;\n};\n\n/**\n * Returns the column at @param index of a row. Throw error if cannot found\n * such column\n */\nexport const getColumnByIndex = (row: Element, index: ColumnIndex): Element => {\n    const all = row.querySelectorAll(Constants.TABLE_COLUMN_SELECTOR);\n    const numIndex: number =\n        index === \"first\" ? 0 : index === \"last\" ? all.length - 1 : index;\n    const column = all[numIndex];\n    if (column instanceof Element) return column;\n    throw Error(\".table-row doesn't have .row-control\");\n};\n\n/**\n * Returns the column on left or right of @param element. Returns null if\n * element is already at the first or last column\n */\nconst getAdjacentColumInRow = (\n    element: Element,\n    direction: ColumnDirection\n): Element | null => {\n    const column = element.closest(Constants.TABLE_COLUMN_SELECTOR);\n    if (column === null) throw Error(\"column is null\");\n    const row = column.closest(Constants.TABLE_ROW_SELECTOR);\n    if (row === null) throw Error(\"row is null\");\n    const all = [...row.querySelectorAll(Constants.TABLE_COLUMN_SELECTOR)];\n    const index = all.indexOf(column);\n    if (direction === \"left\") {\n        return index === 0 ? null : all[index - 1];\n    } else {\n        return index === all.length - 1 ? null : all[index + 1];\n    }\n};\n\n/**\n * Same as @method getAdjacentColumnInRow but also reach the row below or above\n * if necessary. Only returns null if the element is also at the first or last\n * row\n */\nexport const getAdjacentColumn = (\n    element: Element,\n    direction: ColumnDirection\n): Element | null => {\n    const adjacentInRow = getAdjacentColumInRow(element, direction);\n    if (adjacentInRow instanceof Element) return adjacentInRow;\n    // Try below and above row:\n    const isLeft = direction === \"left\";\n    const adjacentRow = getAdjacentRow(element, isLeft ? \"up\" : \"down\");\n    if (adjacentRow === null) return null;\n    return getColumnByIndex(adjacentRow, isLeft ? \"last\" : \"first\");\n};\n\n/**\n * Returns index of element's column in element's row\n */\nconst getColumnIndex = (element: Element): number => {\n    const row = element.closest(Constants.TABLE_ROW_SELECTOR);\n    if (row === null) throw Error(\"Row is null\");\n    const column = element.closest(Constants.TABLE_COLUMN_SELECTOR);\n    if (column === null) throw Error(\"Column is null\");\n    const all = row.querySelectorAll(Constants.TABLE_COLUMN_SELECTOR);\n    return [...all].indexOf(column);\n};\n\n/**\n * Returns the column at the same index but in below or above row. Returns null\n * if element is already at the first or last row\n */\nexport const getJumpColumn = (\n    element: Element,\n    direction: RowDirection\n): Element | null => {\n    const adjacentRow = getAdjacentRow(element, direction);\n    if (adjacentRow === null) return null;\n    const index = getColumnIndex(element);\n    return getColumnByIndex(adjacentRow, index);\n};\n","import * as React from \"react\";\nimport { focusChild } from \"app/dom/dom\";\nimport { getAdjacentColumn, getJumpColumn } from \"app/dom/navigate\";\n\nconst getNextColumn = (element: Element, key: string): Element | null => {\n    switch (key) {\n        case \"ArrowRight\":\n            return getAdjacentColumn(element, \"right\");\n        case \"ArrowLeft\":\n            return getAdjacentColumn(element, \"left\");\n        case \"ArrowUp\":\n            return getJumpColumn(element, \"up\");\n        case \"ArrowDown\": {\n            return getJumpColumn(element, \"down\");\n        }\n    }\n    return null;\n};\n\nexport const navigateOnArrowKeys = (event: React.KeyboardEvent): void => {\n    switch (event.key) {\n        case \"ArrowUp\":\n        case \"ArrowRight\":\n        case \"ArrowDown\":\n        case \"ArrowLeft\":\n            const { target } = event;\n            if (!(target instanceof HTMLElement)) return;\n            if (target instanceof HTMLInputElement) return;\n            // Prevent parent (viewport)'s scrolling\n            event.preventDefault();\n            const next = getNextColumn(target, event.key);\n            if (next === null) return;\n            focusChild(next);\n    }\n};\n","import { background, borderColor, Button, DivPx, Icon, text } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\n\nimport { EditColumn } from \"diagram/models/edit/edit\";\nimport React from \"react\";\nimport s from \"./header.module.scss\";\nimport { TABLE_BODY_WIDTH } from \"app/dom/constants\";\n\ninterface Props {\n    columns: EditColumn[];\n    isExpand: boolean;\n    setIsExpand: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst className = [\n    background.secondary,\n    borderColor.weak,\n    s.container,\n    text.muted,\n].join(\" \");\n\nconst renderColumn = (column: EditColumn, index: number) => (\n    <div\n        key={column.id}\n        className={[s.field, index === 1 ? s.rightField : \"\"].join(\" \")}\n        style={{ width: TABLE_BODY_WIDTH / 2 }}\n        children={column.value.name}\n    />\n);\n\nconst getExpandIcon = (isExpand: Boolean): string =>\n    isExpand ? icons.doubleChevronLeft : icons.doubleChevronRight;\n\nexport const TableBodyHeader = (props: Props) => (\n    <div className={className}>\n        <DivPx size={8} />\n\n        {/* PADDING */}\n        <div className={Button.size.small.main}>\n            <Icon path={icons.blank} size={Button.size.small.iconSize} />\n        </div>\n\n        {/* COLUMN */}\n        {props.columns\n            .slice(0, props.isExpand ? undefined : 2)\n            .map(renderColumn)}\n\n        {/* EXPAND */}\n        <Button\n            onClick={() => props.setIsExpand((b) => !b)}\n            style={Button.style.flat}\n            size={Button.size.small}\n            icon={getExpandIcon(props.isExpand)}\n        />\n\n        <DivPx size={8} />\n    </div>\n);\n","import { Button, Icon, outline } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { ShowCreateEdgePopup } from \"app/edge/create/state\";\nimport { EditRef } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { AddRefPayload } from \"diagram/reducer/ref/add\";\nimport { RemoveRefPayload } from \"diagram/reducer/ref/remove\";\nimport React from \"react\";\nimport { DragSourceMonitor, useDrag } from \"react-dnd\";\nimport { getEmptyImage } from \"react-dnd-html5-backend\";\nimport { RowDragItem, RowDropResult } from \"../drag\";\nimport s from \"./source.module.scss\";\n\ninterface Props {\n    showCreateEdge: ShowCreateEdgePopup;\n    tableId: number;\n    rowId: number;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    edge: EditRef | null;\n}\n\nconst beginDrag = (props: Props) => {\n    if (props.edge === null) return;\n    const payload: RemoveRefPayload = { id: props.edge.id };\n    props.diagramDispatch({ type: \"remove-ref\", payload });\n};\n\nconst collectDrag = (props: Props, monitor: DragSourceMonitor) => {\n    if (monitor.isDragging() === false) return false;\n    if (monitor.getItemType() !== \"row\") return false;\n    const { tableId, rowId } = monitor.getItem() as RowDragItem;\n    return props.tableId === tableId && props.rowId === rowId;\n};\n\nconst endDrag = (props: Props, monitor: DragSourceMonitor) => {\n    const result = monitor.getDropResult() as null | RowDropResult;\n    if (result === null) return;\n    const payload: AddRefPayload = {\n        from: { table: props.tableId, rows: [props.rowId] },\n        to: { table: result.tableId, rows: [result.rowId] },\n    };\n    props.diagramDispatch({ type: \"add-ref\", payload });\n};\n\nexport const RowDragSource = (props: Props) => {\n    const elementRef = React.useRef<HTMLButtonElement>(null);\n\n    const { rowId, tableId } = props;\n    const [isDragging, dragRefCallback, previewRef] = useDrag({\n        item: { type: \"row\", rowId, tableId, elementRef },\n        begin: () => beginDrag(props),\n        end: (_item, monitor) => endDrag(props, monitor),\n        collect: (monitor) => collectDrag(props, monitor),\n    });\n\n    React.useEffect(() => {\n        previewRef(getEmptyImage());\n    }, [previewRef]);\n\n    React.useEffect(() => {\n        dragRefCallback(elementRef);\n    }, [dragRefCallback]);\n\n    const [isHover, setIsHover] = React.useState(false);\n\n    const isActive = isDragging || isHover || props.edge !== null;\n    const iconNode = (\n        <Icon\n            path={isActive ? icons.selection : icons.circle}\n            size={Button.size.small.iconSize}\n        />\n    );\n\n    return (\n        <button\n            ref={elementRef}\n            className={[s.container, outline.normal].join(\" \")}\n            tabIndex={0}\n            onClick={() => {\n                const element = elementRef.current;\n                if (element === null) throw Error(\"Element is null\");\n                props.showCreateEdge(props.tableId, [props.rowId], element);\n            }}\n            onMouseEnter={() => setIsHover(true)}\n            onMouseLeave={() => setIsHover(false)}\n            title=\"Click or drag to create reference\"\n        >\n            <div\n                className={[\n                    s.button,\n                    isDragging ? s.dragging : \"\",\n                    Button.style.flat.main,\n                    Button.size.small.main,\n                    \"react-draggable-cancel\",\n                ].join(\" \")}\n                children={iconNode}\n            />\n        </button>\n    );\n};\n","import { Select } from \"@moai/core\";\nimport * as React from \"react\";\nimport s from \"./boolean.module.css\";\n\ninterface Props {\n    value: string;\n    setValue: (value: string) => void;\n}\n\nconst TRUE_PREFIX = [\"T\", \"t\", \"1\", \"Y\", \"y\"]; // true, 1, yes\n\nconst isBoolean = (text: string): boolean =>\n    TRUE_PREFIX.includes(text.charAt(0));\n\nexport const RowInputBoolean = (props: Props) => (\n    <div className={[s.container].join(\" \")}>\n        <Select<boolean>\n            value={isBoolean(props.value) ? true : false}\n            setValue={(bool) => {\n                props.setValue(bool ? \"TRUE\" : \"FALSE\");\n            }}\n            options={[\n                { value: true, label: \"TRUE\" },\n                { value: false, label: \"FALSE\" },\n            ]}\n            style={Select.style.flat}\n            size={Select.size.small}\n        />\n    </div>\n);\n","/**\n * Whether the browser's focus is just leaving from an Input edit view. This\n * helps 2 things:\n * - Only set the next input string to edit mode if coming from another edit\n *   input via \"Tab\" key\n * - Allow keeping the \"edit\" flag when travelling through non-editable widgets\n *   like the remove button\n */\nconst ref = { current: false, timeout: 0 };\n\nexport const isJustLeftEdit = (): boolean => ref.current;\n\nexport const setJustLeftEdit = (): void => {\n    window.clearTimeout(ref.timeout);\n    ref.current = true;\n    ref.timeout = window.setTimeout(() => {\n        ref.current = false;\n    }, 500);\n};\n","import { Input, outline } from \"@moai/core\";\nimport * as React from \"react\";\nimport { isJustLeftEdit, setJustLeftEdit } from \"./leave\";\nimport s from \"./string.module.scss\";\n\ninterface Props {\n    value: string;\n    setValue: (value: string) => void;\n}\n\ninterface InternalProps extends Props {\n    isEdit: boolean;\n    setIsEdit: React.Dispatch<React.SetStateAction<boolean>>;\n    viewRef: React.RefObject<HTMLDivElement>;\n}\n\nconst focusView = (props: InternalProps) => {\n    const view = props.viewRef.current;\n    if (view === null) throw Error(\"View is null\");\n    view.focus();\n};\n\nconst Edit = (props: InternalProps) => (\n    <div className={s.edit}>\n        <Input\n            key={props.value} // uncontrolled\n            defaultValue={props.value}\n            style={Input.style.flat}\n            size={Input.size.small}\n            autoFocus\n            onBlur={(event) => {\n                props.setValue(event.currentTarget.value);\n                props.setIsEdit(false);\n            }}\n            onKeyDown={(event) => {\n                if (event.key !== \"Tab\") return;\n                setJustLeftEdit();\n            }}\n            onKeyUp={(event) => {\n                if (event.key !== \"Enter\") return;\n                props.setValue(event.currentTarget.value);\n                props.setIsEdit(false);\n                focusView(props);\n            }}\n        />\n    </div>\n);\n\nconst viewClass = [\n    s.view,\n    outline.always,\n    Input.size.small.main,\n    \"react-draggable-cancel\",\n    \"row-input-string-view\",\n].join(\" \");\n\nconst ViewValue = ({ value }: { value: string }) => {\n    if (value.length !== 0) return <span>{value}</span>;\n    return <span className={s.empty}>&lt;empty&gt;</span>;\n};\n\nconst View = (props: InternalProps) => (\n    <div\n        tabIndex={0}\n        children={<ViewValue value={props.value} />}\n        className={viewClass}\n        onDoubleClick={() => {\n            props.setIsEdit(true);\n        }}\n        onFocus={() => {\n            if (isJustLeftEdit()) props.setIsEdit(true);\n        }}\n        onKeyUp={(event) => {\n            if (event.key !== \"Enter\") return;\n            props.setIsEdit(true);\n        }}\n        ref={props.viewRef}\n    />\n);\n\nexport const RowInputString = (props: Props) => {\n    const [isEdit, setIsEdit] = React.useState(false);\n    const viewRef = React.useRef<HTMLDivElement>(null);\n    const internal: InternalProps = { ...props, isEdit, setIsEdit, viewRef };\n\n    return (\n        <div className={[s.container].join(\" \")}>\n            <View {...internal} />\n            {isEdit && <Edit {...internal} />}\n        </div>\n    );\n};\n","import { EditColumn, EditRow } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { UpdateRowPayload } from \"diagram/reducer/row/update\";\nimport React from \"react\";\nimport { RowInputBoolean } from \"./boolean/boolean\";\nimport { RowInputString } from \"./string/string\";\n\ninterface Props {\n    tableId: number;\n    row: EditRow;\n    column: EditColumn;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nconst updateRowField = (props: Props) => (value: string) => {\n    const { tableId, row, column } = props;\n    const [property, rowId] = [column.value.name, row.id];\n    if (value === row.value[property]) return;\n    const payload: UpdateRowPayload = { tableId, rowId, property, value };\n    props.diagramDispatch({ type: \"update-row\", payload });\n};\n\ninterface RowInputProps {\n    value: string;\n    setValue: (value: string) => void;\n}\n\ntype RowInputComponent = (props: RowInputProps) => JSX.Element;\n\nconst getInput = (props: Props): RowInputComponent => {\n    const { type } = props.column.value;\n    switch (type) {\n        case \"boolean\":\n            return RowInputBoolean;\n        case \"string\":\n            return RowInputString;\n        default:\n            throw Error(`Unknown column type \"${type}\"`);\n    }\n};\n\nexport const RowFieldInput = (props: Props) =>\n    getInput(props)({\n        value: props.row.value[props.column.value.name] ?? \"\",\n        setValue: updateRowField(props),\n    });\n","import { Button } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { RemoveRowPayload } from \"diagram/reducer/row/remove\";\nimport React from \"react\";\nimport s from \"./remove.module.scss\";\nimport { getJumpColumn } from \"app/dom/navigate\";\nimport { focusChild } from \"app/dom/dom\";\n\ninterface Props {\n    tableId: number;\n    rowId: number;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nconst removeRow = (props: Props) => {\n    const { tableId, rowId } = props;\n    const payload: RemoveRowPayload = { tableId, rowId };\n    props.diagramDispatch({ type: \"remove-row\", payload });\n};\n\nexport const rowRemoveOnKeyDown = (props: Props) => (\n    event: React.KeyboardEvent\n): void => {\n    const { key, target } = event;\n    switch (key) {\n        case \"Backspace\":\n        case \"Delete\":\n            if (target instanceof HTMLInputElement) return;\n            if (!(target instanceof Element)) return;\n            event.stopPropagation();\n            // To focus after remove this row\n            const next = getJumpColumn(target, \"down\");\n            removeRow(props);\n            if (next === null) return;\n            window.setTimeout(() => void focusChild(next), 0);\n    }\n};\n\nexport const RowRemoveButton = (props: Props) => (\n    <div className={[s.container].join(\" \")}>\n        <Button\n            onClick={() => void removeRow(props)}\n            style={Button.style.flat}\n            size={Button.size.small}\n            icon={icons.remove}\n        />\n    </div>\n);\n","import { DivPx, text } from \"@moai/core\";\nimport * as Constants from \"app/dom/constants\";\nimport { EditColumn, EditRef, EditRow } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport React from \"react\";\nimport { debugLog } from \"utils/debug\";\nimport { useRowDropTarget } from \"./drag/drop/drop\";\nimport { RowDragSource } from \"./drag/source/source\";\nimport { RowFieldInput } from \"./field/field\";\nimport { RowRemoveButton, rowRemoveOnKeyDown } from \"./remove/remove\";\nimport s from \"./row.module.scss\";\nimport { getRowHeight } from \"app/dom/size\";\nimport { ShowCreateEdgePopup } from \"app/edge/create/state\";\n\ninterface Props {\n    // row\n    row: EditRow;\n    edgeFromHere: EditRef | null;\n    edgesToHereCount: number;\n    // table\n    tableId: number;\n    isTableEdit: boolean;\n    isTableColumnsExpand: boolean;\n    // diagram\n    columns: EditColumn[];\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    showCreateEdge: ShowCreateEdgePopup;\n}\n\ntype FieldType = \"first\" | \"second\" | \"rest\";\n\nconst renderField = (props: Props, type: FieldType) => (column: EditColumn) => {\n    const fieldCls = (() => {\n        if (type === \"rest\") return s.field;\n        if (type === \"first\") return s.field1st;\n        return [s.field2nd, text.muted].join(\" \");\n    })();\n    const width = type === \"rest\" ? Constants.TABLE_BODY_WIDTH / 2 : undefined;\n    return (\n        <div\n            className={[Constants.TABLE_COLUMN_CLASS, fieldCls].join(\" \")}\n            style={{ width }}\n            key={column.id}\n        >\n            <RowFieldInput\n                tableId={props.tableId}\n                row={props.row}\n                column={column}\n                diagramDispatch={props.diagramDispatch}\n            />\n        </div>\n    );\n};\n\nconst RowPure = (props: Props) => {\n    debugLog(\"Table\", props.tableId, \"Row\", props.row.id, props.row.value.id);\n\n    const [isOver, dropRef] = useRowDropTarget({\n        tableId: props.tableId,\n        rowId: props.row.id,\n    });\n\n    return (\n        <div\n            className={`${s.container} ${isOver ? s.over : \"\"}`}\n            ref={dropRef}\n            style={{ height: getRowHeight(props.edgesToHereCount) }}\n            onKeyDown={(event) => {\n                rowRemoveOnKeyDown({\n                    tableId: props.tableId,\n                    rowId: props.row.id,\n                    diagramDispatch: props.diagramDispatch,\n                })(event);\n            }}\n        >\n            <DivPx size={8} />\n\n            {/* REMOVE */}\n            {props.isTableEdit && (\n                <div className={Constants.TABLE_COLUMN_CLASS}>\n                    <RowRemoveButton\n                        tableId={props.tableId}\n                        rowId={props.row.id}\n                        diagramDispatch={props.diagramDispatch}\n                    />\n                </div>\n            )}\n\n            {/* The first 2 fields are special, their width are flexible but\n            the total must be fixed */}\n            <div\n                className={s.fields}\n                style={{ width: Constants.TABLE_BODY_WIDTH }}\n            >\n                {renderField(props, \"first\")(props.columns[0])}\n                {renderField(props, \"second\")(props.columns[1])}\n            </div>\n\n            {/* The rest are rendered with fixed width of their own */}\n            {props.isTableColumnsExpand && (\n                <div className={s.fields}>\n                    {props.columns.slice(2).map(renderField(props, \"rest\"))}\n                </div>\n            )}\n\n            {/* DRAG */}\n            {props.isTableEdit && (\n                <RowDragSource\n                    tableId={props.tableId}\n                    rowId={props.row.id}\n                    diagramDispatch={props.diagramDispatch}\n                    edge={props.edgeFromHere}\n                    showCreateEdge={props.showCreateEdge}\n                />\n            )}\n\n            <DivPx size={8} />\n        </div>\n    );\n};\n\nexport const Row = React.memo(RowPure);\n","import { useDrop } from \"react-dnd\";\nimport { RowDropResult } from \"../drag\";\n\ninterface Params {\n    tableId: number;\n    rowId: number;\n}\n\nexport const useRowDropTarget = (params: Params) =>\n    useDrop({\n        accept: \"row\",\n        drop: () => {\n            const { tableId, rowId } = params;\n            const result: RowDropResult = { tableId, rowId };\n            return result;\n        },\n        collect: (monitor) => monitor.isOver(),\n    });\n","import { EditRow, EditTable } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\nimport { groupTableRows, TableRowsItem } from \"./group\";\nimport { RowEdgesMap, RowEdges } from \"app/view/canvas/edge\";\n\ninterface SharedProps {\n    table: EditTable;\n    getRow: (row: EditRow, rowEdges: RowEdges | undefined) => JSX.Element;\n    getHiddenRows: (item: EditRow[]) => JSX.Element;\n    getHideRowsButton: () => JSX.Element | null;\n}\n\ninterface Props extends SharedProps {\n    rowEdgesMap: RowEdgesMap | undefined;\n}\n\n/** Props of each Item, which could be a row or a group of rows */\ninterface ItemProps extends SharedProps {\n    rowEdgesMap: RowEdgesMap | undefined;\n    item: TableRowsItem;\n}\n\nconst Item = (props: ItemProps) => {\n    if (!Array.isArray(props.item)) {\n        // Single row\n        const row = props.item;\n        return props.getRow(row, props.rowEdgesMap?.get(row.id));\n    } else {\n        // Group of rows\n        if (props.table.isRowsExpand === false) {\n            return props.getHiddenRows(props.item);\n        } else {\n            return (\n                <React.Fragment>\n                    {props.item.map((row) => {\n                        const edges = props.rowEdgesMap?.get(row.id);\n                        return props.getRow(row, edges);\n                    })}\n                </React.Fragment>\n            );\n        }\n    }\n};\n\nexport const TableRowsHeadless = (props: Props) => {\n    const { rows } = props.table.value;\n    const items = groupTableRows(rows, props.rowEdgesMap);\n    return (\n        <>\n            {items.map((item) => (\n                <Item\n                    {...props}\n                    key={Array.isArray(item) ? item[0].id : item.id}\n                    rowEdgesMap={props.rowEdgesMap}\n                    item={item}\n                />\n            ))}\n            {props.table.isRowsExpand &&\n                items.length !== rows.length &&\n                props.getHideRowsButton()}\n        </>\n    );\n};\n","import { EditRow } from \"diagram/models/edit/edit\";\nimport { MAX_ROWS_COUNT } from \"app/dom/constants\";\nimport { RowEdgesMap } from \"app/view/canvas/edge\";\n\nexport type TableRowsItem = EditRow | EditRow[];\n\nexport const groupTableRows = (\n    rows: EditRow[],\n    orgRowEdgesMap: RowEdgesMap | undefined\n): TableRowsItem[] => {\n    const rowEdgesMap = orgRowEdgesMap ?? new Map();\n    // When slotCount reaches 0 then start grouping rows\n    let slotCount = MAX_ROWS_COUNT - rowEdgesMap.size;\n    // Prepare\n    const items: TableRowsItem[] = [];\n    let prevGroup: EditRow[] = [];\n    // Push row or group rows\n    rows.forEach((row) => {\n        if (slotCount > 0 || rowEdgesMap.has(row.id)) {\n            if (prevGroup.length !== 0) items.push(prevGroup);\n            prevGroup = [];\n            items.push(row);\n            slotCount = slotCount - 1;\n        } else {\n            prevGroup.push(row);\n        }\n    });\n    if (prevGroup.length !== 0) items.push(prevGroup);\n    // Return\n    return items;\n};\n","import { Background, Border, Button } from \"@moai/core\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport * as React from \"react\";\n\ninterface RowsProps {\n    count: number;\n    tableId: number;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nexport const TableHiddenRows = (props: RowsProps) => (\n    <Background color=\"secondary\">\n        <Border color=\"weak\" />\n        <div style={{ marginTop: -1 }} />\n        <Button\n            style={Button.style.flat}\n            size={Button.size.small}\n            isFullWidth\n            onClick={() => {\n                props.diagramDispatch({\n                    type: \"set-table-rows-expand\",\n                    payload: { id: props.tableId, isExpand: true },\n                });\n            }}\n            children={`${props.count} columns hidden`}\n        />\n        <div style={{ marginTop: -1 }} />\n        <Border color=\"weak\" />\n    </Background>\n);\n\ninterface ButtonProps {\n    tableId: number;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nexport const TableHideRowsButton = (props: ButtonProps) => (\n    <Button\n        style={Button.style.flat}\n        size={Button.size.small}\n        isFullWidth\n        onClick={() => {\n            props.diagramDispatch({\n                type: \"set-table-rows-expand\",\n                payload: { id: props.tableId, isExpand: false },\n            });\n        }}\n        children=\"Hide columns\"\n    />\n);\n","import { TABLE_ROW_CLASS } from \"app/dom/constants\";\nimport { getRowElementId } from \"app/dom/dom\";\nimport { ShowCreateEdgePopup } from \"app/edge/create/state\";\nimport { Row } from \"app/row/row\";\nimport { TableRowsHeadless } from \"app/table/rows/headless\";\nimport { RowEdges, RowEdgesMap } from \"app/view/canvas/edge\";\nimport { EditColumn, EditRow, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport * as React from \"react\";\nimport { TableHiddenRows, TableHideRowsButton } from \"./hidden\";\n\n/** Shared props between a single row and a list of rows */\ninterface SharedProps {\n    // Table\n    table: EditTable;\n    rowEdgesMap: RowEdgesMap | undefined;\n    isEdit: boolean;\n    isColumnsExpand: boolean;\n    // Diagram\n    columns: EditColumn[];\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    showCreateEdge: ShowCreateEdgePopup;\n}\n\n/** Props of this component */\ninterface Props extends SharedProps {}\n\n/** Props of each RowContainer */\ninterface RowContainerProps extends SharedProps {\n    rowEdges: RowEdges | undefined;\n    row: EditRow;\n}\n\nconst RowContainer = (props: RowContainerProps) => (\n    <div\n        className={TABLE_ROW_CLASS} // For keyboard navigation\n        id={getRowElementId(props.table.id, props.row.id)}\n    >\n        <Row\n            // row\n            row={props.row}\n            edgeFromHere={props.rowEdges?.from ?? null}\n            edgesToHereCount={props.rowEdges?.to.size ?? 0}\n            // table\n            tableId={props.table.id}\n            isTableEdit={props.isEdit}\n            isTableColumnsExpand={props.isColumnsExpand}\n            // diagram\n            columns={props.columns}\n            diagramDispatch={props.diagramDispatch}\n            showCreateEdge={props.showCreateEdge}\n        />\n    </div>\n);\n\nexport const TableBodyRows = (props: Props) => (\n    <TableRowsHeadless\n        // Data\n        table={props.table}\n        rowEdgesMap={props.rowEdgesMap}\n        // Components\n        getHideRowsButton={() => (\n            <TableHideRowsButton\n                tableId={props.table.id}\n                diagramDispatch={props.diagramDispatch}\n            />\n        )}\n        getHiddenRows={(item) => (\n            <TableHiddenRows\n                count={item.length}\n                tableId={props.table.id}\n                diagramDispatch={props.diagramDispatch}\n            />\n        )}\n        getRow={(row, rowEdges) => (\n            <RowContainer {...props} row={row} rowEdges={rowEdges} />\n        )}\n    />\n);\n","import { setJustLeftEdit } from \"app/row/field/string/leave\";\nimport { TABLE_COLUMN_SELECTOR, TABLE_ROW_SELECTOR } from \"app/dom/constants\";\nimport { focusChild } from \"app/dom/dom\";\nimport { getColumnByIndex } from \"app/dom/navigate\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { AddRowPayload } from \"diagram/reducer/row/add\";\n\ninterface Props {\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    tableId: number;\n}\n\nconst action = (props: Props, event: React.KeyboardEvent): void => {\n    const target = event.target;\n    if (!(target instanceof HTMLInputElement)) return;\n\n    // Only proceed if tab from last column\n    const column = target.closest(TABLE_COLUMN_SELECTOR);\n    if (column === null) throw Error(\"Column is null\");\n    if (column.nextElementSibling !== null) return;\n    // Only proceed if tab from last row\n    const row = target.closest(TABLE_ROW_SELECTOR);\n    if (row === null) throw Error(\"Row is null\");\n    if (row.nextElementSibling !== null) return;\n\n    const payload: AddRowPayload = { tableId: props.tableId };\n    props.diagramDispatch({ type: \"add-row\", payload });\n\n    // The new row is not rendered at this moment yet so we need to schedule\n    // a task to focus it later\n    window.setTimeout(() => {\n        const nextRow = row.nextElementSibling;\n        if (nextRow === null) throw Error(\"nextRow is null\");\n        const nextColumn = getColumnByIndex(nextRow, 1);\n        setJustLeftEdit(); // Show the edit mode\n        focusChild(nextColumn);\n    }, 0);\n};\n\nexport const createRowOnTab = (props: Props) => {\n    return (event: React.KeyboardEvent): void => {\n        switch (event.key) {\n            case \"Tab\":\n                action(props, event);\n        }\n    };\n};\n","import { DivPx } from \"@moai/core\";\nimport { RowEdgesMap } from \"app/view/canvas/edge\";\nimport { EditColumn, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport React from \"react\";\nimport { TableBodyAdd } from \"./add/add\";\nimport s from \"./body.module.scss\";\nimport { navigateOnArrowKeys } from \"./events/navigate\";\nimport { TableBodyHeader } from \"./header/header\";\nimport { TableBodyRows } from \"./rows/rows\";\nimport { createRowOnTab } from \"./events/create\";\nimport { ShowCreateEdgePopup } from \"app/edge/create/state\";\n\ninterface Props {\n    // Table\n    table: EditTable;\n    rowEdgesMap: RowEdgesMap | undefined;\n    // Edit\n    isEdit: boolean;\n    setIsEdit: React.Dispatch<React.SetStateAction<boolean>>;\n    // Diagram\n    columns: EditColumn[];\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    showCreateEdge: ShowCreateEdgePopup;\n}\n\nconst onFocus = (props: Props) => (event: React.FocusEvent) => {\n    const related = event.relatedTarget as Node | null;\n    if (event.currentTarget.contains(related)) return;\n    if (event.target instanceof HTMLButtonElement) return;\n    props.setIsEdit(true);\n};\n\nexport const TableBody = (props: Props) => {\n    const [isExpand, setIsExpand] = React.useState(false);\n\n    React.useEffect(() => {\n        if (!props.isEdit) setIsExpand(false);\n    }, [props.isEdit]);\n\n    return (\n        <div className={s.container} onFocus={onFocus(props)}>\n            <DivPx size={8} />\n\n            {/* HEADER */}\n            {props.isEdit && (\n                <div className={s.header}>\n                    <TableBodyHeader\n                        columns={props.columns}\n                        isExpand={isExpand}\n                        setIsExpand={setIsExpand}\n                    />\n                </div>\n            )}\n\n            {/* BODY */}\n            <div\n                onKeyDown={(event) => {\n                    navigateOnArrowKeys(event);\n                    createRowOnTab({\n                        diagramDispatch: props.diagramDispatch,\n                        tableId: props.table.id,\n                    })(event);\n                }}\n            >\n                <TableBodyRows\n                    // rows\n                    table={props.table}\n                    rowEdgesMap={props.rowEdgesMap}\n                    isEdit={props.isEdit}\n                    isColumnsExpand={isExpand}\n                    // diagram\n                    columns={props.columns}\n                    diagramDispatch={props.diagramDispatch}\n                    showCreateEdge={props.showCreateEdge}\n                />\n            </div>\n\n            {/* FOOTER */}\n            {(props.isEdit || props.table.value.rows.length === 0) && (\n                <TableBodyAdd\n                    tableId={props.table.id}\n                    diagramDispatch={props.diagramDispatch}\n                />\n            )}\n\n            <DivPx size={8} />\n        </div>\n    );\n};\n","import { Input } from \"@moai/core\";\n\nimport { EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { UpdateTableNamePayload } from \"diagram/reducer/table/update-name\";\nimport React from \"react\";\nimport s from \"./name.module.scss\";\nimport { TABLE_CLIENT_WIDTH } from \"app/dom/constants\";\n\ninterface Props {\n    table: EditTable;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    setIsEdit: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\ntype FocusEvent = React.FocusEvent<HTMLInputElement>;\n\nconst updateTableName = (props: Props, event: FocusEvent) => {\n    const { value } = event.currentTarget;\n    if (value === props.table.value.name) return;\n    const payload: UpdateTableNamePayload = { id: props.table.id, name: value };\n    props.diagramDispatch({ type: \"update-table-name\", payload });\n};\n\nexport const HeaderName = (props: Props) => {\n    // Because HeaderName is draggable, this helps us identify if a drag\n    // happened or just a click\n    const offset = React.useRef({ x: 0, y: 0 });\n\n    // This is the component's internal isEdit state, which decides whether to\n    // show an Input or a div. It's different from props.isEdit, which is\n    // the whole table's edit state\n    const [isEdit, setIsEdit] = React.useState(false);\n    return (\n        <div\n            className={s.container}\n            style={{\n                width: TABLE_CLIENT_WIDTH - 16,\n            }}\n        >\n            {isEdit ? (\n                <Input\n                    key={props.table.value.name} // uncontrolled\n                    defaultValue={props.table.value.name}\n                    onBlur={(event) => {\n                        updateTableName(props, event);\n                        setIsEdit(false);\n                    }}\n                    onFocus={() => {\n                        props.setIsEdit(false);\n                    }}\n                    style={Input.style.flat}\n                    size={Input.size.small}\n                    autoFocus\n                />\n            ) : (\n                <div\n                    className={[s.view, Input.size.small.main].join(\" \")}\n                    onMouseDown={(event) => {\n                        offset.current.x = event.clientX;\n                        offset.current.y = event.clientY;\n                    }}\n                    onClick={(event) => {\n                        const { x: x1, y: y1 } = offset.current;\n                        const { clientX: x2, clientY: y2 } = event;\n                        // Only enter edit mode if this is not a drag\n                        if (x1 === x2 && y1 === y2) setIsEdit(true);\n                    }}\n                >\n                    {props.table.value.name}\n                </div>\n            )}\n        </div>\n    );\n};\n","import { background, Button, ButtonMenu } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { exportDiagram, ExportTextOptions } from \"diagram/export/export\";\nimport { emptyDiagram } from \"diagram/library/fallback\";\nimport { EditColumn, EditDiagram, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { DuplicateTablePayload } from \"diagram/reducer/table/duplicate\";\nimport { RemoveTablePayload } from \"diagram/reducer/table/remove\";\nimport React from \"react\";\nimport { showAlert } from \"@moai/core\";\nimport { copyToClipboard } from \"utils/clipboard\";\nimport s from \"./menu.module.css\";\n\ninterface Props {\n    table: EditTable;\n    columns: EditColumn[];\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nconst remove = (props: Props): void => {\n    const payload: RemoveTablePayload = { id: props.table.id };\n    props.diagramDispatch({ type: \"remove-table\", payload });\n};\n\nconst exportOptions: ExportTextOptions = {\n    type: \"text\",\n    level: \"edit\",\n    format: \"json\",\n};\n\nconst copy = async (props: Props): Promise<void> => {\n    const diagram: EditDiagram = {\n        ...emptyDiagram,\n        columns: props.columns,\n        tables: [props.table],\n    };\n    const text = exportDiagram(diagram, exportOptions).value;\n    await copyToClipboard(text);\n    await showAlert([\n        \"Your table is copied to clipboard\",\n        \"To paste it, press Ctrl/Cmd + V\",\n    ]);\n};\n\nconst duplicate = (props: Props): void => {\n    const payload: DuplicateTablePayload = { id: props.table.id };\n    props.diagramDispatch({ type: \"duplicate-table\", payload });\n};\n\nexport const TableHeaderMenu = (props: Props) => (\n    <div className={[s.container, background.primary].join(\" \")}>\n        <ButtonMenu\n            items={[\n                { label: \"Copy to clipboard\", fn: () => copy(props) },\n                { label: \"Duplicate table\", fn: () => duplicate(props) },\n                \"divider\",\n                { label: \"Delete table\", fn: () => remove(props) },\n            ]}\n            button={{\n                style: Button.style.flat,\n                size: Button.size.small,\n                icon: icons.more,\n            }}\n        />\n    </div>\n);\n","import { EditColumn, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport React from \"react\";\nimport s from \"./header.module.scss\";\nimport { HeaderName } from \"./name/name\";\nimport { TableHeaderMenu } from \"./menu/menu\";\n\ninterface Props {\n    table: EditTable;\n    columns: EditColumn[];\n    isEdit: boolean;\n    setIsEdit: React.Dispatch<React.SetStateAction<boolean>>;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nexport const TableHeader: React.FC<Props> = (props) => (\n    <div className={`${s.container} ${props.isEdit ? s.edit : \"\"}`}>\n        <div className={s.main}>\n            <HeaderName\n                table={props.table}\n                setIsEdit={props.setIsEdit}\n                diagramDispatch={props.diagramDispatch}\n            />\n            <div className={s.menu}>\n                <TableHeaderMenu\n                    table={props.table}\n                    columns={props.columns}\n                    diagramDispatch={props.diagramDispatch}\n                />\n            </div>\n        </div>\n    </div>\n);\n","/** Turn off Edit mode on blur */\nexport const onTableBlur = (\n    isRowDragging: boolean,\n    setIsEdit: React.Dispatch<React.SetStateAction<boolean>>\n) => {\n    if (isRowDragging) return undefined;\n    return (event: React.FocusEvent<HTMLDivElement>) => {\n        const target = event.relatedTarget as Node | null;\n        // If inside Table\n        if (event.currentTarget.contains(target)) return;\n        // If inside CreateEdgePopup\n        const createEdge = document.getElementById(\"create-edge-popup\");\n        if (createEdge !== null && createEdge.contains(target)) return;\n        // All else -> turn off Edit mode\n        setIsEdit(false);\n    };\n};\n","import { background, Border, borderColor, boxShadow } from \"@moai/core\";\nimport { ShowCreateEdgePopup } from \"app/edge/create/state\";\nimport { RowDragItem } from \"app/row/drag/drag\";\nimport { TableEdgesInfo, RelatedTable } from \"app/view/canvas/edge\";\nimport * as Select from \"app/view/select/select\";\nimport { EditColumn, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport React from \"react\";\nimport { DragLayerMonitor, useDragLayer } from \"react-dnd\";\nimport { debugLog } from \"utils/debug\";\nimport { TableBody } from \"../body/body\";\nimport { TableHeader } from \"../header/header\";\nimport { onTableBlur } from \"./event\";\nimport s from \"./main.module.scss\";\n\nexport interface Props {\n    // Table\n    table: EditTable;\n    tableEdgesInfo: TableEdgesInfo | undefined;\n    // Select\n    isSelected: boolean;\n    setSelectIds: Select.SetSelectIds;\n    // Diagram\n    columns: EditColumn[];\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    showCreateEdge: ShowCreateEdgePopup;\n}\n\nconst getCls = (props: Props, isEdit: boolean) => {\n    const cls = [\n        s.container,\n        background.primary,\n        borderColor.strong,\n        boxShadow.strong,\n    ];\n    if (props.isSelected) cls.push(s.selected);\n    if (isEdit) cls.push(s.edit);\n    return cls.join(\" \");\n};\n\nconst isMyRow = (props: Props) => (monitor: DragLayerMonitor): boolean => {\n    const item = monitor.getItem();\n    if (item === null) return false;\n    if (item.type !== \"row\") return false;\n    const rowItem = item as RowDragItem;\n    return rowItem.tableId === props.table.id;\n};\n\nconst toEdgeId = (related: RelatedTable): Select.SelectId => ({\n    type: \"ref\",\n    value: related[0].id,\n});\n\nconst onFocus = (props: Props) => () => {\n    props.setSelectIds((prev) => {\n        const related = props.tableEdgesInfo?.relatedTables ?? [];\n        const next: Select.SelectId[] = related.map(toEdgeId);\n        next.push({ type: \"table\", value: props.table.id });\n        return Select.isSameSelectIds(prev, next) ? prev : next;\n    });\n};\n\nconst TableMainPure: React.FC<Props> = (props) => {\n    debugLog(\"TableMain\", props.table.id, props.table.value.id);\n    const [isEdit, setIsEdit] = React.useState(false);\n    const isRowDragging: boolean = useDragLayer(isMyRow(props));\n    return (\n        <div\n            className={getCls(props, isEdit)}\n            onBlur={onTableBlur(isRowDragging, setIsEdit)}\n            tabIndex={0} // Avoid losing edit mode when dragging\n            onFocus={onFocus(props)}\n        >\n            <TableHeader\n                // Table\n                table={props.table}\n                isEdit={isEdit}\n                setIsEdit={setIsEdit}\n                // Diagram\n                columns={props.columns}\n                diagramDispatch={props.diagramDispatch}\n            />\n            <Border color=\"weak\" />\n            <div style={{ marginTop: -1 }} />\n            <TableBody\n                // table\n                table={props.table}\n                rowEdgesMap={props.tableEdgesInfo?.rowEdgesMap}\n                // Edit\n                isEdit={isEdit}\n                setIsEdit={setIsEdit}\n                // Diagram\n                diagramDispatch={props.diagramDispatch}\n                columns={props.columns}\n                showCreateEdge={props.showCreateEdge}\n            />\n        </div>\n    );\n};\n\nexport const TableMain = React.memo(TableMainPure);\n","import { ShowCreateEdgePopup } from \"app/edge/create/state\";\nimport { TableEdgesInfo } from \"app/view/canvas/edge\";\nimport { SetSelectIds } from \"app/view/select/select\";\nimport { EditColumn, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport React from \"react\";\nimport Draggable from \"react-draggable\";\nimport { debugLog } from \"utils/debug\";\nimport s from \"./active.module.css\";\nimport { onTableDragMove } from \"./drag/move\";\nimport { onTableDragStop } from \"./drag/stop\";\nimport { TableMain } from \"./main/main\";\n\ninterface Props {\n    table: EditTable;\n    tableEdgesInfo: TableEdgesInfo | undefined;\n    // Diagram\n    columns: EditColumn[];\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    showCreateEdge: ShowCreateEdgePopup;\n    // Select\n    isSelected: boolean;\n    setSelectId: SetSelectIds;\n    // View\n    zoom: number;\n}\n\nexport const TableActive = (props: Props) => {\n    debugLog(\"CanvasTable\");\n    const dragRef = React.useRef<HTMLDivElement>(null);\n    const { table, diagramDispatch } = props;\n    const relatedTables = props.tableEdgesInfo?.relatedTables ?? [];\n    return (\n        <Draggable\n            position={{ x: 0, y: 0 }}\n            onDrag={onTableDragMove({ table, relatedTables })}\n            onStop={onTableDragStop({ table, diagramDispatch })}\n            nodeRef={dragRef}\n            scale={props.zoom}\n            cancel=\"input, button, select, .react-draggable-cancel\"\n        >\n            <div ref={dragRef} className={s.container}>\n                <TableMain\n                    table={props.table}\n                    tableEdgesInfo={props.tableEdgesInfo}\n                    // Select\n                    isSelected={props.isSelected}\n                    setSelectIds={props.setSelectId}\n                    // Diagram\n                    columns={props.columns}\n                    diagramDispatch={props.diagramDispatch}\n                    showCreateEdge={props.showCreateEdge}\n                />\n            </div>\n        </Draggable>\n    );\n};\n","import { background, borderColor } from \"@moai/core\";\nimport { EditTable } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\nimport { getTableEstimatedSize } from \"app/dom/size\";\nimport s from \"./blank.module.css\";\n\ninterface Props {\n    table: EditTable;\n}\n\nconst cls = [s.container, background.primary, borderColor.strong].join(\" \");\n\nexport const TableBlank = (props: Props) => (\n    <div className={cls} style={getTableEstimatedSize(props.table)} />\n);\n","import { background, Border, borderColor, text } from \"@moai/core\";\nimport { TABLE_CLIENT_WIDTH } from \"app/dom/constants\";\nimport { getRowElementId } from \"app/dom/dom\";\nimport { getRowHeight } from \"app/dom/size\";\nimport { RowEdges, RowEdgesMap } from \"app/view/canvas/edge\";\nimport { EditColumn, EditRow, EditTable } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\nimport { TableRowsHeadless } from \"../rows/headless\";\n\ninterface SharedProps {\n    table: EditTable;\n    columns: EditColumn[];\n}\n\ninterface Props extends SharedProps {\n    rowEdgesMap: RowEdgesMap | undefined;\n}\n\ninterface RowProps extends SharedProps {\n    row: EditRow;\n    rowEdges: RowEdges | undefined;\n}\n\nconst Field = (props: RowProps & { index: number }) => (\n    <div\n        style={{\n            flex: props.index === 0 ? \"1 1 0px\" : \"0 0 auto\",\n            overflow: \"hidden\",\n            textOverflow: \"ellipsis\",\n            whiteSpace: \"nowrap\",\n            textAlign: props.index === 1 ? \"right\" : undefined,\n        }}\n        className={props.index === 1 ? text.muted : \"\"}\n    >\n        {props.row.value[props.columns[props.index].value.name] ?? \"<empty>\"}\n    </div>\n);\n\nconst getRowStyle = (props: RowProps): React.CSSProperties => {\n    const height = getRowHeight(props.rowEdges?.to.size ?? 0);\n    return { display: \"flex\", alignItems: \"center\", padding: \"0 16px\", height };\n};\n\nconst Row = (props: RowProps) => (\n    <div\n        style={getRowStyle(props)}\n        id={getRowElementId(props.table.id, props.row.id)}\n    >\n        <Field {...props} index={0} />\n        <div style={{ width: 8 }} />\n        <Field {...props} index={1} />\n    </div>\n);\n\nconst containerProps: React.HTMLAttributes<HTMLDivElement> = {\n    className: [background.primary, borderColor.strong].join(\" \"),\n    style: {\n        lineHeight: \"24px\",\n        borderStyle: \"solid\",\n        borderWidth: 1,\n        width: TABLE_CLIENT_WIDTH + 2,\n        margin: -1, // Same for active table\n    },\n};\n\nconst headerStyle: React.CSSProperties = {\n    padding: 8,\n    fontWeight: 600,\n    textAlign: \"center\",\n};\n\nconst HiddenRows = (props: { count: number }) => (\n    <div style={{ textAlign: \"center\" }}>{props.count} columns hidden</div>\n);\n\nexport const TableInactive = (props: Props) => (\n    <div {...containerProps}>\n        <div style={headerStyle}>{props.table.value.name}</div>\n        <Border color=\"weak\" />\n        <div style={{ marginTop: -1 }} />\n        <div style={{ padding: \"8px 0\" }}>\n            <TableRowsHeadless\n                table={props.table}\n                rowEdgesMap={props.rowEdgesMap}\n                getRow={(row, rowEdges) => (\n                    <Row {...props} row={row} rowEdges={rowEdges} />\n                )}\n                getHiddenRows={(item) => <HiddenRows count={item.length} />}\n                getHideRowsButton={() => null}\n            />\n        </div>\n    </div>\n);\n","import { TableEdgesInfo } from \"app/view/canvas/edge\";\nimport { SetSelectIds } from \"app/view/select/select\";\nimport { EditColumn, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport React from \"react\";\nimport { TableActive } from \"./active/active\";\nimport { TableBlank } from \"./blank/blank\";\nimport { TableInactive } from \"./inactive/inactive\";\nimport { getTableElementId } from \"app/dom/dom\";\nimport { ShowCreateEdgePopup } from \"app/edge/create/state\";\n\ninterface Props {\n    // Table\n    table: EditTable;\n    tableEdgesInfo: TableEdgesInfo | undefined;\n    // Diagram\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    columns: EditColumn[];\n    showCreateEdge: ShowCreateEdgePopup;\n    // Select\n    isSelected: boolean;\n    setSelectId: SetSelectIds;\n    // View\n    viewportRef: React.RefObject<HTMLDivElement>;\n    zoom: number;\n    isCapture: boolean;\n}\n\nconst observerCallback = (\n    setIsVisible: React.Dispatch<React.SetStateAction<boolean>>\n) => (entries: IntersectionObserverEntry[]) => {\n    entries.forEach((entry) => {\n        setIsVisible(entry.isIntersecting);\n    });\n};\n\n/**\n * There are 3 versions of the inner table:\n * - active:   to render when the table is inside the user's viewport. This has\n *             all features and interactions\n * - inactive: lightweight version to render when capturing as image. This has\n *             complete info but no interactions\n * - blank:    a placeholder to render when the table is not inside the user's\n *             viewport. Think of this like a ghost version when the user\n *             scroll through their viewport.\n */\nconst getInnerTable = (props: Props, isVisible: boolean) => {\n    if (props.isCapture)\n        return (\n            <TableInactive\n                table={props.table}\n                columns={props.columns}\n                rowEdgesMap={props.tableEdgesInfo?.rowEdgesMap}\n            />\n        );\n    if (!isVisible) return <TableBlank table={props.table} />;\n    return (\n        <TableActive\n            table={props.table}\n            tableEdgesInfo={props.tableEdgesInfo}\n            // Diagram\n            columns={props.columns}\n            diagramDispatch={props.diagramDispatch}\n            showCreateEdge={props.showCreateEdge}\n            // Select\n            isSelected={props.isSelected}\n            setSelectId={props.setSelectId}\n            // View\n            zoom={props.zoom}\n        />\n    );\n};\n\nconst TablePure = (props: Props) => {\n    const ref = React.useRef<HTMLDivElement>(null);\n    const [isVisible, setSelfVisible] = React.useState(false);\n\n    React.useEffect(() => {\n        const callback = observerCallback(setSelfVisible);\n        const observer = new IntersectionObserver(callback, {\n            threshold: 0,\n            root: props.viewportRef.current,\n        });\n        if (ref.current === null) throw Error(\"ref is null\");\n        observer.observe(ref.current);\n        return () => observer.disconnect();\n    }, [props.viewportRef]);\n\n    return (\n        <div\n            id={getTableElementId(props.table.id)}\n            style={{\n                position: \"absolute\",\n                top: props.table.position.top,\n                left: props.table.position.left,\n                // Needs to be set here because this is top-level table\n                zIndex: props.isSelected ? 1 : 0,\n            }}\n            ref={ref}\n            // Temporary use to avoid using previous table size for new layout\n            data-name={props.table.value.name}\n            // Edges will watch this attribute to re-draw themselves\n            data-is-visible={isVisible}\n        >\n            {getInnerTable(props, isVisible)}\n        </div>\n    );\n};\n\nexport const Table = React.memo(TablePure);\n","import { SelectPosition, SelectBox } from \"./drag\";\n\nexport const getDragBox = (\n    startRef: React.RefObject<SelectPosition>,\n    event: React.MouseEvent\n): SelectBox => {\n    const start = startRef.current;\n    if (start === null) throw Error(\"start is null\");\n    const current = {\n        left: event.nativeEvent.offsetX,\n        top: event.nativeEvent.offsetY,\n    };\n    const top = Math.min(start.top, current.top);\n    const right = Math.max(start.left, current.left);\n    const bottom = Math.max(start.top, current.top);\n    const left = Math.min(start.left, current.left);\n    const [width, height] = [right - left, bottom - top];\n    return { top, left, width, height };\n};\n\nexport const setOpacity = (element: HTMLDivElement, opacity: string): void => {\n    element.style.opacity = opacity;\n};\n\nconst emptyBox: SelectBox = { top: 0, left: 0, width: 0, height: 0 };\n\nexport const setSize = (element: HTMLDivElement, box: SelectBox): void => {\n    element.style.width = `${box.width}px`;\n    element.style.height = `${box.height}px`;\n    element.style.transform = `translate(${box.left}px, ${box.top}px)`;\n};\n\nexport const setDragBoxStyles = (\n    boxRef: React.RefObject<HTMLDivElement>,\n    box: SelectBox | \"start\" | \"stop\"\n): void => {\n    const { current: element } = boxRef;\n    if (element === null) throw Error(\"boxRef is null\");\n    if (box === \"start\") {\n        setSize(element, emptyBox);\n        setOpacity(element, \"1\");\n    } else if (box === \"stop\") {\n        setOpacity(element, \"0\");\n    } else {\n        setSize(element, box);\n    }\n};\n","import { getTableElement } from \"app/dom/dom\";\nimport { EditDiagram, EditRef } from \"diagram/models/edit/edit\";\nimport { Position } from \"diagram/models/layout\";\nimport { SelectId, SelectIdType } from \"../../select\";\nimport { SelectBox } from \"./drag\";\n\nconst isBoxOverlap = (a: SelectBox, b: SelectBox) => {\n    // If one rectangle is on the left side of other\n    if (a.left > b.left + b.width) return false;\n    if (b.left > a.left + a.width) return false;\n    // If one rectangle is above the other\n    if (a.top > b.top + b.height) return false;\n    if (b.top > a.top + a.height) return false;\n    // Otherwise it overlaps\n    return true;\n};\n\nexport const isTableOverlap = (props: {\n    target: SelectBox;\n    position: Position;\n    element: HTMLDivElement;\n}) => {\n    if (props.element.dataset.isVisible !== \"true\") return false;\n    // Get box of \"table\"\n    const { clientWidth: width, clientHeight: height } = props.element;\n    const { top, left } = props.position;\n    const current: SelectBox = { width, height, top, left };\n    // Compare and set\n    return isBoxOverlap(props.target, current);\n};\n\ninterface Props {\n    diagram: EditDiagram;\n}\n\nconst getOverlapTables = (props: Props, target: SelectBox): number[] => {\n    return props.diagram.tables\n        .filter((table) =>\n            isTableOverlap({\n                target,\n                position: table.position,\n                element: getTableElement(table.id),\n            })\n        )\n        .map((table) => table.id);\n};\n\nconst getOverlapRefs = (props: Props, tables: number[]): number[] => {\n    const set = new Set(tables);\n    const isRelated = (ref: EditRef) => {\n        return set.has(ref.from.table) || set.has(ref.to.table);\n    };\n    return props.diagram.refs.filter(isRelated).map((ref) => ref.id);\n};\n\nconst getIds = (ids: number[], type: SelectIdType) =>\n    ids.map((value) => ({ type, value }));\n\nexport const getOverlapIds = (props: Props, box: SelectBox): SelectId[] => {\n    const tables = getOverlapTables(props, box);\n    const refs = getOverlapRefs(props, tables);\n    return [...getIds(tables, \"table\"), ...getIds(refs, \"ref\")];\n};\n","import { getTableElement } from \"app/dom/dom\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport { SelectBox } from \"./drag\";\nimport { isTableOverlap } from \"./overlap\";\nimport { getEdgeElement } from \"app/edge/utils\";\n\nexport const DRAG_SELECT_CLASS = \"temp-selected\";\n\nconst setClass = (element: Element, isOverlap: boolean) => {\n    if (isOverlap) {\n        element.classList.add(DRAG_SELECT_CLASS);\n    } else {\n        element.classList.remove(DRAG_SELECT_CLASS);\n    }\n};\n\nexport const setTempSelect = (target: SelectBox, diagram: EditDiagram) => {\n    const selected = new Set<number>();\n    diagram.tables.forEach((table) => {\n        const element = getTableElement(table.id);\n        const { position } = table;\n        const isOverlap = isTableOverlap({ target, element, position });\n        if (isOverlap) selected.add(table.id);\n        setClass(element, isOverlap);\n    });\n    diagram.refs.forEach((ref) => {\n        const isOverlap =\n            selected.has(ref.from.table) || selected.has(ref.to.table);\n        const element = getEdgeElement(ref.id);\n        setClass(element, isOverlap);\n    });\n};\n\nexport const resetTempSelect = () => {\n    document.querySelectorAll(`.${DRAG_SELECT_CLASS}`).forEach((element) => {\n        element.classList.remove(DRAG_SELECT_CLASS);\n    });\n};\n","import { EditDiagram } from \"diagram/models/edit/edit\";\nimport React from \"react\";\nimport { debugLog } from \"utils/debug\";\nimport { SelectId, SetSelectIds } from \"../../select\";\nimport { getDragBox, setDragBoxStyles } from \"./box\";\nimport s from \"./drag.module.css\";\nimport { resetTempSelect, setTempSelect } from \"./element\";\nimport { getOverlapIds } from \"./overlap\";\n\nexport interface SelectBox {\n    top: number;\n    left: number;\n    width: number;\n    height: number;\n}\n\nexport interface SelectPosition {\n    top: number;\n    left: number;\n}\n\ninterface Props {\n    diagram: EditDiagram;\n    setSelectIds: SetSelectIds;\n}\ntype ContainerRef = React.RefObject<HTMLDivElement>;\n\nconst setContainerStyles = (ref: ContainerRef, isDragging: boolean): void => {\n    const { current: element } = ref;\n    if (element === null) throw Error(\"containerRef is null\");\n    // Win table's z index, which is 1\n    element.style.zIndex = isDragging ? \"2\" : \"0\";\n};\n\n// For stable identities\nconst emptyIds: SelectId[] = [];\n\nconst SelectDragLayerPure = (props: Props) => {\n    debugLog(\"CanvasSelectDragPure\");\n    const start = React.useRef<null | SelectPosition>(null);\n    const isDraggingRef = React.useRef(false);\n    const boxRef = React.useRef<HTMLDivElement>(null);\n    const containerRef = React.useRef<HTMLDivElement>(null);\n    const spaceLockRef = React.useRef<boolean>(false);\n    return (\n        <div\n            className={s.container}\n            tabIndex={0}\n            onKeyDown={(event: React.KeyboardEvent) => {\n                if (event.key === \" \") spaceLockRef.current = true;\n            }}\n            onKeyUp={(event: React.KeyboardEvent) => {\n                if (event.key === \" \") spaceLockRef.current = false;\n            }}\n            onMouseDown={(event: React.MouseEvent) => {\n                if (spaceLockRef.current === true) return;\n                const { offsetX, offsetY } = event.nativeEvent;\n                start.current = { left: offsetX, top: offsetY };\n                isDraggingRef.current = true;\n                // Set drag styles\n                setContainerStyles(containerRef, true);\n                setDragBoxStyles(boxRef, \"start\");\n                // Reset ids\n                props.setSelectIds(emptyIds);\n            }}\n            onMouseMove={(event: React.MouseEvent) => {\n                if (isDraggingRef.current === false) return;\n                const box = getDragBox(start, event);\n                // Set styles\n                setDragBoxStyles(boxRef, box);\n                // Set select state (but not set select ids to avoid React's\n                // re-renders)\n                setTempSelect(box, props.diagram);\n            }}\n            onMouseUp={(event: React.MouseEvent) => {\n                if (isDraggingRef.current === false) return;\n                isDraggingRef.current = false;\n                // Reset drag styles\n                resetTempSelect();\n                setContainerStyles(containerRef, false);\n                setDragBoxStyles(boxRef, \"stop\");\n                // Set ids\n                const box = getDragBox(start, event);\n                const ids = getOverlapIds({ diagram: props.diagram }, box);\n                props.setSelectIds(ids);\n                // Done\n                start.current = null;\n            }}\n            ref={containerRef}\n        >\n            <div ref={boxRef} className={s.box}>\n                <div className={s.boxBg} />\n            </div>\n        </div>\n    );\n};\n\nexport const SelectDragLayer = React.memo(SelectDragLayerPure);\n","import { EditEdge, EditTable } from \"diagram/models/edit/edit\";\n\nexport interface RowEdges {\n    from: EditEdge | null;\n    to: Set<EditEdge>;\n}\n\nexport type RowEdgesMap = Map<number /* RowId */, RowEdges>;\n\nexport type RelatedTable = [EditEdge, EditTable]\n\nexport interface TableEdgesInfo {\n    /** Map from table's row's id to related edges */\n    rowEdgesMap: RowEdgesMap;\n    /** List of edges and the table at the other side of the edge */\n    relatedTables: RelatedTable[];\n}\n\nexport type TableEdgesInfoMap = Map<number /* TableId */, TableEdgesInfo>;\n\ntype TableMap = Map<number /* TableId */, EditTable>;\n\nconst newInfo = (): TableEdgesInfo => ({\n    rowEdgesMap: new Map(),\n    relatedTables: [],\n});\n\nconst updateEdgeFrom = (\n    map: TableEdgesInfoMap,\n    tableMap: TableMap,\n    edge: EditEdge\n): void => {\n    const info: TableEdgesInfo = map.get(edge.from.table) ?? newInfo();\n\n    // Update rowEdgesMap\n    const rowEdgesMap = new Map(info.rowEdgesMap);\n    edge.from.rows.forEach((rowId) => {\n        const to = rowEdgesMap.get(rowId)?.to ?? new Set();\n        rowEdgesMap.set(rowId, { from: edge, to });\n    });\n\n    // Update otherTables\n    const otherTables = [...info.relatedTables];\n    otherTables.push([edge, tableMap.get(edge.to.table)!]);\n\n    map.set(edge.from.table, { rowEdgesMap, relatedTables: otherTables });\n};\n\nconst updateEdgeTo = (\n    map: TableEdgesInfoMap,\n    tableMap: TableMap,\n    edge: EditEdge\n): void => {\n    const info: TableEdgesInfo = map.get(edge.to.table) ?? newInfo();\n\n    // Update rowEdgesMap\n    const rowEdgesMap = new Map(info.rowEdgesMap);\n    edge.to.rows.forEach((rowId) => {\n        const from = rowEdgesMap.get(rowId)?.from ?? null;\n        const to = new Set(rowEdgesMap.get(rowId)?.to);\n        to.add(edge);\n        rowEdgesMap.set(rowId, { from, to });\n    });\n\n    // Update otherTables\n    const otherTables = [...info.relatedTables];\n    otherTables.push([edge, tableMap.get(edge.from.table)!]);\n\n    map.set(edge.to.table, { rowEdgesMap, relatedTables: otherTables });\n};\n\nexport const getTableEdgesInfoMap = (\n    tableMap: TableMap,\n    edges: EditEdge[]\n): TableEdgesInfoMap => {\n    const map: TableEdgesInfoMap = new Map();\n    edges.forEach((edge) => {\n        updateEdgeFrom(map, tableMap, edge);\n        updateEdgeTo(map, tableMap, edge);\n    });\n    return map;\n};\n","import { background } from \"@moai/core\";\nimport { EdgesCanvas } from \"app/edge/canvas/canvas\";\nimport { ShowCreateEdgePopup } from \"app/edge/create/state\";\nimport { Table } from \"app/table/table\";\nimport { EditDiagram, EditTable } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { Prefs } from \"pref/pref\";\nimport React from \"react\";\nimport { debugLog } from \"utils/debug\";\nimport { Platform, usePlatform } from \"utils/platform\";\nimport { SelectDragLayer } from \"../select/canvas/drag/drag\";\nimport { SetSelectIds } from \"../select/select\";\nimport s from \"./canvas.module.scss\";\nimport { getTableEdgesInfoMap } from \"./edge\";\n\ninterface Props {\n    // Diagram\n    diagram: EditDiagram;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    viewportRef: React.RefObject<HTMLDivElement>;\n    isCapture: boolean;\n    showCreateEdge: ShowCreateEdgePopup;\n    // Select\n    selectedTables: Set<number>;\n    selectedRefs: Set<number>;\n    setSelectIds: SetSelectIds;\n    // Prefs\n    prefs: Prefs;\n}\n\nconst getContainerStyle = (\n    props: Props,\n    platform: Platform\n): React.CSSProperties => {\n    const [{ zoom }, { width, height }] = [props.prefs, props.diagram.size];\n    const halfMargin = (zoom - 1) / 2;\n    const margin = `${height * halfMargin}px ${width * halfMargin}px`;\n    const transform = zoom !== 1 ? `scale(${zoom})` : \"\";\n    const fontSize = platform === \"mac\" ? 12 : undefined;\n    return { width, height, transform, margin, fontSize };\n};\n\nexport type TablesMap = Map<number, EditTable>;\n\nconst toTablesMap = (map: TablesMap, table: EditTable): TablesMap => {\n    map.set(table.id, table);\n    return map;\n};\n\nexport const Canvas = (props: Props) => {\n    debugLog(\"Canvas\");\n\n    const { refs, tables } = props.diagram;\n    const tableMap = React.useMemo(() => {\n        return tables.reduce(toTablesMap, new Map());\n    }, [tables]);\n    const tableEdgesInfoMap = React.useMemo(() => {\n        return getTableEdgesInfoMap(tableMap, refs);\n    }, [refs, tableMap]);\n    const platform = usePlatform();\n\n    return (\n        <div\n            id=\"canvas\"\n            className={[s.container, background.secondary].join(\" \")}\n            style={getContainerStyle(props, platform)}\n        >\n            {/* Separate grid so both grid and background color is included\n            in exported image */}\n            <div className={s.grid} />\n            {!props.isCapture && (\n                <SelectDragLayer\n                    diagram={props.diagram}\n                    setSelectIds={props.setSelectIds}\n                />\n            )}\n            <EdgesCanvas\n                diagram={props.diagram}\n                diagramDispatch={props.diagramDispatch}\n                setSelectIds={props.setSelectIds}\n                selectedRefs={props.selectedRefs}\n                tablesMap={tableMap}\n                edgeAnimation={props.prefs.edgeAnimation}\n            />\n            {props.diagram.tables.map((table) => (\n                <Table\n                    key={table.id}\n                    // Table\n                    table={table}\n                    tableEdgesInfo={tableEdgesInfoMap.get(table.id)}\n                    // Select\n                    isSelected={props.selectedTables.has(table.id)}\n                    setSelectId={props.setSelectIds}\n                    // Diagram\n                    columns={props.diagram.columns}\n                    diagramDispatch={props.diagramDispatch}\n                    showCreateEdge={props.showCreateEdge}\n                    // View\n                    viewportRef={props.viewportRef}\n                    zoom={props.prefs.zoom}\n                    isCapture={props.isCapture}\n                />\n            ))}\n        </div>\n    );\n};\n","import React from \"react\";\nimport dragscroll from \"dragscroll\";\n\nimport \"./use-drag.scss\";\n\n\ninterface State {\n    drag: boolean;\n    setDrag: React.Dispatch<React.SetStateAction<boolean>>;\n    element: HTMLDivElement;\n}\n\nconst onKeyUp = (state: State) => {\n    const me = () => {\n        state.setDrag(false);\n        state.element.classList.remove(\"dragscroll\");\n        dragscroll.reset();\n        state.element.removeEventListener(\"keyup\", me);\n    };\n    return me;\n};\n\nconst onKeyDown = (state: State) => (event: KeyboardEvent) => {\n    if (event.target instanceof HTMLInputElement) return;\n    if (event.key !== \" \") return;\n    event.preventDefault();\n    if (state.drag) return;\n\n    state.setDrag(true);\n    state.element.classList.add(\"dragscroll\");\n    dragscroll.reset();\n    state.element.addEventListener(\"keyup\", onKeyUp(state));\n};\n\nexport const useDragToScroll = (ref: React.RefObject<HTMLDivElement>) => {\n    const [drag, setDrag] = React.useState(false);\n\n    React.useEffect(() => {\n        const element = ref.current;\n        if (element === null) return;\n        const state = { drag, setDrag, element };\n\n        element.tabIndex = 0;\n        const listener = onKeyDown(state);\n        element.addEventListener(\"keydown\", listener);\n        return () => element.removeEventListener(\"keydown\", listener);\n    }, [drag, ref]);\n};\n","import { Button } from \"@moai/core\";\nimport { createLibraryDiagram } from \"diagram/library/actions\";\nimport { emptyDiagram } from \"diagram/library/fallback\";\nimport * as React from \"react\";\nimport { LibraryPaneProps } from \"../library\";\nimport { ImportPayload } from \"diagram/reducer/import/import\";\nimport { icons } from \"@moai/icon\";\n\ninterface Props extends LibraryPaneProps {}\n\nexport const LibraryCreate = (props: Props) => (\n    <Button\n        onClick={() => {\n            createLibraryDiagram(emptyDiagram, props.setLibrary);\n            const source = emptyDiagram;\n            const payload: ImportPayload = { isAppend: false, source };\n            props.diagramDispatch({ type: \"import\", payload });\n        }}\n        children=\"Diagram\"\n        icon={icons.plus}\n    />\n);\n","import { exportDiagram, ExportTextOptions } from \"diagram/export/export\";\nimport { getLibraryDiagram } from \"diagram/library/actions\";\nimport { showAlert } from \"@moai/core\";\nimport { copyToClipboard } from \"utils/clipboard\";\nimport { saveFile } from \"utils/file/file\";\nimport { Platform } from \"utils/platform\";\n\nconst exportOptions: ExportTextOptions = {\n    type: \"text\",\n    format: \"json\",\n    level: \"edit\",\n};\n\nexport const libraryItemExport = async (\n    name: string,\n    platform: Platform,\n    target: \"file\" | \"clipboard\"\n): Promise<void> => {\n    const diagram = getLibraryDiagram(name);\n    if (diagram === null) throw Error(`Diagram \"${name}\" is null`);\n    const text = exportDiagram(diagram, exportOptions).value;\n    switch (target) {\n        case \"clipboard\":\n            await copyToClipboard(text);\n            showAlert([\n                `Diagram \"${name}\" is copied to clipboard. `,\n                `To import it, go to \"Import\" > \"Import from text\"`,\n            ]);\n            break;\n        case \"file\":\n            saveFile({\n                platform: platform,\n                format: \"diagram\",\n                name: `${name} diagram`,\n                content: text,\n            });\n            break;\n    }\n};\n","import * as Actions from \"diagram/library/actions\";\nimport { emptyDiagram } from \"diagram/library/fallback\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport { ImportPayload } from \"diagram/reducer/import/import\";\nimport { showConfirm } from \"@moai/core\";\nimport { LibraryItemProps } from \"../item\";\n\nexport const libraryItemRemove = async (\n    props: LibraryItemProps\n): Promise<void> => {\n    const sure = await showConfirm([\n        `Are you sure you want to delete \"${props.name}\"?`,\n        \"This action is NOT reversible.\",\n    ]);\n    if (sure === false) return;\n    Actions.deleteLibraryDiagram(props.name, props.setLibrary);\n    if (props.library.current !== props.name) return;\n    // When delete current diagram\n    const next = props.library.all.find((n) => n !== props.name);\n    let source: EditDiagram;\n    if (next !== undefined) {\n        // If there is other diagram ---> select them\n        source = Actions.openLibraryDiagram(next, props.setLibrary);\n    } else {\n        // If deleting the last diagram ---> create new one\n        Actions.createLibraryDiagram(emptyDiagram, props.setLibrary);\n        source = emptyDiagram;\n    }\n    const payload: ImportPayload = { source, isAppend: false };\n    props.diagramDispatch({ type: \"import\", payload });\n};\n","import { Button, ButtonMenu, ButtonMenuItem } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { duplicateLibraryDiagram } from \"diagram/library/actions\";\nimport * as React from \"react\";\nimport { usePlatform } from \"utils/platform\";\nimport { LibraryItemProps } from \"../item\";\nimport { libraryItemExport } from \"./export\";\nimport { libraryItemRemove } from \"./remove\";\n\nconst duplicate = (props: LibraryItemProps): void => {\n    duplicateLibraryDiagram(props.name, props.library.all, props.setLibrary);\n};\n\nexport const LibraryItemMenu = (props: LibraryItemProps) => {\n    const platform = usePlatform();\n    const exportItem = libraryItemExport.bind(null, props.name, platform);\n    const items: ButtonMenuItem[] = [\n        { label: \"Save to file\", fn: () => exportItem(\"file\") },\n        { label: \"Copy to clipboard\", fn: () => exportItem(\"clipboard\") },\n        { label: \"Duplicate diagram\", fn: () => duplicate(props) },\n        \"divider\",\n        { label: \"Delete diagram\", fn: () => libraryItemRemove(props) },\n    ];\n    return (\n        <ButtonMenu\n            button={{\n                icon: icons.more,\n                style: Button.style.flat,\n                title: \"More options\",\n            }}\n            items={items}\n        />\n    );\n};\n","import { Button, Input } from \"@moai/core\";\nimport * as Actions from \"diagram/library/actions\";\nimport { ImportPayload } from \"diagram/reducer/import/import\";\nimport * as React from \"react\";\nimport { LibraryPaneProps } from \"../../library\";\nimport s from \"./name.module.scss\";\n\ninterface Props extends LibraryPaneProps {\n    name: string;\n    isEdit: boolean;\n    setIsEdit: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst open = (props: Props): void => {\n    const source = Actions.openLibraryDiagram(props.name, props.setLibrary);\n    const payload: ImportPayload = { source, isAppend: false };\n    props.diagramDispatch({ type: \"import\", payload });\n};\n\nconst rename = async (props: Props, to: string): Promise<void> => {\n    if (to === props.name) return;\n    await Actions.renameLibraryDiagram(props.setLibrary, props.name, to);\n};\n\nexport const LibraryItemName = (props: Props) => {\n    if (props.isEdit) {\n        return (\n            <Input\n                style={Input.style.flat}\n                defaultValue={props.name}\n                // Don't use onKeyDown here as the Enter will also trigger the\n                // auto-focused \"OK\" button in the confirm dialog\n                onKeyUp={async (event) => {\n                    if (event.key !== \"Enter\") return;\n                    await rename(props, event.currentTarget.value);\n                    props.setIsEdit(false);\n                }}\n                onBlur={async (event) => {\n                    await rename(props, event.currentTarget.value);\n                    props.setIsEdit(false);\n                }}\n                autoFocus\n            />\n        );\n    } else {\n        const className = [\n            s.button,\n            Button.style.flat.main,\n            Button.size.medium.main,\n            props.library.current === props.name ? s.current : \"\",\n        ].join(\" \");\n        return (\n            <button\n                className={className}\n                onClick={() => void open(props)}\n                onDoubleClick={() => void props.setIsEdit(true)}\n                children={props.name}\n                title=\"Click to select, Double-click to rename\"\n            />\n        );\n    }\n};\n","import { background, Button, text } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport * as React from \"react\";\nimport { LibraryPaneProps } from \"../library\";\nimport s from \"./item.module.css\";\nimport { LibraryItemMenu } from \"./menu/menu\";\nimport { LibraryItemName } from \"./name/name\";\n\nexport interface LibraryItemProps extends LibraryPaneProps {\n    name: string;\n}\n\nexport const LibraryItem = (props: LibraryItemProps) => {\n    const [isEdit, setIsEdit] = React.useState<boolean>(false);\n    const isCurrent = props.name === props.library.current;\n    return (\n        <div\n            className={[\n                s.container,\n                isCurrent ? background.secondary : \"\",\n            ].join(\" \")}\n        >\n            <div className={s.primary}>\n                <LibraryItemName\n                    {...props}\n                    isEdit={isEdit}\n                    setIsEdit={setIsEdit}\n                />\n            </div>\n            <div className={[s.secondary, text.muted].join(\" \")}>\n                <Button\n                    // Don't toggle the isEdit boolean here because the input\n                    // already close the edit mode on blur\n                    onClick={() => void setIsEdit(true)}\n                    icon={icons.edit}\n                    style={Button.style.flat}\n                    title=\"Rename diagram\"\n                    selected={isEdit}\n                />\n                <LibraryItemMenu {...props} />\n            </div>\n        </div>\n    );\n};\n","import { Border, DivGrow } from \"@moai/core\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport { DiagramAction } from \"diagram/reducer/reducer\";\nimport { LibraryProps } from \"diagram/library/state\";\nimport * as React from \"react\";\nimport { LibraryCreate } from \"./create/create\";\nimport { LibraryItem } from \"./item/item\";\nimport s from \"./library.module.css\";\n\nexport interface LibraryPaneProps extends LibraryProps {\n    diagram: EditDiagram;\n    diagramDispatch: React.Dispatch<DiagramAction>;\n}\n\nexport const LibraryPane = (props: LibraryPaneProps) => (\n    <div className={s.container}>\n        <div className={s.header}>\n            <h1 className={s.title}>Diagrams</h1>\n            <DivGrow />\n            <LibraryCreate {...props} />\n        </div>\n        <Border color=\"weak\" />\n        {props.library.all.map((name) => (\n            <React.Fragment key={name}>\n                <LibraryItem {...props} name={name} />\n                <Border color=\"weak\" />\n            </React.Fragment>\n        ))}\n    </div>\n);\n","import { ProgressCircle, background, DivPx } from \"@moai/core\";\nimport React from \"react\";\nimport s from \"./progress.module.scss\";\nimport { addExternalFn } from \"utils/external\";\n\nexport type Progress = boolean | number;\n\nconst registerExternal = addExternalFn(\"setProgressIndicator\");\n\nexport const ViewProgress = () => {\n    const [progress, setProgress] = React.useState<Progress>(false);\n    const [text, setText] = React.useState<string | undefined>(undefined);\n\n    React.useEffect(() => {\n        const fn = (progress: Progress, text?: string) => {\n            setProgress(progress);\n            setText(text);\n        };\n        registerExternal(fn);\n    }, []);\n\n    if (progress === false) return null;\n    return (\n        <div className={[s.container, background.secondary].join(\" \")}>\n            <div className={s.body}>\n                <ProgressCircle\n                    size={24}\n                    value={progress === true ? null : progress}\n                />\n                {text !== undefined && (\n                    <>\n                        <DivPx size={16} />\n                        <div>{text}</div>\n                    </>\n                )}\n            </div>\n        </div>\n    );\n};\n","import React from \"react\";\nimport s from \"./resize-div.module.scss\";\n\nconst root = document.documentElement;\n\ninterface Props {\n    /** In pixels, the value to be set on double click */\n    fallback?: number;\n    /** In pixels */\n    min: number;\n    /** In pixels */\n    max: number;\n    /** In pixels, to save to storage */\n    onStop: (width: number) => void;\n    /** In pixels, to update in real time */\n    onChange: (width: number) => void;\n}\n\nexport const ResizeDiv = (props: Props) => {\n    const [isDragging, setIsDragging] = React.useState(false);\n\n    const getWidth = (event: MouseEvent): number => {\n        let width = event.clientX;\n        width = Math.min(width, props.max);\n        width = Math.max(width, props.min);\n        return width - 8; // half of container width\n    };\n\n    const whileDrag = (event: MouseEvent) => {\n        props.onChange(getWidth(event));\n    };\n\n    const stopDrag = (event: MouseEvent) => {\n        root.classList.remove(s.disable);\n        root.removeEventListener(\"mousemove\", whileDrag);\n        root.removeEventListener(\"mouseup\", stopDrag);\n        props.onStop(getWidth(event));\n        setIsDragging(false);\n    };\n\n    return (\n        <div\n            className={`${s.container} ${isDragging ? s.drag : s.noDrag}`}\n            onMouseDown={() => {\n                root.classList.add(s.disable);\n                root.addEventListener(\"mousemove\", whileDrag);\n                root.addEventListener(\"mouseup\", stopDrag);\n                setIsDragging(true);\n            }}\n            onDoubleClick={() => {\n                if (props.fallback) props.onStop(props.fallback);\n            }}\n            children={<div className={s.line} />}\n        />\n    );\n};\n","import { Prefs } from \"pref/pref\";\nimport * as React from \"react\";\nimport { ResizeDiv } from \"utils/resize-div/resize-div\";\nimport s from \"./resizer.module.css\";\n\ninterface Props {\n    libraryRef: React.RefObject<HTMLDivElement>;\n    setPrefs: React.Dispatch<React.SetStateAction<Prefs>>;\n}\n\nconst setLibraryWidth = (width: number) => (prev: Prefs): Prefs => ({\n    ...prev,\n    libraryWidth: width,\n});\n\nexport const ViewResizer = (props: Props) => (\n    <div className={s.container}>\n        <ResizeDiv\n            fallback={320}\n            min={240}\n            max={800}\n            onChange={(width) => {\n                const element = props.libraryRef.current;\n                if (element === null) throw Error(\"LibraryRef is null\");\n                element.style.width = `${width}px`;\n            }}\n            onStop={(width) => {\n                props.setPrefs(setLibraryWidth(width));\n            }}\n        />\n    </div>\n);\n","import { exportDiagram } from \"diagram/export/export\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport * as React from \"react\";\nimport { getSelectSets, SelectId } from \"../select\";\n\ninterface Props {\n    ids: SelectId[];\n    diagram: EditDiagram;\n}\n\nconst catchCopy = (props: Props, event: ClipboardEvent) => {\n    if (event.target instanceof HTMLInputElement) return;\n    if (event.target instanceof HTMLTextAreaElement) return;\n    if (props.ids.length === 0) return;\n    const { tables: selected } = getSelectSets(props.ids);\n    if (selected.size === 0) return;\n    const edit: EditDiagram = {\n        type: \"edit\",\n        version: 2,\n        columns: props.diagram.columns,\n        tables: props.diagram.tables.filter((table) => {\n            return selected.has(table.id);\n        }),\n        refs: props.diagram.refs.filter((ref) => {\n            return selected.has(ref.from.table) && selected.has(ref.to.table);\n        }),\n        size: { width: 0, height: 0 },\n        schema: props.diagram.schema,\n    };\n    const result = exportDiagram(edit, {\n        type: \"text\",\n        format: \"json\",\n        level: \"base\",\n    });\n    event.clipboardData?.setData(\"text/plain\", result.value);\n    event.preventDefault();\n};\n\n// @TODO: These should not belong to \"select\"\nexport const useCanvasCatchCopy = (props: Props) => {\n    const { ids, diagram } = props;\n    React.useEffect(() => {\n        const listener = (event: ClipboardEvent) => {\n            return catchCopy({ ids, diagram }, event);\n        };\n        document.addEventListener(\"copy\", listener);\n        return () => document.removeEventListener(\"copy\", listener);\n    }, [ids, diagram]);\n};\n","import { DiagramAction } from \"diagram/reducer/reducer\";\nimport * as React from \"react\";\nimport { SelectId, SelectIdType } from \"../select\";\n\nconst filterIds = (ids: SelectId[], type: SelectIdType): number[] =>\n    ids.filter((id) => id.type === type).map((id) => id.value);\n\ninterface Props {\n    ids: SelectId[];\n    diagramDispatch: React.Dispatch<DiagramAction>;\n    event: React.KeyboardEvent;\n}\n\nexport const catchDelete = ({ ids, event, diagramDispatch }: Props) => {\n    if ([\"Backspace\", \"Delete\"].includes(event.key) === false) return;\n    if (event.target instanceof HTMLInputElement) return;\n    if (event.target instanceof HTMLTextAreaElement) return;\n    diagramDispatch({\n        type: \"remove-multiple-refs\",\n        payload: { ids: filterIds(ids, \"ref\") },\n    });\n    diagramDispatch({\n        type: \"remove-multiple-tables\",\n        payload: { ids: filterIds(ids, \"table\") },\n    });\n    event.stopPropagation();\n};\n","import { DiagramAction } from \"diagram/reducer/reducer\";\nimport * as React from \"react\";\nimport { ImportPayload } from \"diagram/reducer/import/import\";\n\ninterface Props {\n    dispatch: React.Dispatch<DiagramAction>;\n}\n\nconst catchPaste = (props: Props, event: ClipboardEvent) => {\n    if (event.target instanceof HTMLInputElement) return;\n    if (event.target instanceof HTMLTextAreaElement) return;\n    const source = event.clipboardData?.getData(\"text/plain\") ?? \"\";\n    const payload: ImportPayload = { source, isAppend: true };\n    props.dispatch({ type: \"import\", payload });\n};\n\nexport const useCanvasCatchPaste = (props: Props) => {\n    const { dispatch } = props;\n    React.useEffect(() => {\n        const listener = (event: ClipboardEvent) => {\n            return catchPaste({ dispatch }, event);\n        };\n        document.addEventListener(\"paste\", listener);\n        return () => document.removeEventListener(\"paste\", listener);\n    }, [dispatch]);\n};\n","import { background } from \"@moai/core\";\nimport { CreateEdge } from \"app/edge/create/create\";\nimport { useCreateEdge } from \"app/edge/create/state\";\nimport { Header } from \"app/header/header\";\nimport { RowDragLayer } from \"app/row/drag/layer/layer\";\nimport * as Actions from \"diagram/library/actions\";\nimport { useDiagramLibrary } from \"diagram/library/state\";\nimport { EditDiagram } from \"diagram/models/edit/edit\";\nimport { useDiagram } from \"diagram/state/use-diagram\";\nimport { PrefsProps } from \"pref/pref\";\nimport React from \"react\";\nimport { usePlatform } from \"utils/platform\";\nimport { Canvas } from \"./canvas/canvas\";\nimport { useDragToScroll } from \"./drag/use-drag\";\nimport { LibraryPane } from \"./library/library\";\nimport { ViewProgress } from \"./progress/progress\";\nimport { ViewResizer } from \"./resizer/resizer\";\nimport { useCanvasCatchCopy } from \"./select/canvas/copy\";\nimport { catchDelete } from \"./select/canvas/delete\";\nimport { useCanvasCatchPaste } from \"./select/canvas/paste\";\nimport { useSelect } from \"./select/select\";\nimport s from \"./view.module.scss\";\n\nexport type Mode = \"design\" | \"present\" | \"structure\";\n\ninterface Props extends PrefsProps {}\n\nconst useDiagramFull = () => {\n    const platform = usePlatform();\n\n    const libraryState = useDiagramLibrary();\n    const name = libraryState.library.current;\n\n    // Load initial diagram\n    const initial = React.useMemo((): EditDiagram => {\n        return Actions.getInitialLibraryDiagram(platform, name);\n    }, [platform, name]);\n\n    const diagramState = useDiagram(initial);\n    const diagram = diagramState.history.present;\n\n    // Save current diagram\n    React.useEffect(() => {\n        Actions.setLibraryDiagram(diagram, name);\n    }, [diagram, name]);\n\n    return { diagram: diagramState, library: libraryState };\n};\n\nexport const View = (props: Props) => {\n    const { library, diagram } = useDiagramFull();\n    const viewportRef = React.useRef<HTMLDivElement>(null);\n    const libraryRef = React.useRef<HTMLDivElement>(null);\n    const select = useSelect();\n    const [isCapture, setIsCapture] = React.useState(false);\n    const createEdge = useCreateEdge();\n\n    useCanvasCatchCopy({ diagram: diagram.history.present, ids: select.ids });\n    useCanvasCatchPaste({ dispatch: diagram.dispatch });\n\n    // Drag to scroll viewport\n    useDragToScroll(viewportRef);\n\n    const header = (\n        <Header\n            // Diagram\n            diagram={diagram.history.present}\n            diagramPast={diagram.history.past}\n            diagramFuture={diagram.history.future}\n            diagramDispatch={diagram.dispatch}\n            // Prefs\n            prefs={props.prefs}\n            setPrefs={props.setPrefs}\n            // State\n            setIsCapture={setIsCapture}\n            setSelectIds={select.setIds}\n            // Library\n            library={library.library}\n            setLibrary={library.setLibrary}\n        />\n    );\n\n    const canvas = (\n        <div\n            className={[background.secondary, s.canvas].join(\" \")}\n            tabIndex={0}\n            ref={viewportRef}\n            onKeyDown={(event) => {\n                catchDelete({\n                    ids: select.ids,\n                    diagramDispatch: diagram.dispatch,\n                    event,\n                });\n            }}\n        >\n            <Canvas\n                // Diagram\n                diagram={diagram.history.present}\n                diagramDispatch={diagram.dispatch}\n                showCreateEdge={createEdge.showPopup}\n                // View\n                viewportRef={viewportRef}\n                isCapture={isCapture}\n                // Select\n                selectedRefs={select.refs}\n                selectedTables={select.tables}\n                setSelectIds={select.setIds}\n                // Prefs\n                prefs={props.prefs}\n            />\n        </div>\n    );\n\n    const libraryPane = props.prefs.libraryVisible && (\n        <>\n            <div\n                className={s.library}\n                ref={libraryRef}\n                style={{ width: props.prefs.libraryWidth }}\n            >\n                <LibraryPane\n                    library={library.library}\n                    setLibrary={library.setLibrary}\n                    diagram={diagram.history.present}\n                    diagramDispatch={diagram.dispatch}\n                />\n            </div>\n            <ViewResizer libraryRef={libraryRef} setPrefs={props.setPrefs} />\n        </>\n    );\n\n    return (\n        <div className={s.container}>\n            <div className={s.header} children={header} />\n            <div className={s.body}>\n                {libraryPane}\n                {canvas}\n            </div>\n            <ViewProgress />\n            <RowDragLayer viewportRef={viewportRef} />\n            {createEdge.props && (\n                <CreateEdge\n                    tables={diagram.history.present.tables}\n                    idKey={diagram.history.present.columns[0].value.name}\n                    diagramDispatch={diagram.dispatch}\n                    {...createEdge.props}\n                />\n            )}\n        </div>\n    );\n};\n","import * as React from \"react\";\nimport { usePopper } from \"react-popper\";\n\ntype PopperProps = Pick<ReturnType<typeof usePopper>, \"styles\" | \"attributes\">;\n\nexport interface CreateEdgeProps extends PopperProps {\n    fromTable: number;\n    fromRows: number[];\n    setPopup: React.Dispatch<React.SetStateAction<HTMLElement | null>>;\n    setArrow: React.Dispatch<React.SetStateAction<HTMLElement | null>>;\n    setVisible: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nexport type ShowCreateEdgePopup = (\n    table: number,\n    rows: number[],\n    element: HTMLElement\n) => void;\n\ninterface CreateEdgeState {\n    props: CreateEdgeProps | null;\n    showPopup: ShowCreateEdgePopup;\n}\n\nexport const useCreateEdge = (): CreateEdgeState => {\n    const [visible, setVisible] = React.useState<boolean>(false);\n    // Popover state\n    const [target, setTarget] = React.useState<HTMLElement | null>(null);\n    const [popup, setPopup] = React.useState<HTMLElement | null>(null);\n    const [arrow, setArrow] = React.useState<HTMLElement | null>(null);\n    const { styles, attributes } = usePopper(target, popup, {\n        placement: \"right\",\n        modifiers: [\n            { name: \"arrow\", options: { element: arrow } },\n            { name: \"hide\" },\n        ],\n    });\n    // Initial state\n    const [fromTable, setFromTable] = React.useState<number>(0);\n    const [fromRows, setFromRows] = React.useState<number[]>([]);\n\n    // Memoize because we will pass this to Row and Table\n    const showPopup: ShowCreateEdgePopup = React.useMemo(() => {\n        return (table, rows, element) => {\n            setTarget(element);\n            setFromTable(table);\n            setFromRows(rows);\n            setVisible(true);\n        };\n    }, []);\n\n    // Close on outside click\n    React.useEffect(() => {\n        if (visible === false) return;\n        if (popup === null) return;\n        const listener = (event: MouseEvent) => {\n            if (!(event.target instanceof Node)) return;\n            if (popup.contains(event.target)) return;\n            if (target === null) throw Error(\"target is null\");\n            target.focus();\n            setVisible(false);\n        };\n        document.addEventListener(\"click\", listener);\n        return () => document.removeEventListener(\"click\", listener);\n    }, [visible, popup, target]);\n\n    const props = visible\n        ? {\n              styles,\n              attributes,\n              fromTable,\n              fromRows,\n              setArrow,\n              setPopup,\n              setVisible,\n          }\n        : null;\n    return { showPopup, props };\n};\n","import React from \"react\";\nimport { addExternalFnDirect } from \"utils/external\";\nimport { PrefsProps } from \"./pref\";\n\nexport type Theme = \"light\" | \"dark\" | \"auto\";\n\nconst themes: Theme[] = [\"light\", \"dark\", \"auto\"];\n\nconst isTheme = (theme: any): theme is Theme => themes.includes(theme);\n\nconst applyTheme = (theme: Theme): void => {\n    const themeClasses = themes.map((name) => `theme-${name}`);\n    document.documentElement.classList.remove(...themeClasses);\n    document.documentElement.classList.add(`theme-${theme}`);\n};\n\nconst getTheme = (theme: string): Theme => {\n    if (isTheme(theme)) return theme;\n    throw Error(`Theme is unknown: ${theme}`);\n};\n\nexport const initialTheme: {\n    current: null | Theme;\n} = {\n    current: null,\n};\n\naddExternalFnDirect(\"setTheme\", (text: string) => {\n    const theme = getTheme(text);\n    applyTheme(theme);\n    initialTheme.current = theme;\n});\n\nexport const useTheme = (props: PrefsProps) => {\n    const { theme } = props.prefs;\n    const { setPrefs } = props;\n\n    React.useEffect(() => {\n        applyTheme(theme);\n    }, [theme]);\n\n    React.useEffect(() => {\n        addExternalFnDirect(\"setTheme\", (text: string): void => {\n            setPrefs((prev) => ({ ...prev, theme: getTheme(text) }));\n        });\n    }, [setPrefs]);\n};\n","import * as React from \"react\";\nimport { initialTheme, Theme } from \"./theme\";\n\nexport interface Prefs {\n    theme: Theme;\n    zoom: number;\n    footerVisible: boolean;\n    edgeAnimation: boolean;\n    libraryVisible: boolean;\n    libraryWidth: number;\n}\n\nconst defaultPrefs: Prefs = {\n    theme: \"auto\",\n    zoom: 1,\n    footerVisible: true,\n    libraryVisible: false,\n    edgeAnimation: true,\n    libraryWidth: 320,\n};\n\nconst STORAGE_KEY = \"dg/prefs\";\n\nconst getInitial = (): Prefs => {\n    const theme = initialTheme.current ?? defaultPrefs.theme;\n    const stored = window.localStorage.getItem(STORAGE_KEY);\n    if (stored === null) return { ...defaultPrefs, theme };\n    const prefs = JSON.parse(stored) as Partial<Prefs>;\n    return { ...defaultPrefs, ...prefs, theme };\n};\n\nexport const usePrefs = (): PrefsProps => {\n    const [prefs, setPrefs] = React.useState(getInitial);\n    React.useEffect(() => {\n        window.localStorage.setItem(STORAGE_KEY, JSON.stringify(prefs));\n    }, [prefs]);\n    return { prefs, setPrefs };\n};\n\nexport interface PrefsProps {\n    prefs: Prefs;\n    setPrefs: React.Dispatch<React.SetStateAction<Prefs>>;\n}\n","import { DivEm, MutedDiv, Paragraph } from \"@moai/core\";\nimport React from \"react\";\nimport s from \"./links.module.scss\";\n\nconst TPLink = () => (\n    <span>\n        <span> 2020 </span>\n        <a\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            href=\"https://tableplus.com\"\n            children=\"TablePlus Inc.\"\n        />\n    </span>\n);\n\nexport const FooterLinks = () => (\n    <MutedDiv>\n        <div className={s.container}>\n            <Paragraph>\n                <a href=\"mailto:nick@tableplus.com\">Email us</a>\n                <DivEm />\n                <a\n                    rel=\"noopener noreferrer\"\n                    target=\"_blank\"\n                    href=\"https://github.com/TablePlus/diagram-plugin\"\n                    children=\"Issue tracker\"\n                />\n                <span className={s.tptop}>\n                    <DivEm />\n                    <TPLink />\n                </span>\n            </Paragraph>\n            <Paragraph>\n                <span className={s.nobreak}>1100-1959 Upper Water Street</span>\n                <span> </span>\n                <span className={s.nobreak}>Halifax NS Canada.</span>\n                <span> </span>\n                <span className={s.nobreak}>All rights reserved</span>\n            </Paragraph>\n        </div>\n    </MutedDiv>\n);\n","import React from \"react\";\n\nimport { Paragraph, Strong } from \"@moai/core\";\nimport s from \"./privacy.module.scss\";\n\ninterface Props {\n    dataText: string;\n}\n\nexport const FooterPrivacy: React.FC<Props> = ({ dataText }) => (\n    <div className={s.container}>\n        <Paragraph>\n            <Strong>Your data are safe here. </Strong>\n            <span>\n                We process your {dataText} right in the browser, so no data\n                shall leave this device.\n            </span>\n        </Paragraph>\n    </div>\n);\n","import { Button } from \"@moai/core\";\nimport { icons } from \"@moai/icon\";\nimport { Prefs } from \"pref/pref\";\nimport * as React from \"react\";\n\ninterface Props {\n    setPrefs: React.Dispatch<React.SetStateAction<Prefs>>;\n}\n\nconst closeFooter = (prev: Prefs): Prefs => ({ ...prev, footerVisible: false });\n\nexport const FooterClose = (props: Props) => (\n    <Button\n        style={Button.style.flat}\n        onClick={() => props.setPrefs(closeFooter)}\n        icon={icons.chevronDown}\n        title=\"Close the footer\"\n    />\n);\n","import { DivGrow, DivPx } from \"@moai/core\";\nimport logo from \"./logo.png\";\nimport { FooterLinks } from \"./links/links\";\nimport { FooterPrivacy } from \"./privacy/privacy\";\nimport React from \"react\";\nimport s from \"./footer.module.scss\";\nimport { FooterClose } from \"./close/close\";\nimport { Prefs } from \"pref/pref\";\n\nconst Logo = () => (\n    <a\n        className={s.logo}\n        href=\"https://tableplus.com\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n    >\n        <img alt=\"TablePlus logo\" src={logo} width=\"auto\" height={32} />\n    </a>\n);\n\ninterface Props {\n    setPrefs: React.Dispatch<React.SetStateAction<Prefs>>;\n}\n\nexport const Footer = (props: Props) => (\n    <div className={s.container}>\n        <DivPx size={16} />\n        <FooterClose setPrefs={props.setPrefs} />\n        <DivPx size={16} />\n        <FooterPrivacy dataText=\"diagram\" />\n        <DivGrow />\n        <FooterLinks />\n        <DivPx size={16} />\n        <Logo />\n        <DivPx size={16} />\n    </div>\n);\n","import { Button, DivPx, Paragraph } from \"@moai/core\";\nimport * as React from \"react\";\nimport { usePlatform } from \"utils/platform\";\nimport { ErrorReport } from \"./report/report\";\n\ninterface Props {\n    children: React.ReactChild;\n}\n\ninterface State {\n    hasError: boolean;\n    error: any;\n}\n\nconst Description = () => (\n    <>\n        <Paragraph>\n            Please tell us about this problem. We will treat your report as\n            confidential and anonymous.\n        </Paragraph>\n        <DivPx size={8} />\n        <Paragraph>\n            To help us diagnose the problem, please describe what you were doing\n            when this error occured:\n        </Paragraph>\n        <DivPx size={8} />\n    </>\n);\n\nconst Footer = () => {\n    const platform = usePlatform();\n    if (platform !== \"web\") return null;\n    const reload = () => window.location.reload();\n    return <Button onClick={reload} children=\"Reload\" />;\n};\n\nexport class ErrorBoundary extends React.Component<Props, State> {\n    constructor(props: Props) {\n        super(props);\n        this.state = { hasError: false, error: null };\n    }\n\n    static getDerivedStateFromError(error: any) {\n        return { hasError: true, error };\n    }\n\n    render() {\n        if (this.state.hasError)\n            return (\n                <ErrorReport\n                    type=\"uncaught\"\n                    title=\"There was an unexpected error\"\n                    description={<Description />}\n                    footer={<Footer />}\n                    error={this.state.error}\n                />\n            );\n        return this.props.children;\n    }\n}\n","import { Border, scrollbar } from \"@moai/core\";\nimport { View } from \"app/view/view\";\nimport { usePrefs } from \"pref/pref\";\nimport { useTheme } from \"pref/theme\";\nimport React from \"react\";\nimport { usePlatform } from \"utils/platform\";\nimport s from \"./app.module.scss\";\nimport { Footer } from \"./footer/footer\";\nimport { ErrorBoundary } from \"./error/error\";\n\nexport const App = () => {\n    const platform = usePlatform();\n    const { prefs, setPrefs } = usePrefs();\n    useTheme({ prefs, setPrefs });\n\n    return (\n        <ErrorBoundary>\n            <div className={[s.container, scrollbar.custom].join(\" \")}>\n                <div className={s.body}>\n                    <View prefs={prefs} setPrefs={setPrefs} />\n                </div>\n                {platform === \"web\" && prefs.footerVisible && (\n                    <>\n                        <Border color=\"strong\" />\n                        <div className={s.footer}>\n                            <Footer setPrefs={setPrefs} />\n                        </div>\n                    </>\n                )}\n            </div>\n        </ErrorBoundary>\n    );\n};\n","import \"@moai/core/dist/font/inter.scss\";\nimport { App } from \"app/app/app\";\nimport \"index.scss\";\nimport React from \"react\";\nimport { DndProvider } from \"react-dnd-multi-backend\";\nimport HTML5toTouch from \"react-dnd-multi-backend/dist/esm/HTML5toTouch\";\nimport ReactDOM from \"react-dom\";\nimport { initExternalFns } from \"utils/external\";\nimport { PlatformContext, usePlatformProvider } from \"utils/platform\";\nimport { initVersionControl } from \"utils/version\";\n\ninitVersionControl();\ninitExternalFns();\n\nconst Root = () => {\n    const platform = usePlatformProvider();\n    return (\n        <React.StrictMode>\n            <PlatformContext.Provider value={platform}>\n                <DndProvider options={HTML5toTouch}>\n                    <App />\n                </DndProvider>\n            </PlatformContext.Provider>\n        </React.StrictMode>\n    );\n};\n\nReactDOM.render(<Root />, document.getElementById(\"root\"));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"links_container__1D7C_\",\"nobreak\":\"links_nobreak__2Iiva\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"shape\":\"arrow_shape__fBrkz\",\"menu\":\"arrow_menu__2pAy7\",\"container\":\"arrow_container__127FP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"item_input__35qzn\",\"has\":\"item_has__QaVDK\",\"text\":\"item_text__1ek-c\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"report_container__35CZ6\",\"backdrop\":\"report_backdrop__TrgnD\",\"main\":\"report_main__3ezHR\",\"body\":\"report_body__29c75\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"layer_container__1DSen\",\"svg\":\"layer_svg__1kDpM\",\"line\":\"layer_line__24WBc\",\"icon\":\"layer_icon__1W0JP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"string_container__6Pyow\",\"view\":\"string_view__1oiV8\",\"weak\":\"string_weak__3HpXd\",\"edit\":\"string_edit__2m0iK\",\"empty\":\"string_empty__3u9-r\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"header_container__1QU6W\",\"main\":\"header_main__1XQwN\",\"edit\":\"header_edit__3vvV8\",\"menu\":\"header_menu__2-GKA\",\"title\":\"header_title__l4mqY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"side_container__2xx4C\",\"label\":\"side_label__eAE1p\",\"table\":\"side_table__2Ikrz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"header_container__2zpDr\",\"slide-in\":\"header_slide-in__TPuT0\",\"field\":\"header_field__nquLg\",\"rightField\":\"header_rightField__3R_Ju\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"source_container__3TgWW\",\"slide-in\":\"source_slide-in__P2Ug9\",\"dragging\":\"source_dragging__1rxAg\",\"button\":\"source_button__2cu3w\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"main_container__24nAp\",\"selected\":\"main_selected__1OzJ8\",\"edit\":\"main_edit__KBdPX\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"drag_container__1_FJJ\",\"box\":\"drag_box__2nmY1\",\"boxBg\":\"drag_boxBg__32YQk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"item_container__VRemY\",\"primary\":\"item_primary__3XhBc\",\"secondary\":\"item_secondary__23cx0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"library_header__cU237\",\"title\":\"library_title__y7g63\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"app_container__2pv2U\",\"body\":\"app_body__3dFS1\",\"footer\":\"app_footer__1cpy9\"};"],"sourceRoot":""}